(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const d of l.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function i(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(o){if(o.ep)return;o.ep=!0;const l=i(o);fetch(o.href,l)}})();function Wk(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var Ud={exports:{}},Nr={};var Dv;function Xk(){if(Dv)return Nr;Dv=1;var a=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function i(s,o,l){var d=null;if(l!==void 0&&(d=""+l),o.key!==void 0&&(d=""+o.key),"key"in o){l={};for(var u in o)u!=="key"&&(l[u]=o[u])}else l=o;return o=l.ref,{$$typeof:a,type:s,key:d,ref:o!==void 0?o:null,props:l}}return Nr.Fragment=e,Nr.jsx=i,Nr.jsxs=i,Nr}var Ov;function Zk(){return Ov||(Ov=1,Ud.exports=Xk()),Ud.exports}var h=Zk(),Bd={exports:{}},ge={};var jv;function $k(){if(jv)return ge;jv=1;var a=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),d=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),y=Symbol.for("react.activity"),S=Symbol.iterator;function C(A){return A===null||typeof A!="object"?null:(A=S&&A[S]||A["@@iterator"],typeof A=="function"?A:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,k={};function R(A,Y,se){this.props=A,this.context=Y,this.refs=k,this.updater=se||_}R.prototype.isReactComponent={},R.prototype.setState=function(A,Y){if(typeof A!="object"&&typeof A!="function"&&A!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,A,Y,"setState")},R.prototype.forceUpdate=function(A){this.updater.enqueueForceUpdate(this,A,"forceUpdate")};function O(){}O.prototype=R.prototype;function L(A,Y,se){this.props=A,this.context=Y,this.refs=k,this.updater=se||_}var D=L.prototype=new O;D.constructor=L,x(D,R.prototype),D.isPureReactComponent=!0;var I=Array.isArray;function j(){}var H={H:null,A:null,T:null,S:null},Z=Object.prototype.hasOwnProperty;function ee(A,Y,se){var le=se.ref;return{$$typeof:a,type:A,key:Y,ref:le!==void 0?le:null,props:se}}function te(A,Y){return ee(A.type,Y,A.props)}function re(A){return typeof A=="object"&&A!==null&&A.$$typeof===a}function ue(A){var Y={"=":"=0",":":"=2"};return"$"+A.replace(/[=:]/g,function(se){return Y[se]})}var Me=/\/+/g;function We(A,Y){return typeof A=="object"&&A!==null&&A.key!=null?ue(""+A.key):Y.toString(36)}function ze(A){switch(A.status){case"fulfilled":return A.value;case"rejected":throw A.reason;default:switch(typeof A.status=="string"?A.then(j,j):(A.status="pending",A.then(function(Y){A.status==="pending"&&(A.status="fulfilled",A.value=Y)},function(Y){A.status==="pending"&&(A.status="rejected",A.reason=Y)})),A.status){case"fulfilled":return A.value;case"rejected":throw A.reason}}throw A}function z(A,Y,se,le,pe){var ye=typeof A;(ye==="undefined"||ye==="boolean")&&(A=null);var Be=!1;if(A===null)Be=!0;else switch(ye){case"bigint":case"string":case"number":Be=!0;break;case"object":switch(A.$$typeof){case a:case e:Be=!0;break;case v:return Be=A._init,z(Be(A._payload),Y,se,le,pe)}}if(Be)return pe=pe(A),Be=le===""?"."+We(A,0):le,I(pe)?(se="",Be!=null&&(se=Be.replace(Me,"$&/")+"/"),z(pe,Y,se,"",function(Is){return Is})):pe!=null&&(re(pe)&&(pe=te(pe,se+(pe.key==null||A&&A.key===pe.key?"":(""+pe.key).replace(Me,"$&/")+"/")+Be)),Y.push(pe)),1;Be=0;var Dt=le===""?".":le+":";if(I(A))for(var ot=0;ot<A.length;ot++)le=A[ot],ye=Dt+We(le,ot),Be+=z(le,Y,se,ye,pe);else if(ot=C(A),typeof ot=="function")for(A=ot.call(A),ot=0;!(le=A.next()).done;)le=le.value,ye=Dt+We(le,ot++),Be+=z(le,Y,se,ye,pe);else if(ye==="object"){if(typeof A.then=="function")return z(ze(A),Y,se,le,pe);throw Y=String(A),Error("Objects are not valid as a React child (found: "+(Y==="[object Object]"?"object with keys {"+Object.keys(A).join(", ")+"}":Y)+"). If you meant to render a collection of children, use an array instead.")}return Be}function ne(A,Y,se){if(A==null)return A;var le=[],pe=0;return z(A,le,"","",function(ye){return Y.call(se,ye,pe++)}),le}function he(A){if(A._status===-1){var Y=A._result;Y=Y(),Y.then(function(se){(A._status===0||A._status===-1)&&(A._status=1,A._result=se)},function(se){(A._status===0||A._status===-1)&&(A._status=2,A._result=se)}),A._status===-1&&(A._status=0,A._result=Y)}if(A._status===1)return A._result.default;throw A._result}var Oe=typeof reportError=="function"?reportError:function(A){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Y=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof A=="object"&&A!==null&&typeof A.message=="string"?String(A.message):String(A),error:A});if(!window.dispatchEvent(Y))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",A);return}console.error(A)},Le={map:ne,forEach:function(A,Y,se){ne(A,function(){Y.apply(this,arguments)},se)},count:function(A){var Y=0;return ne(A,function(){Y++}),Y},toArray:function(A){return ne(A,function(Y){return Y})||[]},only:function(A){if(!re(A))throw Error("React.Children.only expected to receive a single React element child.");return A}};return ge.Activity=y,ge.Children=Le,ge.Component=R,ge.Fragment=i,ge.Profiler=o,ge.PureComponent=L,ge.StrictMode=s,ge.Suspense=f,ge.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=H,ge.__COMPILER_RUNTIME={__proto__:null,c:function(A){return H.H.useMemoCache(A)}},ge.cache=function(A){return function(){return A.apply(null,arguments)}},ge.cacheSignal=function(){return null},ge.cloneElement=function(A,Y,se){if(A==null)throw Error("The argument must be a React element, but you passed "+A+".");var le=x({},A.props),pe=A.key;if(Y!=null)for(ye in Y.key!==void 0&&(pe=""+Y.key),Y)!Z.call(Y,ye)||ye==="key"||ye==="__self"||ye==="__source"||ye==="ref"&&Y.ref===void 0||(le[ye]=Y[ye]);var ye=arguments.length-2;if(ye===1)le.children=se;else if(1<ye){for(var Be=Array(ye),Dt=0;Dt<ye;Dt++)Be[Dt]=arguments[Dt+2];le.children=Be}return ee(A.type,pe,le)},ge.createContext=function(A){return A={$$typeof:d,_currentValue:A,_currentValue2:A,_threadCount:0,Provider:null,Consumer:null},A.Provider=A,A.Consumer={$$typeof:l,_context:A},A},ge.createElement=function(A,Y,se){var le,pe={},ye=null;if(Y!=null)for(le in Y.key!==void 0&&(ye=""+Y.key),Y)Z.call(Y,le)&&le!=="key"&&le!=="__self"&&le!=="__source"&&(pe[le]=Y[le]);var Be=arguments.length-2;if(Be===1)pe.children=se;else if(1<Be){for(var Dt=Array(Be),ot=0;ot<Be;ot++)Dt[ot]=arguments[ot+2];pe.children=Dt}if(A&&A.defaultProps)for(le in Be=A.defaultProps,Be)pe[le]===void 0&&(pe[le]=Be[le]);return ee(A,ye,pe)},ge.createRef=function(){return{current:null}},ge.forwardRef=function(A){return{$$typeof:u,render:A}},ge.isValidElement=re,ge.lazy=function(A){return{$$typeof:v,_payload:{_status:-1,_result:A},_init:he}},ge.memo=function(A,Y){return{$$typeof:p,type:A,compare:Y===void 0?null:Y}},ge.startTransition=function(A){var Y=H.T,se={};H.T=se;try{var le=A(),pe=H.S;pe!==null&&pe(se,le),typeof le=="object"&&le!==null&&typeof le.then=="function"&&le.then(j,Oe)}catch(ye){Oe(ye)}finally{Y!==null&&se.types!==null&&(Y.types=se.types),H.T=Y}},ge.unstable_useCacheRefresh=function(){return H.H.useCacheRefresh()},ge.use=function(A){return H.H.use(A)},ge.useActionState=function(A,Y,se){return H.H.useActionState(A,Y,se)},ge.useCallback=function(A,Y){return H.H.useCallback(A,Y)},ge.useContext=function(A){return H.H.useContext(A)},ge.useDebugValue=function(){},ge.useDeferredValue=function(A,Y){return H.H.useDeferredValue(A,Y)},ge.useEffect=function(A,Y){return H.H.useEffect(A,Y)},ge.useEffectEvent=function(A){return H.H.useEffectEvent(A)},ge.useId=function(){return H.H.useId()},ge.useImperativeHandle=function(A,Y,se){return H.H.useImperativeHandle(A,Y,se)},ge.useInsertionEffect=function(A,Y){return H.H.useInsertionEffect(A,Y)},ge.useLayoutEffect=function(A,Y){return H.H.useLayoutEffect(A,Y)},ge.useMemo=function(A,Y){return H.H.useMemo(A,Y)},ge.useOptimistic=function(A,Y){return H.H.useOptimistic(A,Y)},ge.useReducer=function(A,Y,se){return H.H.useReducer(A,Y,se)},ge.useRef=function(A){return H.H.useRef(A)},ge.useState=function(A){return H.H.useState(A)},ge.useSyncExternalStore=function(A,Y,se){return H.H.useSyncExternalStore(A,Y,se)},ge.useTransition=function(){return H.H.useTransition()},ge.version="19.2.4",ge}var Pv;function Yh(){return Pv||(Pv=1,Bd.exports=$k()),Bd.exports}var M=Yh();const e1=Wk(M);var qd={exports:{}},Ar={},Fd={exports:{}},zd={};var Iv;function t1(){return Iv||(Iv=1,(function(a){function e(z,ne){var he=z.length;z.push(ne);e:for(;0<he;){var Oe=he-1>>>1,Le=z[Oe];if(0<o(Le,ne))z[Oe]=ne,z[he]=Le,he=Oe;else break e}}function i(z){return z.length===0?null:z[0]}function s(z){if(z.length===0)return null;var ne=z[0],he=z.pop();if(he!==ne){z[0]=he;e:for(var Oe=0,Le=z.length,A=Le>>>1;Oe<A;){var Y=2*(Oe+1)-1,se=z[Y],le=Y+1,pe=z[le];if(0>o(se,he))le<Le&&0>o(pe,se)?(z[Oe]=pe,z[le]=he,Oe=le):(z[Oe]=se,z[Y]=he,Oe=Y);else if(le<Le&&0>o(pe,he))z[Oe]=pe,z[le]=he,Oe=le;else break e}}return ne}function o(z,ne){var he=z.sortIndex-ne.sortIndex;return he!==0?he:z.id-ne.id}if(a.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;a.unstable_now=function(){return l.now()}}else{var d=Date,u=d.now();a.unstable_now=function(){return d.now()-u}}var f=[],p=[],v=1,y=null,S=3,C=!1,_=!1,x=!1,k=!1,R=typeof setTimeout=="function"?setTimeout:null,O=typeof clearTimeout=="function"?clearTimeout:null,L=typeof setImmediate<"u"?setImmediate:null;function D(z){for(var ne=i(p);ne!==null;){if(ne.callback===null)s(p);else if(ne.startTime<=z)s(p),ne.sortIndex=ne.expirationTime,e(f,ne);else break;ne=i(p)}}function I(z){if(x=!1,D(z),!_)if(i(f)!==null)_=!0,j||(j=!0,ue());else{var ne=i(p);ne!==null&&ze(I,ne.startTime-z)}}var j=!1,H=-1,Z=5,ee=-1;function te(){return k?!0:!(a.unstable_now()-ee<Z)}function re(){if(k=!1,j){var z=a.unstable_now();ee=z;var ne=!0;try{e:{_=!1,x&&(x=!1,O(H),H=-1),C=!0;var he=S;try{t:{for(D(z),y=i(f);y!==null&&!(y.expirationTime>z&&te());){var Oe=y.callback;if(typeof Oe=="function"){y.callback=null,S=y.priorityLevel;var Le=Oe(y.expirationTime<=z);if(z=a.unstable_now(),typeof Le=="function"){y.callback=Le,D(z),ne=!0;break t}y===i(f)&&s(f),D(z)}else s(f);y=i(f)}if(y!==null)ne=!0;else{var A=i(p);A!==null&&ze(I,A.startTime-z),ne=!1}}break e}finally{y=null,S=he,C=!1}ne=void 0}}finally{ne?ue():j=!1}}}var ue;if(typeof L=="function")ue=function(){L(re)};else if(typeof MessageChannel<"u"){var Me=new MessageChannel,We=Me.port2;Me.port1.onmessage=re,ue=function(){We.postMessage(null)}}else ue=function(){R(re,0)};function ze(z,ne){H=R(function(){z(a.unstable_now())},ne)}a.unstable_IdlePriority=5,a.unstable_ImmediatePriority=1,a.unstable_LowPriority=4,a.unstable_NormalPriority=3,a.unstable_Profiling=null,a.unstable_UserBlockingPriority=2,a.unstable_cancelCallback=function(z){z.callback=null},a.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Z=0<z?Math.floor(1e3/z):5},a.unstable_getCurrentPriorityLevel=function(){return S},a.unstable_next=function(z){switch(S){case 1:case 2:case 3:var ne=3;break;default:ne=S}var he=S;S=ne;try{return z()}finally{S=he}},a.unstable_requestPaint=function(){k=!0},a.unstable_runWithPriority=function(z,ne){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var he=S;S=z;try{return ne()}finally{S=he}},a.unstable_scheduleCallback=function(z,ne,he){var Oe=a.unstable_now();switch(typeof he=="object"&&he!==null?(he=he.delay,he=typeof he=="number"&&0<he?Oe+he:Oe):he=Oe,z){case 1:var Le=-1;break;case 2:Le=250;break;case 5:Le=1073741823;break;case 4:Le=1e4;break;default:Le=5e3}return Le=he+Le,z={id:v++,callback:ne,priorityLevel:z,startTime:he,expirationTime:Le,sortIndex:-1},he>Oe?(z.sortIndex=he,e(p,z),i(f)===null&&z===i(p)&&(x?(O(H),H=-1):x=!0,ze(I,he-Oe))):(z.sortIndex=Le,e(f,z),_||C||(_=!0,j||(j=!0,ue()))),z},a.unstable_shouldYield=te,a.unstable_wrapCallback=function(z){var ne=S;return function(){var he=S;S=ne;try{return z.apply(this,arguments)}finally{S=he}}}})(zd)),zd}var Lv;function n1(){return Lv||(Lv=1,Fd.exports=t1()),Fd.exports}var Hd={exports:{}},At={};var Uv;function i1(){if(Uv)return At;Uv=1;var a=Yh();function e(f){var p="https://react.dev/errors/"+f;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var v=2;v<arguments.length;v++)p+="&args[]="+encodeURIComponent(arguments[v])}return"Minified React error #"+f+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(){}var s={d:{f:i,r:function(){throw Error(e(522))},D:i,C:i,L:i,m:i,X:i,S:i,M:i},p:0,findDOMNode:null},o=Symbol.for("react.portal");function l(f,p,v){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:y==null?null:""+y,children:f,containerInfo:p,implementation:v}}var d=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(f,p){if(f==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return At.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,At.createPortal=function(f,p){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return l(f,p,null,v)},At.flushSync=function(f){var p=d.T,v=s.p;try{if(d.T=null,s.p=2,f)return f()}finally{d.T=p,s.p=v,s.d.f()}},At.preconnect=function(f,p){typeof f=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,s.d.C(f,p))},At.prefetchDNS=function(f){typeof f=="string"&&s.d.D(f)},At.preinit=function(f,p){if(typeof f=="string"&&p&&typeof p.as=="string"){var v=p.as,y=u(v,p.crossOrigin),S=typeof p.integrity=="string"?p.integrity:void 0,C=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;v==="style"?s.d.S(f,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:y,integrity:S,fetchPriority:C}):v==="script"&&s.d.X(f,{crossOrigin:y,integrity:S,fetchPriority:C,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},At.preinitModule=function(f,p){if(typeof f=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var v=u(p.as,p.crossOrigin);s.d.M(f,{crossOrigin:v,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&s.d.M(f)},At.preload=function(f,p){if(typeof f=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var v=p.as,y=u(v,p.crossOrigin);s.d.L(f,v,{crossOrigin:y,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},At.preloadModule=function(f,p){if(typeof f=="string")if(p){var v=u(p.as,p.crossOrigin);s.d.m(f,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:v,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else s.d.m(f)},At.requestFormReset=function(f){s.d.r(f)},At.unstable_batchedUpdates=function(f,p){return f(p)},At.useFormState=function(f,p,v){return d.H.useFormState(f,p,v)},At.useFormStatus=function(){return d.H.useHostTransitionStatus()},At.version="19.2.4",At}var Bv;function a1(){if(Bv)return Hd.exports;Bv=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(e){console.error(e)}}return a(),Hd.exports=i1(),Hd.exports}var qv;function s1(){if(qv)return Ar;qv=1;var a=n1(),e=Yh(),i=a1();function s(t){var n="https://react.dev/errors/"+t;if(1<arguments.length){n+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)n+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+t+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function l(t){var n=t,r=t;if(t.alternate)for(;n.return;)n=n.return;else{t=n;do n=t,(n.flags&4098)!==0&&(r=n.return),t=n.return;while(t)}return n.tag===3?r:null}function d(t){if(t.tag===13){var n=t.memoizedState;if(n===null&&(t=t.alternate,t!==null&&(n=t.memoizedState)),n!==null)return n.dehydrated}return null}function u(t){if(t.tag===31){var n=t.memoizedState;if(n===null&&(t=t.alternate,t!==null&&(n=t.memoizedState)),n!==null)return n.dehydrated}return null}function f(t){if(l(t)!==t)throw Error(s(188))}function p(t){var n=t.alternate;if(!n){if(n=l(t),n===null)throw Error(s(188));return n!==t?null:t}for(var r=t,c=n;;){var m=r.return;if(m===null)break;var g=m.alternate;if(g===null){if(c=m.return,c!==null){r=c;continue}break}if(m.child===g.child){for(g=m.child;g;){if(g===r)return f(m),t;if(g===c)return f(m),n;g=g.sibling}throw Error(s(188))}if(r.return!==c.return)r=m,c=g;else{for(var b=!1,T=m.child;T;){if(T===r){b=!0,r=m,c=g;break}if(T===c){b=!0,c=m,r=g;break}T=T.sibling}if(!b){for(T=g.child;T;){if(T===r){b=!0,r=g,c=m;break}if(T===c){b=!0,c=g,r=m;break}T=T.sibling}if(!b)throw Error(s(189))}}if(r.alternate!==c)throw Error(s(190))}if(r.tag!==3)throw Error(s(188));return r.stateNode.current===r?t:n}function v(t){var n=t.tag;if(n===5||n===26||n===27||n===6)return t;for(t=t.child;t!==null;){if(n=v(t),n!==null)return n;t=t.sibling}return null}var y=Object.assign,S=Symbol.for("react.element"),C=Symbol.for("react.transitional.element"),_=Symbol.for("react.portal"),x=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),O=Symbol.for("react.consumer"),L=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),j=Symbol.for("react.suspense_list"),H=Symbol.for("react.memo"),Z=Symbol.for("react.lazy"),ee=Symbol.for("react.activity"),te=Symbol.for("react.memo_cache_sentinel"),re=Symbol.iterator;function ue(t){return t===null||typeof t!="object"?null:(t=re&&t[re]||t["@@iterator"],typeof t=="function"?t:null)}var Me=Symbol.for("react.client.reference");function We(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===Me?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case x:return"Fragment";case R:return"Profiler";case k:return"StrictMode";case I:return"Suspense";case j:return"SuspenseList";case ee:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case _:return"Portal";case L:return t.displayName||"Context";case O:return(t._context.displayName||"Context")+".Consumer";case D:var n=t.render;return t=t.displayName,t||(t=n.displayName||n.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case H:return n=t.displayName||null,n!==null?n:We(t.type)||"Memo";case Z:n=t._payload,t=t._init;try{return We(t(n))}catch{}}return null}var ze=Array.isArray,z=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ne=i.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,he={pending:!1,data:null,method:null,action:null},Oe=[],Le=-1;function A(t){return{current:t}}function Y(t){0>Le||(t.current=Oe[Le],Oe[Le]=null,Le--)}function se(t,n){Le++,Oe[Le]=t.current,t.current=n}var le=A(null),pe=A(null),ye=A(null),Be=A(null);function Dt(t,n){switch(se(ye,n),se(pe,t),se(le,null),n.nodeType){case 9:case 11:t=(t=n.documentElement)&&(t=t.namespaceURI)?tv(t):0;break;default:if(t=n.tagName,n=n.namespaceURI)n=tv(n),t=nv(n,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}Y(le),se(le,t)}function ot(){Y(le),Y(pe),Y(ye)}function Is(t){t.memoizedState!==null&&se(Be,t);var n=le.current,r=nv(n,t.type);n!==r&&(se(pe,t),se(le,r))}function ao(t){pe.current===t&&(Y(le),Y(pe)),Be.current===t&&(Y(Be),Er._currentValue=he)}var Sc,Mf;function aa(t){if(Sc===void 0)try{throw Error()}catch(r){var n=r.stack.trim().match(/\n( *(at )?)/);Sc=n&&n[1]||"",Mf=-1<r.stack.indexOf(`
    at`)?" (<anonymous>)":-1<r.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Sc+t+Mf}var Tc=!1;function Cc(t,n){if(!t||Tc)return"";Tc=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(n){var J=function(){throw Error()};if(Object.defineProperty(J.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(J,[])}catch(V){var F=V}Reflect.construct(t,[],J)}else{try{J.call()}catch(V){F=V}t.call(J.prototype)}}else{try{throw Error()}catch(V){F=V}(J=t())&&typeof J.catch=="function"&&J.catch(function(){})}}catch(V){if(V&&F&&typeof V.stack=="string")return[V.stack,F.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=c.DetermineComponentFrameRoot(),b=g[0],T=g[1];if(b&&T){var w=b.split(`
`),q=T.split(`
`);for(m=c=0;c<w.length&&!w[c].includes("DetermineComponentFrameRoot");)c++;for(;m<q.length&&!q[m].includes("DetermineComponentFrameRoot");)m++;if(c===w.length||m===q.length)for(c=w.length-1,m=q.length-1;1<=c&&0<=m&&w[c]!==q[m];)m--;for(;1<=c&&0<=m;c--,m--)if(w[c]!==q[m]){if(c!==1||m!==1)do if(c--,m--,0>m||w[c]!==q[m]){var G=`
`+w[c].replace(" at new "," at ");return t.displayName&&G.includes("<anonymous>")&&(G=G.replace("<anonymous>",t.displayName)),G}while(1<=c&&0<=m);break}}}finally{Tc=!1,Error.prepareStackTrace=r}return(r=t?t.displayName||t.name:"")?aa(r):""}function _T(t,n){switch(t.tag){case 26:case 27:case 5:return aa(t.type);case 16:return aa("Lazy");case 13:return t.child!==n&&n!==null?aa("Suspense Fallback"):aa("Suspense");case 19:return aa("SuspenseList");case 0:case 15:return Cc(t.type,!1);case 11:return Cc(t.type.render,!1);case 1:return Cc(t.type,!0);case 31:return aa("Activity");default:return""}}function Df(t){try{var n="",r=null;do n+=_T(t,r),r=t,t=t.return;while(t);return n}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var kc=Object.prototype.hasOwnProperty,xc=a.unstable_scheduleCallback,Ec=a.unstable_cancelCallback,RT=a.unstable_shouldYield,NT=a.unstable_requestPaint,Jt=a.unstable_now,AT=a.unstable_getCurrentPriorityLevel,Of=a.unstable_ImmediatePriority,jf=a.unstable_UserBlockingPriority,so=a.unstable_NormalPriority,MT=a.unstable_LowPriority,Pf=a.unstable_IdlePriority,DT=a.log,OT=a.unstable_setDisableYieldValue,Ls=null,Qt=null;function bi(t){if(typeof DT=="function"&&OT(t),Qt&&typeof Qt.setStrictMode=="function")try{Qt.setStrictMode(Ls,t)}catch{}}var Wt=Math.clz32?Math.clz32:IT,jT=Math.log,PT=Math.LN2;function IT(t){return t>>>=0,t===0?32:31-(jT(t)/PT|0)|0}var ro=256,oo=262144,lo=4194304;function sa(t){var n=t&42;if(n!==0)return n;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return t&261888;case 262144:case 524288:case 1048576:case 2097152:return t&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function co(t,n,r){var c=t.pendingLanes;if(c===0)return 0;var m=0,g=t.suspendedLanes,b=t.pingedLanes;t=t.warmLanes;var T=c&134217727;return T!==0?(c=T&~g,c!==0?m=sa(c):(b&=T,b!==0?m=sa(b):r||(r=T&~t,r!==0&&(m=sa(r))))):(T=c&~g,T!==0?m=sa(T):b!==0?m=sa(b):r||(r=c&~t,r!==0&&(m=sa(r)))),m===0?0:n!==0&&n!==m&&(n&g)===0&&(g=m&-m,r=n&-n,g>=r||g===32&&(r&4194048)!==0)?n:m}function Us(t,n){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&n)===0}function LT(t,n){switch(t){case 1:case 2:case 4:case 8:case 64:return n+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function If(){var t=lo;return lo<<=1,(lo&62914560)===0&&(lo=4194304),t}function wc(t){for(var n=[],r=0;31>r;r++)n.push(t);return n}function Bs(t,n){t.pendingLanes|=n,n!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function UT(t,n,r,c,m,g){var b=t.pendingLanes;t.pendingLanes=r,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=r,t.entangledLanes&=r,t.errorRecoveryDisabledLanes&=r,t.shellSuspendCounter=0;var T=t.entanglements,w=t.expirationTimes,q=t.hiddenUpdates;for(r=b&~r;0<r;){var G=31-Wt(r),J=1<<G;T[G]=0,w[G]=-1;var F=q[G];if(F!==null)for(q[G]=null,G=0;G<F.length;G++){var V=F[G];V!==null&&(V.lane&=-536870913)}r&=~J}c!==0&&Lf(t,c,0),g!==0&&m===0&&t.tag!==0&&(t.suspendedLanes|=g&~(b&~n))}function Lf(t,n,r){t.pendingLanes|=n,t.suspendedLanes&=~n;var c=31-Wt(n);t.entangledLanes|=n,t.entanglements[c]=t.entanglements[c]|1073741824|r&261930}function Uf(t,n){var r=t.entangledLanes|=n;for(t=t.entanglements;r;){var c=31-Wt(r),m=1<<c;m&n|t[c]&n&&(t[c]|=n),r&=~m}}function Bf(t,n){var r=n&-n;return r=(r&42)!==0?1:_c(r),(r&(t.suspendedLanes|n))!==0?0:r}function _c(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function Rc(t){return t&=-t,2<t?8<t?(t&134217727)!==0?32:268435456:8:2}function qf(){var t=ne.p;return t!==0?t:(t=window.event,t===void 0?32:Ev(t.type))}function Ff(t,n){var r=ne.p;try{return ne.p=t,n()}finally{ne.p=r}}var Si=Math.random().toString(36).slice(2),kt="__reactFiber$"+Si,Ut="__reactProps$"+Si,ja="__reactContainer$"+Si,Nc="__reactEvents$"+Si,BT="__reactListeners$"+Si,qT="__reactHandles$"+Si,zf="__reactResources$"+Si,qs="__reactMarker$"+Si;function Ac(t){delete t[kt],delete t[Ut],delete t[Nc],delete t[BT],delete t[qT]}function Pa(t){var n=t[kt];if(n)return n;for(var r=t.parentNode;r;){if(n=r[ja]||r[kt]){if(r=n.alternate,n.child!==null||r!==null&&r.child!==null)for(t=cv(t);t!==null;){if(r=t[kt])return r;t=cv(t)}return n}t=r,r=t.parentNode}return null}function Ia(t){if(t=t[kt]||t[ja]){var n=t.tag;if(n===5||n===6||n===13||n===31||n===26||n===27||n===3)return t}return null}function Fs(t){var n=t.tag;if(n===5||n===26||n===27||n===6)return t.stateNode;throw Error(s(33))}function La(t){var n=t[zf];return n||(n=t[zf]={hoistableStyles:new Map,hoistableScripts:new Map}),n}function bt(t){t[qs]=!0}var Hf=new Set,Vf={};function ra(t,n){Ua(t,n),Ua(t+"Capture",n)}function Ua(t,n){for(Vf[t]=n,t=0;t<n.length;t++)Hf.add(n[t])}var FT=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Gf={},Kf={};function zT(t){return kc.call(Kf,t)?!0:kc.call(Gf,t)?!1:FT.test(t)?Kf[t]=!0:(Gf[t]=!0,!1)}function uo(t,n,r){if(zT(n))if(r===null)t.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":t.removeAttribute(n);return;case"boolean":var c=n.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){t.removeAttribute(n);return}}t.setAttribute(n,""+r)}}function ho(t,n,r){if(r===null)t.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(n);return}t.setAttribute(n,""+r)}}function Gn(t,n,r,c){if(c===null)t.removeAttribute(r);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(r);return}t.setAttributeNS(n,r,""+c)}}function on(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Yf(t){var n=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function HT(t,n,r){var c=Object.getOwnPropertyDescriptor(t.constructor.prototype,n);if(!t.hasOwnProperty(n)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var m=c.get,g=c.set;return Object.defineProperty(t,n,{configurable:!0,get:function(){return m.call(this)},set:function(b){r=""+b,g.call(this,b)}}),Object.defineProperty(t,n,{enumerable:c.enumerable}),{getValue:function(){return r},setValue:function(b){r=""+b},stopTracking:function(){t._valueTracker=null,delete t[n]}}}}function Mc(t){if(!t._valueTracker){var n=Yf(t)?"checked":"value";t._valueTracker=HT(t,n,""+t[n])}}function Jf(t){if(!t)return!1;var n=t._valueTracker;if(!n)return!0;var r=n.getValue(),c="";return t&&(c=Yf(t)?t.checked?"true":"false":t.value),t=c,t!==r?(n.setValue(t),!0):!1}function fo(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var VT=/[\n"\\]/g;function ln(t){return t.replace(VT,function(n){return"\\"+n.charCodeAt(0).toString(16)+" "})}function Dc(t,n,r,c,m,g,b,T){t.name="",b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"?t.type=b:t.removeAttribute("type"),n!=null?b==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+on(n)):t.value!==""+on(n)&&(t.value=""+on(n)):b!=="submit"&&b!=="reset"||t.removeAttribute("value"),n!=null?Oc(t,b,on(n)):r!=null?Oc(t,b,on(r)):c!=null&&t.removeAttribute("value"),m==null&&g!=null&&(t.defaultChecked=!!g),m!=null&&(t.checked=m&&typeof m!="function"&&typeof m!="symbol"),T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?t.name=""+on(T):t.removeAttribute("name")}function Qf(t,n,r,c,m,g,b,T){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(t.type=g),n!=null||r!=null){if(!(g!=="submit"&&g!=="reset"||n!=null)){Mc(t);return}r=r!=null?""+on(r):"",n=n!=null?""+on(n):r,T||n===t.value||(t.value=n),t.defaultValue=n}c=c??m,c=typeof c!="function"&&typeof c!="symbol"&&!!c,t.checked=T?t.checked:!!c,t.defaultChecked=!!c,b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(t.name=b),Mc(t)}function Oc(t,n,r){n==="number"&&fo(t.ownerDocument)===t||t.defaultValue===""+r||(t.defaultValue=""+r)}function Ba(t,n,r,c){if(t=t.options,n){n={};for(var m=0;m<r.length;m++)n["$"+r[m]]=!0;for(r=0;r<t.length;r++)m=n.hasOwnProperty("$"+t[r].value),t[r].selected!==m&&(t[r].selected=m),m&&c&&(t[r].defaultSelected=!0)}else{for(r=""+on(r),n=null,m=0;m<t.length;m++){if(t[m].value===r){t[m].selected=!0,c&&(t[m].defaultSelected=!0);return}n!==null||t[m].disabled||(n=t[m])}n!==null&&(n.selected=!0)}}function Wf(t,n,r){if(n!=null&&(n=""+on(n),n!==t.value&&(t.value=n),r==null)){t.defaultValue!==n&&(t.defaultValue=n);return}t.defaultValue=r!=null?""+on(r):""}function Xf(t,n,r,c){if(n==null){if(c!=null){if(r!=null)throw Error(s(92));if(ze(c)){if(1<c.length)throw Error(s(93));c=c[0]}r=c}r==null&&(r=""),n=r}r=on(n),t.defaultValue=r,c=t.textContent,c===r&&c!==""&&c!==null&&(t.value=c),Mc(t)}function qa(t,n){if(n){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=n;return}}t.textContent=n}var GT=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Zf(t,n,r){var c=n.indexOf("--")===0;r==null||typeof r=="boolean"||r===""?c?t.setProperty(n,""):n==="float"?t.cssFloat="":t[n]="":c?t.setProperty(n,r):typeof r!="number"||r===0||GT.has(n)?n==="float"?t.cssFloat=r:t[n]=(""+r).trim():t[n]=r+"px"}function $f(t,n,r){if(n!=null&&typeof n!="object")throw Error(s(62));if(t=t.style,r!=null){for(var c in r)!r.hasOwnProperty(c)||n!=null&&n.hasOwnProperty(c)||(c.indexOf("--")===0?t.setProperty(c,""):c==="float"?t.cssFloat="":t[c]="");for(var m in n)c=n[m],n.hasOwnProperty(m)&&r[m]!==c&&Zf(t,m,c)}else for(var g in n)n.hasOwnProperty(g)&&Zf(t,g,n[g])}function jc(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var KT=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),YT=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function mo(t){return YT.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}function Kn(){}var Pc=null;function Ic(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Fa=null,za=null;function em(t){var n=Ia(t);if(n&&(t=n.stateNode)){var r=t[Ut]||null;e:switch(t=n.stateNode,n.type){case"input":if(Dc(t,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name),n=r.name,r.type==="radio"&&n!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll('input[name="'+ln(""+n)+'"][type="radio"]'),n=0;n<r.length;n++){var c=r[n];if(c!==t&&c.form===t.form){var m=c[Ut]||null;if(!m)throw Error(s(90));Dc(c,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(n=0;n<r.length;n++)c=r[n],c.form===t.form&&Jf(c)}break e;case"textarea":Wf(t,r.value,r.defaultValue);break e;case"select":n=r.value,n!=null&&Ba(t,!!r.multiple,n,!1)}}}var Lc=!1;function tm(t,n,r){if(Lc)return t(n,r);Lc=!0;try{var c=t(n);return c}finally{if(Lc=!1,(Fa!==null||za!==null)&&(tl(),Fa&&(n=Fa,t=za,za=Fa=null,em(n),t)))for(n=0;n<t.length;n++)em(t[n])}}function zs(t,n){var r=t.stateNode;if(r===null)return null;var c=r[Ut]||null;if(c===null)return null;r=c[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(t=t.type,c=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!c;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(s(231,n,typeof r));return r}var Yn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Uc=!1;if(Yn)try{var Hs={};Object.defineProperty(Hs,"passive",{get:function(){Uc=!0}}),window.addEventListener("test",Hs,Hs),window.removeEventListener("test",Hs,Hs)}catch{Uc=!1}var Ti=null,Bc=null,po=null;function nm(){if(po)return po;var t,n=Bc,r=n.length,c,m="value"in Ti?Ti.value:Ti.textContent,g=m.length;for(t=0;t<r&&n[t]===m[t];t++);var b=r-t;for(c=1;c<=b&&n[r-c]===m[g-c];c++);return po=m.slice(t,1<c?1-c:void 0)}function go(t){var n=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&n===13&&(t=13)):t=n,t===10&&(t=13),32<=t||t===13?t:0}function vo(){return!0}function im(){return!1}function Bt(t){function n(r,c,m,g,b){this._reactName=r,this._targetInst=m,this.type=c,this.nativeEvent=g,this.target=b,this.currentTarget=null;for(var T in t)t.hasOwnProperty(T)&&(r=t[T],this[T]=r?r(g):g[T]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?vo:im,this.isPropagationStopped=im,this}return y(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=vo)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=vo)},persist:function(){},isPersistent:vo}),n}var oa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},yo=Bt(oa),Vs=y({},oa,{view:0,detail:0}),JT=Bt(Vs),qc,Fc,Gs,bo=y({},Vs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Hc,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Gs&&(Gs&&t.type==="mousemove"?(qc=t.screenX-Gs.screenX,Fc=t.screenY-Gs.screenY):Fc=qc=0,Gs=t),qc)},movementY:function(t){return"movementY"in t?t.movementY:Fc}}),am=Bt(bo),QT=y({},bo,{dataTransfer:0}),WT=Bt(QT),XT=y({},Vs,{relatedTarget:0}),zc=Bt(XT),ZT=y({},oa,{animationName:0,elapsedTime:0,pseudoElement:0}),$T=Bt(ZT),eC=y({},oa,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),tC=Bt(eC),nC=y({},oa,{data:0}),sm=Bt(nC),iC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},aC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},sC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function rC(t){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(t):(t=sC[t])?!!n[t]:!1}function Hc(){return rC}var oC=y({},Vs,{key:function(t){if(t.key){var n=iC[t.key]||t.key;if(n!=="Unidentified")return n}return t.type==="keypress"?(t=go(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?aC[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Hc,charCode:function(t){return t.type==="keypress"?go(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?go(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),lC=Bt(oC),cC=y({},bo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),rm=Bt(cC),uC=y({},Vs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Hc}),dC=Bt(uC),hC=y({},oa,{propertyName:0,elapsedTime:0,pseudoElement:0}),fC=Bt(hC),mC=y({},bo,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),pC=Bt(mC),gC=y({},oa,{newState:0,oldState:0}),vC=Bt(gC),yC=[9,13,27,32],Vc=Yn&&"CompositionEvent"in window,Ks=null;Yn&&"documentMode"in document&&(Ks=document.documentMode);var bC=Yn&&"TextEvent"in window&&!Ks,om=Yn&&(!Vc||Ks&&8<Ks&&11>=Ks),lm=" ",cm=!1;function um(t,n){switch(t){case"keyup":return yC.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function dm(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ha=!1;function SC(t,n){switch(t){case"compositionend":return dm(n);case"keypress":return n.which!==32?null:(cm=!0,lm);case"textInput":return t=n.data,t===lm&&cm?null:t;default:return null}}function TC(t,n){if(Ha)return t==="compositionend"||!Vc&&um(t,n)?(t=nm(),po=Bc=Ti=null,Ha=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return om&&n.locale!=="ko"?null:n.data;default:return null}}var CC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function hm(t){var n=t&&t.nodeName&&t.nodeName.toLowerCase();return n==="input"?!!CC[t.type]:n==="textarea"}function fm(t,n,r,c){Fa?za?za.push(c):za=[c]:Fa=c,n=ll(n,"onChange"),0<n.length&&(r=new yo("onChange","change",null,r,c),t.push({event:r,listeners:n}))}var Ys=null,Js=null;function kC(t){Qg(t,0)}function So(t){var n=Fs(t);if(Jf(n))return t}function mm(t,n){if(t==="change")return n}var pm=!1;if(Yn){var Gc;if(Yn){var Kc="oninput"in document;if(!Kc){var gm=document.createElement("div");gm.setAttribute("oninput","return;"),Kc=typeof gm.oninput=="function"}Gc=Kc}else Gc=!1;pm=Gc&&(!document.documentMode||9<document.documentMode)}function vm(){Ys&&(Ys.detachEvent("onpropertychange",ym),Js=Ys=null)}function ym(t){if(t.propertyName==="value"&&So(Js)){var n=[];fm(n,Js,t,Ic(t)),tm(kC,n)}}function xC(t,n,r){t==="focusin"?(vm(),Ys=n,Js=r,Ys.attachEvent("onpropertychange",ym)):t==="focusout"&&vm()}function EC(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return So(Js)}function wC(t,n){if(t==="click")return So(n)}function _C(t,n){if(t==="input"||t==="change")return So(n)}function RC(t,n){return t===n&&(t!==0||1/t===1/n)||t!==t&&n!==n}var Xt=typeof Object.is=="function"?Object.is:RC;function Qs(t,n){if(Xt(t,n))return!0;if(typeof t!="object"||t===null||typeof n!="object"||n===null)return!1;var r=Object.keys(t),c=Object.keys(n);if(r.length!==c.length)return!1;for(c=0;c<r.length;c++){var m=r[c];if(!kc.call(n,m)||!Xt(t[m],n[m]))return!1}return!0}function bm(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Sm(t,n){var r=bm(t);t=0;for(var c;r;){if(r.nodeType===3){if(c=t+r.textContent.length,t<=n&&c>=n)return{node:r,offset:n-t};t=c}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=bm(r)}}function Tm(t,n){return t&&n?t===n?!0:t&&t.nodeType===3?!1:n&&n.nodeType===3?Tm(t,n.parentNode):"contains"in t?t.contains(n):t.compareDocumentPosition?!!(t.compareDocumentPosition(n)&16):!1:!1}function Cm(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var n=fo(t.document);n instanceof t.HTMLIFrameElement;){try{var r=typeof n.contentWindow.location.href=="string"}catch{r=!1}if(r)t=n.contentWindow;else break;n=fo(t.document)}return n}function Yc(t){var n=t&&t.nodeName&&t.nodeName.toLowerCase();return n&&(n==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||n==="textarea"||t.contentEditable==="true")}var NC=Yn&&"documentMode"in document&&11>=document.documentMode,Va=null,Jc=null,Ws=null,Qc=!1;function km(t,n,r){var c=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Qc||Va==null||Va!==fo(c)||(c=Va,"selectionStart"in c&&Yc(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Ws&&Qs(Ws,c)||(Ws=c,c=ll(Jc,"onSelect"),0<c.length&&(n=new yo("onSelect","select",null,n,r),t.push({event:n,listeners:c}),n.target=Va)))}function la(t,n){var r={};return r[t.toLowerCase()]=n.toLowerCase(),r["Webkit"+t]="webkit"+n,r["Moz"+t]="moz"+n,r}var Ga={animationend:la("Animation","AnimationEnd"),animationiteration:la("Animation","AnimationIteration"),animationstart:la("Animation","AnimationStart"),transitionrun:la("Transition","TransitionRun"),transitionstart:la("Transition","TransitionStart"),transitioncancel:la("Transition","TransitionCancel"),transitionend:la("Transition","TransitionEnd")},Wc={},xm={};Yn&&(xm=document.createElement("div").style,"AnimationEvent"in window||(delete Ga.animationend.animation,delete Ga.animationiteration.animation,delete Ga.animationstart.animation),"TransitionEvent"in window||delete Ga.transitionend.transition);function ca(t){if(Wc[t])return Wc[t];if(!Ga[t])return t;var n=Ga[t],r;for(r in n)if(n.hasOwnProperty(r)&&r in xm)return Wc[t]=n[r];return t}var Em=ca("animationend"),wm=ca("animationiteration"),_m=ca("animationstart"),AC=ca("transitionrun"),MC=ca("transitionstart"),DC=ca("transitioncancel"),Rm=ca("transitionend"),Nm=new Map,Xc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Xc.push("scrollEnd");function Cn(t,n){Nm.set(t,n),ra(n,[t])}var To=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var n=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(n))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)},cn=[],Ka=0,Zc=0;function Co(){for(var t=Ka,n=Zc=Ka=0;n<t;){var r=cn[n];cn[n++]=null;var c=cn[n];cn[n++]=null;var m=cn[n];cn[n++]=null;var g=cn[n];if(cn[n++]=null,c!==null&&m!==null){var b=c.pending;b===null?m.next=m:(m.next=b.next,b.next=m),c.pending=m}g!==0&&Am(r,m,g)}}function ko(t,n,r,c){cn[Ka++]=t,cn[Ka++]=n,cn[Ka++]=r,cn[Ka++]=c,Zc|=c,t.lanes|=c,t=t.alternate,t!==null&&(t.lanes|=c)}function $c(t,n,r,c){return ko(t,n,r,c),xo(t)}function ua(t,n){return ko(t,null,null,n),xo(t)}function Am(t,n,r){t.lanes|=r;var c=t.alternate;c!==null&&(c.lanes|=r);for(var m=!1,g=t.return;g!==null;)g.childLanes|=r,c=g.alternate,c!==null&&(c.childLanes|=r),g.tag===22&&(t=g.stateNode,t===null||t._visibility&1||(m=!0)),t=g,g=g.return;return t.tag===3?(g=t.stateNode,m&&n!==null&&(m=31-Wt(r),t=g.hiddenUpdates,c=t[m],c===null?t[m]=[n]:c.push(n),n.lane=r|536870912),g):null}function xo(t){if(50<yr)throw yr=0,ld=null,Error(s(185));for(var n=t.return;n!==null;)t=n,n=t.return;return t.tag===3?t.stateNode:null}var Ya={};function OC(t,n,r,c){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Zt(t,n,r,c){return new OC(t,n,r,c)}function eu(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Jn(t,n){var r=t.alternate;return r===null?(r=Zt(t.tag,n,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=n,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&65011712,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,n=t.dependencies,r.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r.refCleanup=t.refCleanup,r}function Mm(t,n){t.flags&=65011714;var r=t.alternate;return r===null?(t.childLanes=0,t.lanes=n,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=r.childLanes,t.lanes=r.lanes,t.child=r.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=r.memoizedProps,t.memoizedState=r.memoizedState,t.updateQueue=r.updateQueue,t.type=r.type,n=r.dependencies,t.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t}function Eo(t,n,r,c,m,g){var b=0;if(c=t,typeof t=="function")eu(t)&&(b=1);else if(typeof t=="string")b=Uk(t,r,le.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case ee:return t=Zt(31,r,n,m),t.elementType=ee,t.lanes=g,t;case x:return da(r.children,m,g,n);case k:b=8,m|=24;break;case R:return t=Zt(12,r,n,m|2),t.elementType=R,t.lanes=g,t;case I:return t=Zt(13,r,n,m),t.elementType=I,t.lanes=g,t;case j:return t=Zt(19,r,n,m),t.elementType=j,t.lanes=g,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case L:b=10;break e;case O:b=9;break e;case D:b=11;break e;case H:b=14;break e;case Z:b=16,c=null;break e}b=29,r=Error(s(130,t===null?"null":typeof t,"")),c=null}return n=Zt(b,r,n,m),n.elementType=t,n.type=c,n.lanes=g,n}function da(t,n,r,c){return t=Zt(7,t,c,n),t.lanes=r,t}function tu(t,n,r){return t=Zt(6,t,null,n),t.lanes=r,t}function Dm(t){var n=Zt(18,null,null,0);return n.stateNode=t,n}function nu(t,n,r){return n=Zt(4,t.children!==null?t.children:[],t.key,n),n.lanes=r,n.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},n}var Om=new WeakMap;function un(t,n){if(typeof t=="object"&&t!==null){var r=Om.get(t);return r!==void 0?r:(n={value:t,source:n,stack:Df(n)},Om.set(t,n),n)}return{value:t,source:n,stack:Df(n)}}var Ja=[],Qa=0,wo=null,Xs=0,dn=[],hn=0,Ci=null,On=1,jn="";function Qn(t,n){Ja[Qa++]=Xs,Ja[Qa++]=wo,wo=t,Xs=n}function jm(t,n,r){dn[hn++]=On,dn[hn++]=jn,dn[hn++]=Ci,Ci=t;var c=On;t=jn;var m=32-Wt(c)-1;c&=~(1<<m),r+=1;var g=32-Wt(n)+m;if(30<g){var b=m-m%5;g=(c&(1<<b)-1).toString(32),c>>=b,m-=b,On=1<<32-Wt(n)+m|r<<m|c,jn=g+t}else On=1<<g|r<<m|c,jn=t}function iu(t){t.return!==null&&(Qn(t,1),jm(t,1,0))}function au(t){for(;t===wo;)wo=Ja[--Qa],Ja[Qa]=null,Xs=Ja[--Qa],Ja[Qa]=null;for(;t===Ci;)Ci=dn[--hn],dn[hn]=null,jn=dn[--hn],dn[hn]=null,On=dn[--hn],dn[hn]=null}function Pm(t,n){dn[hn++]=On,dn[hn++]=jn,dn[hn++]=Ci,On=n.id,jn=n.overflow,Ci=t}var xt=null,Xe=null,Ne=!1,ki=null,fn=!1,su=Error(s(519));function xi(t){var n=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Zs(un(n,t)),su}function Im(t){var n=t.stateNode,r=t.type,c=t.memoizedProps;switch(n[kt]=t,n[Ut]=c,r){case"dialog":xe("cancel",n),xe("close",n);break;case"iframe":case"object":case"embed":xe("load",n);break;case"video":case"audio":for(r=0;r<Sr.length;r++)xe(Sr[r],n);break;case"source":xe("error",n);break;case"img":case"image":case"link":xe("error",n),xe("load",n);break;case"details":xe("toggle",n);break;case"input":xe("invalid",n),Qf(n,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":xe("invalid",n);break;case"textarea":xe("invalid",n),Xf(n,c.value,c.defaultValue,c.children)}r=c.children,typeof r!="string"&&typeof r!="number"&&typeof r!="bigint"||n.textContent===""+r||c.suppressHydrationWarning===!0||$g(n.textContent,r)?(c.popover!=null&&(xe("beforetoggle",n),xe("toggle",n)),c.onScroll!=null&&xe("scroll",n),c.onScrollEnd!=null&&xe("scrollend",n),c.onClick!=null&&(n.onclick=Kn),n=!0):n=!1,n||xi(t,!0)}function Lm(t){for(xt=t.return;xt;)switch(xt.tag){case 5:case 31:case 13:fn=!1;return;case 27:case 3:fn=!0;return;default:xt=xt.return}}function Wa(t){if(t!==xt)return!1;if(!Ne)return Lm(t),Ne=!0,!1;var n=t.tag,r;if((r=n!==3&&n!==27)&&((r=n===5)&&(r=t.type,r=!(r!=="form"&&r!=="button")||kd(t.type,t.memoizedProps)),r=!r),r&&Xe&&xi(t),Lm(t),n===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(s(317));Xe=lv(t)}else if(n===31){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(s(317));Xe=lv(t)}else n===27?(n=Xe,Ui(t.type)?(t=Rd,Rd=null,Xe=t):Xe=n):Xe=xt?pn(t.stateNode.nextSibling):null;return!0}function ha(){Xe=xt=null,Ne=!1}function ru(){var t=ki;return t!==null&&(Ht===null?Ht=t:Ht.push.apply(Ht,t),ki=null),t}function Zs(t){ki===null?ki=[t]:ki.push(t)}var ou=A(null),fa=null,Wn=null;function Ei(t,n,r){se(ou,n._currentValue),n._currentValue=r}function Xn(t){t._currentValue=ou.current,Y(ou)}function lu(t,n,r){for(;t!==null;){var c=t.alternate;if((t.childLanes&n)!==n?(t.childLanes|=n,c!==null&&(c.childLanes|=n)):c!==null&&(c.childLanes&n)!==n&&(c.childLanes|=n),t===r)break;t=t.return}}function cu(t,n,r,c){var m=t.child;for(m!==null&&(m.return=t);m!==null;){var g=m.dependencies;if(g!==null){var b=m.child;g=g.firstContext;e:for(;g!==null;){var T=g;g=m;for(var w=0;w<n.length;w++)if(T.context===n[w]){g.lanes|=r,T=g.alternate,T!==null&&(T.lanes|=r),lu(g.return,r,t),c||(b=null);break e}g=T.next}}else if(m.tag===18){if(b=m.return,b===null)throw Error(s(341));b.lanes|=r,g=b.alternate,g!==null&&(g.lanes|=r),lu(b,r,t),b=null}else b=m.child;if(b!==null)b.return=m;else for(b=m;b!==null;){if(b===t){b=null;break}if(m=b.sibling,m!==null){m.return=b.return,b=m;break}b=b.return}m=b}}function Xa(t,n,r,c){t=null;for(var m=n,g=!1;m!==null;){if(!g){if((m.flags&524288)!==0)g=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var b=m.alternate;if(b===null)throw Error(s(387));if(b=b.memoizedProps,b!==null){var T=m.type;Xt(m.pendingProps.value,b.value)||(t!==null?t.push(T):t=[T])}}else if(m===Be.current){if(b=m.alternate,b===null)throw Error(s(387));b.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(t!==null?t.push(Er):t=[Er])}m=m.return}t!==null&&cu(n,t,r,c),n.flags|=262144}function _o(t){for(t=t.firstContext;t!==null;){if(!Xt(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function ma(t){fa=t,Wn=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function Et(t){return Um(fa,t)}function Ro(t,n){return fa===null&&ma(t),Um(t,n)}function Um(t,n){var r=n._currentValue;if(n={context:n,memoizedValue:r,next:null},Wn===null){if(t===null)throw Error(s(308));Wn=n,t.dependencies={lanes:0,firstContext:n},t.flags|=524288}else Wn=Wn.next=n;return r}var jC=typeof AbortController<"u"?AbortController:function(){var t=[],n=this.signal={aborted:!1,addEventListener:function(r,c){t.push(c)}};this.abort=function(){n.aborted=!0,t.forEach(function(r){return r()})}},PC=a.unstable_scheduleCallback,IC=a.unstable_NormalPriority,ft={$$typeof:L,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function uu(){return{controller:new jC,data:new Map,refCount:0}}function $s(t){t.refCount--,t.refCount===0&&PC(IC,function(){t.controller.abort()})}var er=null,du=0,Za=0,$a=null;function LC(t,n){if(er===null){var r=er=[];du=0,Za=md(),$a={status:"pending",value:void 0,then:function(c){r.push(c)}}}return du++,n.then(Bm,Bm),n}function Bm(){if(--du===0&&er!==null){$a!==null&&($a.status="fulfilled");var t=er;er=null,Za=0,$a=null;for(var n=0;n<t.length;n++)(0,t[n])()}}function UC(t,n){var r=[],c={status:"pending",value:null,reason:null,then:function(m){r.push(m)}};return t.then(function(){c.status="fulfilled",c.value=n;for(var m=0;m<r.length;m++)(0,r[m])(n)},function(m){for(c.status="rejected",c.reason=m,m=0;m<r.length;m++)(0,r[m])(void 0)}),c}var qm=z.S;z.S=function(t,n){kg=Jt(),typeof n=="object"&&n!==null&&typeof n.then=="function"&&LC(t,n),qm!==null&&qm(t,n)};var pa=A(null);function hu(){var t=pa.current;return t!==null?t:Ye.pooledCache}function No(t,n){n===null?se(pa,pa.current):se(pa,n.pool)}function Fm(){var t=hu();return t===null?null:{parent:ft._currentValue,pool:t}}var es=Error(s(460)),fu=Error(s(474)),Ao=Error(s(542)),Mo={then:function(){}};function zm(t){return t=t.status,t==="fulfilled"||t==="rejected"}function Hm(t,n,r){switch(r=t[r],r===void 0?t.push(n):r!==n&&(n.then(Kn,Kn),n=r),n.status){case"fulfilled":return n.value;case"rejected":throw t=n.reason,Gm(t),t;default:if(typeof n.status=="string")n.then(Kn,Kn);else{if(t=Ye,t!==null&&100<t.shellSuspendCounter)throw Error(s(482));t=n,t.status="pending",t.then(function(c){if(n.status==="pending"){var m=n;m.status="fulfilled",m.value=c}},function(c){if(n.status==="pending"){var m=n;m.status="rejected",m.reason=c}})}switch(n.status){case"fulfilled":return n.value;case"rejected":throw t=n.reason,Gm(t),t}throw va=n,es}}function ga(t){try{var n=t._init;return n(t._payload)}catch(r){throw r!==null&&typeof r=="object"&&typeof r.then=="function"?(va=r,es):r}}var va=null;function Vm(){if(va===null)throw Error(s(459));var t=va;return va=null,t}function Gm(t){if(t===es||t===Ao)throw Error(s(483))}var ts=null,tr=0;function Do(t){var n=tr;return tr+=1,ts===null&&(ts=[]),Hm(ts,t,n)}function nr(t,n){n=n.props.ref,t.ref=n!==void 0?n:null}function Oo(t,n){throw n.$$typeof===S?Error(s(525)):(t=Object.prototype.toString.call(n),Error(s(31,t==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":t)))}function Km(t){function n(P,N){if(t){var B=P.deletions;B===null?(P.deletions=[N],P.flags|=16):B.push(N)}}function r(P,N){if(!t)return null;for(;N!==null;)n(P,N),N=N.sibling;return null}function c(P){for(var N=new Map;P!==null;)P.key!==null?N.set(P.key,P):N.set(P.index,P),P=P.sibling;return N}function m(P,N){return P=Jn(P,N),P.index=0,P.sibling=null,P}function g(P,N,B){return P.index=B,t?(B=P.alternate,B!==null?(B=B.index,B<N?(P.flags|=67108866,N):B):(P.flags|=67108866,N)):(P.flags|=1048576,N)}function b(P){return t&&P.alternate===null&&(P.flags|=67108866),P}function T(P,N,B,K){return N===null||N.tag!==6?(N=tu(B,P.mode,K),N.return=P,N):(N=m(N,B),N.return=P,N)}function w(P,N,B,K){var de=B.type;return de===x?G(P,N,B.props.children,K,B.key):N!==null&&(N.elementType===de||typeof de=="object"&&de!==null&&de.$$typeof===Z&&ga(de)===N.type)?(N=m(N,B.props),nr(N,B),N.return=P,N):(N=Eo(B.type,B.key,B.props,null,P.mode,K),nr(N,B),N.return=P,N)}function q(P,N,B,K){return N===null||N.tag!==4||N.stateNode.containerInfo!==B.containerInfo||N.stateNode.implementation!==B.implementation?(N=nu(B,P.mode,K),N.return=P,N):(N=m(N,B.children||[]),N.return=P,N)}function G(P,N,B,K,de){return N===null||N.tag!==7?(N=da(B,P.mode,K,de),N.return=P,N):(N=m(N,B),N.return=P,N)}function J(P,N,B){if(typeof N=="string"&&N!==""||typeof N=="number"||typeof N=="bigint")return N=tu(""+N,P.mode,B),N.return=P,N;if(typeof N=="object"&&N!==null){switch(N.$$typeof){case C:return B=Eo(N.type,N.key,N.props,null,P.mode,B),nr(B,N),B.return=P,B;case _:return N=nu(N,P.mode,B),N.return=P,N;case Z:return N=ga(N),J(P,N,B)}if(ze(N)||ue(N))return N=da(N,P.mode,B,null),N.return=P,N;if(typeof N.then=="function")return J(P,Do(N),B);if(N.$$typeof===L)return J(P,Ro(P,N),B);Oo(P,N)}return null}function F(P,N,B,K){var de=N!==null?N.key:null;if(typeof B=="string"&&B!==""||typeof B=="number"||typeof B=="bigint")return de!==null?null:T(P,N,""+B,K);if(typeof B=="object"&&B!==null){switch(B.$$typeof){case C:return B.key===de?w(P,N,B,K):null;case _:return B.key===de?q(P,N,B,K):null;case Z:return B=ga(B),F(P,N,B,K)}if(ze(B)||ue(B))return de!==null?null:G(P,N,B,K,null);if(typeof B.then=="function")return F(P,N,Do(B),K);if(B.$$typeof===L)return F(P,N,Ro(P,B),K);Oo(P,B)}return null}function V(P,N,B,K,de){if(typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint")return P=P.get(B)||null,T(N,P,""+K,de);if(typeof K=="object"&&K!==null){switch(K.$$typeof){case C:return P=P.get(K.key===null?B:K.key)||null,w(N,P,K,de);case _:return P=P.get(K.key===null?B:K.key)||null,q(N,P,K,de);case Z:return K=ga(K),V(P,N,B,K,de)}if(ze(K)||ue(K))return P=P.get(B)||null,G(N,P,K,de,null);if(typeof K.then=="function")return V(P,N,B,Do(K),de);if(K.$$typeof===L)return V(P,N,B,Ro(N,K),de);Oo(N,K)}return null}function oe(P,N,B,K){for(var de=null,je=null,ce=N,be=N=0,Re=null;ce!==null&&be<B.length;be++){ce.index>be?(Re=ce,ce=null):Re=ce.sibling;var Pe=F(P,ce,B[be],K);if(Pe===null){ce===null&&(ce=Re);break}t&&ce&&Pe.alternate===null&&n(P,ce),N=g(Pe,N,be),je===null?de=Pe:je.sibling=Pe,je=Pe,ce=Re}if(be===B.length)return r(P,ce),Ne&&Qn(P,be),de;if(ce===null){for(;be<B.length;be++)ce=J(P,B[be],K),ce!==null&&(N=g(ce,N,be),je===null?de=ce:je.sibling=ce,je=ce);return Ne&&Qn(P,be),de}for(ce=c(ce);be<B.length;be++)Re=V(ce,P,be,B[be],K),Re!==null&&(t&&Re.alternate!==null&&ce.delete(Re.key===null?be:Re.key),N=g(Re,N,be),je===null?de=Re:je.sibling=Re,je=Re);return t&&ce.forEach(function(Hi){return n(P,Hi)}),Ne&&Qn(P,be),de}function fe(P,N,B,K){if(B==null)throw Error(s(151));for(var de=null,je=null,ce=N,be=N=0,Re=null,Pe=B.next();ce!==null&&!Pe.done;be++,Pe=B.next()){ce.index>be?(Re=ce,ce=null):Re=ce.sibling;var Hi=F(P,ce,Pe.value,K);if(Hi===null){ce===null&&(ce=Re);break}t&&ce&&Hi.alternate===null&&n(P,ce),N=g(Hi,N,be),je===null?de=Hi:je.sibling=Hi,je=Hi,ce=Re}if(Pe.done)return r(P,ce),Ne&&Qn(P,be),de;if(ce===null){for(;!Pe.done;be++,Pe=B.next())Pe=J(P,Pe.value,K),Pe!==null&&(N=g(Pe,N,be),je===null?de=Pe:je.sibling=Pe,je=Pe);return Ne&&Qn(P,be),de}for(ce=c(ce);!Pe.done;be++,Pe=B.next())Pe=V(ce,P,be,Pe.value,K),Pe!==null&&(t&&Pe.alternate!==null&&ce.delete(Pe.key===null?be:Pe.key),N=g(Pe,N,be),je===null?de=Pe:je.sibling=Pe,je=Pe);return t&&ce.forEach(function(Qk){return n(P,Qk)}),Ne&&Qn(P,be),de}function Ge(P,N,B,K){if(typeof B=="object"&&B!==null&&B.type===x&&B.key===null&&(B=B.props.children),typeof B=="object"&&B!==null){switch(B.$$typeof){case C:e:{for(var de=B.key;N!==null;){if(N.key===de){if(de=B.type,de===x){if(N.tag===7){r(P,N.sibling),K=m(N,B.props.children),K.return=P,P=K;break e}}else if(N.elementType===de||typeof de=="object"&&de!==null&&de.$$typeof===Z&&ga(de)===N.type){r(P,N.sibling),K=m(N,B.props),nr(K,B),K.return=P,P=K;break e}r(P,N);break}else n(P,N);N=N.sibling}B.type===x?(K=da(B.props.children,P.mode,K,B.key),K.return=P,P=K):(K=Eo(B.type,B.key,B.props,null,P.mode,K),nr(K,B),K.return=P,P=K)}return b(P);case _:e:{for(de=B.key;N!==null;){if(N.key===de)if(N.tag===4&&N.stateNode.containerInfo===B.containerInfo&&N.stateNode.implementation===B.implementation){r(P,N.sibling),K=m(N,B.children||[]),K.return=P,P=K;break e}else{r(P,N);break}else n(P,N);N=N.sibling}K=nu(B,P.mode,K),K.return=P,P=K}return b(P);case Z:return B=ga(B),Ge(P,N,B,K)}if(ze(B))return oe(P,N,B,K);if(ue(B)){if(de=ue(B),typeof de!="function")throw Error(s(150));return B=de.call(B),fe(P,N,B,K)}if(typeof B.then=="function")return Ge(P,N,Do(B),K);if(B.$$typeof===L)return Ge(P,N,Ro(P,B),K);Oo(P,B)}return typeof B=="string"&&B!==""||typeof B=="number"||typeof B=="bigint"?(B=""+B,N!==null&&N.tag===6?(r(P,N.sibling),K=m(N,B),K.return=P,P=K):(r(P,N),K=tu(B,P.mode,K),K.return=P,P=K),b(P)):r(P,N)}return function(P,N,B,K){try{tr=0;var de=Ge(P,N,B,K);return ts=null,de}catch(ce){if(ce===es||ce===Ao)throw ce;var je=Zt(29,ce,null,P.mode);return je.lanes=K,je.return=P,je}}}var ya=Km(!0),Ym=Km(!1),wi=!1;function mu(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function pu(t,n){t=t.updateQueue,n.updateQueue===t&&(n.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function _i(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function Ri(t,n,r){var c=t.updateQueue;if(c===null)return null;if(c=c.shared,(Ue&2)!==0){var m=c.pending;return m===null?n.next=n:(n.next=m.next,m.next=n),c.pending=n,n=xo(t),Am(t,null,r),n}return ko(t,c,n,r),xo(t)}function ir(t,n,r){if(n=n.updateQueue,n!==null&&(n=n.shared,(r&4194048)!==0)){var c=n.lanes;c&=t.pendingLanes,r|=c,n.lanes=r,Uf(t,r)}}function gu(t,n){var r=t.updateQueue,c=t.alternate;if(c!==null&&(c=c.updateQueue,r===c)){var m=null,g=null;if(r=r.firstBaseUpdate,r!==null){do{var b={lane:r.lane,tag:r.tag,payload:r.payload,callback:null,next:null};g===null?m=g=b:g=g.next=b,r=r.next}while(r!==null);g===null?m=g=n:g=g.next=n}else m=g=n;r={baseState:c.baseState,firstBaseUpdate:m,lastBaseUpdate:g,shared:c.shared,callbacks:c.callbacks},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=n:t.next=n,r.lastBaseUpdate=n}var vu=!1;function ar(){if(vu){var t=$a;if(t!==null)throw t}}function sr(t,n,r,c){vu=!1;var m=t.updateQueue;wi=!1;var g=m.firstBaseUpdate,b=m.lastBaseUpdate,T=m.shared.pending;if(T!==null){m.shared.pending=null;var w=T,q=w.next;w.next=null,b===null?g=q:b.next=q,b=w;var G=t.alternate;G!==null&&(G=G.updateQueue,T=G.lastBaseUpdate,T!==b&&(T===null?G.firstBaseUpdate=q:T.next=q,G.lastBaseUpdate=w))}if(g!==null){var J=m.baseState;b=0,G=q=w=null,T=g;do{var F=T.lane&-536870913,V=F!==T.lane;if(V?(_e&F)===F:(c&F)===F){F!==0&&F===Za&&(vu=!0),G!==null&&(G=G.next={lane:0,tag:T.tag,payload:T.payload,callback:null,next:null});e:{var oe=t,fe=T;F=n;var Ge=r;switch(fe.tag){case 1:if(oe=fe.payload,typeof oe=="function"){J=oe.call(Ge,J,F);break e}J=oe;break e;case 3:oe.flags=oe.flags&-65537|128;case 0:if(oe=fe.payload,F=typeof oe=="function"?oe.call(Ge,J,F):oe,F==null)break e;J=y({},J,F);break e;case 2:wi=!0}}F=T.callback,F!==null&&(t.flags|=64,V&&(t.flags|=8192),V=m.callbacks,V===null?m.callbacks=[F]:V.push(F))}else V={lane:F,tag:T.tag,payload:T.payload,callback:T.callback,next:null},G===null?(q=G=V,w=J):G=G.next=V,b|=F;if(T=T.next,T===null){if(T=m.shared.pending,T===null)break;V=T,T=V.next,V.next=null,m.lastBaseUpdate=V,m.shared.pending=null}}while(!0);G===null&&(w=J),m.baseState=w,m.firstBaseUpdate=q,m.lastBaseUpdate=G,g===null&&(m.shared.lanes=0),Oi|=b,t.lanes=b,t.memoizedState=J}}function Jm(t,n){if(typeof t!="function")throw Error(s(191,t));t.call(n)}function Qm(t,n){var r=t.callbacks;if(r!==null)for(t.callbacks=null,t=0;t<r.length;t++)Jm(r[t],n)}var ns=A(null),jo=A(0);function Wm(t,n){t=ri,se(jo,t),se(ns,n),ri=t|n.baseLanes}function yu(){se(jo,ri),se(ns,ns.current)}function bu(){ri=jo.current,Y(ns),Y(jo)}var $t=A(null),mn=null;function Ni(t){var n=t.alternate;se(lt,lt.current&1),se($t,t),mn===null&&(n===null||ns.current!==null||n.memoizedState!==null)&&(mn=t)}function Su(t){se(lt,lt.current),se($t,t),mn===null&&(mn=t)}function Xm(t){t.tag===22?(se(lt,lt.current),se($t,t),mn===null&&(mn=t)):Ai()}function Ai(){se(lt,lt.current),se($t,$t.current)}function en(t){Y($t),mn===t&&(mn=null),Y(lt)}var lt=A(0);function Po(t){for(var n=t;n!==null;){if(n.tag===13){var r=n.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||wd(r)||_d(r)))return n}else if(n.tag===19&&(n.memoizedProps.revealOrder==="forwards"||n.memoizedProps.revealOrder==="backwards"||n.memoizedProps.revealOrder==="unstable_legacy-backwards"||n.memoizedProps.revealOrder==="together")){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var Zn=0,ve=null,He=null,mt=null,Io=!1,is=!1,ba=!1,Lo=0,rr=0,as=null,BC=0;function it(){throw Error(s(321))}function Tu(t,n){if(n===null)return!1;for(var r=0;r<n.length&&r<t.length;r++)if(!Xt(t[r],n[r]))return!1;return!0}function Cu(t,n,r,c,m,g){return Zn=g,ve=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,z.H=t===null||t.memoizedState===null?jp:Lu,ba=!1,g=r(c,m),ba=!1,is&&(g=$m(n,r,c,m)),Zm(t),g}function Zm(t){z.H=cr;var n=He!==null&&He.next!==null;if(Zn=0,mt=He=ve=null,Io=!1,rr=0,as=null,n)throw Error(s(300));t===null||pt||(t=t.dependencies,t!==null&&_o(t)&&(pt=!0))}function $m(t,n,r,c){ve=t;var m=0;do{if(is&&(as=null),rr=0,is=!1,25<=m)throw Error(s(301));if(m+=1,mt=He=null,t.updateQueue!=null){var g=t.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}z.H=Pp,g=n(r,c)}while(is);return g}function qC(){var t=z.H,n=t.useState()[0];return n=typeof n.then=="function"?or(n):n,t=t.useState()[0],(He!==null?He.memoizedState:null)!==t&&(ve.flags|=1024),n}function ku(){var t=Lo!==0;return Lo=0,t}function xu(t,n,r){n.updateQueue=t.updateQueue,n.flags&=-2053,t.lanes&=~r}function Eu(t){if(Io){for(t=t.memoizedState;t!==null;){var n=t.queue;n!==null&&(n.pending=null),t=t.next}Io=!1}Zn=0,mt=He=ve=null,is=!1,rr=Lo=0,as=null}function Ot(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return mt===null?ve.memoizedState=mt=t:mt=mt.next=t,mt}function ct(){if(He===null){var t=ve.alternate;t=t!==null?t.memoizedState:null}else t=He.next;var n=mt===null?ve.memoizedState:mt.next;if(n!==null)mt=n,He=t;else{if(t===null)throw ve.alternate===null?Error(s(467)):Error(s(310));He=t,t={memoizedState:He.memoizedState,baseState:He.baseState,baseQueue:He.baseQueue,queue:He.queue,next:null},mt===null?ve.memoizedState=mt=t:mt=mt.next=t}return mt}function Uo(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function or(t){var n=rr;return rr+=1,as===null&&(as=[]),t=Hm(as,t,n),n=ve,(mt===null?n.memoizedState:mt.next)===null&&(n=n.alternate,z.H=n===null||n.memoizedState===null?jp:Lu),t}function Bo(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return or(t);if(t.$$typeof===L)return Et(t)}throw Error(s(438,String(t)))}function wu(t){var n=null,r=ve.updateQueue;if(r!==null&&(n=r.memoCache),n==null){var c=ve.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(n={data:c.data.map(function(m){return m.slice()}),index:0})))}if(n==null&&(n={data:[],index:0}),r===null&&(r=Uo(),ve.updateQueue=r),r.memoCache=n,r=n.data[n.index],r===void 0)for(r=n.data[n.index]=Array(t),c=0;c<t;c++)r[c]=te;return n.index++,r}function $n(t,n){return typeof n=="function"?n(t):n}function qo(t){var n=ct();return _u(n,He,t)}function _u(t,n,r){var c=t.queue;if(c===null)throw Error(s(311));c.lastRenderedReducer=r;var m=t.baseQueue,g=c.pending;if(g!==null){if(m!==null){var b=m.next;m.next=g.next,g.next=b}n.baseQueue=m=g,c.pending=null}if(g=t.baseState,m===null)t.memoizedState=g;else{n=m.next;var T=b=null,w=null,q=n,G=!1;do{var J=q.lane&-536870913;if(J!==q.lane?(_e&J)===J:(Zn&J)===J){var F=q.revertLane;if(F===0)w!==null&&(w=w.next={lane:0,revertLane:0,gesture:null,action:q.action,hasEagerState:q.hasEagerState,eagerState:q.eagerState,next:null}),J===Za&&(G=!0);else if((Zn&F)===F){q=q.next,F===Za&&(G=!0);continue}else J={lane:0,revertLane:q.revertLane,gesture:null,action:q.action,hasEagerState:q.hasEagerState,eagerState:q.eagerState,next:null},w===null?(T=w=J,b=g):w=w.next=J,ve.lanes|=F,Oi|=F;J=q.action,ba&&r(g,J),g=q.hasEagerState?q.eagerState:r(g,J)}else F={lane:J,revertLane:q.revertLane,gesture:q.gesture,action:q.action,hasEagerState:q.hasEagerState,eagerState:q.eagerState,next:null},w===null?(T=w=F,b=g):w=w.next=F,ve.lanes|=J,Oi|=J;q=q.next}while(q!==null&&q!==n);if(w===null?b=g:w.next=T,!Xt(g,t.memoizedState)&&(pt=!0,G&&(r=$a,r!==null)))throw r;t.memoizedState=g,t.baseState=b,t.baseQueue=w,c.lastRenderedState=g}return m===null&&(c.lanes=0),[t.memoizedState,c.dispatch]}function Ru(t){var n=ct(),r=n.queue;if(r===null)throw Error(s(311));r.lastRenderedReducer=t;var c=r.dispatch,m=r.pending,g=n.memoizedState;if(m!==null){r.pending=null;var b=m=m.next;do g=t(g,b.action),b=b.next;while(b!==m);Xt(g,n.memoizedState)||(pt=!0),n.memoizedState=g,n.baseQueue===null&&(n.baseState=g),r.lastRenderedState=g}return[g,c]}function ep(t,n,r){var c=ve,m=ct(),g=Ne;if(g){if(r===void 0)throw Error(s(407));r=r()}else r=n();var b=!Xt((He||m).memoizedState,r);if(b&&(m.memoizedState=r,pt=!0),m=m.queue,Mu(ip.bind(null,c,m,t),[t]),m.getSnapshot!==n||b||mt!==null&&mt.memoizedState.tag&1){if(c.flags|=2048,ss(9,{destroy:void 0},np.bind(null,c,m,r,n),null),Ye===null)throw Error(s(349));g||(Zn&127)!==0||tp(c,n,r)}return r}function tp(t,n,r){t.flags|=16384,t={getSnapshot:n,value:r},n=ve.updateQueue,n===null?(n=Uo(),ve.updateQueue=n,n.stores=[t]):(r=n.stores,r===null?n.stores=[t]:r.push(t))}function np(t,n,r,c){n.value=r,n.getSnapshot=c,ap(n)&&sp(t)}function ip(t,n,r){return r(function(){ap(n)&&sp(t)})}function ap(t){var n=t.getSnapshot;t=t.value;try{var r=n();return!Xt(t,r)}catch{return!0}}function sp(t){var n=ua(t,2);n!==null&&Vt(n,t,2)}function Nu(t){var n=Ot();if(typeof t=="function"){var r=t;if(t=r(),ba){bi(!0);try{r()}finally{bi(!1)}}}return n.memoizedState=n.baseState=t,n.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:$n,lastRenderedState:t},n}function rp(t,n,r,c){return t.baseState=r,_u(t,He,typeof c=="function"?c:$n)}function FC(t,n,r,c,m){if(Ho(t))throw Error(s(485));if(t=n.action,t!==null){var g={payload:m,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(b){g.listeners.push(b)}};z.T!==null?r(!0):g.isTransition=!1,c(g),r=n.pending,r===null?(g.next=n.pending=g,op(n,g)):(g.next=r.next,n.pending=r.next=g)}}function op(t,n){var r=n.action,c=n.payload,m=t.state;if(n.isTransition){var g=z.T,b={};z.T=b;try{var T=r(m,c),w=z.S;w!==null&&w(b,T),lp(t,n,T)}catch(q){Au(t,n,q)}finally{g!==null&&b.types!==null&&(g.types=b.types),z.T=g}}else try{g=r(m,c),lp(t,n,g)}catch(q){Au(t,n,q)}}function lp(t,n,r){r!==null&&typeof r=="object"&&typeof r.then=="function"?r.then(function(c){cp(t,n,c)},function(c){return Au(t,n,c)}):cp(t,n,r)}function cp(t,n,r){n.status="fulfilled",n.value=r,up(n),t.state=r,n=t.pending,n!==null&&(r=n.next,r===n?t.pending=null:(r=r.next,n.next=r,op(t,r)))}function Au(t,n,r){var c=t.pending;if(t.pending=null,c!==null){c=c.next;do n.status="rejected",n.reason=r,up(n),n=n.next;while(n!==c)}t.action=null}function up(t){t=t.listeners;for(var n=0;n<t.length;n++)(0,t[n])()}function dp(t,n){return n}function hp(t,n){if(Ne){var r=Ye.formState;if(r!==null){e:{var c=ve;if(Ne){if(Xe){t:{for(var m=Xe,g=fn;m.nodeType!==8;){if(!g){m=null;break t}if(m=pn(m.nextSibling),m===null){m=null;break t}}g=m.data,m=g==="F!"||g==="F"?m:null}if(m){Xe=pn(m.nextSibling),c=m.data==="F!";break e}}xi(c)}c=!1}c&&(n=r[0])}}return r=Ot(),r.memoizedState=r.baseState=n,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:dp,lastRenderedState:n},r.queue=c,r=Mp.bind(null,ve,c),c.dispatch=r,c=Nu(!1),g=Iu.bind(null,ve,!1,c.queue),c=Ot(),m={state:n,dispatch:null,action:t,pending:null},c.queue=m,r=FC.bind(null,ve,m,g,r),m.dispatch=r,c.memoizedState=t,[n,r,!1]}function fp(t){var n=ct();return mp(n,He,t)}function mp(t,n,r){if(n=_u(t,n,dp)[0],t=qo($n)[0],typeof n=="object"&&n!==null&&typeof n.then=="function")try{var c=or(n)}catch(b){throw b===es?Ao:b}else c=n;n=ct();var m=n.queue,g=m.dispatch;return r!==n.memoizedState&&(ve.flags|=2048,ss(9,{destroy:void 0},zC.bind(null,m,r),null)),[c,g,t]}function zC(t,n){t.action=n}function pp(t){var n=ct(),r=He;if(r!==null)return mp(n,r,t);ct(),n=n.memoizedState,r=ct();var c=r.queue.dispatch;return r.memoizedState=t,[n,c,!1]}function ss(t,n,r,c){return t={tag:t,create:r,deps:c,inst:n,next:null},n=ve.updateQueue,n===null&&(n=Uo(),ve.updateQueue=n),r=n.lastEffect,r===null?n.lastEffect=t.next=t:(c=r.next,r.next=t,t.next=c,n.lastEffect=t),t}function gp(){return ct().memoizedState}function Fo(t,n,r,c){var m=Ot();ve.flags|=t,m.memoizedState=ss(1|n,{destroy:void 0},r,c===void 0?null:c)}function zo(t,n,r,c){var m=ct();c=c===void 0?null:c;var g=m.memoizedState.inst;He!==null&&c!==null&&Tu(c,He.memoizedState.deps)?m.memoizedState=ss(n,g,r,c):(ve.flags|=t,m.memoizedState=ss(1|n,g,r,c))}function vp(t,n){Fo(8390656,8,t,n)}function Mu(t,n){zo(2048,8,t,n)}function HC(t){ve.flags|=4;var n=ve.updateQueue;if(n===null)n=Uo(),ve.updateQueue=n,n.events=[t];else{var r=n.events;r===null?n.events=[t]:r.push(t)}}function yp(t){var n=ct().memoizedState;return HC({ref:n,nextImpl:t}),function(){if((Ue&2)!==0)throw Error(s(440));return n.impl.apply(void 0,arguments)}}function bp(t,n){return zo(4,2,t,n)}function Sp(t,n){return zo(4,4,t,n)}function Tp(t,n){if(typeof n=="function"){t=t();var r=n(t);return function(){typeof r=="function"?r():n(null)}}if(n!=null)return t=t(),n.current=t,function(){n.current=null}}function Cp(t,n,r){r=r!=null?r.concat([t]):null,zo(4,4,Tp.bind(null,n,t),r)}function Du(){}function kp(t,n){var r=ct();n=n===void 0?null:n;var c=r.memoizedState;return n!==null&&Tu(n,c[1])?c[0]:(r.memoizedState=[t,n],t)}function xp(t,n){var r=ct();n=n===void 0?null:n;var c=r.memoizedState;if(n!==null&&Tu(n,c[1]))return c[0];if(c=t(),ba){bi(!0);try{t()}finally{bi(!1)}}return r.memoizedState=[c,n],c}function Ou(t,n,r){return r===void 0||(Zn&1073741824)!==0&&(_e&261930)===0?t.memoizedState=n:(t.memoizedState=r,t=Eg(),ve.lanes|=t,Oi|=t,r)}function Ep(t,n,r,c){return Xt(r,n)?r:ns.current!==null?(t=Ou(t,r,c),Xt(t,n)||(pt=!0),t):(Zn&42)===0||(Zn&1073741824)!==0&&(_e&261930)===0?(pt=!0,t.memoizedState=r):(t=Eg(),ve.lanes|=t,Oi|=t,n)}function wp(t,n,r,c,m){var g=ne.p;ne.p=g!==0&&8>g?g:8;var b=z.T,T={};z.T=T,Iu(t,!1,n,r);try{var w=m(),q=z.S;if(q!==null&&q(T,w),w!==null&&typeof w=="object"&&typeof w.then=="function"){var G=UC(w,c);lr(t,n,G,an(t))}else lr(t,n,c,an(t))}catch(J){lr(t,n,{then:function(){},status:"rejected",reason:J},an())}finally{ne.p=g,b!==null&&T.types!==null&&(b.types=T.types),z.T=b}}function VC(){}function ju(t,n,r,c){if(t.tag!==5)throw Error(s(476));var m=_p(t).queue;wp(t,m,n,he,r===null?VC:function(){return Rp(t),r(c)})}function _p(t){var n=t.memoizedState;if(n!==null)return n;n={memoizedState:he,baseState:he,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:$n,lastRenderedState:he},next:null};var r={};return n.next={memoizedState:r,baseState:r,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:$n,lastRenderedState:r},next:null},t.memoizedState=n,t=t.alternate,t!==null&&(t.memoizedState=n),n}function Rp(t){var n=_p(t);n.next===null&&(n=t.alternate.memoizedState),lr(t,n.next.queue,{},an())}function Pu(){return Et(Er)}function Np(){return ct().memoizedState}function Ap(){return ct().memoizedState}function GC(t){for(var n=t.return;n!==null;){switch(n.tag){case 24:case 3:var r=an();t=_i(r);var c=Ri(n,t,r);c!==null&&(Vt(c,n,r),ir(c,n,r)),n={cache:uu()},t.payload=n;return}n=n.return}}function KC(t,n,r){var c=an();r={lane:c,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},Ho(t)?Dp(n,r):(r=$c(t,n,r,c),r!==null&&(Vt(r,t,c),Op(r,n,c)))}function Mp(t,n,r){var c=an();lr(t,n,r,c)}function lr(t,n,r,c){var m={lane:c,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null};if(Ho(t))Dp(n,m);else{var g=t.alternate;if(t.lanes===0&&(g===null||g.lanes===0)&&(g=n.lastRenderedReducer,g!==null))try{var b=n.lastRenderedState,T=g(b,r);if(m.hasEagerState=!0,m.eagerState=T,Xt(T,b))return ko(t,n,m,0),Ye===null&&Co(),!1}catch{}if(r=$c(t,n,m,c),r!==null)return Vt(r,t,c),Op(r,n,c),!0}return!1}function Iu(t,n,r,c){if(c={lane:2,revertLane:md(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Ho(t)){if(n)throw Error(s(479))}else n=$c(t,r,c,2),n!==null&&Vt(n,t,2)}function Ho(t){var n=t.alternate;return t===ve||n!==null&&n===ve}function Dp(t,n){is=Io=!0;var r=t.pending;r===null?n.next=n:(n.next=r.next,r.next=n),t.pending=n}function Op(t,n,r){if((r&4194048)!==0){var c=n.lanes;c&=t.pendingLanes,r|=c,n.lanes=r,Uf(t,r)}}var cr={readContext:Et,use:Bo,useCallback:it,useContext:it,useEffect:it,useImperativeHandle:it,useLayoutEffect:it,useInsertionEffect:it,useMemo:it,useReducer:it,useRef:it,useState:it,useDebugValue:it,useDeferredValue:it,useTransition:it,useSyncExternalStore:it,useId:it,useHostTransitionStatus:it,useFormState:it,useActionState:it,useOptimistic:it,useMemoCache:it,useCacheRefresh:it};cr.useEffectEvent=it;var jp={readContext:Et,use:Bo,useCallback:function(t,n){return Ot().memoizedState=[t,n===void 0?null:n],t},useContext:Et,useEffect:vp,useImperativeHandle:function(t,n,r){r=r!=null?r.concat([t]):null,Fo(4194308,4,Tp.bind(null,n,t),r)},useLayoutEffect:function(t,n){return Fo(4194308,4,t,n)},useInsertionEffect:function(t,n){Fo(4,2,t,n)},useMemo:function(t,n){var r=Ot();n=n===void 0?null:n;var c=t();if(ba){bi(!0);try{t()}finally{bi(!1)}}return r.memoizedState=[c,n],c},useReducer:function(t,n,r){var c=Ot();if(r!==void 0){var m=r(n);if(ba){bi(!0);try{r(n)}finally{bi(!1)}}}else m=n;return c.memoizedState=c.baseState=m,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:m},c.queue=t,t=t.dispatch=KC.bind(null,ve,t),[c.memoizedState,t]},useRef:function(t){var n=Ot();return t={current:t},n.memoizedState=t},useState:function(t){t=Nu(t);var n=t.queue,r=Mp.bind(null,ve,n);return n.dispatch=r,[t.memoizedState,r]},useDebugValue:Du,useDeferredValue:function(t,n){var r=Ot();return Ou(r,t,n)},useTransition:function(){var t=Nu(!1);return t=wp.bind(null,ve,t.queue,!0,!1),Ot().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,n,r){var c=ve,m=Ot();if(Ne){if(r===void 0)throw Error(s(407));r=r()}else{if(r=n(),Ye===null)throw Error(s(349));(_e&127)!==0||tp(c,n,r)}m.memoizedState=r;var g={value:r,getSnapshot:n};return m.queue=g,vp(ip.bind(null,c,g,t),[t]),c.flags|=2048,ss(9,{destroy:void 0},np.bind(null,c,g,r,n),null),r},useId:function(){var t=Ot(),n=Ye.identifierPrefix;if(Ne){var r=jn,c=On;r=(c&~(1<<32-Wt(c)-1)).toString(32)+r,n="_"+n+"R_"+r,r=Lo++,0<r&&(n+="H"+r.toString(32)),n+="_"}else r=BC++,n="_"+n+"r_"+r.toString(32)+"_";return t.memoizedState=n},useHostTransitionStatus:Pu,useFormState:hp,useActionState:hp,useOptimistic:function(t){var n=Ot();n.memoizedState=n.baseState=t;var r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return n.queue=r,n=Iu.bind(null,ve,!0,r),r.dispatch=n,[t,n]},useMemoCache:wu,useCacheRefresh:function(){return Ot().memoizedState=GC.bind(null,ve)},useEffectEvent:function(t){var n=Ot(),r={impl:t};return n.memoizedState=r,function(){if((Ue&2)!==0)throw Error(s(440));return r.impl.apply(void 0,arguments)}}},Lu={readContext:Et,use:Bo,useCallback:kp,useContext:Et,useEffect:Mu,useImperativeHandle:Cp,useInsertionEffect:bp,useLayoutEffect:Sp,useMemo:xp,useReducer:qo,useRef:gp,useState:function(){return qo($n)},useDebugValue:Du,useDeferredValue:function(t,n){var r=ct();return Ep(r,He.memoizedState,t,n)},useTransition:function(){var t=qo($n)[0],n=ct().memoizedState;return[typeof t=="boolean"?t:or(t),n]},useSyncExternalStore:ep,useId:Np,useHostTransitionStatus:Pu,useFormState:fp,useActionState:fp,useOptimistic:function(t,n){var r=ct();return rp(r,He,t,n)},useMemoCache:wu,useCacheRefresh:Ap};Lu.useEffectEvent=yp;var Pp={readContext:Et,use:Bo,useCallback:kp,useContext:Et,useEffect:Mu,useImperativeHandle:Cp,useInsertionEffect:bp,useLayoutEffect:Sp,useMemo:xp,useReducer:Ru,useRef:gp,useState:function(){return Ru($n)},useDebugValue:Du,useDeferredValue:function(t,n){var r=ct();return He===null?Ou(r,t,n):Ep(r,He.memoizedState,t,n)},useTransition:function(){var t=Ru($n)[0],n=ct().memoizedState;return[typeof t=="boolean"?t:or(t),n]},useSyncExternalStore:ep,useId:Np,useHostTransitionStatus:Pu,useFormState:pp,useActionState:pp,useOptimistic:function(t,n){var r=ct();return He!==null?rp(r,He,t,n):(r.baseState=t,[t,r.queue.dispatch])},useMemoCache:wu,useCacheRefresh:Ap};Pp.useEffectEvent=yp;function Uu(t,n,r,c){n=t.memoizedState,r=r(c,n),r=r==null?n:y({},n,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Bu={enqueueSetState:function(t,n,r){t=t._reactInternals;var c=an(),m=_i(c);m.payload=n,r!=null&&(m.callback=r),n=Ri(t,m,c),n!==null&&(Vt(n,t,c),ir(n,t,c))},enqueueReplaceState:function(t,n,r){t=t._reactInternals;var c=an(),m=_i(c);m.tag=1,m.payload=n,r!=null&&(m.callback=r),n=Ri(t,m,c),n!==null&&(Vt(n,t,c),ir(n,t,c))},enqueueForceUpdate:function(t,n){t=t._reactInternals;var r=an(),c=_i(r);c.tag=2,n!=null&&(c.callback=n),n=Ri(t,c,r),n!==null&&(Vt(n,t,r),ir(n,t,r))}};function Ip(t,n,r,c,m,g,b){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(c,g,b):n.prototype&&n.prototype.isPureReactComponent?!Qs(r,c)||!Qs(m,g):!0}function Lp(t,n,r,c){t=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(r,c),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(r,c),n.state!==t&&Bu.enqueueReplaceState(n,n.state,null)}function Sa(t,n){var r=n;if("ref"in n){r={};for(var c in n)c!=="ref"&&(r[c]=n[c])}if(t=t.defaultProps){r===n&&(r=y({},r));for(var m in t)r[m]===void 0&&(r[m]=t[m])}return r}function Up(t){To(t)}function Bp(t){console.error(t)}function qp(t){To(t)}function Vo(t,n){try{var r=t.onUncaughtError;r(n.value,{componentStack:n.stack})}catch(c){setTimeout(function(){throw c})}}function Fp(t,n,r){try{var c=t.onCaughtError;c(r.value,{componentStack:r.stack,errorBoundary:n.tag===1?n.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function qu(t,n,r){return r=_i(r),r.tag=3,r.payload={element:null},r.callback=function(){Vo(t,n)},r}function zp(t){return t=_i(t),t.tag=3,t}function Hp(t,n,r,c){var m=r.type.getDerivedStateFromError;if(typeof m=="function"){var g=c.value;t.payload=function(){return m(g)},t.callback=function(){Fp(n,r,c)}}var b=r.stateNode;b!==null&&typeof b.componentDidCatch=="function"&&(t.callback=function(){Fp(n,r,c),typeof m!="function"&&(ji===null?ji=new Set([this]):ji.add(this));var T=c.stack;this.componentDidCatch(c.value,{componentStack:T!==null?T:""})})}function YC(t,n,r,c,m){if(r.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(n=r.alternate,n!==null&&Xa(n,r,m,!0),r=$t.current,r!==null){switch(r.tag){case 31:case 13:return mn===null?nl():r.alternate===null&&at===0&&(at=3),r.flags&=-257,r.flags|=65536,r.lanes=m,c===Mo?r.flags|=16384:(n=r.updateQueue,n===null?r.updateQueue=new Set([c]):n.add(c),dd(t,c,m)),!1;case 22:return r.flags|=65536,c===Mo?r.flags|=16384:(n=r.updateQueue,n===null?(n={transitions:null,markerInstances:null,retryQueue:new Set([c])},r.updateQueue=n):(r=n.retryQueue,r===null?n.retryQueue=new Set([c]):r.add(c)),dd(t,c,m)),!1}throw Error(s(435,r.tag))}return dd(t,c,m),nl(),!1}if(Ne)return n=$t.current,n!==null?((n.flags&65536)===0&&(n.flags|=256),n.flags|=65536,n.lanes=m,c!==su&&(t=Error(s(422),{cause:c}),Zs(un(t,r)))):(c!==su&&(n=Error(s(423),{cause:c}),Zs(un(n,r))),t=t.current.alternate,t.flags|=65536,m&=-m,t.lanes|=m,c=un(c,r),m=qu(t.stateNode,c,m),gu(t,m),at!==4&&(at=2)),!1;var g=Error(s(520),{cause:c});if(g=un(g,r),vr===null?vr=[g]:vr.push(g),at!==4&&(at=2),n===null)return!0;c=un(c,r),r=n;do{switch(r.tag){case 3:return r.flags|=65536,t=m&-m,r.lanes|=t,t=qu(r.stateNode,c,t),gu(r,t),!1;case 1:if(n=r.type,g=r.stateNode,(r.flags&128)===0&&(typeof n.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(ji===null||!ji.has(g))))return r.flags|=65536,m&=-m,r.lanes|=m,m=zp(m),Hp(m,t,r,c),gu(r,m),!1}r=r.return}while(r!==null);return!1}var Fu=Error(s(461)),pt=!1;function wt(t,n,r,c){n.child=t===null?Ym(n,null,r,c):ya(n,t.child,r,c)}function Vp(t,n,r,c,m){r=r.render;var g=n.ref;if("ref"in c){var b={};for(var T in c)T!=="ref"&&(b[T]=c[T])}else b=c;return ma(n),c=Cu(t,n,r,b,g,m),T=ku(),t!==null&&!pt?(xu(t,n,m),ei(t,n,m)):(Ne&&T&&iu(n),n.flags|=1,wt(t,n,c,m),n.child)}function Gp(t,n,r,c,m){if(t===null){var g=r.type;return typeof g=="function"&&!eu(g)&&g.defaultProps===void 0&&r.compare===null?(n.tag=15,n.type=g,Kp(t,n,g,c,m)):(t=Eo(r.type,null,c,n,n.mode,m),t.ref=n.ref,t.return=n,n.child=t)}if(g=t.child,!Qu(t,m)){var b=g.memoizedProps;if(r=r.compare,r=r!==null?r:Qs,r(b,c)&&t.ref===n.ref)return ei(t,n,m)}return n.flags|=1,t=Jn(g,c),t.ref=n.ref,t.return=n,n.child=t}function Kp(t,n,r,c,m){if(t!==null){var g=t.memoizedProps;if(Qs(g,c)&&t.ref===n.ref)if(pt=!1,n.pendingProps=c=g,Qu(t,m))(t.flags&131072)!==0&&(pt=!0);else return n.lanes=t.lanes,ei(t,n,m)}return zu(t,n,r,c,m)}function Yp(t,n,r,c){var m=c.children,g=t!==null?t.memoizedState:null;if(t===null&&n.stateNode===null&&(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((n.flags&128)!==0){if(g=g!==null?g.baseLanes|r:r,t!==null){for(c=n.child=t.child,m=0;c!==null;)m=m|c.lanes|c.childLanes,c=c.sibling;c=m&~g}else c=0,n.child=null;return Jp(t,n,g,r,c)}if((r&536870912)!==0)n.memoizedState={baseLanes:0,cachePool:null},t!==null&&No(n,g!==null?g.cachePool:null),g!==null?Wm(n,g):yu(),Xm(n);else return c=n.lanes=536870912,Jp(t,n,g!==null?g.baseLanes|r:r,r,c)}else g!==null?(No(n,g.cachePool),Wm(n,g),Ai(),n.memoizedState=null):(t!==null&&No(n,null),yu(),Ai());return wt(t,n,m,r),n.child}function ur(t,n){return t!==null&&t.tag===22||n.stateNode!==null||(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),n.sibling}function Jp(t,n,r,c,m){var g=hu();return g=g===null?null:{parent:ft._currentValue,pool:g},n.memoizedState={baseLanes:r,cachePool:g},t!==null&&No(n,null),yu(),Xm(n),t!==null&&Xa(t,n,c,!0),n.childLanes=m,null}function Go(t,n){return n=Yo({mode:n.mode,children:n.children},t.mode),n.ref=t.ref,t.child=n,n.return=t,n}function Qp(t,n,r){return ya(n,t.child,null,r),t=Go(n,n.pendingProps),t.flags|=2,en(n),n.memoizedState=null,t}function JC(t,n,r){var c=n.pendingProps,m=(n.flags&128)!==0;if(n.flags&=-129,t===null){if(Ne){if(c.mode==="hidden")return t=Go(n,c),n.lanes=536870912,ur(null,t);if(Su(n),(t=Xe)?(t=ov(t,fn),t=t!==null&&t.data==="&"?t:null,t!==null&&(n.memoizedState={dehydrated:t,treeContext:Ci!==null?{id:On,overflow:jn}:null,retryLane:536870912,hydrationErrors:null},r=Dm(t),r.return=n,n.child=r,xt=n,Xe=null)):t=null,t===null)throw xi(n);return n.lanes=536870912,null}return Go(n,c)}var g=t.memoizedState;if(g!==null){var b=g.dehydrated;if(Su(n),m)if(n.flags&256)n.flags&=-257,n=Qp(t,n,r);else if(n.memoizedState!==null)n.child=t.child,n.flags|=128,n=null;else throw Error(s(558));else if(pt||Xa(t,n,r,!1),m=(r&t.childLanes)!==0,pt||m){if(c=Ye,c!==null&&(b=Bf(c,r),b!==0&&b!==g.retryLane))throw g.retryLane=b,ua(t,b),Vt(c,t,b),Fu;nl(),n=Qp(t,n,r)}else t=g.treeContext,Xe=pn(b.nextSibling),xt=n,Ne=!0,ki=null,fn=!1,t!==null&&Pm(n,t),n=Go(n,c),n.flags|=4096;return n}return t=Jn(t.child,{mode:c.mode,children:c.children}),t.ref=n.ref,n.child=t,t.return=n,t}function Ko(t,n){var r=n.ref;if(r===null)t!==null&&t.ref!==null&&(n.flags|=4194816);else{if(typeof r!="function"&&typeof r!="object")throw Error(s(284));(t===null||t.ref!==r)&&(n.flags|=4194816)}}function zu(t,n,r,c,m){return ma(n),r=Cu(t,n,r,c,void 0,m),c=ku(),t!==null&&!pt?(xu(t,n,m),ei(t,n,m)):(Ne&&c&&iu(n),n.flags|=1,wt(t,n,r,m),n.child)}function Wp(t,n,r,c,m,g){return ma(n),n.updateQueue=null,r=$m(n,c,r,m),Zm(t),c=ku(),t!==null&&!pt?(xu(t,n,g),ei(t,n,g)):(Ne&&c&&iu(n),n.flags|=1,wt(t,n,r,g),n.child)}function Xp(t,n,r,c,m){if(ma(n),n.stateNode===null){var g=Ya,b=r.contextType;typeof b=="object"&&b!==null&&(g=Et(b)),g=new r(c,g),n.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=Bu,n.stateNode=g,g._reactInternals=n,g=n.stateNode,g.props=c,g.state=n.memoizedState,g.refs={},mu(n),b=r.contextType,g.context=typeof b=="object"&&b!==null?Et(b):Ya,g.state=n.memoizedState,b=r.getDerivedStateFromProps,typeof b=="function"&&(Uu(n,r,b,c),g.state=n.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(b=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),b!==g.state&&Bu.enqueueReplaceState(g,g.state,null),sr(n,c,g,m),ar(),g.state=n.memoizedState),typeof g.componentDidMount=="function"&&(n.flags|=4194308),c=!0}else if(t===null){g=n.stateNode;var T=n.memoizedProps,w=Sa(r,T);g.props=w;var q=g.context,G=r.contextType;b=Ya,typeof G=="object"&&G!==null&&(b=Et(G));var J=r.getDerivedStateFromProps;G=typeof J=="function"||typeof g.getSnapshotBeforeUpdate=="function",T=n.pendingProps!==T,G||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(T||q!==b)&&Lp(n,g,c,b),wi=!1;var F=n.memoizedState;g.state=F,sr(n,c,g,m),ar(),q=n.memoizedState,T||F!==q||wi?(typeof J=="function"&&(Uu(n,r,J,c),q=n.memoizedState),(w=wi||Ip(n,r,w,c,F,q,b))?(G||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(n.flags|=4194308)):(typeof g.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=c,n.memoizedState=q),g.props=c,g.state=q,g.context=b,c=w):(typeof g.componentDidMount=="function"&&(n.flags|=4194308),c=!1)}else{g=n.stateNode,pu(t,n),b=n.memoizedProps,G=Sa(r,b),g.props=G,J=n.pendingProps,F=g.context,q=r.contextType,w=Ya,typeof q=="object"&&q!==null&&(w=Et(q)),T=r.getDerivedStateFromProps,(q=typeof T=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(b!==J||F!==w)&&Lp(n,g,c,w),wi=!1,F=n.memoizedState,g.state=F,sr(n,c,g,m),ar();var V=n.memoizedState;b!==J||F!==V||wi||t!==null&&t.dependencies!==null&&_o(t.dependencies)?(typeof T=="function"&&(Uu(n,r,T,c),V=n.memoizedState),(G=wi||Ip(n,r,G,c,F,V,w)||t!==null&&t.dependencies!==null&&_o(t.dependencies))?(q||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(c,V,w),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(c,V,w)),typeof g.componentDidUpdate=="function"&&(n.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof g.componentDidUpdate!="function"||b===t.memoizedProps&&F===t.memoizedState||(n.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||b===t.memoizedProps&&F===t.memoizedState||(n.flags|=1024),n.memoizedProps=c,n.memoizedState=V),g.props=c,g.state=V,g.context=w,c=G):(typeof g.componentDidUpdate!="function"||b===t.memoizedProps&&F===t.memoizedState||(n.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||b===t.memoizedProps&&F===t.memoizedState||(n.flags|=1024),c=!1)}return g=c,Ko(t,n),c=(n.flags&128)!==0,g||c?(g=n.stateNode,r=c&&typeof r.getDerivedStateFromError!="function"?null:g.render(),n.flags|=1,t!==null&&c?(n.child=ya(n,t.child,null,m),n.child=ya(n,null,r,m)):wt(t,n,r,m),n.memoizedState=g.state,t=n.child):t=ei(t,n,m),t}function Zp(t,n,r,c){return ha(),n.flags|=256,wt(t,n,r,c),n.child}var Hu={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Vu(t){return{baseLanes:t,cachePool:Fm()}}function Gu(t,n,r){return t=t!==null?t.childLanes&~r:0,n&&(t|=nn),t}function $p(t,n,r){var c=n.pendingProps,m=!1,g=(n.flags&128)!==0,b;if((b=g)||(b=t!==null&&t.memoizedState===null?!1:(lt.current&2)!==0),b&&(m=!0,n.flags&=-129),b=(n.flags&32)!==0,n.flags&=-33,t===null){if(Ne){if(m?Ni(n):Ai(),(t=Xe)?(t=ov(t,fn),t=t!==null&&t.data!=="&"?t:null,t!==null&&(n.memoizedState={dehydrated:t,treeContext:Ci!==null?{id:On,overflow:jn}:null,retryLane:536870912,hydrationErrors:null},r=Dm(t),r.return=n,n.child=r,xt=n,Xe=null)):t=null,t===null)throw xi(n);return _d(t)?n.lanes=32:n.lanes=536870912,null}var T=c.children;return c=c.fallback,m?(Ai(),m=n.mode,T=Yo({mode:"hidden",children:T},m),c=da(c,m,r,null),T.return=n,c.return=n,T.sibling=c,n.child=T,c=n.child,c.memoizedState=Vu(r),c.childLanes=Gu(t,b,r),n.memoizedState=Hu,ur(null,c)):(Ni(n),Ku(n,T))}var w=t.memoizedState;if(w!==null&&(T=w.dehydrated,T!==null)){if(g)n.flags&256?(Ni(n),n.flags&=-257,n=Yu(t,n,r)):n.memoizedState!==null?(Ai(),n.child=t.child,n.flags|=128,n=null):(Ai(),T=c.fallback,m=n.mode,c=Yo({mode:"visible",children:c.children},m),T=da(T,m,r,null),T.flags|=2,c.return=n,T.return=n,c.sibling=T,n.child=c,ya(n,t.child,null,r),c=n.child,c.memoizedState=Vu(r),c.childLanes=Gu(t,b,r),n.memoizedState=Hu,n=ur(null,c));else if(Ni(n),_d(T)){if(b=T.nextSibling&&T.nextSibling.dataset,b)var q=b.dgst;b=q,c=Error(s(419)),c.stack="",c.digest=b,Zs({value:c,source:null,stack:null}),n=Yu(t,n,r)}else if(pt||Xa(t,n,r,!1),b=(r&t.childLanes)!==0,pt||b){if(b=Ye,b!==null&&(c=Bf(b,r),c!==0&&c!==w.retryLane))throw w.retryLane=c,ua(t,c),Vt(b,t,c),Fu;wd(T)||nl(),n=Yu(t,n,r)}else wd(T)?(n.flags|=192,n.child=t.child,n=null):(t=w.treeContext,Xe=pn(T.nextSibling),xt=n,Ne=!0,ki=null,fn=!1,t!==null&&Pm(n,t),n=Ku(n,c.children),n.flags|=4096);return n}return m?(Ai(),T=c.fallback,m=n.mode,w=t.child,q=w.sibling,c=Jn(w,{mode:"hidden",children:c.children}),c.subtreeFlags=w.subtreeFlags&65011712,q!==null?T=Jn(q,T):(T=da(T,m,r,null),T.flags|=2),T.return=n,c.return=n,c.sibling=T,n.child=c,ur(null,c),c=n.child,T=t.child.memoizedState,T===null?T=Vu(r):(m=T.cachePool,m!==null?(w=ft._currentValue,m=m.parent!==w?{parent:w,pool:w}:m):m=Fm(),T={baseLanes:T.baseLanes|r,cachePool:m}),c.memoizedState=T,c.childLanes=Gu(t,b,r),n.memoizedState=Hu,ur(t.child,c)):(Ni(n),r=t.child,t=r.sibling,r=Jn(r,{mode:"visible",children:c.children}),r.return=n,r.sibling=null,t!==null&&(b=n.deletions,b===null?(n.deletions=[t],n.flags|=16):b.push(t)),n.child=r,n.memoizedState=null,r)}function Ku(t,n){return n=Yo({mode:"visible",children:n},t.mode),n.return=t,t.child=n}function Yo(t,n){return t=Zt(22,t,null,n),t.lanes=0,t}function Yu(t,n,r){return ya(n,t.child,null,r),t=Ku(n,n.pendingProps.children),t.flags|=2,n.memoizedState=null,t}function eg(t,n,r){t.lanes|=n;var c=t.alternate;c!==null&&(c.lanes|=n),lu(t.return,n,r)}function Ju(t,n,r,c,m,g){var b=t.memoizedState;b===null?t.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:c,tail:r,tailMode:m,treeForkCount:g}:(b.isBackwards=n,b.rendering=null,b.renderingStartTime=0,b.last=c,b.tail=r,b.tailMode=m,b.treeForkCount=g)}function tg(t,n,r){var c=n.pendingProps,m=c.revealOrder,g=c.tail;c=c.children;var b=lt.current,T=(b&2)!==0;if(T?(b=b&1|2,n.flags|=128):b&=1,se(lt,b),wt(t,n,c,r),c=Ne?Xs:0,!T&&t!==null&&(t.flags&128)!==0)e:for(t=n.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&eg(t,r,n);else if(t.tag===19)eg(t,r,n);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===n)break e;for(;t.sibling===null;){if(t.return===null||t.return===n)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}switch(m){case"forwards":for(r=n.child,m=null;r!==null;)t=r.alternate,t!==null&&Po(t)===null&&(m=r),r=r.sibling;r=m,r===null?(m=n.child,n.child=null):(m=r.sibling,r.sibling=null),Ju(n,!1,m,r,g,c);break;case"backwards":case"unstable_legacy-backwards":for(r=null,m=n.child,n.child=null;m!==null;){if(t=m.alternate,t!==null&&Po(t)===null){n.child=m;break}t=m.sibling,m.sibling=r,r=m,m=t}Ju(n,!0,r,null,g,c);break;case"together":Ju(n,!1,null,null,void 0,c);break;default:n.memoizedState=null}return n.child}function ei(t,n,r){if(t!==null&&(n.dependencies=t.dependencies),Oi|=n.lanes,(r&n.childLanes)===0)if(t!==null){if(Xa(t,n,r,!1),(r&n.childLanes)===0)return null}else return null;if(t!==null&&n.child!==t.child)throw Error(s(153));if(n.child!==null){for(t=n.child,r=Jn(t,t.pendingProps),n.child=r,r.return=n;t.sibling!==null;)t=t.sibling,r=r.sibling=Jn(t,t.pendingProps),r.return=n;r.sibling=null}return n.child}function Qu(t,n){return(t.lanes&n)!==0?!0:(t=t.dependencies,!!(t!==null&&_o(t)))}function QC(t,n,r){switch(n.tag){case 3:Dt(n,n.stateNode.containerInfo),Ei(n,ft,t.memoizedState.cache),ha();break;case 27:case 5:Is(n);break;case 4:Dt(n,n.stateNode.containerInfo);break;case 10:Ei(n,n.type,n.memoizedProps.value);break;case 31:if(n.memoizedState!==null)return n.flags|=128,Su(n),null;break;case 13:var c=n.memoizedState;if(c!==null)return c.dehydrated!==null?(Ni(n),n.flags|=128,null):(r&n.child.childLanes)!==0?$p(t,n,r):(Ni(n),t=ei(t,n,r),t!==null?t.sibling:null);Ni(n);break;case 19:var m=(t.flags&128)!==0;if(c=(r&n.childLanes)!==0,c||(Xa(t,n,r,!1),c=(r&n.childLanes)!==0),m){if(c)return tg(t,n,r);n.flags|=128}if(m=n.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),se(lt,lt.current),c)break;return null;case 22:return n.lanes=0,Yp(t,n,r,n.pendingProps);case 24:Ei(n,ft,t.memoizedState.cache)}return ei(t,n,r)}function ng(t,n,r){if(t!==null)if(t.memoizedProps!==n.pendingProps)pt=!0;else{if(!Qu(t,r)&&(n.flags&128)===0)return pt=!1,QC(t,n,r);pt=(t.flags&131072)!==0}else pt=!1,Ne&&(n.flags&1048576)!==0&&jm(n,Xs,n.index);switch(n.lanes=0,n.tag){case 16:e:{var c=n.pendingProps;if(t=ga(n.elementType),n.type=t,typeof t=="function")eu(t)?(c=Sa(t,c),n.tag=1,n=Xp(null,n,t,c,r)):(n.tag=0,n=zu(null,n,t,c,r));else{if(t!=null){var m=t.$$typeof;if(m===D){n.tag=11,n=Vp(null,n,t,c,r);break e}else if(m===H){n.tag=14,n=Gp(null,n,t,c,r);break e}}throw n=We(t)||t,Error(s(306,n,""))}}return n;case 0:return zu(t,n,n.type,n.pendingProps,r);case 1:return c=n.type,m=Sa(c,n.pendingProps),Xp(t,n,c,m,r);case 3:e:{if(Dt(n,n.stateNode.containerInfo),t===null)throw Error(s(387));c=n.pendingProps;var g=n.memoizedState;m=g.element,pu(t,n),sr(n,c,null,r);var b=n.memoizedState;if(c=b.cache,Ei(n,ft,c),c!==g.cache&&cu(n,[ft],r,!0),ar(),c=b.element,g.isDehydrated)if(g={element:c,isDehydrated:!1,cache:b.cache},n.updateQueue.baseState=g,n.memoizedState=g,n.flags&256){n=Zp(t,n,c,r);break e}else if(c!==m){m=un(Error(s(424)),n),Zs(m),n=Zp(t,n,c,r);break e}else for(t=n.stateNode.containerInfo,t.nodeType===9?t=t.body:t=t.nodeName==="HTML"?t.ownerDocument.body:t,Xe=pn(t.firstChild),xt=n,Ne=!0,ki=null,fn=!0,r=Ym(n,null,c,r),n.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(ha(),c===m){n=ei(t,n,r);break e}wt(t,n,c,r)}n=n.child}return n;case 26:return Ko(t,n),t===null?(r=fv(n.type,null,n.pendingProps,null))?n.memoizedState=r:Ne||(r=n.type,t=n.pendingProps,c=cl(ye.current).createElement(r),c[kt]=n,c[Ut]=t,_t(c,r,t),bt(c),n.stateNode=c):n.memoizedState=fv(n.type,t.memoizedProps,n.pendingProps,t.memoizedState),null;case 27:return Is(n),t===null&&Ne&&(c=n.stateNode=uv(n.type,n.pendingProps,ye.current),xt=n,fn=!0,m=Xe,Ui(n.type)?(Rd=m,Xe=pn(c.firstChild)):Xe=m),wt(t,n,n.pendingProps.children,r),Ko(t,n),t===null&&(n.flags|=4194304),n.child;case 5:return t===null&&Ne&&((m=c=Xe)&&(c=Ek(c,n.type,n.pendingProps,fn),c!==null?(n.stateNode=c,xt=n,Xe=pn(c.firstChild),fn=!1,m=!0):m=!1),m||xi(n)),Is(n),m=n.type,g=n.pendingProps,b=t!==null?t.memoizedProps:null,c=g.children,kd(m,g)?c=null:b!==null&&kd(m,b)&&(n.flags|=32),n.memoizedState!==null&&(m=Cu(t,n,qC,null,null,r),Er._currentValue=m),Ko(t,n),wt(t,n,c,r),n.child;case 6:return t===null&&Ne&&((t=r=Xe)&&(r=wk(r,n.pendingProps,fn),r!==null?(n.stateNode=r,xt=n,Xe=null,t=!0):t=!1),t||xi(n)),null;case 13:return $p(t,n,r);case 4:return Dt(n,n.stateNode.containerInfo),c=n.pendingProps,t===null?n.child=ya(n,null,c,r):wt(t,n,c,r),n.child;case 11:return Vp(t,n,n.type,n.pendingProps,r);case 7:return wt(t,n,n.pendingProps,r),n.child;case 8:return wt(t,n,n.pendingProps.children,r),n.child;case 12:return wt(t,n,n.pendingProps.children,r),n.child;case 10:return c=n.pendingProps,Ei(n,n.type,c.value),wt(t,n,c.children,r),n.child;case 9:return m=n.type._context,c=n.pendingProps.children,ma(n),m=Et(m),c=c(m),n.flags|=1,wt(t,n,c,r),n.child;case 14:return Gp(t,n,n.type,n.pendingProps,r);case 15:return Kp(t,n,n.type,n.pendingProps,r);case 19:return tg(t,n,r);case 31:return JC(t,n,r);case 22:return Yp(t,n,r,n.pendingProps);case 24:return ma(n),c=Et(ft),t===null?(m=hu(),m===null&&(m=Ye,g=uu(),m.pooledCache=g,g.refCount++,g!==null&&(m.pooledCacheLanes|=r),m=g),n.memoizedState={parent:c,cache:m},mu(n),Ei(n,ft,m)):((t.lanes&r)!==0&&(pu(t,n),sr(n,null,null,r),ar()),m=t.memoizedState,g=n.memoizedState,m.parent!==c?(m={parent:c,cache:c},n.memoizedState=m,n.lanes===0&&(n.memoizedState=n.updateQueue.baseState=m),Ei(n,ft,c)):(c=g.cache,Ei(n,ft,c),c!==m.cache&&cu(n,[ft],r,!0))),wt(t,n,n.pendingProps.children,r),n.child;case 29:throw n.pendingProps}throw Error(s(156,n.tag))}function ti(t){t.flags|=4}function Wu(t,n,r,c,m){if((n=(t.mode&32)!==0)&&(n=!1),n){if(t.flags|=16777216,(m&335544128)===m)if(t.stateNode.complete)t.flags|=8192;else if(Ng())t.flags|=8192;else throw va=Mo,fu}else t.flags&=-16777217}function ig(t,n){if(n.type!=="stylesheet"||(n.state.loading&4)!==0)t.flags&=-16777217;else if(t.flags|=16777216,!yv(n))if(Ng())t.flags|=8192;else throw va=Mo,fu}function Jo(t,n){n!==null&&(t.flags|=4),t.flags&16384&&(n=t.tag!==22?If():536870912,t.lanes|=n,cs|=n)}function dr(t,n){if(!Ne)switch(t.tailMode){case"hidden":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var c=null;r!==null;)r.alternate!==null&&(c=r),r=r.sibling;c===null?n||t.tail===null?t.tail=null:t.tail.sibling=null:c.sibling=null}}function Ze(t){var n=t.alternate!==null&&t.alternate.child===t.child,r=0,c=0;if(n)for(var m=t.child;m!==null;)r|=m.lanes|m.childLanes,c|=m.subtreeFlags&65011712,c|=m.flags&65011712,m.return=t,m=m.sibling;else for(m=t.child;m!==null;)r|=m.lanes|m.childLanes,c|=m.subtreeFlags,c|=m.flags,m.return=t,m=m.sibling;return t.subtreeFlags|=c,t.childLanes=r,n}function WC(t,n,r){var c=n.pendingProps;switch(au(n),n.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ze(n),null;case 1:return Ze(n),null;case 3:return r=n.stateNode,c=null,t!==null&&(c=t.memoizedState.cache),n.memoizedState.cache!==c&&(n.flags|=2048),Xn(ft),ot(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Wa(n)?ti(n):t===null||t.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,ru())),Ze(n),null;case 26:var m=n.type,g=n.memoizedState;return t===null?(ti(n),g!==null?(Ze(n),ig(n,g)):(Ze(n),Wu(n,m,null,c,r))):g?g!==t.memoizedState?(ti(n),Ze(n),ig(n,g)):(Ze(n),n.flags&=-16777217):(t=t.memoizedProps,t!==c&&ti(n),Ze(n),Wu(n,m,t,c,r)),null;case 27:if(ao(n),r=ye.current,m=n.type,t!==null&&n.stateNode!=null)t.memoizedProps!==c&&ti(n);else{if(!c){if(n.stateNode===null)throw Error(s(166));return Ze(n),null}t=le.current,Wa(n)?Im(n):(t=uv(m,c,r),n.stateNode=t,ti(n))}return Ze(n),null;case 5:if(ao(n),m=n.type,t!==null&&n.stateNode!=null)t.memoizedProps!==c&&ti(n);else{if(!c){if(n.stateNode===null)throw Error(s(166));return Ze(n),null}if(g=le.current,Wa(n))Im(n);else{var b=cl(ye.current);switch(g){case 1:g=b.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:g=b.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":g=b.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":g=b.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":g=b.createElement("div"),g.innerHTML="<script><\/script>",g=g.removeChild(g.firstChild);break;case"select":g=typeof c.is=="string"?b.createElement("select",{is:c.is}):b.createElement("select"),c.multiple?g.multiple=!0:c.size&&(g.size=c.size);break;default:g=typeof c.is=="string"?b.createElement(m,{is:c.is}):b.createElement(m)}}g[kt]=n,g[Ut]=c;e:for(b=n.child;b!==null;){if(b.tag===5||b.tag===6)g.appendChild(b.stateNode);else if(b.tag!==4&&b.tag!==27&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===n)break e;for(;b.sibling===null;){if(b.return===null||b.return===n)break e;b=b.return}b.sibling.return=b.return,b=b.sibling}n.stateNode=g;e:switch(_t(g,m,c),m){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&ti(n)}}return Ze(n),Wu(n,n.type,t===null?null:t.memoizedProps,n.pendingProps,r),null;case 6:if(t&&n.stateNode!=null)t.memoizedProps!==c&&ti(n);else{if(typeof c!="string"&&n.stateNode===null)throw Error(s(166));if(t=ye.current,Wa(n)){if(t=n.stateNode,r=n.memoizedProps,c=null,m=xt,m!==null)switch(m.tag){case 27:case 5:c=m.memoizedProps}t[kt]=n,t=!!(t.nodeValue===r||c!==null&&c.suppressHydrationWarning===!0||$g(t.nodeValue,r)),t||xi(n,!0)}else t=cl(t).createTextNode(c),t[kt]=n,n.stateNode=t}return Ze(n),null;case 31:if(r=n.memoizedState,t===null||t.memoizedState!==null){if(c=Wa(n),r!==null){if(t===null){if(!c)throw Error(s(318));if(t=n.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(s(557));t[kt]=n}else ha(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;Ze(n),t=!1}else r=ru(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=r),t=!0;if(!t)return n.flags&256?(en(n),n):(en(n),null);if((n.flags&128)!==0)throw Error(s(558))}return Ze(n),null;case 13:if(c=n.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(m=Wa(n),c!==null&&c.dehydrated!==null){if(t===null){if(!m)throw Error(s(318));if(m=n.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(s(317));m[kt]=n}else ha(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;Ze(n),m=!1}else m=ru(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=m),m=!0;if(!m)return n.flags&256?(en(n),n):(en(n),null)}return en(n),(n.flags&128)!==0?(n.lanes=r,n):(r=c!==null,t=t!==null&&t.memoizedState!==null,r&&(c=n.child,m=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(m=c.alternate.memoizedState.cachePool.pool),g=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(g=c.memoizedState.cachePool.pool),g!==m&&(c.flags|=2048)),r!==t&&r&&(n.child.flags|=8192),Jo(n,n.updateQueue),Ze(n),null);case 4:return ot(),t===null&&yd(n.stateNode.containerInfo),Ze(n),null;case 10:return Xn(n.type),Ze(n),null;case 19:if(Y(lt),c=n.memoizedState,c===null)return Ze(n),null;if(m=(n.flags&128)!==0,g=c.rendering,g===null)if(m)dr(c,!1);else{if(at!==0||t!==null&&(t.flags&128)!==0)for(t=n.child;t!==null;){if(g=Po(t),g!==null){for(n.flags|=128,dr(c,!1),t=g.updateQueue,n.updateQueue=t,Jo(n,t),n.subtreeFlags=0,t=r,r=n.child;r!==null;)Mm(r,t),r=r.sibling;return se(lt,lt.current&1|2),Ne&&Qn(n,c.treeForkCount),n.child}t=t.sibling}c.tail!==null&&Jt()>$o&&(n.flags|=128,m=!0,dr(c,!1),n.lanes=4194304)}else{if(!m)if(t=Po(g),t!==null){if(n.flags|=128,m=!0,t=t.updateQueue,n.updateQueue=t,Jo(n,t),dr(c,!0),c.tail===null&&c.tailMode==="hidden"&&!g.alternate&&!Ne)return Ze(n),null}else 2*Jt()-c.renderingStartTime>$o&&r!==536870912&&(n.flags|=128,m=!0,dr(c,!1),n.lanes=4194304);c.isBackwards?(g.sibling=n.child,n.child=g):(t=c.last,t!==null?t.sibling=g:n.child=g,c.last=g)}return c.tail!==null?(t=c.tail,c.rendering=t,c.tail=t.sibling,c.renderingStartTime=Jt(),t.sibling=null,r=lt.current,se(lt,m?r&1|2:r&1),Ne&&Qn(n,c.treeForkCount),t):(Ze(n),null);case 22:case 23:return en(n),bu(),c=n.memoizedState!==null,t!==null?t.memoizedState!==null!==c&&(n.flags|=8192):c&&(n.flags|=8192),c?(r&536870912)!==0&&(n.flags&128)===0&&(Ze(n),n.subtreeFlags&6&&(n.flags|=8192)):Ze(n),r=n.updateQueue,r!==null&&Jo(n,r.retryQueue),r=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(r=t.memoizedState.cachePool.pool),c=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(c=n.memoizedState.cachePool.pool),c!==r&&(n.flags|=2048),t!==null&&Y(pa),null;case 24:return r=null,t!==null&&(r=t.memoizedState.cache),n.memoizedState.cache!==r&&(n.flags|=2048),Xn(ft),Ze(n),null;case 25:return null;case 30:return null}throw Error(s(156,n.tag))}function XC(t,n){switch(au(n),n.tag){case 1:return t=n.flags,t&65536?(n.flags=t&-65537|128,n):null;case 3:return Xn(ft),ot(),t=n.flags,(t&65536)!==0&&(t&128)===0?(n.flags=t&-65537|128,n):null;case 26:case 27:case 5:return ao(n),null;case 31:if(n.memoizedState!==null){if(en(n),n.alternate===null)throw Error(s(340));ha()}return t=n.flags,t&65536?(n.flags=t&-65537|128,n):null;case 13:if(en(n),t=n.memoizedState,t!==null&&t.dehydrated!==null){if(n.alternate===null)throw Error(s(340));ha()}return t=n.flags,t&65536?(n.flags=t&-65537|128,n):null;case 19:return Y(lt),null;case 4:return ot(),null;case 10:return Xn(n.type),null;case 22:case 23:return en(n),bu(),t!==null&&Y(pa),t=n.flags,t&65536?(n.flags=t&-65537|128,n):null;case 24:return Xn(ft),null;case 25:return null;default:return null}}function ag(t,n){switch(au(n),n.tag){case 3:Xn(ft),ot();break;case 26:case 27:case 5:ao(n);break;case 4:ot();break;case 31:n.memoizedState!==null&&en(n);break;case 13:en(n);break;case 19:Y(lt);break;case 10:Xn(n.type);break;case 22:case 23:en(n),bu(),t!==null&&Y(pa);break;case 24:Xn(ft)}}function hr(t,n){try{var r=n.updateQueue,c=r!==null?r.lastEffect:null;if(c!==null){var m=c.next;r=m;do{if((r.tag&t)===t){c=void 0;var g=r.create,b=r.inst;c=g(),b.destroy=c}r=r.next}while(r!==m)}}catch(T){Fe(n,n.return,T)}}function Mi(t,n,r){try{var c=n.updateQueue,m=c!==null?c.lastEffect:null;if(m!==null){var g=m.next;c=g;do{if((c.tag&t)===t){var b=c.inst,T=b.destroy;if(T!==void 0){b.destroy=void 0,m=n;var w=r,q=T;try{q()}catch(G){Fe(m,w,G)}}}c=c.next}while(c!==g)}}catch(G){Fe(n,n.return,G)}}function sg(t){var n=t.updateQueue;if(n!==null){var r=t.stateNode;try{Qm(n,r)}catch(c){Fe(t,t.return,c)}}}function rg(t,n,r){r.props=Sa(t.type,t.memoizedProps),r.state=t.memoizedState;try{r.componentWillUnmount()}catch(c){Fe(t,n,c)}}function fr(t,n){try{var r=t.ref;if(r!==null){switch(t.tag){case 26:case 27:case 5:var c=t.stateNode;break;case 30:c=t.stateNode;break;default:c=t.stateNode}typeof r=="function"?t.refCleanup=r(c):r.current=c}}catch(m){Fe(t,n,m)}}function Pn(t,n){var r=t.ref,c=t.refCleanup;if(r!==null)if(typeof c=="function")try{c()}catch(m){Fe(t,n,m)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof r=="function")try{r(null)}catch(m){Fe(t,n,m)}else r.current=null}function og(t){var n=t.type,r=t.memoizedProps,c=t.stateNode;try{e:switch(n){case"button":case"input":case"select":case"textarea":r.autoFocus&&c.focus();break e;case"img":r.src?c.src=r.src:r.srcSet&&(c.srcset=r.srcSet)}}catch(m){Fe(t,t.return,m)}}function Xu(t,n,r){try{var c=t.stateNode;bk(c,t.type,r,n),c[Ut]=n}catch(m){Fe(t,t.return,m)}}function lg(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&Ui(t.type)||t.tag===4}function Zu(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||lg(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&Ui(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function $u(t,n,r){var c=t.tag;if(c===5||c===6)t=t.stateNode,n?(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r).insertBefore(t,n):(n=r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,n.appendChild(t),r=r._reactRootContainer,r!=null||n.onclick!==null||(n.onclick=Kn));else if(c!==4&&(c===27&&Ui(t.type)&&(r=t.stateNode,n=null),t=t.child,t!==null))for($u(t,n,r),t=t.sibling;t!==null;)$u(t,n,r),t=t.sibling}function Qo(t,n,r){var c=t.tag;if(c===5||c===6)t=t.stateNode,n?r.insertBefore(t,n):r.appendChild(t);else if(c!==4&&(c===27&&Ui(t.type)&&(r=t.stateNode),t=t.child,t!==null))for(Qo(t,n,r),t=t.sibling;t!==null;)Qo(t,n,r),t=t.sibling}function cg(t){var n=t.stateNode,r=t.memoizedProps;try{for(var c=t.type,m=n.attributes;m.length;)n.removeAttributeNode(m[0]);_t(n,c,r),n[kt]=t,n[Ut]=r}catch(g){Fe(t,t.return,g)}}var ni=!1,gt=!1,ed=!1,ug=typeof WeakSet=="function"?WeakSet:Set,St=null;function ZC(t,n){if(t=t.containerInfo,Td=gl,t=Cm(t),Yc(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var c=r.getSelection&&r.getSelection();if(c&&c.rangeCount!==0){r=c.anchorNode;var m=c.anchorOffset,g=c.focusNode;c=c.focusOffset;try{r.nodeType,g.nodeType}catch{r=null;break e}var b=0,T=-1,w=-1,q=0,G=0,J=t,F=null;t:for(;;){for(var V;J!==r||m!==0&&J.nodeType!==3||(T=b+m),J!==g||c!==0&&J.nodeType!==3||(w=b+c),J.nodeType===3&&(b+=J.nodeValue.length),(V=J.firstChild)!==null;)F=J,J=V;for(;;){if(J===t)break t;if(F===r&&++q===m&&(T=b),F===g&&++G===c&&(w=b),(V=J.nextSibling)!==null)break;J=F,F=J.parentNode}J=V}r=T===-1||w===-1?null:{start:T,end:w}}else r=null}r=r||{start:0,end:0}}else r=null;for(Cd={focusedElem:t,selectionRange:r},gl=!1,St=n;St!==null;)if(n=St,t=n.child,(n.subtreeFlags&1028)!==0&&t!==null)t.return=n,St=t;else for(;St!==null;){switch(n=St,g=n.alternate,t=n.flags,n.tag){case 0:if((t&4)!==0&&(t=n.updateQueue,t=t!==null?t.events:null,t!==null))for(r=0;r<t.length;r++)m=t[r],m.ref.impl=m.nextImpl;break;case 11:case 15:break;case 1:if((t&1024)!==0&&g!==null){t=void 0,r=n,m=g.memoizedProps,g=g.memoizedState,c=r.stateNode;try{var oe=Sa(r.type,m);t=c.getSnapshotBeforeUpdate(oe,g),c.__reactInternalSnapshotBeforeUpdate=t}catch(fe){Fe(r,r.return,fe)}}break;case 3:if((t&1024)!==0){if(t=n.stateNode.containerInfo,r=t.nodeType,r===9)Ed(t);else if(r===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":Ed(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((t&1024)!==0)throw Error(s(163))}if(t=n.sibling,t!==null){t.return=n.return,St=t;break}St=n.return}}function dg(t,n,r){var c=r.flags;switch(r.tag){case 0:case 11:case 15:ai(t,r),c&4&&hr(5,r);break;case 1:if(ai(t,r),c&4)if(t=r.stateNode,n===null)try{t.componentDidMount()}catch(b){Fe(r,r.return,b)}else{var m=Sa(r.type,n.memoizedProps);n=n.memoizedState;try{t.componentDidUpdate(m,n,t.__reactInternalSnapshotBeforeUpdate)}catch(b){Fe(r,r.return,b)}}c&64&&sg(r),c&512&&fr(r,r.return);break;case 3:if(ai(t,r),c&64&&(t=r.updateQueue,t!==null)){if(n=null,r.child!==null)switch(r.child.tag){case 27:case 5:n=r.child.stateNode;break;case 1:n=r.child.stateNode}try{Qm(t,n)}catch(b){Fe(r,r.return,b)}}break;case 27:n===null&&c&4&&cg(r);case 26:case 5:ai(t,r),n===null&&c&4&&og(r),c&512&&fr(r,r.return);break;case 12:ai(t,r);break;case 31:ai(t,r),c&4&&mg(t,r);break;case 13:ai(t,r),c&4&&pg(t,r),c&64&&(t=r.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(r=ok.bind(null,r),_k(t,r))));break;case 22:if(c=r.memoizedState!==null||ni,!c){n=n!==null&&n.memoizedState!==null||gt,m=ni;var g=gt;ni=c,(gt=n)&&!g?si(t,r,(r.subtreeFlags&8772)!==0):ai(t,r),ni=m,gt=g}break;case 30:break;default:ai(t,r)}}function hg(t){var n=t.alternate;n!==null&&(t.alternate=null,hg(n)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(n=t.stateNode,n!==null&&Ac(n)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var $e=null,qt=!1;function ii(t,n,r){for(r=r.child;r!==null;)fg(t,n,r),r=r.sibling}function fg(t,n,r){if(Qt&&typeof Qt.onCommitFiberUnmount=="function")try{Qt.onCommitFiberUnmount(Ls,r)}catch{}switch(r.tag){case 26:gt||Pn(r,n),ii(t,n,r),r.memoizedState?r.memoizedState.count--:r.stateNode&&(r=r.stateNode,r.parentNode.removeChild(r));break;case 27:gt||Pn(r,n);var c=$e,m=qt;Ui(r.type)&&($e=r.stateNode,qt=!1),ii(t,n,r),Cr(r.stateNode),$e=c,qt=m;break;case 5:gt||Pn(r,n);case 6:if(c=$e,m=qt,$e=null,ii(t,n,r),$e=c,qt=m,$e!==null)if(qt)try{($e.nodeType===9?$e.body:$e.nodeName==="HTML"?$e.ownerDocument.body:$e).removeChild(r.stateNode)}catch(g){Fe(r,n,g)}else try{$e.removeChild(r.stateNode)}catch(g){Fe(r,n,g)}break;case 18:$e!==null&&(qt?(t=$e,sv(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,r.stateNode),vs(t)):sv($e,r.stateNode));break;case 4:c=$e,m=qt,$e=r.stateNode.containerInfo,qt=!0,ii(t,n,r),$e=c,qt=m;break;case 0:case 11:case 14:case 15:Mi(2,r,n),gt||Mi(4,r,n),ii(t,n,r);break;case 1:gt||(Pn(r,n),c=r.stateNode,typeof c.componentWillUnmount=="function"&&rg(r,n,c)),ii(t,n,r);break;case 21:ii(t,n,r);break;case 22:gt=(c=gt)||r.memoizedState!==null,ii(t,n,r),gt=c;break;default:ii(t,n,r)}}function mg(t,n){if(n.memoizedState===null&&(t=n.alternate,t!==null&&(t=t.memoizedState,t!==null))){t=t.dehydrated;try{vs(t)}catch(r){Fe(n,n.return,r)}}}function pg(t,n){if(n.memoizedState===null&&(t=n.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{vs(t)}catch(r){Fe(n,n.return,r)}}function $C(t){switch(t.tag){case 31:case 13:case 19:var n=t.stateNode;return n===null&&(n=t.stateNode=new ug),n;case 22:return t=t.stateNode,n=t._retryCache,n===null&&(n=t._retryCache=new ug),n;default:throw Error(s(435,t.tag))}}function Wo(t,n){var r=$C(t);n.forEach(function(c){if(!r.has(c)){r.add(c);var m=lk.bind(null,t,c);c.then(m,m)}})}function Ft(t,n){var r=n.deletions;if(r!==null)for(var c=0;c<r.length;c++){var m=r[c],g=t,b=n,T=b;e:for(;T!==null;){switch(T.tag){case 27:if(Ui(T.type)){$e=T.stateNode,qt=!1;break e}break;case 5:$e=T.stateNode,qt=!1;break e;case 3:case 4:$e=T.stateNode.containerInfo,qt=!0;break e}T=T.return}if($e===null)throw Error(s(160));fg(g,b,m),$e=null,qt=!1,g=m.alternate,g!==null&&(g.return=null),m.return=null}if(n.subtreeFlags&13886)for(n=n.child;n!==null;)gg(n,t),n=n.sibling}var kn=null;function gg(t,n){var r=t.alternate,c=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:Ft(n,t),zt(t),c&4&&(Mi(3,t,t.return),hr(3,t),Mi(5,t,t.return));break;case 1:Ft(n,t),zt(t),c&512&&(gt||r===null||Pn(r,r.return)),c&64&&ni&&(t=t.updateQueue,t!==null&&(c=t.callbacks,c!==null&&(r=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=r===null?c:r.concat(c))));break;case 26:var m=kn;if(Ft(n,t),zt(t),c&512&&(gt||r===null||Pn(r,r.return)),c&4){var g=r!==null?r.memoizedState:null;if(c=t.memoizedState,r===null)if(c===null)if(t.stateNode===null){e:{c=t.type,r=t.memoizedProps,m=m.ownerDocument||m;t:switch(c){case"title":g=m.getElementsByTagName("title")[0],(!g||g[qs]||g[kt]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=m.createElement(c),m.head.insertBefore(g,m.querySelector("head > title"))),_t(g,c,r),g[kt]=t,bt(g),c=g;break e;case"link":var b=gv("link","href",m).get(c+(r.href||""));if(b){for(var T=0;T<b.length;T++)if(g=b[T],g.getAttribute("href")===(r.href==null||r.href===""?null:r.href)&&g.getAttribute("rel")===(r.rel==null?null:r.rel)&&g.getAttribute("title")===(r.title==null?null:r.title)&&g.getAttribute("crossorigin")===(r.crossOrigin==null?null:r.crossOrigin)){b.splice(T,1);break t}}g=m.createElement(c),_t(g,c,r),m.head.appendChild(g);break;case"meta":if(b=gv("meta","content",m).get(c+(r.content||""))){for(T=0;T<b.length;T++)if(g=b[T],g.getAttribute("content")===(r.content==null?null:""+r.content)&&g.getAttribute("name")===(r.name==null?null:r.name)&&g.getAttribute("property")===(r.property==null?null:r.property)&&g.getAttribute("http-equiv")===(r.httpEquiv==null?null:r.httpEquiv)&&g.getAttribute("charset")===(r.charSet==null?null:r.charSet)){b.splice(T,1);break t}}g=m.createElement(c),_t(g,c,r),m.head.appendChild(g);break;default:throw Error(s(468,c))}g[kt]=t,bt(g),c=g}t.stateNode=c}else vv(m,t.type,t.stateNode);else t.stateNode=pv(m,c,t.memoizedProps);else g!==c?(g===null?r.stateNode!==null&&(r=r.stateNode,r.parentNode.removeChild(r)):g.count--,c===null?vv(m,t.type,t.stateNode):pv(m,c,t.memoizedProps)):c===null&&t.stateNode!==null&&Xu(t,t.memoizedProps,r.memoizedProps)}break;case 27:Ft(n,t),zt(t),c&512&&(gt||r===null||Pn(r,r.return)),r!==null&&c&4&&Xu(t,t.memoizedProps,r.memoizedProps);break;case 5:if(Ft(n,t),zt(t),c&512&&(gt||r===null||Pn(r,r.return)),t.flags&32){m=t.stateNode;try{qa(m,"")}catch(oe){Fe(t,t.return,oe)}}c&4&&t.stateNode!=null&&(m=t.memoizedProps,Xu(t,m,r!==null?r.memoizedProps:m)),c&1024&&(ed=!0);break;case 6:if(Ft(n,t),zt(t),c&4){if(t.stateNode===null)throw Error(s(162));c=t.memoizedProps,r=t.stateNode;try{r.nodeValue=c}catch(oe){Fe(t,t.return,oe)}}break;case 3:if(hl=null,m=kn,kn=ul(n.containerInfo),Ft(n,t),kn=m,zt(t),c&4&&r!==null&&r.memoizedState.isDehydrated)try{vs(n.containerInfo)}catch(oe){Fe(t,t.return,oe)}ed&&(ed=!1,vg(t));break;case 4:c=kn,kn=ul(t.stateNode.containerInfo),Ft(n,t),zt(t),kn=c;break;case 12:Ft(n,t),zt(t);break;case 31:Ft(n,t),zt(t),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,Wo(t,c)));break;case 13:Ft(n,t),zt(t),t.child.flags&8192&&t.memoizedState!==null!=(r!==null&&r.memoizedState!==null)&&(Zo=Jt()),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,Wo(t,c)));break;case 22:m=t.memoizedState!==null;var w=r!==null&&r.memoizedState!==null,q=ni,G=gt;if(ni=q||m,gt=G||w,Ft(n,t),gt=G,ni=q,zt(t),c&8192)e:for(n=t.stateNode,n._visibility=m?n._visibility&-2:n._visibility|1,m&&(r===null||w||ni||gt||Ta(t)),r=null,n=t;;){if(n.tag===5||n.tag===26){if(r===null){w=r=n;try{if(g=w.stateNode,m)b=g.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none";else{T=w.stateNode;var J=w.memoizedProps.style,F=J!=null&&J.hasOwnProperty("display")?J.display:null;T.style.display=F==null||typeof F=="boolean"?"":(""+F).trim()}}catch(oe){Fe(w,w.return,oe)}}}else if(n.tag===6){if(r===null){w=n;try{w.stateNode.nodeValue=m?"":w.memoizedProps}catch(oe){Fe(w,w.return,oe)}}}else if(n.tag===18){if(r===null){w=n;try{var V=w.stateNode;m?rv(V,!0):rv(w.stateNode,!1)}catch(oe){Fe(w,w.return,oe)}}}else if((n.tag!==22&&n.tag!==23||n.memoizedState===null||n===t)&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break e;for(;n.sibling===null;){if(n.return===null||n.return===t)break e;r===n&&(r=null),n=n.return}r===n&&(r=null),n.sibling.return=n.return,n=n.sibling}c&4&&(c=t.updateQueue,c!==null&&(r=c.retryQueue,r!==null&&(c.retryQueue=null,Wo(t,r))));break;case 19:Ft(n,t),zt(t),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,Wo(t,c)));break;case 30:break;case 21:break;default:Ft(n,t),zt(t)}}function zt(t){var n=t.flags;if(n&2){try{for(var r,c=t.return;c!==null;){if(lg(c)){r=c;break}c=c.return}if(r==null)throw Error(s(160));switch(r.tag){case 27:var m=r.stateNode,g=Zu(t);Qo(t,g,m);break;case 5:var b=r.stateNode;r.flags&32&&(qa(b,""),r.flags&=-33);var T=Zu(t);Qo(t,T,b);break;case 3:case 4:var w=r.stateNode.containerInfo,q=Zu(t);$u(t,q,w);break;default:throw Error(s(161))}}catch(G){Fe(t,t.return,G)}t.flags&=-3}n&4096&&(t.flags&=-4097)}function vg(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var n=t;vg(n),n.tag===5&&n.flags&1024&&n.stateNode.reset(),t=t.sibling}}function ai(t,n){if(n.subtreeFlags&8772)for(n=n.child;n!==null;)dg(t,n.alternate,n),n=n.sibling}function Ta(t){for(t=t.child;t!==null;){var n=t;switch(n.tag){case 0:case 11:case 14:case 15:Mi(4,n,n.return),Ta(n);break;case 1:Pn(n,n.return);var r=n.stateNode;typeof r.componentWillUnmount=="function"&&rg(n,n.return,r),Ta(n);break;case 27:Cr(n.stateNode);case 26:case 5:Pn(n,n.return),Ta(n);break;case 22:n.memoizedState===null&&Ta(n);break;case 30:Ta(n);break;default:Ta(n)}t=t.sibling}}function si(t,n,r){for(r=r&&(n.subtreeFlags&8772)!==0,n=n.child;n!==null;){var c=n.alternate,m=t,g=n,b=g.flags;switch(g.tag){case 0:case 11:case 15:si(m,g,r),hr(4,g);break;case 1:if(si(m,g,r),c=g,m=c.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(q){Fe(c,c.return,q)}if(c=g,m=c.updateQueue,m!==null){var T=c.stateNode;try{var w=m.shared.hiddenCallbacks;if(w!==null)for(m.shared.hiddenCallbacks=null,m=0;m<w.length;m++)Jm(w[m],T)}catch(q){Fe(c,c.return,q)}}r&&b&64&&sg(g),fr(g,g.return);break;case 27:cg(g);case 26:case 5:si(m,g,r),r&&c===null&&b&4&&og(g),fr(g,g.return);break;case 12:si(m,g,r);break;case 31:si(m,g,r),r&&b&4&&mg(m,g);break;case 13:si(m,g,r),r&&b&4&&pg(m,g);break;case 22:g.memoizedState===null&&si(m,g,r),fr(g,g.return);break;case 30:break;default:si(m,g,r)}n=n.sibling}}function td(t,n){var r=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(r=t.memoizedState.cachePool.pool),t=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(t=n.memoizedState.cachePool.pool),t!==r&&(t!=null&&t.refCount++,r!=null&&$s(r))}function nd(t,n){t=null,n.alternate!==null&&(t=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==t&&(n.refCount++,t!=null&&$s(t))}function xn(t,n,r,c){if(n.subtreeFlags&10256)for(n=n.child;n!==null;)yg(t,n,r,c),n=n.sibling}function yg(t,n,r,c){var m=n.flags;switch(n.tag){case 0:case 11:case 15:xn(t,n,r,c),m&2048&&hr(9,n);break;case 1:xn(t,n,r,c);break;case 3:xn(t,n,r,c),m&2048&&(t=null,n.alternate!==null&&(t=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==t&&(n.refCount++,t!=null&&$s(t)));break;case 12:if(m&2048){xn(t,n,r,c),t=n.stateNode;try{var g=n.memoizedProps,b=g.id,T=g.onPostCommit;typeof T=="function"&&T(b,n.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(w){Fe(n,n.return,w)}}else xn(t,n,r,c);break;case 31:xn(t,n,r,c);break;case 13:xn(t,n,r,c);break;case 23:break;case 22:g=n.stateNode,b=n.alternate,n.memoizedState!==null?g._visibility&2?xn(t,n,r,c):mr(t,n):g._visibility&2?xn(t,n,r,c):(g._visibility|=2,rs(t,n,r,c,(n.subtreeFlags&10256)!==0||!1)),m&2048&&td(b,n);break;case 24:xn(t,n,r,c),m&2048&&nd(n.alternate,n);break;default:xn(t,n,r,c)}}function rs(t,n,r,c,m){for(m=m&&((n.subtreeFlags&10256)!==0||!1),n=n.child;n!==null;){var g=t,b=n,T=r,w=c,q=b.flags;switch(b.tag){case 0:case 11:case 15:rs(g,b,T,w,m),hr(8,b);break;case 23:break;case 22:var G=b.stateNode;b.memoizedState!==null?G._visibility&2?rs(g,b,T,w,m):mr(g,b):(G._visibility|=2,rs(g,b,T,w,m)),m&&q&2048&&td(b.alternate,b);break;case 24:rs(g,b,T,w,m),m&&q&2048&&nd(b.alternate,b);break;default:rs(g,b,T,w,m)}n=n.sibling}}function mr(t,n){if(n.subtreeFlags&10256)for(n=n.child;n!==null;){var r=t,c=n,m=c.flags;switch(c.tag){case 22:mr(r,c),m&2048&&td(c.alternate,c);break;case 24:mr(r,c),m&2048&&nd(c.alternate,c);break;default:mr(r,c)}n=n.sibling}}var pr=8192;function os(t,n,r){if(t.subtreeFlags&pr)for(t=t.child;t!==null;)bg(t,n,r),t=t.sibling}function bg(t,n,r){switch(t.tag){case 26:os(t,n,r),t.flags&pr&&t.memoizedState!==null&&Bk(r,kn,t.memoizedState,t.memoizedProps);break;case 5:os(t,n,r);break;case 3:case 4:var c=kn;kn=ul(t.stateNode.containerInfo),os(t,n,r),kn=c;break;case 22:t.memoizedState===null&&(c=t.alternate,c!==null&&c.memoizedState!==null?(c=pr,pr=16777216,os(t,n,r),pr=c):os(t,n,r));break;default:os(t,n,r)}}function Sg(t){var n=t.alternate;if(n!==null&&(t=n.child,t!==null)){n.child=null;do n=t.sibling,t.sibling=null,t=n;while(t!==null)}}function gr(t){var n=t.deletions;if((t.flags&16)!==0){if(n!==null)for(var r=0;r<n.length;r++){var c=n[r];St=c,Cg(c,t)}Sg(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)Tg(t),t=t.sibling}function Tg(t){switch(t.tag){case 0:case 11:case 15:gr(t),t.flags&2048&&Mi(9,t,t.return);break;case 3:gr(t);break;case 12:gr(t);break;case 22:var n=t.stateNode;t.memoizedState!==null&&n._visibility&2&&(t.return===null||t.return.tag!==13)?(n._visibility&=-3,Xo(t)):gr(t);break;default:gr(t)}}function Xo(t){var n=t.deletions;if((t.flags&16)!==0){if(n!==null)for(var r=0;r<n.length;r++){var c=n[r];St=c,Cg(c,t)}Sg(t)}for(t=t.child;t!==null;){switch(n=t,n.tag){case 0:case 11:case 15:Mi(8,n,n.return),Xo(n);break;case 22:r=n.stateNode,r._visibility&2&&(r._visibility&=-3,Xo(n));break;default:Xo(n)}t=t.sibling}}function Cg(t,n){for(;St!==null;){var r=St;switch(r.tag){case 0:case 11:case 15:Mi(8,r,n);break;case 23:case 22:if(r.memoizedState!==null&&r.memoizedState.cachePool!==null){var c=r.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:$s(r.memoizedState.cache)}if(c=r.child,c!==null)c.return=r,St=c;else e:for(r=t;St!==null;){c=St;var m=c.sibling,g=c.return;if(hg(c),c===r){St=null;break e}if(m!==null){m.return=g,St=m;break e}St=g}}}var ek={getCacheForType:function(t){var n=Et(ft),r=n.data.get(t);return r===void 0&&(r=t(),n.data.set(t,r)),r},cacheSignal:function(){return Et(ft).controller.signal}},tk=typeof WeakMap=="function"?WeakMap:Map,Ue=0,Ye=null,ke=null,_e=0,qe=0,tn=null,Di=!1,ls=!1,id=!1,ri=0,at=0,Oi=0,Ca=0,ad=0,nn=0,cs=0,vr=null,Ht=null,sd=!1,Zo=0,kg=0,$o=1/0,el=null,ji=null,yt=0,Pi=null,us=null,oi=0,rd=0,od=null,xg=null,yr=0,ld=null;function an(){return(Ue&2)!==0&&_e!==0?_e&-_e:z.T!==null?md():qf()}function Eg(){if(nn===0)if((_e&536870912)===0||Ne){var t=oo;oo<<=1,(oo&3932160)===0&&(oo=262144),nn=t}else nn=536870912;return t=$t.current,t!==null&&(t.flags|=32),nn}function Vt(t,n,r){(t===Ye&&(qe===2||qe===9)||t.cancelPendingCommit!==null)&&(ds(t,0),Ii(t,_e,nn,!1)),Bs(t,r),((Ue&2)===0||t!==Ye)&&(t===Ye&&((Ue&2)===0&&(Ca|=r),at===4&&Ii(t,_e,nn,!1)),In(t))}function wg(t,n,r){if((Ue&6)!==0)throw Error(s(327));var c=!r&&(n&127)===0&&(n&t.expiredLanes)===0||Us(t,n),m=c?ak(t,n):ud(t,n,!0),g=c;do{if(m===0){ls&&!c&&Ii(t,n,0,!1);break}else{if(r=t.current.alternate,g&&!nk(r)){m=ud(t,n,!1),g=!1;continue}if(m===2){if(g=n,t.errorRecoveryDisabledLanes&g)var b=0;else b=t.pendingLanes&-536870913,b=b!==0?b:b&536870912?536870912:0;if(b!==0){n=b;e:{var T=t;m=vr;var w=T.current.memoizedState.isDehydrated;if(w&&(ds(T,b).flags|=256),b=ud(T,b,!1),b!==2){if(id&&!w){T.errorRecoveryDisabledLanes|=g,Ca|=g,m=4;break e}g=Ht,Ht=m,g!==null&&(Ht===null?Ht=g:Ht.push.apply(Ht,g))}m=b}if(g=!1,m!==2)continue}}if(m===1){ds(t,0),Ii(t,n,0,!0);break}e:{switch(c=t,g=m,g){case 0:case 1:throw Error(s(345));case 4:if((n&4194048)!==n)break;case 6:Ii(c,n,nn,!Di);break e;case 2:Ht=null;break;case 3:case 5:break;default:throw Error(s(329))}if((n&62914560)===n&&(m=Zo+300-Jt(),10<m)){if(Ii(c,n,nn,!Di),co(c,0,!0)!==0)break e;oi=n,c.timeoutHandle=iv(_g.bind(null,c,r,Ht,el,sd,n,nn,Ca,cs,Di,g,"Throttled",-0,0),m);break e}_g(c,r,Ht,el,sd,n,nn,Ca,cs,Di,g,null,-0,0)}}break}while(!0);In(t)}function _g(t,n,r,c,m,g,b,T,w,q,G,J,F,V){if(t.timeoutHandle=-1,J=n.subtreeFlags,J&8192||(J&16785408)===16785408){J={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Kn},bg(n,g,J);var oe=(g&62914560)===g?Zo-Jt():(g&4194048)===g?kg-Jt():0;if(oe=qk(J,oe),oe!==null){oi=g,t.cancelPendingCommit=oe(Pg.bind(null,t,n,g,r,c,m,b,T,w,G,J,null,F,V)),Ii(t,g,b,!q);return}}Pg(t,n,g,r,c,m,b,T,w)}function nk(t){for(var n=t;;){var r=n.tag;if((r===0||r===11||r===15)&&n.flags&16384&&(r=n.updateQueue,r!==null&&(r=r.stores,r!==null)))for(var c=0;c<r.length;c++){var m=r[c],g=m.getSnapshot;m=m.value;try{if(!Xt(g(),m))return!1}catch{return!1}}if(r=n.child,n.subtreeFlags&16384&&r!==null)r.return=n,n=r;else{if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function Ii(t,n,r,c){n&=~ad,n&=~Ca,t.suspendedLanes|=n,t.pingedLanes&=~n,c&&(t.warmLanes|=n),c=t.expirationTimes;for(var m=n;0<m;){var g=31-Wt(m),b=1<<g;c[g]=-1,m&=~b}r!==0&&Lf(t,r,n)}function tl(){return(Ue&6)===0?(br(0),!1):!0}function cd(){if(ke!==null){if(qe===0)var t=ke.return;else t=ke,Wn=fa=null,Eu(t),ts=null,tr=0,t=ke;for(;t!==null;)ag(t.alternate,t),t=t.return;ke=null}}function ds(t,n){var r=t.timeoutHandle;r!==-1&&(t.timeoutHandle=-1,Ck(r)),r=t.cancelPendingCommit,r!==null&&(t.cancelPendingCommit=null,r()),oi=0,cd(),Ye=t,ke=r=Jn(t.current,null),_e=n,qe=0,tn=null,Di=!1,ls=Us(t,n),id=!1,cs=nn=ad=Ca=Oi=at=0,Ht=vr=null,sd=!1,(n&8)!==0&&(n|=n&32);var c=t.entangledLanes;if(c!==0)for(t=t.entanglements,c&=n;0<c;){var m=31-Wt(c),g=1<<m;n|=t[m],c&=~g}return ri=n,Co(),r}function Rg(t,n){ve=null,z.H=cr,n===es||n===Ao?(n=Vm(),qe=3):n===fu?(n=Vm(),qe=4):qe=n===Fu?8:n!==null&&typeof n=="object"&&typeof n.then=="function"?6:1,tn=n,ke===null&&(at=1,Vo(t,un(n,t.current)))}function Ng(){var t=$t.current;return t===null?!0:(_e&4194048)===_e?mn===null:(_e&62914560)===_e||(_e&536870912)!==0?t===mn:!1}function Ag(){var t=z.H;return z.H=cr,t===null?cr:t}function Mg(){var t=z.A;return z.A=ek,t}function nl(){at=4,Di||(_e&4194048)!==_e&&$t.current!==null||(ls=!0),(Oi&134217727)===0&&(Ca&134217727)===0||Ye===null||Ii(Ye,_e,nn,!1)}function ud(t,n,r){var c=Ue;Ue|=2;var m=Ag(),g=Mg();(Ye!==t||_e!==n)&&(el=null,ds(t,n)),n=!1;var b=at;e:do try{if(qe!==0&&ke!==null){var T=ke,w=tn;switch(qe){case 8:cd(),b=6;break e;case 3:case 2:case 9:case 6:$t.current===null&&(n=!0);var q=qe;if(qe=0,tn=null,hs(t,T,w,q),r&&ls){b=0;break e}break;default:q=qe,qe=0,tn=null,hs(t,T,w,q)}}ik(),b=at;break}catch(G){Rg(t,G)}while(!0);return n&&t.shellSuspendCounter++,Wn=fa=null,Ue=c,z.H=m,z.A=g,ke===null&&(Ye=null,_e=0,Co()),b}function ik(){for(;ke!==null;)Dg(ke)}function ak(t,n){var r=Ue;Ue|=2;var c=Ag(),m=Mg();Ye!==t||_e!==n?(el=null,$o=Jt()+500,ds(t,n)):ls=Us(t,n);e:do try{if(qe!==0&&ke!==null){n=ke;var g=tn;t:switch(qe){case 1:qe=0,tn=null,hs(t,n,g,1);break;case 2:case 9:if(zm(g)){qe=0,tn=null,Og(n);break}n=function(){qe!==2&&qe!==9||Ye!==t||(qe=7),In(t)},g.then(n,n);break e;case 3:qe=7;break e;case 4:qe=5;break e;case 7:zm(g)?(qe=0,tn=null,Og(n)):(qe=0,tn=null,hs(t,n,g,7));break;case 5:var b=null;switch(ke.tag){case 26:b=ke.memoizedState;case 5:case 27:var T=ke;if(b?yv(b):T.stateNode.complete){qe=0,tn=null;var w=T.sibling;if(w!==null)ke=w;else{var q=T.return;q!==null?(ke=q,il(q)):ke=null}break t}}qe=0,tn=null,hs(t,n,g,5);break;case 6:qe=0,tn=null,hs(t,n,g,6);break;case 8:cd(),at=6;break e;default:throw Error(s(462))}}sk();break}catch(G){Rg(t,G)}while(!0);return Wn=fa=null,z.H=c,z.A=m,Ue=r,ke!==null?0:(Ye=null,_e=0,Co(),at)}function sk(){for(;ke!==null&&!RT();)Dg(ke)}function Dg(t){var n=ng(t.alternate,t,ri);t.memoizedProps=t.pendingProps,n===null?il(t):ke=n}function Og(t){var n=t,r=n.alternate;switch(n.tag){case 15:case 0:n=Wp(r,n,n.pendingProps,n.type,void 0,_e);break;case 11:n=Wp(r,n,n.pendingProps,n.type.render,n.ref,_e);break;case 5:Eu(n);default:ag(r,n),n=ke=Mm(n,ri),n=ng(r,n,ri)}t.memoizedProps=t.pendingProps,n===null?il(t):ke=n}function hs(t,n,r,c){Wn=fa=null,Eu(n),ts=null,tr=0;var m=n.return;try{if(YC(t,m,n,r,_e)){at=1,Vo(t,un(r,t.current)),ke=null;return}}catch(g){if(m!==null)throw ke=m,g;at=1,Vo(t,un(r,t.current)),ke=null;return}n.flags&32768?(Ne||c===1?t=!0:ls||(_e&536870912)!==0?t=!1:(Di=t=!0,(c===2||c===9||c===3||c===6)&&(c=$t.current,c!==null&&c.tag===13&&(c.flags|=16384))),jg(n,t)):il(n)}function il(t){var n=t;do{if((n.flags&32768)!==0){jg(n,Di);return}t=n.return;var r=WC(n.alternate,n,ri);if(r!==null){ke=r;return}if(n=n.sibling,n!==null){ke=n;return}ke=n=t}while(n!==null);at===0&&(at=5)}function jg(t,n){do{var r=XC(t.alternate,t);if(r!==null){r.flags&=32767,ke=r;return}if(r=t.return,r!==null&&(r.flags|=32768,r.subtreeFlags=0,r.deletions=null),!n&&(t=t.sibling,t!==null)){ke=t;return}ke=t=r}while(t!==null);at=6,ke=null}function Pg(t,n,r,c,m,g,b,T,w){t.cancelPendingCommit=null;do al();while(yt!==0);if((Ue&6)!==0)throw Error(s(327));if(n!==null){if(n===t.current)throw Error(s(177));if(g=n.lanes|n.childLanes,g|=Zc,UT(t,r,g,b,T,w),t===Ye&&(ke=Ye=null,_e=0),us=n,Pi=t,oi=r,rd=g,od=m,xg=c,(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?(t.callbackNode=null,t.callbackPriority=0,ck(so,function(){return qg(),null})):(t.callbackNode=null,t.callbackPriority=0),c=(n.flags&13878)!==0,(n.subtreeFlags&13878)!==0||c){c=z.T,z.T=null,m=ne.p,ne.p=2,b=Ue,Ue|=4;try{ZC(t,n,r)}finally{Ue=b,ne.p=m,z.T=c}}yt=1,Ig(),Lg(),Ug()}}function Ig(){if(yt===1){yt=0;var t=Pi,n=us,r=(n.flags&13878)!==0;if((n.subtreeFlags&13878)!==0||r){r=z.T,z.T=null;var c=ne.p;ne.p=2;var m=Ue;Ue|=4;try{gg(n,t);var g=Cd,b=Cm(t.containerInfo),T=g.focusedElem,w=g.selectionRange;if(b!==T&&T&&T.ownerDocument&&Tm(T.ownerDocument.documentElement,T)){if(w!==null&&Yc(T)){var q=w.start,G=w.end;if(G===void 0&&(G=q),"selectionStart"in T)T.selectionStart=q,T.selectionEnd=Math.min(G,T.value.length);else{var J=T.ownerDocument||document,F=J&&J.defaultView||window;if(F.getSelection){var V=F.getSelection(),oe=T.textContent.length,fe=Math.min(w.start,oe),Ge=w.end===void 0?fe:Math.min(w.end,oe);!V.extend&&fe>Ge&&(b=Ge,Ge=fe,fe=b);var P=Sm(T,fe),N=Sm(T,Ge);if(P&&N&&(V.rangeCount!==1||V.anchorNode!==P.node||V.anchorOffset!==P.offset||V.focusNode!==N.node||V.focusOffset!==N.offset)){var B=J.createRange();B.setStart(P.node,P.offset),V.removeAllRanges(),fe>Ge?(V.addRange(B),V.extend(N.node,N.offset)):(B.setEnd(N.node,N.offset),V.addRange(B))}}}}for(J=[],V=T;V=V.parentNode;)V.nodeType===1&&J.push({element:V,left:V.scrollLeft,top:V.scrollTop});for(typeof T.focus=="function"&&T.focus(),T=0;T<J.length;T++){var K=J[T];K.element.scrollLeft=K.left,K.element.scrollTop=K.top}}gl=!!Td,Cd=Td=null}finally{Ue=m,ne.p=c,z.T=r}}t.current=n,yt=2}}function Lg(){if(yt===2){yt=0;var t=Pi,n=us,r=(n.flags&8772)!==0;if((n.subtreeFlags&8772)!==0||r){r=z.T,z.T=null;var c=ne.p;ne.p=2;var m=Ue;Ue|=4;try{dg(t,n.alternate,n)}finally{Ue=m,ne.p=c,z.T=r}}yt=3}}function Ug(){if(yt===4||yt===3){yt=0,NT();var t=Pi,n=us,r=oi,c=xg;(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?yt=5:(yt=0,us=Pi=null,Bg(t,t.pendingLanes));var m=t.pendingLanes;if(m===0&&(ji=null),Rc(r),n=n.stateNode,Qt&&typeof Qt.onCommitFiberRoot=="function")try{Qt.onCommitFiberRoot(Ls,n,void 0,(n.current.flags&128)===128)}catch{}if(c!==null){n=z.T,m=ne.p,ne.p=2,z.T=null;try{for(var g=t.onRecoverableError,b=0;b<c.length;b++){var T=c[b];g(T.value,{componentStack:T.stack})}}finally{z.T=n,ne.p=m}}(oi&3)!==0&&al(),In(t),m=t.pendingLanes,(r&261930)!==0&&(m&42)!==0?t===ld?yr++:(yr=0,ld=t):yr=0,br(0)}}function Bg(t,n){(t.pooledCacheLanes&=n)===0&&(n=t.pooledCache,n!=null&&(t.pooledCache=null,$s(n)))}function al(){return Ig(),Lg(),Ug(),qg()}function qg(){if(yt!==5)return!1;var t=Pi,n=rd;rd=0;var r=Rc(oi),c=z.T,m=ne.p;try{ne.p=32>r?32:r,z.T=null,r=od,od=null;var g=Pi,b=oi;if(yt=0,us=Pi=null,oi=0,(Ue&6)!==0)throw Error(s(331));var T=Ue;if(Ue|=4,Tg(g.current),yg(g,g.current,b,r),Ue=T,br(0,!1),Qt&&typeof Qt.onPostCommitFiberRoot=="function")try{Qt.onPostCommitFiberRoot(Ls,g)}catch{}return!0}finally{ne.p=m,z.T=c,Bg(t,n)}}function Fg(t,n,r){n=un(r,n),n=qu(t.stateNode,n,2),t=Ri(t,n,2),t!==null&&(Bs(t,2),In(t))}function Fe(t,n,r){if(t.tag===3)Fg(t,t,r);else for(;n!==null;){if(n.tag===3){Fg(n,t,r);break}else if(n.tag===1){var c=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(ji===null||!ji.has(c))){t=un(r,t),r=zp(2),c=Ri(n,r,2),c!==null&&(Hp(r,c,n,t),Bs(c,2),In(c));break}}n=n.return}}function dd(t,n,r){var c=t.pingCache;if(c===null){c=t.pingCache=new tk;var m=new Set;c.set(n,m)}else m=c.get(n),m===void 0&&(m=new Set,c.set(n,m));m.has(r)||(id=!0,m.add(r),t=rk.bind(null,t,n,r),n.then(t,t))}function rk(t,n,r){var c=t.pingCache;c!==null&&c.delete(n),t.pingedLanes|=t.suspendedLanes&r,t.warmLanes&=~r,Ye===t&&(_e&r)===r&&(at===4||at===3&&(_e&62914560)===_e&&300>Jt()-Zo?(Ue&2)===0&&ds(t,0):ad|=r,cs===_e&&(cs=0)),In(t)}function zg(t,n){n===0&&(n=If()),t=ua(t,n),t!==null&&(Bs(t,n),In(t))}function ok(t){var n=t.memoizedState,r=0;n!==null&&(r=n.retryLane),zg(t,r)}function lk(t,n){var r=0;switch(t.tag){case 31:case 13:var c=t.stateNode,m=t.memoizedState;m!==null&&(r=m.retryLane);break;case 19:c=t.stateNode;break;case 22:c=t.stateNode._retryCache;break;default:throw Error(s(314))}c!==null&&c.delete(n),zg(t,r)}function ck(t,n){return xc(t,n)}var sl=null,fs=null,hd=!1,rl=!1,fd=!1,Li=0;function In(t){t!==fs&&t.next===null&&(fs===null?sl=fs=t:fs=fs.next=t),rl=!0,hd||(hd=!0,dk())}function br(t,n){if(!fd&&rl){fd=!0;do for(var r=!1,c=sl;c!==null;){if(t!==0){var m=c.pendingLanes;if(m===0)var g=0;else{var b=c.suspendedLanes,T=c.pingedLanes;g=(1<<31-Wt(42|t)+1)-1,g&=m&~(b&~T),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(r=!0,Kg(c,g))}else g=_e,g=co(c,c===Ye?g:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(g&3)===0||Us(c,g)||(r=!0,Kg(c,g));c=c.next}while(r);fd=!1}}function uk(){Hg()}function Hg(){rl=hd=!1;var t=0;Li!==0&&Tk()&&(t=Li);for(var n=Jt(),r=null,c=sl;c!==null;){var m=c.next,g=Vg(c,n);g===0?(c.next=null,r===null?sl=m:r.next=m,m===null&&(fs=r)):(r=c,(t!==0||(g&3)!==0)&&(rl=!0)),c=m}yt!==0&&yt!==5||br(t),Li!==0&&(Li=0)}function Vg(t,n){for(var r=t.suspendedLanes,c=t.pingedLanes,m=t.expirationTimes,g=t.pendingLanes&-62914561;0<g;){var b=31-Wt(g),T=1<<b,w=m[b];w===-1?((T&r)===0||(T&c)!==0)&&(m[b]=LT(T,n)):w<=n&&(t.expiredLanes|=T),g&=~T}if(n=Ye,r=_e,r=co(t,t===n?r:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),c=t.callbackNode,r===0||t===n&&(qe===2||qe===9)||t.cancelPendingCommit!==null)return c!==null&&c!==null&&Ec(c),t.callbackNode=null,t.callbackPriority=0;if((r&3)===0||Us(t,r)){if(n=r&-r,n===t.callbackPriority)return n;switch(c!==null&&Ec(c),Rc(r)){case 2:case 8:r=jf;break;case 32:r=so;break;case 268435456:r=Pf;break;default:r=so}return c=Gg.bind(null,t),r=xc(r,c),t.callbackPriority=n,t.callbackNode=r,n}return c!==null&&c!==null&&Ec(c),t.callbackPriority=2,t.callbackNode=null,2}function Gg(t,n){if(yt!==0&&yt!==5)return t.callbackNode=null,t.callbackPriority=0,null;var r=t.callbackNode;if(al()&&t.callbackNode!==r)return null;var c=_e;return c=co(t,t===Ye?c:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),c===0?null:(wg(t,c,n),Vg(t,Jt()),t.callbackNode!=null&&t.callbackNode===r?Gg.bind(null,t):null)}function Kg(t,n){if(al())return null;wg(t,n,!0)}function dk(){kk(function(){(Ue&6)!==0?xc(Of,uk):Hg()})}function md(){if(Li===0){var t=Za;t===0&&(t=ro,ro<<=1,(ro&261888)===0&&(ro=256)),Li=t}return Li}function Yg(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:mo(""+t)}function Jg(t,n){var r=n.ownerDocument.createElement("input");return r.name=n.name,r.value=n.value,t.id&&r.setAttribute("form",t.id),n.parentNode.insertBefore(r,n),t=new FormData(t),r.parentNode.removeChild(r),t}function hk(t,n,r,c,m){if(n==="submit"&&r&&r.stateNode===m){var g=Yg((m[Ut]||null).action),b=c.submitter;b&&(n=(n=b[Ut]||null)?Yg(n.formAction):b.getAttribute("formAction"),n!==null&&(g=n,b=null));var T=new yo("action","action",null,c,m);t.push({event:T,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Li!==0){var w=b?Jg(m,b):new FormData(m);ju(r,{pending:!0,data:w,method:m.method,action:g},null,w)}}else typeof g=="function"&&(T.preventDefault(),w=b?Jg(m,b):new FormData(m),ju(r,{pending:!0,data:w,method:m.method,action:g},g,w))},currentTarget:m}]})}}for(var pd=0;pd<Xc.length;pd++){var gd=Xc[pd],fk=gd.toLowerCase(),mk=gd[0].toUpperCase()+gd.slice(1);Cn(fk,"on"+mk)}Cn(Em,"onAnimationEnd"),Cn(wm,"onAnimationIteration"),Cn(_m,"onAnimationStart"),Cn("dblclick","onDoubleClick"),Cn("focusin","onFocus"),Cn("focusout","onBlur"),Cn(AC,"onTransitionRun"),Cn(MC,"onTransitionStart"),Cn(DC,"onTransitionCancel"),Cn(Rm,"onTransitionEnd"),Ua("onMouseEnter",["mouseout","mouseover"]),Ua("onMouseLeave",["mouseout","mouseover"]),Ua("onPointerEnter",["pointerout","pointerover"]),Ua("onPointerLeave",["pointerout","pointerover"]),ra("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ra("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ra("onBeforeInput",["compositionend","keypress","textInput","paste"]),ra("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ra("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ra("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Sr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),pk=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Sr));function Qg(t,n){n=(n&4)!==0;for(var r=0;r<t.length;r++){var c=t[r],m=c.event;c=c.listeners;e:{var g=void 0;if(n)for(var b=c.length-1;0<=b;b--){var T=c[b],w=T.instance,q=T.currentTarget;if(T=T.listener,w!==g&&m.isPropagationStopped())break e;g=T,m.currentTarget=q;try{g(m)}catch(G){To(G)}m.currentTarget=null,g=w}else for(b=0;b<c.length;b++){if(T=c[b],w=T.instance,q=T.currentTarget,T=T.listener,w!==g&&m.isPropagationStopped())break e;g=T,m.currentTarget=q;try{g(m)}catch(G){To(G)}m.currentTarget=null,g=w}}}}function xe(t,n){var r=n[Nc];r===void 0&&(r=n[Nc]=new Set);var c=t+"__bubble";r.has(c)||(Wg(n,t,2,!1),r.add(c))}function vd(t,n,r){var c=0;n&&(c|=4),Wg(r,t,c,n)}var ol="_reactListening"+Math.random().toString(36).slice(2);function yd(t){if(!t[ol]){t[ol]=!0,Hf.forEach(function(r){r!=="selectionchange"&&(pk.has(r)||vd(r,!1,t),vd(r,!0,t))});var n=t.nodeType===9?t:t.ownerDocument;n===null||n[ol]||(n[ol]=!0,vd("selectionchange",!1,n))}}function Wg(t,n,r,c){switch(Ev(n)){case 2:var m=Hk;break;case 8:m=Vk;break;default:m=Od}r=m.bind(null,n,r,t),m=void 0,!Uc||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(m=!0),c?m!==void 0?t.addEventListener(n,r,{capture:!0,passive:m}):t.addEventListener(n,r,!0):m!==void 0?t.addEventListener(n,r,{passive:m}):t.addEventListener(n,r,!1)}function bd(t,n,r,c,m){var g=c;if((n&1)===0&&(n&2)===0&&c!==null)e:for(;;){if(c===null)return;var b=c.tag;if(b===3||b===4){var T=c.stateNode.containerInfo;if(T===m)break;if(b===4)for(b=c.return;b!==null;){var w=b.tag;if((w===3||w===4)&&b.stateNode.containerInfo===m)return;b=b.return}for(;T!==null;){if(b=Pa(T),b===null)return;if(w=b.tag,w===5||w===6||w===26||w===27){c=g=b;continue e}T=T.parentNode}}c=c.return}tm(function(){var q=g,G=Ic(r),J=[];e:{var F=Nm.get(t);if(F!==void 0){var V=yo,oe=t;switch(t){case"keypress":if(go(r)===0)break e;case"keydown":case"keyup":V=lC;break;case"focusin":oe="focus",V=zc;break;case"focusout":oe="blur",V=zc;break;case"beforeblur":case"afterblur":V=zc;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":V=am;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":V=WT;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":V=dC;break;case Em:case wm:case _m:V=$T;break;case Rm:V=fC;break;case"scroll":case"scrollend":V=JT;break;case"wheel":V=pC;break;case"copy":case"cut":case"paste":V=tC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":V=rm;break;case"toggle":case"beforetoggle":V=vC}var fe=(n&4)!==0,Ge=!fe&&(t==="scroll"||t==="scrollend"),P=fe?F!==null?F+"Capture":null:F;fe=[];for(var N=q,B;N!==null;){var K=N;if(B=K.stateNode,K=K.tag,K!==5&&K!==26&&K!==27||B===null||P===null||(K=zs(N,P),K!=null&&fe.push(Tr(N,K,B))),Ge)break;N=N.return}0<fe.length&&(F=new V(F,oe,null,r,G),J.push({event:F,listeners:fe}))}}if((n&7)===0){e:{if(F=t==="mouseover"||t==="pointerover",V=t==="mouseout"||t==="pointerout",F&&r!==Pc&&(oe=r.relatedTarget||r.fromElement)&&(Pa(oe)||oe[ja]))break e;if((V||F)&&(F=G.window===G?G:(F=G.ownerDocument)?F.defaultView||F.parentWindow:window,V?(oe=r.relatedTarget||r.toElement,V=q,oe=oe?Pa(oe):null,oe!==null&&(Ge=l(oe),fe=oe.tag,oe!==Ge||fe!==5&&fe!==27&&fe!==6)&&(oe=null)):(V=null,oe=q),V!==oe)){if(fe=am,K="onMouseLeave",P="onMouseEnter",N="mouse",(t==="pointerout"||t==="pointerover")&&(fe=rm,K="onPointerLeave",P="onPointerEnter",N="pointer"),Ge=V==null?F:Fs(V),B=oe==null?F:Fs(oe),F=new fe(K,N+"leave",V,r,G),F.target=Ge,F.relatedTarget=B,K=null,Pa(G)===q&&(fe=new fe(P,N+"enter",oe,r,G),fe.target=B,fe.relatedTarget=Ge,K=fe),Ge=K,V&&oe)t:{for(fe=gk,P=V,N=oe,B=0,K=P;K;K=fe(K))B++;K=0;for(var de=N;de;de=fe(de))K++;for(;0<B-K;)P=fe(P),B--;for(;0<K-B;)N=fe(N),K--;for(;B--;){if(P===N||N!==null&&P===N.alternate){fe=P;break t}P=fe(P),N=fe(N)}fe=null}else fe=null;V!==null&&Xg(J,F,V,fe,!1),oe!==null&&Ge!==null&&Xg(J,Ge,oe,fe,!0)}}e:{if(F=q?Fs(q):window,V=F.nodeName&&F.nodeName.toLowerCase(),V==="select"||V==="input"&&F.type==="file")var je=mm;else if(hm(F))if(pm)je=_C;else{je=EC;var ce=xC}else V=F.nodeName,!V||V.toLowerCase()!=="input"||F.type!=="checkbox"&&F.type!=="radio"?q&&jc(q.elementType)&&(je=mm):je=wC;if(je&&(je=je(t,q))){fm(J,je,r,G);break e}ce&&ce(t,F,q),t==="focusout"&&q&&F.type==="number"&&q.memoizedProps.value!=null&&Oc(F,"number",F.value)}switch(ce=q?Fs(q):window,t){case"focusin":(hm(ce)||ce.contentEditable==="true")&&(Va=ce,Jc=q,Ws=null);break;case"focusout":Ws=Jc=Va=null;break;case"mousedown":Qc=!0;break;case"contextmenu":case"mouseup":case"dragend":Qc=!1,km(J,r,G);break;case"selectionchange":if(NC)break;case"keydown":case"keyup":km(J,r,G)}var be;if(Vc)e:{switch(t){case"compositionstart":var Re="onCompositionStart";break e;case"compositionend":Re="onCompositionEnd";break e;case"compositionupdate":Re="onCompositionUpdate";break e}Re=void 0}else Ha?um(t,r)&&(Re="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(Re="onCompositionStart");Re&&(om&&r.locale!=="ko"&&(Ha||Re!=="onCompositionStart"?Re==="onCompositionEnd"&&Ha&&(be=nm()):(Ti=G,Bc="value"in Ti?Ti.value:Ti.textContent,Ha=!0)),ce=ll(q,Re),0<ce.length&&(Re=new sm(Re,t,null,r,G),J.push({event:Re,listeners:ce}),be?Re.data=be:(be=dm(r),be!==null&&(Re.data=be)))),(be=bC?SC(t,r):TC(t,r))&&(Re=ll(q,"onBeforeInput"),0<Re.length&&(ce=new sm("onBeforeInput","beforeinput",null,r,G),J.push({event:ce,listeners:Re}),ce.data=be)),hk(J,t,q,r,G)}Qg(J,n)})}function Tr(t,n,r){return{instance:t,listener:n,currentTarget:r}}function ll(t,n){for(var r=n+"Capture",c=[];t!==null;){var m=t,g=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||g===null||(m=zs(t,r),m!=null&&c.unshift(Tr(t,m,g)),m=zs(t,n),m!=null&&c.push(Tr(t,m,g))),t.tag===3)return c;t=t.return}return[]}function gk(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function Xg(t,n,r,c,m){for(var g=n._reactName,b=[];r!==null&&r!==c;){var T=r,w=T.alternate,q=T.stateNode;if(T=T.tag,w!==null&&w===c)break;T!==5&&T!==26&&T!==27||q===null||(w=q,m?(q=zs(r,g),q!=null&&b.unshift(Tr(r,q,w))):m||(q=zs(r,g),q!=null&&b.push(Tr(r,q,w)))),r=r.return}b.length!==0&&t.push({event:n,listeners:b})}var vk=/\r\n?/g,yk=/\u0000|\uFFFD/g;function Zg(t){return(typeof t=="string"?t:""+t).replace(vk,`
`).replace(yk,"")}function $g(t,n){return n=Zg(n),Zg(t)===n}function Ve(t,n,r,c,m,g){switch(r){case"children":typeof c=="string"?n==="body"||n==="textarea"&&c===""||qa(t,c):(typeof c=="number"||typeof c=="bigint")&&n!=="body"&&qa(t,""+c);break;case"className":ho(t,"class",c);break;case"tabIndex":ho(t,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":ho(t,r,c);break;case"style":$f(t,c,g);break;case"data":if(n!=="object"){ho(t,"data",c);break}case"src":case"href":if(c===""&&(n!=="a"||r!=="href")){t.removeAttribute(r);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){t.removeAttribute(r);break}c=mo(""+c),t.setAttribute(r,c);break;case"action":case"formAction":if(typeof c=="function"){t.setAttribute(r,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(r==="formAction"?(n!=="input"&&Ve(t,n,"name",m.name,m,null),Ve(t,n,"formEncType",m.formEncType,m,null),Ve(t,n,"formMethod",m.formMethod,m,null),Ve(t,n,"formTarget",m.formTarget,m,null)):(Ve(t,n,"encType",m.encType,m,null),Ve(t,n,"method",m.method,m,null),Ve(t,n,"target",m.target,m,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){t.removeAttribute(r);break}c=mo(""+c),t.setAttribute(r,c);break;case"onClick":c!=null&&(t.onclick=Kn);break;case"onScroll":c!=null&&xe("scroll",t);break;case"onScrollEnd":c!=null&&xe("scrollend",t);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(s(61));if(r=c.__html,r!=null){if(m.children!=null)throw Error(s(60));t.innerHTML=r}}break;case"multiple":t.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":t.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){t.removeAttribute("xlink:href");break}r=mo(""+c),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(r,""+c):t.removeAttribute(r);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(r,""):t.removeAttribute(r);break;case"capture":case"download":c===!0?t.setAttribute(r,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(r,c):t.removeAttribute(r);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?t.setAttribute(r,c):t.removeAttribute(r);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?t.removeAttribute(r):t.setAttribute(r,c);break;case"popover":xe("beforetoggle",t),xe("toggle",t),uo(t,"popover",c);break;case"xlinkActuate":Gn(t,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":Gn(t,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":Gn(t,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":Gn(t,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":Gn(t,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":Gn(t,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":Gn(t,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":Gn(t,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":Gn(t,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":uo(t,"is",c);break;case"innerText":case"textContent":break;default:(!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(r=KT.get(r)||r,uo(t,r,c))}}function Sd(t,n,r,c,m,g){switch(r){case"style":$f(t,c,g);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(s(61));if(r=c.__html,r!=null){if(m.children!=null)throw Error(s(60));t.innerHTML=r}}break;case"children":typeof c=="string"?qa(t,c):(typeof c=="number"||typeof c=="bigint")&&qa(t,""+c);break;case"onScroll":c!=null&&xe("scroll",t);break;case"onScrollEnd":c!=null&&xe("scrollend",t);break;case"onClick":c!=null&&(t.onclick=Kn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Vf.hasOwnProperty(r))e:{if(r[0]==="o"&&r[1]==="n"&&(m=r.endsWith("Capture"),n=r.slice(2,m?r.length-7:void 0),g=t[Ut]||null,g=g!=null?g[r]:null,typeof g=="function"&&t.removeEventListener(n,g,m),typeof c=="function")){typeof g!="function"&&g!==null&&(r in t?t[r]=null:t.hasAttribute(r)&&t.removeAttribute(r)),t.addEventListener(n,c,m);break e}r in t?t[r]=c:c===!0?t.setAttribute(r,""):uo(t,r,c)}}}function _t(t,n,r){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":xe("error",t),xe("load",t);var c=!1,m=!1,g;for(g in r)if(r.hasOwnProperty(g)){var b=r[g];if(b!=null)switch(g){case"src":c=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,n));default:Ve(t,n,g,b,r,null)}}m&&Ve(t,n,"srcSet",r.srcSet,r,null),c&&Ve(t,n,"src",r.src,r,null);return;case"input":xe("invalid",t);var T=g=b=m=null,w=null,q=null;for(c in r)if(r.hasOwnProperty(c)){var G=r[c];if(G!=null)switch(c){case"name":m=G;break;case"type":b=G;break;case"checked":w=G;break;case"defaultChecked":q=G;break;case"value":g=G;break;case"defaultValue":T=G;break;case"children":case"dangerouslySetInnerHTML":if(G!=null)throw Error(s(137,n));break;default:Ve(t,n,c,G,r,null)}}Qf(t,g,T,w,q,b,m,!1);return;case"select":xe("invalid",t),c=b=g=null;for(m in r)if(r.hasOwnProperty(m)&&(T=r[m],T!=null))switch(m){case"value":g=T;break;case"defaultValue":b=T;break;case"multiple":c=T;default:Ve(t,n,m,T,r,null)}n=g,r=b,t.multiple=!!c,n!=null?Ba(t,!!c,n,!1):r!=null&&Ba(t,!!c,r,!0);return;case"textarea":xe("invalid",t),g=m=c=null;for(b in r)if(r.hasOwnProperty(b)&&(T=r[b],T!=null))switch(b){case"value":c=T;break;case"defaultValue":m=T;break;case"children":g=T;break;case"dangerouslySetInnerHTML":if(T!=null)throw Error(s(91));break;default:Ve(t,n,b,T,r,null)}Xf(t,c,m,g);return;case"option":for(w in r)r.hasOwnProperty(w)&&(c=r[w],c!=null)&&(w==="selected"?t.selected=c&&typeof c!="function"&&typeof c!="symbol":Ve(t,n,w,c,r,null));return;case"dialog":xe("beforetoggle",t),xe("toggle",t),xe("cancel",t),xe("close",t);break;case"iframe":case"object":xe("load",t);break;case"video":case"audio":for(c=0;c<Sr.length;c++)xe(Sr[c],t);break;case"image":xe("error",t),xe("load",t);break;case"details":xe("toggle",t);break;case"embed":case"source":case"link":xe("error",t),xe("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(q in r)if(r.hasOwnProperty(q)&&(c=r[q],c!=null))switch(q){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,n));default:Ve(t,n,q,c,r,null)}return;default:if(jc(n)){for(G in r)r.hasOwnProperty(G)&&(c=r[G],c!==void 0&&Sd(t,n,G,c,r,void 0));return}}for(T in r)r.hasOwnProperty(T)&&(c=r[T],c!=null&&Ve(t,n,T,c,r,null))}function bk(t,n,r,c){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,g=null,b=null,T=null,w=null,q=null,G=null;for(V in r){var J=r[V];if(r.hasOwnProperty(V)&&J!=null)switch(V){case"checked":break;case"value":break;case"defaultValue":w=J;default:c.hasOwnProperty(V)||Ve(t,n,V,null,c,J)}}for(var F in c){var V=c[F];if(J=r[F],c.hasOwnProperty(F)&&(V!=null||J!=null))switch(F){case"type":g=V;break;case"name":m=V;break;case"checked":q=V;break;case"defaultChecked":G=V;break;case"value":b=V;break;case"defaultValue":T=V;break;case"children":case"dangerouslySetInnerHTML":if(V!=null)throw Error(s(137,n));break;default:V!==J&&Ve(t,n,F,V,c,J)}}Dc(t,b,T,w,q,G,g,m);return;case"select":V=b=T=F=null;for(g in r)if(w=r[g],r.hasOwnProperty(g)&&w!=null)switch(g){case"value":break;case"multiple":V=w;default:c.hasOwnProperty(g)||Ve(t,n,g,null,c,w)}for(m in c)if(g=c[m],w=r[m],c.hasOwnProperty(m)&&(g!=null||w!=null))switch(m){case"value":F=g;break;case"defaultValue":T=g;break;case"multiple":b=g;default:g!==w&&Ve(t,n,m,g,c,w)}n=T,r=b,c=V,F!=null?Ba(t,!!r,F,!1):!!c!=!!r&&(n!=null?Ba(t,!!r,n,!0):Ba(t,!!r,r?[]:"",!1));return;case"textarea":V=F=null;for(T in r)if(m=r[T],r.hasOwnProperty(T)&&m!=null&&!c.hasOwnProperty(T))switch(T){case"value":break;case"children":break;default:Ve(t,n,T,null,c,m)}for(b in c)if(m=c[b],g=r[b],c.hasOwnProperty(b)&&(m!=null||g!=null))switch(b){case"value":F=m;break;case"defaultValue":V=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(s(91));break;default:m!==g&&Ve(t,n,b,m,c,g)}Wf(t,F,V);return;case"option":for(var oe in r)F=r[oe],r.hasOwnProperty(oe)&&F!=null&&!c.hasOwnProperty(oe)&&(oe==="selected"?t.selected=!1:Ve(t,n,oe,null,c,F));for(w in c)F=c[w],V=r[w],c.hasOwnProperty(w)&&F!==V&&(F!=null||V!=null)&&(w==="selected"?t.selected=F&&typeof F!="function"&&typeof F!="symbol":Ve(t,n,w,F,c,V));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var fe in r)F=r[fe],r.hasOwnProperty(fe)&&F!=null&&!c.hasOwnProperty(fe)&&Ve(t,n,fe,null,c,F);for(q in c)if(F=c[q],V=r[q],c.hasOwnProperty(q)&&F!==V&&(F!=null||V!=null))switch(q){case"children":case"dangerouslySetInnerHTML":if(F!=null)throw Error(s(137,n));break;default:Ve(t,n,q,F,c,V)}return;default:if(jc(n)){for(var Ge in r)F=r[Ge],r.hasOwnProperty(Ge)&&F!==void 0&&!c.hasOwnProperty(Ge)&&Sd(t,n,Ge,void 0,c,F);for(G in c)F=c[G],V=r[G],!c.hasOwnProperty(G)||F===V||F===void 0&&V===void 0||Sd(t,n,G,F,c,V);return}}for(var P in r)F=r[P],r.hasOwnProperty(P)&&F!=null&&!c.hasOwnProperty(P)&&Ve(t,n,P,null,c,F);for(J in c)F=c[J],V=r[J],!c.hasOwnProperty(J)||F===V||F==null&&V==null||Ve(t,n,J,F,c,V)}function ev(t){switch(t){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Sk(){if(typeof performance.getEntriesByType=="function"){for(var t=0,n=0,r=performance.getEntriesByType("resource"),c=0;c<r.length;c++){var m=r[c],g=m.transferSize,b=m.initiatorType,T=m.duration;if(g&&T&&ev(b)){for(b=0,T=m.responseEnd,c+=1;c<r.length;c++){var w=r[c],q=w.startTime;if(q>T)break;var G=w.transferSize,J=w.initiatorType;G&&ev(J)&&(w=w.responseEnd,b+=G*(w<T?1:(T-q)/(w-q)))}if(--c,n+=8*(g+b)/(m.duration/1e3),t++,10<t)break}}if(0<t)return n/t/1e6}return navigator.connection&&(t=navigator.connection.downlink,typeof t=="number")?t:5}var Td=null,Cd=null;function cl(t){return t.nodeType===9?t:t.ownerDocument}function tv(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function nv(t,n){if(t===0)switch(n){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&n==="foreignObject"?0:t}function kd(t,n){return t==="textarea"||t==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.children=="bigint"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var xd=null;function Tk(){var t=window.event;return t&&t.type==="popstate"?t===xd?!1:(xd=t,!0):(xd=null,!1)}var iv=typeof setTimeout=="function"?setTimeout:void 0,Ck=typeof clearTimeout=="function"?clearTimeout:void 0,av=typeof Promise=="function"?Promise:void 0,kk=typeof queueMicrotask=="function"?queueMicrotask:typeof av<"u"?function(t){return av.resolve(null).then(t).catch(xk)}:iv;function xk(t){setTimeout(function(){throw t})}function Ui(t){return t==="head"}function sv(t,n){var r=n,c=0;do{var m=r.nextSibling;if(t.removeChild(r),m&&m.nodeType===8)if(r=m.data,r==="/$"||r==="/&"){if(c===0){t.removeChild(m),vs(n);return}c--}else if(r==="$"||r==="$?"||r==="$~"||r==="$!"||r==="&")c++;else if(r==="html")Cr(t.ownerDocument.documentElement);else if(r==="head"){r=t.ownerDocument.head,Cr(r);for(var g=r.firstChild;g;){var b=g.nextSibling,T=g.nodeName;g[qs]||T==="SCRIPT"||T==="STYLE"||T==="LINK"&&g.rel.toLowerCase()==="stylesheet"||r.removeChild(g),g=b}}else r==="body"&&Cr(t.ownerDocument.body);r=m}while(r);vs(n)}function rv(t,n){var r=t;t=0;do{var c=r.nextSibling;if(r.nodeType===1?n?(r._stashedDisplay=r.style.display,r.style.display="none"):(r.style.display=r._stashedDisplay||"",r.getAttribute("style")===""&&r.removeAttribute("style")):r.nodeType===3&&(n?(r._stashedText=r.nodeValue,r.nodeValue=""):r.nodeValue=r._stashedText||""),c&&c.nodeType===8)if(r=c.data,r==="/$"){if(t===0)break;t--}else r!=="$"&&r!=="$?"&&r!=="$~"&&r!=="$!"||t++;r=c}while(r)}function Ed(t){var n=t.firstChild;for(n&&n.nodeType===10&&(n=n.nextSibling);n;){var r=n;switch(n=n.nextSibling,r.nodeName){case"HTML":case"HEAD":case"BODY":Ed(r),Ac(r);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(r.rel.toLowerCase()==="stylesheet")continue}t.removeChild(r)}}function Ek(t,n,r,c){for(;t.nodeType===1;){var m=r;if(t.nodeName.toLowerCase()!==n.toLowerCase()){if(!c&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(c){if(!t[qs])switch(n){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(g=t.getAttribute("rel"),g==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(g!==m.rel||t.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||t.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||t.getAttribute("title")!==(m.title==null?null:m.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(g=t.getAttribute("src"),(g!==(m.src==null?null:m.src)||t.getAttribute("type")!==(m.type==null?null:m.type)||t.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&g&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(n==="input"&&t.type==="hidden"){var g=m.name==null?null:""+m.name;if(m.type==="hidden"&&t.getAttribute("name")===g)return t}else return t;if(t=pn(t.nextSibling),t===null)break}return null}function wk(t,n,r){if(n==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!r||(t=pn(t.nextSibling),t===null))return null;return t}function ov(t,n){for(;t.nodeType!==8;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!n||(t=pn(t.nextSibling),t===null))return null;return t}function wd(t){return t.data==="$?"||t.data==="$~"}function _d(t){return t.data==="$!"||t.data==="$?"&&t.ownerDocument.readyState!=="loading"}function _k(t,n){var r=t.ownerDocument;if(t.data==="$~")t._reactRetry=n;else if(t.data!=="$?"||r.readyState!=="loading")n();else{var c=function(){n(),r.removeEventListener("DOMContentLoaded",c)};r.addEventListener("DOMContentLoaded",c),t._reactRetry=c}}function pn(t){for(;t!=null;t=t.nextSibling){var n=t.nodeType;if(n===1||n===3)break;if(n===8){if(n=t.data,n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"||n==="F!"||n==="F")break;if(n==="/$"||n==="/&")return null}}return t}var Rd=null;function lv(t){t=t.nextSibling;for(var n=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"||r==="/&"){if(n===0)return pn(t.nextSibling);n--}else r!=="$"&&r!=="$!"&&r!=="$?"&&r!=="$~"&&r!=="&"||n++}t=t.nextSibling}return null}function cv(t){t=t.previousSibling;for(var n=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"){if(n===0)return t;n--}else r!=="/$"&&r!=="/&"||n++}t=t.previousSibling}return null}function uv(t,n,r){switch(n=cl(r),t){case"html":if(t=n.documentElement,!t)throw Error(s(452));return t;case"head":if(t=n.head,!t)throw Error(s(453));return t;case"body":if(t=n.body,!t)throw Error(s(454));return t;default:throw Error(s(451))}}function Cr(t){for(var n=t.attributes;n.length;)t.removeAttributeNode(n[0]);Ac(t)}var gn=new Map,dv=new Set;function ul(t){return typeof t.getRootNode=="function"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var li=ne.d;ne.d={f:Rk,r:Nk,D:Ak,C:Mk,L:Dk,m:Ok,X:Pk,S:jk,M:Ik};function Rk(){var t=li.f(),n=tl();return t||n}function Nk(t){var n=Ia(t);n!==null&&n.tag===5&&n.type==="form"?Rp(n):li.r(t)}var ms=typeof document>"u"?null:document;function hv(t,n,r){var c=ms;if(c&&typeof n=="string"&&n){var m=ln(n);m='link[rel="'+t+'"][href="'+m+'"]',typeof r=="string"&&(m+='[crossorigin="'+r+'"]'),dv.has(m)||(dv.add(m),t={rel:t,crossOrigin:r,href:n},c.querySelector(m)===null&&(n=c.createElement("link"),_t(n,"link",t),bt(n),c.head.appendChild(n)))}}function Ak(t){li.D(t),hv("dns-prefetch",t,null)}function Mk(t,n){li.C(t,n),hv("preconnect",t,n)}function Dk(t,n,r){li.L(t,n,r);var c=ms;if(c&&t&&n){var m='link[rel="preload"][as="'+ln(n)+'"]';n==="image"&&r&&r.imageSrcSet?(m+='[imagesrcset="'+ln(r.imageSrcSet)+'"]',typeof r.imageSizes=="string"&&(m+='[imagesizes="'+ln(r.imageSizes)+'"]')):m+='[href="'+ln(t)+'"]';var g=m;switch(n){case"style":g=ps(t);break;case"script":g=gs(t)}gn.has(g)||(t=y({rel:"preload",href:n==="image"&&r&&r.imageSrcSet?void 0:t,as:n},r),gn.set(g,t),c.querySelector(m)!==null||n==="style"&&c.querySelector(kr(g))||n==="script"&&c.querySelector(xr(g))||(n=c.createElement("link"),_t(n,"link",t),bt(n),c.head.appendChild(n)))}}function Ok(t,n){li.m(t,n);var r=ms;if(r&&t){var c=n&&typeof n.as=="string"?n.as:"script",m='link[rel="modulepreload"][as="'+ln(c)+'"][href="'+ln(t)+'"]',g=m;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=gs(t)}if(!gn.has(g)&&(t=y({rel:"modulepreload",href:t},n),gn.set(g,t),r.querySelector(m)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(r.querySelector(xr(g)))return}c=r.createElement("link"),_t(c,"link",t),bt(c),r.head.appendChild(c)}}}function jk(t,n,r){li.S(t,n,r);var c=ms;if(c&&t){var m=La(c).hoistableStyles,g=ps(t);n=n||"default";var b=m.get(g);if(!b){var T={loading:0,preload:null};if(b=c.querySelector(kr(g)))T.loading=5;else{t=y({rel:"stylesheet",href:t,"data-precedence":n},r),(r=gn.get(g))&&Nd(t,r);var w=b=c.createElement("link");bt(w),_t(w,"link",t),w._p=new Promise(function(q,G){w.onload=q,w.onerror=G}),w.addEventListener("load",function(){T.loading|=1}),w.addEventListener("error",function(){T.loading|=2}),T.loading|=4,dl(b,n,c)}b={type:"stylesheet",instance:b,count:1,state:T},m.set(g,b)}}}function Pk(t,n){li.X(t,n);var r=ms;if(r&&t){var c=La(r).hoistableScripts,m=gs(t),g=c.get(m);g||(g=r.querySelector(xr(m)),g||(t=y({src:t,async:!0},n),(n=gn.get(m))&&Ad(t,n),g=r.createElement("script"),bt(g),_t(g,"link",t),r.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},c.set(m,g))}}function Ik(t,n){li.M(t,n);var r=ms;if(r&&t){var c=La(r).hoistableScripts,m=gs(t),g=c.get(m);g||(g=r.querySelector(xr(m)),g||(t=y({src:t,async:!0,type:"module"},n),(n=gn.get(m))&&Ad(t,n),g=r.createElement("script"),bt(g),_t(g,"link",t),r.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},c.set(m,g))}}function fv(t,n,r,c){var m=(m=ye.current)?ul(m):null;if(!m)throw Error(s(446));switch(t){case"meta":case"title":return null;case"style":return typeof r.precedence=="string"&&typeof r.href=="string"?(n=ps(r.href),r=La(m).hoistableStyles,c=r.get(n),c||(c={type:"style",instance:null,count:0,state:null},r.set(n,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(r.rel==="stylesheet"&&typeof r.href=="string"&&typeof r.precedence=="string"){t=ps(r.href);var g=La(m).hoistableStyles,b=g.get(t);if(b||(m=m.ownerDocument||m,b={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(t,b),(g=m.querySelector(kr(t)))&&!g._p&&(b.instance=g,b.state.loading=5),gn.has(t)||(r={rel:"preload",as:"style",href:r.href,crossOrigin:r.crossOrigin,integrity:r.integrity,media:r.media,hrefLang:r.hrefLang,referrerPolicy:r.referrerPolicy},gn.set(t,r),g||Lk(m,t,r,b.state))),n&&c===null)throw Error(s(528,""));return b}if(n&&c!==null)throw Error(s(529,""));return null;case"script":return n=r.async,r=r.src,typeof r=="string"&&n&&typeof n!="function"&&typeof n!="symbol"?(n=gs(r),r=La(m).hoistableScripts,c=r.get(n),c||(c={type:"script",instance:null,count:0,state:null},r.set(n,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,t))}}function ps(t){return'href="'+ln(t)+'"'}function kr(t){return'link[rel="stylesheet"]['+t+"]"}function mv(t){return y({},t,{"data-precedence":t.precedence,precedence:null})}function Lk(t,n,r,c){t.querySelector('link[rel="preload"][as="style"]['+n+"]")?c.loading=1:(n=t.createElement("link"),c.preload=n,n.addEventListener("load",function(){return c.loading|=1}),n.addEventListener("error",function(){return c.loading|=2}),_t(n,"link",r),bt(n),t.head.appendChild(n))}function gs(t){return'[src="'+ln(t)+'"]'}function xr(t){return"script[async]"+t}function pv(t,n,r){if(n.count++,n.instance===null)switch(n.type){case"style":var c=t.querySelector('style[data-href~="'+ln(r.href)+'"]');if(c)return n.instance=c,bt(c),c;var m=y({},r,{"data-href":r.href,"data-precedence":r.precedence,href:null,precedence:null});return c=(t.ownerDocument||t).createElement("style"),bt(c),_t(c,"style",m),dl(c,r.precedence,t),n.instance=c;case"stylesheet":m=ps(r.href);var g=t.querySelector(kr(m));if(g)return n.state.loading|=4,n.instance=g,bt(g),g;c=mv(r),(m=gn.get(m))&&Nd(c,m),g=(t.ownerDocument||t).createElement("link"),bt(g);var b=g;return b._p=new Promise(function(T,w){b.onload=T,b.onerror=w}),_t(g,"link",c),n.state.loading|=4,dl(g,r.precedence,t),n.instance=g;case"script":return g=gs(r.src),(m=t.querySelector(xr(g)))?(n.instance=m,bt(m),m):(c=r,(m=gn.get(g))&&(c=y({},r),Ad(c,m)),t=t.ownerDocument||t,m=t.createElement("script"),bt(m),_t(m,"link",c),t.head.appendChild(m),n.instance=m);case"void":return null;default:throw Error(s(443,n.type))}else n.type==="stylesheet"&&(n.state.loading&4)===0&&(c=n.instance,n.state.loading|=4,dl(c,r.precedence,t));return n.instance}function dl(t,n,r){for(var c=r.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=c.length?c[c.length-1]:null,g=m,b=0;b<c.length;b++){var T=c[b];if(T.dataset.precedence===n)g=T;else if(g!==m)break}g?g.parentNode.insertBefore(t,g.nextSibling):(n=r.nodeType===9?r.head:r,n.insertBefore(t,n.firstChild))}function Nd(t,n){t.crossOrigin==null&&(t.crossOrigin=n.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=n.referrerPolicy),t.title==null&&(t.title=n.title)}function Ad(t,n){t.crossOrigin==null&&(t.crossOrigin=n.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=n.referrerPolicy),t.integrity==null&&(t.integrity=n.integrity)}var hl=null;function gv(t,n,r){if(hl===null){var c=new Map,m=hl=new Map;m.set(r,c)}else m=hl,c=m.get(r),c||(c=new Map,m.set(r,c));if(c.has(t))return c;for(c.set(t,null),r=r.getElementsByTagName(t),m=0;m<r.length;m++){var g=r[m];if(!(g[qs]||g[kt]||t==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var b=g.getAttribute(n)||"";b=t+b;var T=c.get(b);T?T.push(g):c.set(b,[g])}}return c}function vv(t,n,r){t=t.ownerDocument||t,t.head.insertBefore(r,n==="title"?t.querySelector("head > title"):null)}function Uk(t,n,r){if(r===1||n.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof n.precedence!="string"||typeof n.href!="string"||n.href==="")break;return!0;case"link":if(typeof n.rel!="string"||typeof n.href!="string"||n.href===""||n.onLoad||n.onError)break;return n.rel==="stylesheet"?(t=n.disabled,typeof n.precedence=="string"&&t==null):!0;case"script":if(n.async&&typeof n.async!="function"&&typeof n.async!="symbol"&&!n.onLoad&&!n.onError&&n.src&&typeof n.src=="string")return!0}return!1}function yv(t){return!(t.type==="stylesheet"&&(t.state.loading&3)===0)}function Bk(t,n,r,c){if(r.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(r.state.loading&4)===0){if(r.instance===null){var m=ps(c.href),g=n.querySelector(kr(m));if(g){n=g._p,n!==null&&typeof n=="object"&&typeof n.then=="function"&&(t.count++,t=fl.bind(t),n.then(t,t)),r.state.loading|=4,r.instance=g,bt(g);return}g=n.ownerDocument||n,c=mv(c),(m=gn.get(m))&&Nd(c,m),g=g.createElement("link"),bt(g);var b=g;b._p=new Promise(function(T,w){b.onload=T,b.onerror=w}),_t(g,"link",c),r.instance=g}t.stylesheets===null&&(t.stylesheets=new Map),t.stylesheets.set(r,n),(n=r.state.preload)&&(r.state.loading&3)===0&&(t.count++,r=fl.bind(t),n.addEventListener("load",r),n.addEventListener("error",r))}}var Md=0;function qk(t,n){return t.stylesheets&&t.count===0&&pl(t,t.stylesheets),0<t.count||0<t.imgCount?function(r){var c=setTimeout(function(){if(t.stylesheets&&pl(t,t.stylesheets),t.unsuspend){var g=t.unsuspend;t.unsuspend=null,g()}},6e4+n);0<t.imgBytes&&Md===0&&(Md=62500*Sk());var m=setTimeout(function(){if(t.waitingForImages=!1,t.count===0&&(t.stylesheets&&pl(t,t.stylesheets),t.unsuspend)){var g=t.unsuspend;t.unsuspend=null,g()}},(t.imgBytes>Md?50:800)+n);return t.unsuspend=r,function(){t.unsuspend=null,clearTimeout(c),clearTimeout(m)}}:null}function fl(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)pl(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var ml=null;function pl(t,n){t.stylesheets=null,t.unsuspend!==null&&(t.count++,ml=new Map,n.forEach(Fk,t),ml=null,fl.call(t))}function Fk(t,n){if(!(n.state.loading&4)){var r=ml.get(t);if(r)var c=r.get(null);else{r=new Map,ml.set(t,r);for(var m=t.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<m.length;g++){var b=m[g];(b.nodeName==="LINK"||b.getAttribute("media")!=="not all")&&(r.set(b.dataset.precedence,b),c=b)}c&&r.set(null,c)}m=n.instance,b=m.getAttribute("data-precedence"),g=r.get(b)||c,g===c&&r.set(null,m),r.set(b,m),this.count++,c=fl.bind(this),m.addEventListener("load",c),m.addEventListener("error",c),g?g.parentNode.insertBefore(m,g.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(m,t.firstChild)),n.state.loading|=4}}var Er={$$typeof:L,Provider:null,Consumer:null,_currentValue:he,_currentValue2:he,_threadCount:0};function zk(t,n,r,c,m,g,b,T,w){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=wc(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=wc(0),this.hiddenUpdates=wc(null),this.identifierPrefix=c,this.onUncaughtError=m,this.onCaughtError=g,this.onRecoverableError=b,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=w,this.incompleteTransitions=new Map}function bv(t,n,r,c,m,g,b,T,w,q,G,J){return t=new zk(t,n,r,b,w,q,G,J,T),n=1,g===!0&&(n|=24),g=Zt(3,null,null,n),t.current=g,g.stateNode=t,n=uu(),n.refCount++,t.pooledCache=n,n.refCount++,g.memoizedState={element:c,isDehydrated:r,cache:n},mu(g),t}function Sv(t){return t?(t=Ya,t):Ya}function Tv(t,n,r,c,m,g){m=Sv(m),c.context===null?c.context=m:c.pendingContext=m,c=_i(n),c.payload={element:r},g=g===void 0?null:g,g!==null&&(c.callback=g),r=Ri(t,c,n),r!==null&&(Vt(r,t,n),ir(r,t,n))}function Cv(t,n){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<n?r:n}}function Dd(t,n){Cv(t,n),(t=t.alternate)&&Cv(t,n)}function kv(t){if(t.tag===13||t.tag===31){var n=ua(t,67108864);n!==null&&Vt(n,t,67108864),Dd(t,67108864)}}function xv(t){if(t.tag===13||t.tag===31){var n=an();n=_c(n);var r=ua(t,n);r!==null&&Vt(r,t,n),Dd(t,n)}}var gl=!0;function Hk(t,n,r,c){var m=z.T;z.T=null;var g=ne.p;try{ne.p=2,Od(t,n,r,c)}finally{ne.p=g,z.T=m}}function Vk(t,n,r,c){var m=z.T;z.T=null;var g=ne.p;try{ne.p=8,Od(t,n,r,c)}finally{ne.p=g,z.T=m}}function Od(t,n,r,c){if(gl){var m=jd(c);if(m===null)bd(t,n,c,vl,r),wv(t,c);else if(Kk(m,t,n,r,c))c.stopPropagation();else if(wv(t,c),n&4&&-1<Gk.indexOf(t)){for(;m!==null;){var g=Ia(m);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var b=sa(g.pendingLanes);if(b!==0){var T=g;for(T.pendingLanes|=2,T.entangledLanes|=2;b;){var w=1<<31-Wt(b);T.entanglements[1]|=w,b&=~w}In(g),(Ue&6)===0&&($o=Jt()+500,br(0))}}break;case 31:case 13:T=ua(g,2),T!==null&&Vt(T,g,2),tl(),Dd(g,2)}if(g=jd(c),g===null&&bd(t,n,c,vl,r),g===m)break;m=g}m!==null&&c.stopPropagation()}else bd(t,n,c,null,r)}}function jd(t){return t=Ic(t),Pd(t)}var vl=null;function Pd(t){if(vl=null,t=Pa(t),t!==null){var n=l(t);if(n===null)t=null;else{var r=n.tag;if(r===13){if(t=d(n),t!==null)return t;t=null}else if(r===31){if(t=u(n),t!==null)return t;t=null}else if(r===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;t=null}else n!==t&&(t=null)}}return vl=t,null}function Ev(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(AT()){case Of:return 2;case jf:return 8;case so:case MT:return 32;case Pf:return 268435456;default:return 32}default:return 32}}var Id=!1,Bi=null,qi=null,Fi=null,wr=new Map,_r=new Map,zi=[],Gk="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function wv(t,n){switch(t){case"focusin":case"focusout":Bi=null;break;case"dragenter":case"dragleave":qi=null;break;case"mouseover":case"mouseout":Fi=null;break;case"pointerover":case"pointerout":wr.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":_r.delete(n.pointerId)}}function Rr(t,n,r,c,m,g){return t===null||t.nativeEvent!==g?(t={blockedOn:n,domEventName:r,eventSystemFlags:c,nativeEvent:g,targetContainers:[m]},n!==null&&(n=Ia(n),n!==null&&kv(n)),t):(t.eventSystemFlags|=c,n=t.targetContainers,m!==null&&n.indexOf(m)===-1&&n.push(m),t)}function Kk(t,n,r,c,m){switch(n){case"focusin":return Bi=Rr(Bi,t,n,r,c,m),!0;case"dragenter":return qi=Rr(qi,t,n,r,c,m),!0;case"mouseover":return Fi=Rr(Fi,t,n,r,c,m),!0;case"pointerover":var g=m.pointerId;return wr.set(g,Rr(wr.get(g)||null,t,n,r,c,m)),!0;case"gotpointercapture":return g=m.pointerId,_r.set(g,Rr(_r.get(g)||null,t,n,r,c,m)),!0}return!1}function _v(t){var n=Pa(t.target);if(n!==null){var r=l(n);if(r!==null){if(n=r.tag,n===13){if(n=d(r),n!==null){t.blockedOn=n,Ff(t.priority,function(){xv(r)});return}}else if(n===31){if(n=u(r),n!==null){t.blockedOn=n,Ff(t.priority,function(){xv(r)});return}}else if(n===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function yl(t){if(t.blockedOn!==null)return!1;for(var n=t.targetContainers;0<n.length;){var r=jd(t.nativeEvent);if(r===null){r=t.nativeEvent;var c=new r.constructor(r.type,r);Pc=c,r.target.dispatchEvent(c),Pc=null}else return n=Ia(r),n!==null&&kv(n),t.blockedOn=r,!1;n.shift()}return!0}function Rv(t,n,r){yl(t)&&r.delete(n)}function Yk(){Id=!1,Bi!==null&&yl(Bi)&&(Bi=null),qi!==null&&yl(qi)&&(qi=null),Fi!==null&&yl(Fi)&&(Fi=null),wr.forEach(Rv),_r.forEach(Rv)}function bl(t,n){t.blockedOn===n&&(t.blockedOn=null,Id||(Id=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Yk)))}var Sl=null;function Nv(t){Sl!==t&&(Sl=t,a.unstable_scheduleCallback(a.unstable_NormalPriority,function(){Sl===t&&(Sl=null);for(var n=0;n<t.length;n+=3){var r=t[n],c=t[n+1],m=t[n+2];if(typeof c!="function"){if(Pd(c||r)===null)continue;break}var g=Ia(r);g!==null&&(t.splice(n,3),n-=3,ju(g,{pending:!0,data:m,method:r.method,action:c},c,m))}}))}function vs(t){function n(w){return bl(w,t)}Bi!==null&&bl(Bi,t),qi!==null&&bl(qi,t),Fi!==null&&bl(Fi,t),wr.forEach(n),_r.forEach(n);for(var r=0;r<zi.length;r++){var c=zi[r];c.blockedOn===t&&(c.blockedOn=null)}for(;0<zi.length&&(r=zi[0],r.blockedOn===null);)_v(r),r.blockedOn===null&&zi.shift();if(r=(t.ownerDocument||t).$$reactFormReplay,r!=null)for(c=0;c<r.length;c+=3){var m=r[c],g=r[c+1],b=m[Ut]||null;if(typeof g=="function")b||Nv(r);else if(b){var T=null;if(g&&g.hasAttribute("formAction")){if(m=g,b=g[Ut]||null)T=b.formAction;else if(Pd(m)!==null)continue}else T=b.action;typeof T=="function"?r[c+1]=T:(r.splice(c,3),c-=3),Nv(r)}}}function Av(){function t(g){g.canIntercept&&g.info==="react-transition"&&g.intercept({handler:function(){return new Promise(function(b){return m=b})},focusReset:"manual",scroll:"manual"})}function n(){m!==null&&(m(),m=null),c||setTimeout(r,20)}function r(){if(!c&&!navigation.transition){var g=navigation.currentEntry;g&&g.url!=null&&navigation.navigate(g.url,{state:g.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,m=null;return navigation.addEventListener("navigate",t),navigation.addEventListener("navigatesuccess",n),navigation.addEventListener("navigateerror",n),setTimeout(r,100),function(){c=!0,navigation.removeEventListener("navigate",t),navigation.removeEventListener("navigatesuccess",n),navigation.removeEventListener("navigateerror",n),m!==null&&(m(),m=null)}}}function Ld(t){this._internalRoot=t}Tl.prototype.render=Ld.prototype.render=function(t){var n=this._internalRoot;if(n===null)throw Error(s(409));var r=n.current,c=an();Tv(r,c,t,n,null,null)},Tl.prototype.unmount=Ld.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var n=t.containerInfo;Tv(t.current,2,null,t,null,null),tl(),n[ja]=null}};function Tl(t){this._internalRoot=t}Tl.prototype.unstable_scheduleHydration=function(t){if(t){var n=qf();t={blockedOn:null,target:t,priority:n};for(var r=0;r<zi.length&&n!==0&&n<zi[r].priority;r++);zi.splice(r,0,t),r===0&&_v(t)}};var Mv=e.version;if(Mv!=="19.2.4")throw Error(s(527,Mv,"19.2.4"));ne.findDOMNode=function(t){var n=t._reactInternals;if(n===void 0)throw typeof t.render=="function"?Error(s(188)):(t=Object.keys(t).join(","),Error(s(268,t)));return t=p(n),t=t!==null?v(t):null,t=t===null?null:t.stateNode,t};var Jk={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:z,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Cl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Cl.isDisabled&&Cl.supportsFiber)try{Ls=Cl.inject(Jk),Qt=Cl}catch{}}return Ar.createRoot=function(t,n){if(!o(t))throw Error(s(299));var r=!1,c="",m=Up,g=Bp,b=qp;return n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(c=n.identifierPrefix),n.onUncaughtError!==void 0&&(m=n.onUncaughtError),n.onCaughtError!==void 0&&(g=n.onCaughtError),n.onRecoverableError!==void 0&&(b=n.onRecoverableError)),n=bv(t,1,!1,null,null,r,c,null,m,g,b,Av),t[ja]=n.current,yd(t),new Ld(n)},Ar.hydrateRoot=function(t,n,r){if(!o(t))throw Error(s(299));var c=!1,m="",g=Up,b=Bp,T=qp,w=null;return r!=null&&(r.unstable_strictMode===!0&&(c=!0),r.identifierPrefix!==void 0&&(m=r.identifierPrefix),r.onUncaughtError!==void 0&&(g=r.onUncaughtError),r.onCaughtError!==void 0&&(b=r.onCaughtError),r.onRecoverableError!==void 0&&(T=r.onRecoverableError),r.formState!==void 0&&(w=r.formState)),n=bv(t,1,!0,n,r??null,c,m,w,g,b,T,Av),n.context=Sv(null),r=n.current,c=an(),c=_c(c),m=_i(c),m.callback=null,Ri(r,m,c),r=c,n.current.lanes=r,Bs(n,r),In(n),t[ja]=n.current,yd(t),new Tl(n)},Ar.version="19.2.4",Ar}var Fv;function r1(){if(Fv)return qd.exports;Fv=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(e){console.error(e)}}return a(),qd.exports=s1(),qd.exports}var o1=r1();var zv="popstate";function l1(a={}){function e(s,o){let{pathname:l,search:d,hash:u}=s.location;return mh("",{pathname:l,search:d,hash:u},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function i(s,o){return typeof o=="string"?o:Kr(o)}return u1(e,i,null,a)}function nt(a,e){if(a===!1||a===null||typeof a>"u")throw new Error(e)}function Dn(a,e){if(!a){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function c1(){return Math.random().toString(36).substring(2,10)}function Hv(a,e){return{usr:a.state,key:a.key,idx:e}}function mh(a,e,i=null,s){return{pathname:typeof a=="string"?a:a.pathname,search:"",hash:"",...typeof e=="string"?js(e):e,state:i,key:e&&e.key||s||c1()}}function Kr({pathname:a="/",search:e="",hash:i=""}){return e&&e!=="?"&&(a+=e.charAt(0)==="?"?e:"?"+e),i&&i!=="#"&&(a+=i.charAt(0)==="#"?i:"#"+i),a}function js(a){let e={};if(a){let i=a.indexOf("#");i>=0&&(e.hash=a.substring(i),a=a.substring(0,i));let s=a.indexOf("?");s>=0&&(e.search=a.substring(s),a=a.substring(0,s)),a&&(e.pathname=a)}return e}function u1(a,e,i,s={}){let{window:o=document.defaultView,v5Compat:l=!1}=s,d=o.history,u="POP",f=null,p=v();p==null&&(p=0,d.replaceState({...d.state,idx:p},""));function v(){return(d.state||{idx:null}).idx}function y(){u="POP";let k=v(),R=k==null?null:k-p;p=k,f&&f({action:u,location:x.location,delta:R})}function S(k,R){u="PUSH";let O=mh(x.location,k,R);p=v()+1;let L=Hv(O,p),D=x.createHref(O);try{d.pushState(L,"",D)}catch(I){if(I instanceof DOMException&&I.name==="DataCloneError")throw I;o.location.assign(D)}l&&f&&f({action:u,location:x.location,delta:1})}function C(k,R){u="REPLACE";let O=mh(x.location,k,R);p=v();let L=Hv(O,p),D=x.createHref(O);d.replaceState(L,"",D),l&&f&&f({action:u,location:x.location,delta:0})}function _(k){return d1(k)}let x={get action(){return u},get location(){return a(o,d)},listen(k){if(f)throw new Error("A history only accepts one active listener");return o.addEventListener(zv,y),f=k,()=>{o.removeEventListener(zv,y),f=null}},createHref(k){return e(o,k)},createURL:_,encodeLocation(k){let R=_(k);return{pathname:R.pathname,search:R.search,hash:R.hash}},push:S,replace:C,go(k){return d.go(k)}};return x}function d1(a,e=!1){let i="http://localhost";typeof window<"u"&&(i=window.location.origin!=="null"?window.location.origin:window.location.href),nt(i,"No window.location.(origin|href) available to create URL");let s=typeof a=="string"?a:Kr(a);return s=s.replace(/ $/,"%20"),!e&&s.startsWith("//")&&(s=i+s),new URL(s,i)}function Y0(a,e,i="/"){return h1(a,e,i,!1)}function h1(a,e,i,s){let o=typeof e=="string"?js(e):e,l=vi(o.pathname||"/",i);if(l==null)return null;let d=J0(a);f1(d);let u=null;for(let f=0;u==null&&f<d.length;++f){let p=x1(l);u=C1(d[f],p,s)}return u}function J0(a,e=[],i=[],s="",o=!1){let l=(d,u,f=o,p)=>{let v={relativePath:p===void 0?d.path||"":p,caseSensitive:d.caseSensitive===!0,childrenIndex:u,route:d};if(v.relativePath.startsWith("/")){if(!v.relativePath.startsWith(s)&&f)return;nt(v.relativePath.startsWith(s),`Absolute route path "${v.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),v.relativePath=v.relativePath.slice(s.length)}let y=gi([s,v.relativePath]),S=i.concat(v);d.children&&d.children.length>0&&(nt(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${y}".`),J0(d.children,e,S,y,f)),!(d.path==null&&!d.index)&&e.push({path:y,score:S1(y,d.index),routesMeta:S})};return a.forEach((d,u)=>{if(d.path===""||!d.path?.includes("?"))l(d,u);else for(let f of Q0(d.path))l(d,u,!0,f)}),e}function Q0(a){let e=a.split("/");if(e.length===0)return[];let[i,...s]=e,o=i.endsWith("?"),l=i.replace(/\?$/,"");if(s.length===0)return o?[l,""]:[l];let d=Q0(s.join("/")),u=[];return u.push(...d.map(f=>f===""?l:[l,f].join("/"))),o&&u.push(...d),u.map(f=>a.startsWith("/")&&f===""?"/":f)}function f1(a){a.sort((e,i)=>e.score!==i.score?i.score-e.score:T1(e.routesMeta.map(s=>s.childrenIndex),i.routesMeta.map(s=>s.childrenIndex)))}var m1=/^:[\w-]+$/,p1=3,g1=2,v1=1,y1=10,b1=-2,Vv=a=>a==="*";function S1(a,e){let i=a.split("/"),s=i.length;return i.some(Vv)&&(s+=b1),e&&(s+=g1),i.filter(o=>!Vv(o)).reduce((o,l)=>o+(m1.test(l)?p1:l===""?v1:y1),s)}function T1(a,e){return a.length===e.length&&a.slice(0,-1).every((s,o)=>s===e[o])?a[a.length-1]-e[e.length-1]:0}function C1(a,e,i=!1){let{routesMeta:s}=a,o={},l="/",d=[];for(let u=0;u<s.length;++u){let f=s[u],p=u===s.length-1,v=l==="/"?e:e.slice(l.length)||"/",y=Vl({path:f.relativePath,caseSensitive:f.caseSensitive,end:p},v),S=f.route;if(!y&&p&&i&&!s[s.length-1].route.index&&(y=Vl({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},v)),!y)return null;Object.assign(o,y.params),d.push({params:o,pathname:gi([l,y.pathname]),pathnameBase:R1(gi([l,y.pathnameBase])),route:S}),y.pathnameBase!=="/"&&(l=gi([l,y.pathnameBase]))}return d}function Vl(a,e){typeof a=="string"&&(a={path:a,caseSensitive:!1,end:!0});let[i,s]=k1(a.path,a.caseSensitive,a.end),o=e.match(i);if(!o)return null;let l=o[0],d=l.replace(/(.)\/+$/,"$1"),u=o.slice(1);return{params:s.reduce((p,{paramName:v,isOptional:y},S)=>{if(v==="*"){let _=u[S]||"";d=l.slice(0,l.length-_.length).replace(/(.)\/+$/,"$1")}const C=u[S];return y&&!C?p[v]=void 0:p[v]=(C||"").replace(/%2F/g,"/"),p},{}),pathname:l,pathnameBase:d,pattern:a}}function k1(a,e=!1,i=!0){Dn(a==="*"||!a.endsWith("*")||a.endsWith("/*"),`Route path "${a}" will be treated as if it were "${a.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${a.replace(/\*$/,"/*")}".`);let s=[],o="^"+a.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,u,f)=>(s.push({paramName:u,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return a.endsWith("*")?(s.push({paramName:"*"}),o+=a==="*"||a==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):i?o+="\\/*$":a!==""&&a!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,e?void 0:"i"),s]}function x1(a){try{return a.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Dn(!1,`The URL path "${a}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),a}}function vi(a,e){if(e==="/")return a;if(!a.toLowerCase().startsWith(e.toLowerCase()))return null;let i=e.endsWith("/")?e.length-1:e.length,s=a.charAt(i);return s&&s!=="/"?null:a.slice(i)||"/"}var E1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function w1(a,e="/"){let{pathname:i,search:s="",hash:o=""}=typeof a=="string"?js(a):a,l;return i?(i=i.replace(/\/\/+/g,"/"),i.startsWith("/")?l=Gv(i.substring(1),"/"):l=Gv(i,e)):l=e,{pathname:l,search:N1(s),hash:A1(o)}}function Gv(a,e){let i=e.replace(/\/+$/,"").split("/");return a.split("/").forEach(o=>{o===".."?i.length>1&&i.pop():o!=="."&&i.push(o)}),i.length>1?i.join("/"):"/"}function Vd(a,e,i,s){return`Cannot include a '${a}' character in a manually specified \`to.${e}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${i}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function _1(a){return a.filter((e,i)=>i===0||e.route.path&&e.route.path.length>0)}function W0(a){let e=_1(a);return e.map((i,s)=>s===e.length-1?i.pathname:i.pathnameBase)}function X0(a,e,i,s=!1){let o;typeof a=="string"?o=js(a):(o={...a},nt(!o.pathname||!o.pathname.includes("?"),Vd("?","pathname","search",o)),nt(!o.pathname||!o.pathname.includes("#"),Vd("#","pathname","hash",o)),nt(!o.search||!o.search.includes("#"),Vd("#","search","hash",o)));let l=a===""||o.pathname==="",d=l?"/":o.pathname,u;if(d==null)u=i;else{let y=e.length-1;if(!s&&d.startsWith("..")){let S=d.split("/");for(;S[0]==="..";)S.shift(),y-=1;o.pathname=S.join("/")}u=y>=0?e[y]:"/"}let f=w1(o,u),p=d&&d!=="/"&&d.endsWith("/"),v=(l||d===".")&&i.endsWith("/");return!f.pathname.endsWith("/")&&(p||v)&&(f.pathname+="/"),f}var gi=a=>a.join("/").replace(/\/\/+/g,"/"),R1=a=>a.replace(/\/+$/,"").replace(/^\/*/,"/"),N1=a=>!a||a==="?"?"":a.startsWith("?")?a:"?"+a,A1=a=>!a||a==="#"?"":a.startsWith("#")?a:"#"+a,M1=class{constructor(a,e,i,s=!1){this.status=a,this.statusText=e||"",this.internal=s,i instanceof Error?(this.data=i.toString(),this.error=i):this.data=i}};function D1(a){return a!=null&&typeof a.status=="number"&&typeof a.statusText=="string"&&typeof a.internal=="boolean"&&"data"in a}function O1(a){return a.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var Z0=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function $0(a,e){let i=a;if(typeof i!="string"||!E1.test(i))return{absoluteURL:void 0,isExternal:!1,to:i};let s=i,o=!1;if(Z0)try{let l=new URL(window.location.href),d=i.startsWith("//")?new URL(l.protocol+i):new URL(i),u=vi(d.pathname,e);d.origin===l.origin&&u!=null?i=u+d.search+d.hash:o=!0}catch{Dn(!1,`<Link to="${i}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:s,isExternal:o,to:i}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var eb=["POST","PUT","PATCH","DELETE"];new Set(eb);var j1=["GET",...eb];new Set(j1);var Ps=M.createContext(null);Ps.displayName="DataRouter";var lc=M.createContext(null);lc.displayName="DataRouterState";var P1=M.createContext(!1),tb=M.createContext({isTransitioning:!1});tb.displayName="ViewTransition";var I1=M.createContext(new Map);I1.displayName="Fetchers";var L1=M.createContext(null);L1.displayName="Await";var Tn=M.createContext(null);Tn.displayName="Navigation";var to=M.createContext(null);to.displayName="Location";var Hn=M.createContext({outlet:null,matches:[],isDataRoute:!1});Hn.displayName="Route";var Jh=M.createContext(null);Jh.displayName="RouteError";var nb="REACT_ROUTER_ERROR",U1="REDIRECT",B1="ROUTE_ERROR_RESPONSE";function q1(a){if(a.startsWith(`${nb}:${U1}:{`))try{let e=JSON.parse(a.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function F1(a){if(a.startsWith(`${nb}:${B1}:{`))try{let e=JSON.parse(a.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new M1(e.status,e.statusText,e.data)}catch{}}function z1(a,{relative:e}={}){nt(no(),"useHref() may be used only in the context of a <Router> component.");let{basename:i,navigator:s}=M.useContext(Tn),{hash:o,pathname:l,search:d}=io(a,{relative:e}),u=l;return i!=="/"&&(u=l==="/"?i:gi([i,l])),s.createHref({pathname:u,search:d,hash:o})}function no(){return M.useContext(to)!=null}function ea(){return nt(no(),"useLocation() may be used only in the context of a <Router> component."),M.useContext(to).location}var ib="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function ab(a){M.useContext(Tn).static||M.useLayoutEffect(a)}function Ma(){let{isDataRoute:a}=M.useContext(Hn);return a?nx():H1()}function H1(){nt(no(),"useNavigate() may be used only in the context of a <Router> component.");let a=M.useContext(Ps),{basename:e,navigator:i}=M.useContext(Tn),{matches:s}=M.useContext(Hn),{pathname:o}=ea(),l=JSON.stringify(W0(s)),d=M.useRef(!1);return ab(()=>{d.current=!0}),M.useCallback((f,p={})=>{if(Dn(d.current,ib),!d.current)return;if(typeof f=="number"){i.go(f);return}let v=X0(f,JSON.parse(l),o,p.relative==="path");a==null&&e!=="/"&&(v.pathname=v.pathname==="/"?e:gi([e,v.pathname])),(p.replace?i.replace:i.push)(v,p.state,p)},[e,i,l,o,a])}M.createContext(null);function V1(){let{matches:a}=M.useContext(Hn),e=a[a.length-1];return e?e.params:{}}function io(a,{relative:e}={}){let{matches:i}=M.useContext(Hn),{pathname:s}=ea(),o=JSON.stringify(W0(i));return M.useMemo(()=>X0(a,JSON.parse(o),s,e==="path"),[a,o,s,e])}function G1(a,e){return sb(a,e)}function sb(a,e,i,s,o){nt(no(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:l}=M.useContext(Tn),{matches:d}=M.useContext(Hn),u=d[d.length-1],f=u?u.params:{},p=u?u.pathname:"/",v=u?u.pathnameBase:"/",y=u&&u.route;{let O=y&&y.path||"";ob(p,!y||O.endsWith("*")||O.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${p}" (under <Route path="${O}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${O}"> to <Route path="${O==="/"?"*":`${O}/*`}">.`)}let S=ea(),C;if(e){let O=typeof e=="string"?js(e):e;nt(v==="/"||O.pathname?.startsWith(v),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${v}" but pathname "${O.pathname}" was given in the \`location\` prop.`),C=O}else C=S;let _=C.pathname||"/",x=_;if(v!=="/"){let O=v.replace(/^\//,"").split("/");x="/"+_.replace(/^\//,"").split("/").slice(O.length).join("/")}let k=Y0(a,{pathname:x});Dn(y||k!=null,`No routes matched location "${C.pathname}${C.search}${C.hash}" `),Dn(k==null||k[k.length-1].route.element!==void 0||k[k.length-1].route.Component!==void 0||k[k.length-1].route.lazy!==void 0,`Matched leaf route at location "${C.pathname}${C.search}${C.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let R=W1(k&&k.map(O=>Object.assign({},O,{params:Object.assign({},f,O.params),pathname:gi([v,l.encodeLocation?l.encodeLocation(O.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:O.pathname]),pathnameBase:O.pathnameBase==="/"?v:gi([v,l.encodeLocation?l.encodeLocation(O.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:O.pathnameBase])})),d,i,s,o);return e&&R?M.createElement(to.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...C},navigationType:"POP"}},R):R}function K1(){let a=tx(),e=D1(a)?`${a.status} ${a.statusText}`:a instanceof Error?a.message:JSON.stringify(a),i=a instanceof Error?a.stack:null,s="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:s},l={padding:"2px 4px",backgroundColor:s},d=null;return console.error("Error handled by React Router default ErrorBoundary:",a),d=M.createElement(M.Fragment,null,M.createElement("p",null," Hey developer "),M.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",M.createElement("code",{style:l},"ErrorBoundary")," or"," ",M.createElement("code",{style:l},"errorElement")," prop on your route.")),M.createElement(M.Fragment,null,M.createElement("h2",null,"Unexpected Application Error!"),M.createElement("h3",{style:{fontStyle:"italic"}},e),i?M.createElement("pre",{style:o},i):null,d)}var Y1=M.createElement(K1,null),rb=class extends M.Component{constructor(a){super(a),this.state={location:a.location,revalidation:a.revalidation,error:a.error}}static getDerivedStateFromError(a){return{error:a}}static getDerivedStateFromProps(a,e){return e.location!==a.location||e.revalidation!=="idle"&&a.revalidation==="idle"?{error:a.error,location:a.location,revalidation:a.revalidation}:{error:a.error!==void 0?a.error:e.error,location:e.location,revalidation:a.revalidation||e.revalidation}}componentDidCatch(a,e){this.props.onError?this.props.onError(a,e):console.error("React Router caught the following error during render",a)}render(){let a=this.state.error;if(this.context&&typeof a=="object"&&a&&"digest"in a&&typeof a.digest=="string"){const i=F1(a.digest);i&&(a=i)}let e=a!==void 0?M.createElement(Hn.Provider,{value:this.props.routeContext},M.createElement(Jh.Provider,{value:a,children:this.props.component})):this.props.children;return this.context?M.createElement(J1,{error:a},e):e}};rb.contextType=P1;var Gd=new WeakMap;function J1({children:a,error:e}){let{basename:i}=M.useContext(Tn);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let s=q1(e.digest);if(s){let o=Gd.get(e);if(o)throw o;let l=$0(s.location,i);if(Z0&&!Gd.get(e))if(l.isExternal||s.reloadDocument)window.location.href=l.absoluteURL||l.to;else{const d=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(l.to,{replace:s.replace}));throw Gd.set(e,d),d}return M.createElement("meta",{httpEquiv:"refresh",content:`0;url=${l.absoluteURL||l.to}`})}}return a}function Q1({routeContext:a,match:e,children:i}){let s=M.useContext(Ps);return s&&s.static&&s.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=e.route.id),M.createElement(Hn.Provider,{value:a},i)}function W1(a,e=[],i=null,s=null,o=null){if(a==null){if(!i)return null;if(i.errors)a=i.matches;else if(e.length===0&&!i.initialized&&i.matches.length>0)a=i.matches;else return null}let l=a,d=i?.errors;if(d!=null){let v=l.findIndex(y=>y.route.id&&d?.[y.route.id]!==void 0);nt(v>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),l=l.slice(0,Math.min(l.length,v+1))}let u=!1,f=-1;if(i)for(let v=0;v<l.length;v++){let y=l[v];if((y.route.HydrateFallback||y.route.hydrateFallbackElement)&&(f=v),y.route.id){let{loaderData:S,errors:C}=i,_=y.route.loader&&!S.hasOwnProperty(y.route.id)&&(!C||C[y.route.id]===void 0);if(y.route.lazy||_){u=!0,f>=0?l=l.slice(0,f+1):l=[l[0]];break}}}let p=i&&s?(v,y)=>{s(v,{location:i.location,params:i.matches?.[0]?.params??{},unstable_pattern:O1(i.matches),errorInfo:y})}:void 0;return l.reduceRight((v,y,S)=>{let C,_=!1,x=null,k=null;i&&(C=d&&y.route.id?d[y.route.id]:void 0,x=y.route.errorElement||Y1,u&&(f<0&&S===0?(ob("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),_=!0,k=null):f===S&&(_=!0,k=y.route.hydrateFallbackElement||null)));let R=e.concat(l.slice(0,S+1)),O=()=>{let L;return C?L=x:_?L=k:y.route.Component?L=M.createElement(y.route.Component,null):y.route.element?L=y.route.element:L=v,M.createElement(Q1,{match:y,routeContext:{outlet:v,matches:R,isDataRoute:i!=null},children:L})};return i&&(y.route.ErrorBoundary||y.route.errorElement||S===0)?M.createElement(rb,{location:i.location,revalidation:i.revalidation,component:x,error:C,children:O(),routeContext:{outlet:null,matches:R,isDataRoute:!0},onError:p}):O()},null)}function Qh(a){return`${a} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function X1(a){let e=M.useContext(Ps);return nt(e,Qh(a)),e}function Z1(a){let e=M.useContext(lc);return nt(e,Qh(a)),e}function $1(a){let e=M.useContext(Hn);return nt(e,Qh(a)),e}function Wh(a){let e=$1(a),i=e.matches[e.matches.length-1];return nt(i.route.id,`${a} can only be used on routes that contain a unique "id"`),i.route.id}function ex(){return Wh("useRouteId")}function tx(){let a=M.useContext(Jh),e=Z1("useRouteError"),i=Wh("useRouteError");return a!==void 0?a:e.errors?.[i]}function nx(){let{router:a}=X1("useNavigate"),e=Wh("useNavigate"),i=M.useRef(!1);return ab(()=>{i.current=!0}),M.useCallback(async(o,l={})=>{Dn(i.current,ib),i.current&&(typeof o=="number"?await a.navigate(o):await a.navigate(o,{fromRouteId:e,...l}))},[a,e])}var Kv={};function ob(a,e,i){!e&&!Kv[a]&&(Kv[a]=!0,Dn(!1,i))}M.memo(ix);function ix({routes:a,future:e,state:i,onError:s}){return sb(a,void 0,i,s,e)}function sn(a){nt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function ax({basename:a="/",children:e=null,location:i,navigationType:s="POP",navigator:o,static:l=!1,unstable_useTransitions:d}){nt(!no(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let u=a.replace(/^\/*/,"/"),f=M.useMemo(()=>({basename:u,navigator:o,static:l,unstable_useTransitions:d,future:{}}),[u,o,l,d]);typeof i=="string"&&(i=js(i));let{pathname:p="/",search:v="",hash:y="",state:S=null,key:C="default"}=i,_=M.useMemo(()=>{let x=vi(p,u);return x==null?null:{location:{pathname:x,search:v,hash:y,state:S,key:C},navigationType:s}},[u,p,v,y,S,C,s]);return Dn(_!=null,`<Router basename="${u}"> is not able to match the URL "${p}${v}${y}" because it does not start with the basename, so the <Router> won't render anything.`),_==null?null:M.createElement(Tn.Provider,{value:f},M.createElement(to.Provider,{children:e,value:_}))}function sx({children:a,location:e}){return G1(ph(a),e)}function ph(a,e=[]){let i=[];return M.Children.forEach(a,(s,o)=>{if(!M.isValidElement(s))return;let l=[...e,o];if(s.type===M.Fragment){i.push.apply(i,ph(s.props.children,l));return}nt(s.type===sn,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),nt(!s.props.index||!s.props.children,"An index route cannot have child routes.");let d={id:s.props.id||l.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,middleware:s.props.middleware,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(d.children=ph(s.props.children,l)),i.push(d)}),i}var _l="get",Rl="application/x-www-form-urlencoded";function cc(a){return typeof HTMLElement<"u"&&a instanceof HTMLElement}function rx(a){return cc(a)&&a.tagName.toLowerCase()==="button"}function ox(a){return cc(a)&&a.tagName.toLowerCase()==="form"}function lx(a){return cc(a)&&a.tagName.toLowerCase()==="input"}function cx(a){return!!(a.metaKey||a.altKey||a.ctrlKey||a.shiftKey)}function ux(a,e){return a.button===0&&(!e||e==="_self")&&!cx(a)}function gh(a=""){return new URLSearchParams(typeof a=="string"||Array.isArray(a)||a instanceof URLSearchParams?a:Object.keys(a).reduce((e,i)=>{let s=a[i];return e.concat(Array.isArray(s)?s.map(o=>[i,o]):[[i,s]])},[]))}function dx(a,e){let i=gh(a);return e&&e.forEach((s,o)=>{i.has(o)||e.getAll(o).forEach(l=>{i.append(o,l)})}),i}var kl=null;function hx(){if(kl===null)try{new FormData(document.createElement("form"),0),kl=!1}catch{kl=!0}return kl}var fx=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Kd(a){return a!=null&&!fx.has(a)?(Dn(!1,`"${a}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Rl}"`),null):a}function mx(a,e){let i,s,o,l,d;if(ox(a)){let u=a.getAttribute("action");s=u?vi(u,e):null,i=a.getAttribute("method")||_l,o=Kd(a.getAttribute("enctype"))||Rl,l=new FormData(a)}else if(rx(a)||lx(a)&&(a.type==="submit"||a.type==="image")){let u=a.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=a.getAttribute("formaction")||u.getAttribute("action");if(s=f?vi(f,e):null,i=a.getAttribute("formmethod")||u.getAttribute("method")||_l,o=Kd(a.getAttribute("formenctype"))||Kd(u.getAttribute("enctype"))||Rl,l=new FormData(u,a),!hx()){let{name:p,type:v,value:y}=a;if(v==="image"){let S=p?`${p}.`:"";l.append(`${S}x`,"0"),l.append(`${S}y`,"0")}else p&&l.append(p,y)}}else{if(cc(a))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');i=_l,s=null,o=Rl,d=a}return l&&o==="text/plain"&&(d=l,l=void 0),{action:s,method:i.toLowerCase(),encType:o,formData:l,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Xh(a,e){if(a===!1||a===null||typeof a>"u")throw new Error(e)}function px(a,e,i,s){let o=typeof a=="string"?new URL(a,typeof window>"u"?"server://singlefetch/":window.location.origin):a;return i?o.pathname.endsWith("/")?o.pathname=`${o.pathname}_.${s}`:o.pathname=`${o.pathname}.${s}`:o.pathname==="/"?o.pathname=`_root.${s}`:e&&vi(o.pathname,e)==="/"?o.pathname=`${e.replace(/\/$/,"")}/_root.${s}`:o.pathname=`${o.pathname.replace(/\/$/,"")}.${s}`,o}async function gx(a,e){if(a.id in e)return e[a.id];try{let i=await import(a.module);return e[a.id]=i,i}catch(i){return console.error(`Error loading route module \`${a.module}\`, reloading page...`),console.error(i),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function vx(a){return a==null?!1:a.href==null?a.rel==="preload"&&typeof a.imageSrcSet=="string"&&typeof a.imageSizes=="string":typeof a.rel=="string"&&typeof a.href=="string"}async function yx(a,e,i){let s=await Promise.all(a.map(async o=>{let l=e.routes[o.route.id];if(l){let d=await gx(l,i);return d.links?d.links():[]}return[]}));return Cx(s.flat(1).filter(vx).filter(o=>o.rel==="stylesheet"||o.rel==="preload").map(o=>o.rel==="stylesheet"?{...o,rel:"prefetch",as:"style"}:{...o,rel:"prefetch"}))}function Yv(a,e,i,s,o,l){let d=(f,p)=>i[p]?f.route.id!==i[p].route.id:!0,u=(f,p)=>i[p].pathname!==f.pathname||i[p].route.path?.endsWith("*")&&i[p].params["*"]!==f.params["*"];return l==="assets"?e.filter((f,p)=>d(f,p)||u(f,p)):l==="data"?e.filter((f,p)=>{let v=s.routes[f.route.id];if(!v||!v.hasLoader)return!1;if(d(f,p)||u(f,p))return!0;if(f.route.shouldRevalidate){let y=f.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:i[0]?.params||{},nextUrl:new URL(a,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof y=="boolean")return y}return!0}):[]}function bx(a,e,{includeHydrateFallback:i}={}){return Sx(a.map(s=>{let o=e.routes[s.route.id];if(!o)return[];let l=[o.module];return o.clientActionModule&&(l=l.concat(o.clientActionModule)),o.clientLoaderModule&&(l=l.concat(o.clientLoaderModule)),i&&o.hydrateFallbackModule&&(l=l.concat(o.hydrateFallbackModule)),o.imports&&(l=l.concat(o.imports)),l}).flat(1))}function Sx(a){return[...new Set(a)]}function Tx(a){let e={},i=Object.keys(a).sort();for(let s of i)e[s]=a[s];return e}function Cx(a,e){let i=new Set;return new Set(e),a.reduce((s,o)=>{let l=JSON.stringify(Tx(o));return i.has(l)||(i.add(l),s.push({key:l,link:o})),s},[])}function lb(){let a=M.useContext(Ps);return Xh(a,"You must render this element inside a <DataRouterContext.Provider> element"),a}function kx(){let a=M.useContext(lc);return Xh(a,"You must render this element inside a <DataRouterStateContext.Provider> element"),a}var Zh=M.createContext(void 0);Zh.displayName="FrameworkContext";function cb(){let a=M.useContext(Zh);return Xh(a,"You must render this element inside a <HydratedRouter> element"),a}function xx(a,e){let i=M.useContext(Zh),[s,o]=M.useState(!1),[l,d]=M.useState(!1),{onFocus:u,onBlur:f,onMouseEnter:p,onMouseLeave:v,onTouchStart:y}=e,S=M.useRef(null);M.useEffect(()=>{if(a==="render"&&d(!0),a==="viewport"){let x=R=>{R.forEach(O=>{d(O.isIntersecting)})},k=new IntersectionObserver(x,{threshold:.5});return S.current&&k.observe(S.current),()=>{k.disconnect()}}},[a]),M.useEffect(()=>{if(s){let x=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(x)}}},[s]);let C=()=>{o(!0)},_=()=>{o(!1),d(!1)};return i?a!=="intent"?[l,S,{}]:[l,S,{onFocus:Mr(u,C),onBlur:Mr(f,_),onMouseEnter:Mr(p,C),onMouseLeave:Mr(v,_),onTouchStart:Mr(y,C)}]:[!1,S,{}]}function Mr(a,e){return i=>{a&&a(i),i.defaultPrevented||e(i)}}function Ex({page:a,...e}){let{router:i}=lb(),s=M.useMemo(()=>Y0(i.routes,a,i.basename),[i.routes,a,i.basename]);return s?M.createElement(_x,{page:a,matches:s,...e}):null}function wx(a){let{manifest:e,routeModules:i}=cb(),[s,o]=M.useState([]);return M.useEffect(()=>{let l=!1;return yx(a,e,i).then(d=>{l||o(d)}),()=>{l=!0}},[a,e,i]),s}function _x({page:a,matches:e,...i}){let s=ea(),{future:o,manifest:l,routeModules:d}=cb(),{basename:u}=lb(),{loaderData:f,matches:p}=kx(),v=M.useMemo(()=>Yv(a,e,p,l,s,"data"),[a,e,p,l,s]),y=M.useMemo(()=>Yv(a,e,p,l,s,"assets"),[a,e,p,l,s]),S=M.useMemo(()=>{if(a===s.pathname+s.search+s.hash)return[];let x=new Set,k=!1;if(e.forEach(O=>{let L=l.routes[O.route.id];!L||!L.hasLoader||(!v.some(D=>D.route.id===O.route.id)&&O.route.id in f&&d[O.route.id]?.shouldRevalidate||L.hasClientLoader?k=!0:x.add(O.route.id))}),x.size===0)return[];let R=px(a,u,o.unstable_trailingSlashAwareDataRequests,"data");return k&&x.size>0&&R.searchParams.set("_routes",e.filter(O=>x.has(O.route.id)).map(O=>O.route.id).join(",")),[R.pathname+R.search]},[u,o.unstable_trailingSlashAwareDataRequests,f,s,l,v,e,a,d]),C=M.useMemo(()=>bx(y,l),[y,l]),_=wx(y);return M.createElement(M.Fragment,null,S.map(x=>M.createElement("link",{key:x,rel:"prefetch",as:"fetch",href:x,...i})),C.map(x=>M.createElement("link",{key:x,rel:"modulepreload",href:x,...i})),_.map(({key:x,link:k})=>M.createElement("link",{key:x,nonce:i.nonce,...k,crossOrigin:k.crossOrigin??i.crossOrigin})))}function Rx(...a){return e=>{a.forEach(i=>{typeof i=="function"?i(e):i!=null&&(i.current=e)})}}var Nx=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Nx&&(window.__reactRouterVersion="7.13.0")}catch{}function Ax({basename:a,children:e,unstable_useTransitions:i,window:s}){let o=M.useRef();o.current==null&&(o.current=l1({window:s,v5Compat:!0}));let l=o.current,[d,u]=M.useState({action:l.action,location:l.location}),f=M.useCallback(p=>{i===!1?u(p):M.startTransition(()=>u(p))},[i]);return M.useLayoutEffect(()=>l.listen(f),[l,f]),M.createElement(ax,{basename:a,children:e,location:d.location,navigationType:d.action,navigator:l,unstable_useTransitions:i})}var ub=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Te=M.forwardRef(function({onClick:e,discover:i="render",prefetch:s="none",relative:o,reloadDocument:l,replace:d,state:u,target:f,to:p,preventScrollReset:v,viewTransition:y,unstable_defaultShouldRevalidate:S,...C},_){let{basename:x,unstable_useTransitions:k}=M.useContext(Tn),R=typeof p=="string"&&ub.test(p),O=$0(p,x);p=O.to;let L=z1(p,{relative:o}),[D,I,j]=xx(s,C),H=jx(p,{replace:d,state:u,target:f,preventScrollReset:v,relative:o,viewTransition:y,unstable_defaultShouldRevalidate:S,unstable_useTransitions:k});function Z(te){e&&e(te),te.defaultPrevented||H(te)}let ee=M.createElement("a",{...C,...j,href:O.absoluteURL||L,onClick:O.isExternal||l?e:Z,ref:Rx(_,I),target:f,"data-discover":!R&&i==="render"?"true":void 0});return D&&!R?M.createElement(M.Fragment,null,ee,M.createElement(Ex,{page:L})):ee});Te.displayName="Link";var Mx=M.forwardRef(function({"aria-current":e="page",caseSensitive:i=!1,className:s="",end:o=!1,style:l,to:d,viewTransition:u,children:f,...p},v){let y=io(d,{relative:p.relative}),S=ea(),C=M.useContext(lc),{navigator:_,basename:x}=M.useContext(Tn),k=C!=null&&qx(y)&&u===!0,R=_.encodeLocation?_.encodeLocation(y).pathname:y.pathname,O=S.pathname,L=C&&C.navigation&&C.navigation.location?C.navigation.location.pathname:null;i||(O=O.toLowerCase(),L=L?L.toLowerCase():null,R=R.toLowerCase()),L&&x&&(L=vi(L,x)||L);const D=R!=="/"&&R.endsWith("/")?R.length-1:R.length;let I=O===R||!o&&O.startsWith(R)&&O.charAt(D)==="/",j=L!=null&&(L===R||!o&&L.startsWith(R)&&L.charAt(R.length)==="/"),H={isActive:I,isPending:j,isTransitioning:k},Z=I?e:void 0,ee;typeof s=="function"?ee=s(H):ee=[s,I?"active":null,j?"pending":null,k?"transitioning":null].filter(Boolean).join(" ");let te=typeof l=="function"?l(H):l;return M.createElement(Te,{...p,"aria-current":Z,className:ee,ref:v,style:te,to:d,viewTransition:u},typeof f=="function"?f(H):f)});Mx.displayName="NavLink";var Dx=M.forwardRef(({discover:a="render",fetcherKey:e,navigate:i,reloadDocument:s,replace:o,state:l,method:d=_l,action:u,onSubmit:f,relative:p,preventScrollReset:v,viewTransition:y,unstable_defaultShouldRevalidate:S,...C},_)=>{let{unstable_useTransitions:x}=M.useContext(Tn),k=Ux(),R=Bx(u,{relative:p}),O=d.toLowerCase()==="get"?"get":"post",L=typeof u=="string"&&ub.test(u),D=I=>{if(f&&f(I),I.defaultPrevented)return;I.preventDefault();let j=I.nativeEvent.submitter,H=j?.getAttribute("formmethod")||d,Z=()=>k(j||I.currentTarget,{fetcherKey:e,method:H,navigate:i,replace:o,state:l,relative:p,preventScrollReset:v,viewTransition:y,unstable_defaultShouldRevalidate:S});x&&i!==!1?M.startTransition(()=>Z()):Z()};return M.createElement("form",{ref:_,method:O,action:R,onSubmit:s?f:D,...C,"data-discover":!L&&a==="render"?"true":void 0})});Dx.displayName="Form";function Ox(a){return`${a} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function db(a){let e=M.useContext(Ps);return nt(e,Ox(a)),e}function jx(a,{target:e,replace:i,state:s,preventScrollReset:o,relative:l,viewTransition:d,unstable_defaultShouldRevalidate:u,unstable_useTransitions:f}={}){let p=Ma(),v=ea(),y=io(a,{relative:l});return M.useCallback(S=>{if(ux(S,e)){S.preventDefault();let C=i!==void 0?i:Kr(v)===Kr(y),_=()=>p(a,{replace:C,state:s,preventScrollReset:o,relative:l,viewTransition:d,unstable_defaultShouldRevalidate:u});f?M.startTransition(()=>_()):_()}},[v,p,y,i,s,e,a,o,l,d,u,f])}function Px(a){Dn(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=M.useRef(gh(a)),i=M.useRef(!1),s=ea(),o=M.useMemo(()=>dx(s.search,i.current?null:e.current),[s.search]),l=Ma(),d=M.useCallback((u,f)=>{const p=gh(typeof u=="function"?u(new URLSearchParams(o)):u);i.current=!0,l("?"+p,f)},[l,o]);return[o,d]}var Ix=0,Lx=()=>`__${String(++Ix)}__`;function Ux(){let{router:a}=db("useSubmit"),{basename:e}=M.useContext(Tn),i=ex(),s=a.fetch,o=a.navigate;return M.useCallback(async(l,d={})=>{let{action:u,method:f,encType:p,formData:v,body:y}=mx(l,e);if(d.navigate===!1){let S=d.fetcherKey||Lx();await s(S,i,d.action||u,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:v,body:y,formMethod:d.method||f,formEncType:d.encType||p,flushSync:d.flushSync})}else await o(d.action||u,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:v,body:y,formMethod:d.method||f,formEncType:d.encType||p,replace:d.replace,state:d.state,fromRouteId:i,flushSync:d.flushSync,viewTransition:d.viewTransition})},[s,o,e,i])}function Bx(a,{relative:e}={}){let{basename:i}=M.useContext(Tn),s=M.useContext(Hn);nt(s,"useFormAction must be used inside a RouteContext");let[o]=s.matches.slice(-1),l={...io(a||".",{relative:e})},d=ea();if(a==null){l.search=d.search;let u=new URLSearchParams(l.search),f=u.getAll("index");if(f.some(v=>v==="")){u.delete("index"),f.filter(y=>y).forEach(y=>u.append("index",y));let v=u.toString();l.search=v?`?${v}`:""}}return(!a||a===".")&&o.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),i!=="/"&&(l.pathname=l.pathname==="/"?i:gi([i,l.pathname])),Kr(l)}function qx(a,{relative:e}={}){let i=M.useContext(tb);nt(i!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=db("useViewTransitionState"),o=io(a,{relative:e});if(!i.isTransitioning)return!1;let l=vi(i.currentLocation.pathname,s)||i.currentLocation.pathname,d=vi(i.nextLocation.pathname,s)||i.nextLocation.pathname;return Vl(o.pathname,d)!=null||Vl(o.pathname,l)!=null}const Fx=(a,e)=>{switch(e.type){case"ADD_ITEM":{const i=a.items.findIndex(s=>s.id===e.payload.id&&s.pack===e.payload.pack);if(i>=0){const s=[...a.items];return s[i]={...s[i],quantity:s[i].quantity+e.payload.quantity},{...a,items:s,isOpen:!0}}return{...a,items:[...a.items,e.payload],isOpen:!0}}case"REMOVE_ITEM":return{...a,items:a.items.filter(i=>!(i.id===e.payload.id&&i.pack===e.payload.pack))};case"UPDATE_QUANTITY":return e.payload.quantity<=0?{...a,items:a.items.filter(i=>!(i.id===e.payload.id&&i.pack===e.payload.pack))}:{...a,items:a.items.map(i=>i.id===e.payload.id&&i.pack===e.payload.pack?{...i,quantity:e.payload.quantity}:i)};case"CLEAR_CART":return{...a,items:[]};case"TOGGLE_CART":return{...a,isOpen:!a.isOpen};case"OPEN_CART":return{...a,isOpen:!0};case"CLOSE_CART":return{...a,isOpen:!1};default:return a}},hb=M.createContext(null),zx=()=>{try{const a=localStorage.getItem("ammafoods_cart");if(a)return{items:JSON.parse(a),isOpen:!1}}catch{}return{items:[],isOpen:!1}},Hx=({children:a})=>{const[e,i]=M.useReducer(Fx,zx());M.useEffect(()=>{localStorage.setItem("ammafoods_cart",JSON.stringify(e.items))},[e.items]);const s=e.items.reduce((d,u)=>d+u.quantity,0),o=e.items.reduce((d,u)=>d+u.price*u.quantity,0),l=e.items.reduce((d,u)=>d+(u.originalPrice-u.price)*u.quantity,0);return h.jsx(hb.Provider,{value:{state:e,addToCart:d=>i({type:"ADD_ITEM",payload:d}),removeFromCart:(d,u)=>i({type:"REMOVE_ITEM",payload:{id:d,pack:u}}),updateQuantity:(d,u,f)=>i({type:"UPDATE_QUANTITY",payload:{id:d,pack:u,quantity:f}}),clearCart:()=>i({type:"CLEAR_CART"}),toggleCart:()=>i({type:"TOGGLE_CART"}),openCart:()=>i({type:"OPEN_CART"}),closeCart:()=>i({type:"CLOSE_CART"}),cartCount:s,cartTotal:o,cartSavings:l},children:a})},Da=()=>{const a=M.useContext(hb);if(!a)throw new Error("useCart must be used within CartProvider");return a},Jv=[" FREE Delivery on all orders across India"," Flat 12% OFF on your first order"," Buy 2 Get 1 FREE on selected combos"," 100% Natural & Authentic Ayurvedic Products"," Cash on Delivery (COD) Available PAN-India"," Trusted by 5 Lakh+ Happy Customers"," Up to 25% OFF on Super Saver Combos"," Free shipping on orders above 499"],Vx=()=>{const a=[...Jv,...Jv];return h.jsx("div",{className:"promo-bar",children:h.jsx("div",{className:"promo-track",children:a.map((e,i)=>h.jsxs("span",{className:"promo-item",children:[e," ",h.jsx("span",{className:"promo-dot",children:""})]},i))})})};const fb=(...a)=>a.filter((e,i,s)=>!!e&&e.trim()!==""&&s.indexOf(e)===i).join(" ").trim();const Gx=a=>a.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();const Kx=a=>a.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,i,s)=>s?s.toUpperCase():i.toLowerCase());const Qv=a=>{const e=Kx(a);return e.charAt(0).toUpperCase()+e.slice(1)};var Yx={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Jx=a=>{for(const e in a)if(e.startsWith("aria-")||e==="role"||e==="title")return!0;return!1};const Qx=M.forwardRef(({color:a="currentColor",size:e=24,strokeWidth:i=2,absoluteStrokeWidth:s,className:o="",children:l,iconNode:d,...u},f)=>M.createElement("svg",{ref:f,...Yx,width:e,height:e,stroke:a,strokeWidth:s?Number(i)*24/Number(e):i,className:fb("lucide",o),...!l&&!Jx(u)&&{"aria-hidden":"true"},...u},[...d.map(([p,v])=>M.createElement(p,v)),...Array.isArray(l)?l:[l]]));const Ae=(a,e)=>{const i=M.forwardRef(({className:s,...o},l)=>M.createElement(Qx,{ref:l,iconNode:e,className:fb(`lucide-${Gx(Qv(a))}`,`lucide-${a}`,s),...o}));return i.displayName=Qv(a),i};const Wx=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],Xx=Ae("briefcase",Wx);const Zx=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],mb=Ae("check",Zx);const $x=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Gl=Ae("chevron-down",$x);const eE=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Nl=Ae("chevron-left",eE);const tE=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Al=Ae("chevron-right",tE);const nE=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],iE=Ae("ellipsis",nE);const aE=[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]],sE=Ae("facebook",aE);const rE=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],oE=Ae("funnel",rE);const lE=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],cE=Ae("house",lE);const uE=[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]],dE=Ae("instagram",uE);const hE=[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]],fE=Ae("leaf",hE);const mE=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],pb=Ae("mail",mE);const pE=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],gb=Ae("map-pin",pE);const gE=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],vE=Ae("menu",gE);const yE=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]],Wv=Ae("mic",yE);const bE=[["path",{d:"M5 12h14",key:"1ays0h"}]],vb=Ae("minus",bE);const SE=[["path",{d:"M10.1 13.9a14 14 0 0 0 3.732 2.668 1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2 18 18 0 0 1-12.728-5.272",key:"1wngk7"}],["path",{d:"M22 2 2 22",key:"y4kqgn"}],["path",{d:"M4.76 13.582A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 .244.473",key:"10hv5p"}]],TE=Ae("phone-off",SE);const CE=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],yb=Ae("phone",CE);const kE=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],bb=Ae("plus",kE);const xE=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Sb=Ae("refresh-cw",xE);const EE=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],vh=Ae("search",EE);const wE=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],_E=Ae("shield-check",wE);const RE=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],NE=Ae("shield",RE);const AE=[["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}],["path",{d:"M3.103 6.034h17.794",key:"awc11p"}],["path",{d:"M3.4 5.467a2 2 0 0 0-.4 1.2V20a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6.667a2 2 0 0 0-.4-1.2l-2-2.667A2 2 0 0 0 17 2H7a2 2 0 0 0-1.6.8z",key:"o988cm"}]],ME=Ae("shopping-bag",AE);const DE=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],$h=Ae("shopping-cart",DE);const OE=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Kl=Ae("star",OE);const jE=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],PE=Ae("trash-2",jE);const IE=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],Yl=Ae("truck",IE);const LE=[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]],UE=Ae("twitter",LE);const BE=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],qE=Ae("user",BE);const FE=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],zE=Ae("users",FE);const HE=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],VE=Ae("volume-2",HE);const GE=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],uc=Ae("x",GE);const KE=[["path",{d:"M2.5 17a24.12 24.12 0 0 1 0-10 2 2 0 0 1 1.4-1.4 49.56 49.56 0 0 1 16.2 0A2 2 0 0 1 21.5 7a24.12 24.12 0 0 1 0 10 2 2 0 0 1-1.4 1.4 49.55 49.55 0 0 1-16.2 0A2 2 0 0 1 2.5 17",key:"1q2vi4"}],["path",{d:"m10 15 5-3-5-3z",key:"1jp15x"}]],YE=Ae("youtube",KE),JE=[{icon:"",name:"Herbal Supplements",sub:["Single Herb","Multi-Herb","Condition Specific"],cat:"Herbal Supplements"},{icon:"",name:"Organic Foods",sub:["Pulses & Dals","Salt & Spices","Oats & Quinoa"],cat:"Organic Foods"},{icon:"",name:"Teas & Infusions",sub:["Green Teas","Herbal Infusions","Black Tea","Detox Teas"],cat:"Teas & Infusions"},{icon:"",name:"Detox Programs",sub:["Kits","Shakes","Colon Cleanse"],cat:"Detox Programs"},{icon:"",name:"Sugar Alternatives",sub:["Honey","Jaggery","Stevia","Khandsari Sugar"],cat:"Sugar Alternatives"},{icon:"",name:"Oils & Ghee",sub:["Cow Ghee","Cold Pressed Oils"],cat:"Oils & Ghee"},{icon:"",name:"Coffee",sub:["Filter Coffee","Herbal Coffee","Cold Brew"],cat:"Coffee"},{icon:"",name:"Gift Boxes",sub:["Wellness Kits","Festival Combos"],cat:"Gift Boxes"},{icon:"",name:"Gym Diet",sub:["Plant Proteins","Fitness Supplements","Energy Foods"],cat:"Gym Diet",isNew:!0}],QE=()=>h.jsx("div",{className:"mega-menu",children:h.jsx("div",{className:"container mega-inner",children:h.jsx("div",{className:"mega-grid",children:JE.map(a=>h.jsxs("div",{className:"mega-cat",children:[h.jsxs(Te,{to:`/products?category=${encodeURIComponent(a.cat)}`,className:"mega-cat-title",children:[h.jsx("span",{className:"mega-cat-icon",children:a.icon}),a.name,a.isNew&&h.jsx("span",{className:"mega-new-badge",children:"NEW"})]}),h.jsx("ul",{className:"mega-sub-list",children:a.sub.map(e=>h.jsx("li",{children:h.jsx(Te,{to:`/products?category=${encodeURIComponent(a.cat)}&sub=${encodeURIComponent(e)}`,children:e})},e))})]},a.name))})})}),WE=[{group:" Gut Care",items:["Bloating / Gas / Indigestion","Constipation","IBS / IBD","Colon Cleansing","Gut Cleansing"]},{group:" Liver / Kidney",items:["Liver Support","Kidney Care","Detox"]},{group:" Immunity Care",items:["Cough / Cold","Respiratory Care","Nasal Congestion","Pollution Care"]},{group:" Heart Care",items:["Cholesterol","Triglycerides","Hypertension","Palpitations"]},{group:" Nutrition",items:["Anaemia","Plant Proteins","Healthy Cooking Medium","Healthy Sweeteners"]},{group:" Joint Care",items:["Arthritis / Joint Pain","Muscle Care"]},{group:" Quick Links",items:["Men's Health","Women's Health","Sleep Care","Metabolism Care"]}],XE=()=>h.jsx("div",{className:"mega-menu",children:h.jsx("div",{className:"container mega-inner",children:h.jsx("div",{className:"mega-grid mega-grid-cond",children:WE.map(a=>h.jsxs("div",{className:"mega-cat",children:[h.jsx("div",{className:"mega-cat-title mega-cat-group",children:a.group}),h.jsx("ul",{className:"mega-sub-list",children:a.items.map(e=>h.jsx("li",{children:h.jsx(Te,{to:`/products?condition=${encodeURIComponent(e)}`,children:e})},e))})]},a.group))})})}),ZE=[{name:"Active Start Combo",img:"https://images.unsplash.com/photo-1622979135225-d2ba269cf1ac?w=200&q=80",off:"20% OFF",id:"p6"},{name:"Calm & Balance Combo",img:"https://images.unsplash.com/photo-1611694300810-c1c3e84bc3f8?w=200&q=80",off:"21% OFF",id:"p7"},{name:"Gut Reset Combo",img:"https://images.unsplash.com/photo-1512621776951-a57141f2eefd?w=200&q=80",off:"22% OFF",id:"p8"},{name:"Wellness Starter Pack",img:"https://images.unsplash.com/photo-1576678927484-cc907957088c?w=200&q=80",off:"25% OFF",id:"p9"},{name:"Clean 7 Days Kit",img:"https://images.unsplash.com/photo-1547592180-85f173990554?w=200&q=80",off:"20% OFF",id:"p10"}],$E=()=>h.jsx("div",{className:"mega-menu",children:h.jsxs("div",{className:"container mega-inner",children:[h.jsxs("div",{className:"combo-header",children:[h.jsx("h3",{children:" Super Saver Combos"}),h.jsx("p",{children:"Curated wellness bundles at unbeatable prices"})]}),h.jsx("div",{className:"combo-grid",children:ZE.map(a=>h.jsxs(Te,{to:`/product/${a.id}`,className:"combo-card",children:[h.jsxs("div",{className:"combo-img-wrap",children:[h.jsx("img",{src:a.img,alt:a.name}),h.jsx("span",{className:"combo-badge",children:a.off})]}),h.jsx("span",{className:"combo-name",children:a.name})]},a.id))}),h.jsx(Te,{to:"/products?category=Super+Saver+Combos",className:"view-all-link",children:"View All Combos "})]})}),ew=[{icon:"",label:"Energy & Stamina",goal:"Energy",color:"#ff6b35"},{icon:"",label:"Calm & Stress Relief",goal:"Calm",color:"#7b68ee"},{icon:"",label:"Digestion & Gut",goal:"Digestion",color:"#2e7d32"},{icon:"",label:"Immunity Boost",goal:"Immunity",color:"#e65100"},{icon:"",label:"Detox & Cleanse",goal:"Detox",color:"#00838f"},{icon:"",label:"Gym & Fitness",goal:"Fitness",color:"#1565c0"},{icon:"",label:"Sleep Support",goal:"Sleep",color:"#4a148c"},{icon:"",label:"Weight Management",goal:"Weight",color:"#bf360c"},{icon:"",label:"Overall Wellness",goal:"Wellness",color:"#558b2f"}],tw=()=>h.jsx("div",{className:"mega-menu",children:h.jsx("div",{className:"container mega-inner",children:h.jsx("div",{className:"goals-grid",children:ew.map(a=>h.jsxs(Te,{to:`/products?goal=${encodeURIComponent(a.goal)}`,className:"goal-tile",children:[h.jsx("div",{className:"goal-icon",style:{background:`${a.color}18`,color:a.color},children:a.icon}),h.jsx("span",{className:"goal-label",children:a.label})]},a.goal))})})}),Tb="/assets/amma_foods_logo-C7dseYIW.jpg",Xv=[{label:"Shop By Category",menu:"category"},{label:"Shop By Condition",menu:"condition"},{label:"Super Saver Combos",menu:"combos"},{label:"Shop By Goal",menu:"goal"}],nw=()=>{const{cartCount:a,toggleCart:e}=Da(),[i,s]=M.useState(null),[o,l]=M.useState(!1),[d,u]=M.useState(!1),[f,p]=M.useState(""),[v,y]=M.useState(!1),S=Ma(),C=M.useRef(null),_=M.useRef(null);M.useEffect(()=>{const L=()=>u(window.scrollY>10);return window.addEventListener("scroll",L),()=>window.removeEventListener("scroll",L)},[]);const x=L=>{_.current!==null&&clearTimeout(_.current),s(L)},k=()=>{_.current=window.setTimeout(()=>s(null),150)},R=L=>{L.preventDefault(),f.trim()&&S(`/products?q=${encodeURIComponent(f.trim())}`)},O=()=>{if(!i)return null;switch(i){case"category":return h.jsx(QE,{});case"condition":return h.jsx(XE,{});case"combos":return h.jsx($E,{});case"goal":return h.jsx(tw,{});default:return null}};return h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:`header-wrapper ${d?"scrolled":""}`,ref:C,children:[h.jsx("header",{className:"main-header",children:h.jsxs("div",{className:"container header-inner",children:[h.jsxs(Te,{to:"/",className:"logo",children:[h.jsx("div",{className:"logo-icon",children:h.jsx("img",{src:Tb,alt:"AmmaFoods Logo",style:{width:"48px",height:"48px",objectFit:"contain",borderRadius:"50%"}})}),h.jsxs("div",{className:"logo-text",children:[h.jsx("span",{className:"logo-name",children:"AmmaFoods"}),h.jsx("span",{className:"logo-tag",children:"Herbal  Healthy  Tasty"})]})]}),h.jsxs("form",{className:"search-form hide-mobile",onSubmit:R,children:[h.jsx("input",{type:"text",placeholder:"Search herbs, supplements, teas...",value:f,onChange:L=>p(L.target.value),className:"search-input"}),h.jsx("button",{type:"submit",className:"search-btn",children:h.jsx(vh,{size:18})})]}),h.jsxs("div",{className:"header-actions",children:[h.jsxs("div",{className:"action-icon delivery-icon hide-mobile",onMouseEnter:()=>y(!0),onMouseLeave:()=>y(!1),children:[h.jsx(Yl,{size:22}),v&&h.jsxs("div",{className:"delivery-tooltip",children:[h.jsx("strong",{children:"Free PAN-India Delivery"}),h.jsx("span",{children:"On orders above 499"}),h.jsx("span",{children:"COD Available"})]})]}),h.jsxs("button",{className:"action-icon cart-btn",onClick:e,"aria-label":"Open cart",children:[h.jsx($h,{size:22}),a>0&&h.jsx("span",{className:"cart-badge",children:a})]}),h.jsx("button",{className:"hamburger hide-desktop",onClick:()=>l(!o),"aria-label":"Toggle menu",children:o?h.jsx(uc,{size:24}):h.jsx(vE,{size:24})})]})]})}),h.jsx("nav",{className:"primary-nav hide-mobile",children:h.jsxs("div",{className:"container nav-inner",children:[Xv.map(L=>h.jsxs("div",{className:`nav-item ${i===L.menu?"active":""}`,onMouseEnter:()=>x(L.menu),onMouseLeave:k,children:[h.jsxs("span",{className:"nav-label",children:[L.label,h.jsx(Gl,{size:14,className:"nav-chevron"})]}),i===L.menu&&h.jsx("div",{className:"mega-menu-wrapper",onMouseEnter:()=>x(L.menu),onMouseLeave:k,children:O()})]},L.menu)),h.jsx(Te,{to:"/products",className:"nav-item nav-link-plain",children:"All Products"}),h.jsx(Te,{to:"/products?tag=bestseller",className:"nav-item nav-link-plain nav-highlight",children:" Best Sellers"}),h.jsx(Te,{to:"/maruthompal",className:"nav-item nav-link-plain nav-maruthompal",children:" Maruthompal"})]})})]}),o&&h.jsxs("div",{className:"mobile-menu",children:[h.jsxs("form",{className:"search-form mobile-search",onSubmit:R,children:[h.jsx("input",{type:"text",placeholder:"Search products...",value:f,onChange:L=>p(L.target.value),className:"search-input"}),h.jsx("button",{type:"submit",className:"search-btn",children:h.jsx(vh,{size:18})})]}),Xv.map(L=>h.jsx("div",{className:"mobile-nav-item",children:h.jsxs("button",{className:"mobile-nav-btn",onClick:()=>s(i===L.menu?null:L.menu),children:[L.label,h.jsx(Gl,{size:14,style:{transform:i===L.menu?"rotate(180deg)":"none",transition:"0.2s"}})]})},L.menu)),h.jsx(Te,{to:"/products",className:"mobile-nav-link",onClick:()=>l(!1),children:"All Products"}),h.jsx(Te,{to:"/products?tag=bestseller",className:"mobile-nav-link",onClick:()=>l(!1),children:"Best Sellers"}),h.jsx(Te,{to:"/maruthompal",className:"mobile-nav-link mobile-maruthompal",onClick:()=>l(!1),children:" Maruthompal"})]})]})},iw=()=>{const{state:a,closeCart:e,removeFromCart:i,updateQuantity:s,cartTotal:o,cartSavings:l}=Da(),d=Ma();if(!a.isOpen)return null;const u=()=>{e(),d("/checkout")};return h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"overlay",onClick:e}),h.jsxs("div",{className:"cart-drawer",children:[h.jsxs("div",{className:"cart-header",children:[h.jsxs("div",{className:"cart-title",children:[h.jsx(ME,{size:20}),h.jsx("span",{children:"My Cart"}),a.items.length>0&&h.jsx("span",{className:"cart-count-badge",children:a.items.reduce((f,p)=>f+p.quantity,0)})]}),h.jsx("button",{className:"cart-close",onClick:e,"aria-label":"Close cart",children:h.jsx(uc,{size:20})})]}),a.items.length===0?h.jsxs("div",{className:"cart-empty",children:[h.jsx("div",{className:"empty-icon",children:""}),h.jsx("h3",{children:"Your cart is empty"}),h.jsx("p",{children:"Add some healthy products to get started!"}),h.jsx("button",{className:"btn btn-primary",onClick:()=>{e(),d("/products")},children:"Shop Now"})]}):h.jsxs(h.Fragment,{children:[l>0&&h.jsxs("div",{className:"savings-banner",children:[" You're saving ",h.jsxs("strong",{children:["",l.toLocaleString()]})," on this order!"]}),h.jsx("div",{className:"cart-items",children:a.items.map(f=>h.jsxs("div",{className:"cart-item",children:[h.jsx(Te,{to:`/product/${f.id}`,onClick:e,className:"cart-item-img",children:h.jsx("img",{src:f.image,alt:f.name})}),h.jsxs("div",{className:"cart-item-info",children:[h.jsx(Te,{to:`/product/${f.id}`,onClick:e,className:"cart-item-name",children:f.name}),h.jsx("span",{className:"cart-item-pack",children:f.pack}),h.jsxs("div",{className:"cart-item-price",children:[h.jsxs("span",{className:"price-current",children:["",f.price]}),h.jsxs("span",{className:"price-original",children:["",f.originalPrice]})]}),h.jsxs("div",{className:"cart-item-actions",children:[h.jsxs("div",{className:"qty-ctrl",children:[h.jsx("button",{onClick:()=>s(f.id,f.pack,f.quantity-1),"aria-label":"Decrease",children:h.jsx(vb,{size:12})}),h.jsx("span",{children:f.quantity}),h.jsx("button",{onClick:()=>s(f.id,f.pack,f.quantity+1),"aria-label":"Increase",children:h.jsx(bb,{size:12})})]}),h.jsxs("span",{className:"item-subtotal",children:["",(f.price*f.quantity).toLocaleString()]}),h.jsx("button",{className:"remove-btn",onClick:()=>i(f.id,f.pack),"aria-label":"Remove",children:h.jsx(PE,{size:14})})]})]})]},`${f.id}-${f.pack}`))}),h.jsxs("div",{className:"cart-footer",children:[h.jsxs("div",{className:"cart-summary",children:[h.jsxs("div",{className:"summary-row",children:[h.jsx("span",{children:"Subtotal"}),h.jsxs("span",{children:["",o.toLocaleString()]})]}),l>0&&h.jsxs("div",{className:"summary-row green",children:[h.jsx("span",{children:"Savings"}),h.jsxs("span",{children:["-",l.toLocaleString()]})]}),h.jsxs("div",{className:"summary-row",children:[h.jsx("span",{children:"Delivery"}),h.jsx("span",{className:"free-tag",children:o>=499?"FREE ":"49"})]}),h.jsxs("div",{className:"summary-row total",children:[h.jsx("span",{children:"Total"}),h.jsxs("span",{children:["",(o+(o>=499?0:49)).toLocaleString()]})]})]}),h.jsx("button",{className:"checkout-btn",onClick:u,children:"Proceed to Checkout "}),h.jsx("button",{className:"continue-btn",onClick:()=>{e(),d("/products")},children:"Continue Shopping"})]})]})]})]})},aw=()=>h.jsxs("footer",{className:"footer",children:[h.jsx("div",{className:"footer-top",children:h.jsxs("div",{className:"container footer-grid",children:[h.jsxs("div",{className:"footer-brand",children:[h.jsxs(Te,{to:"/",className:"footer-logo",children:[h.jsx("div",{className:"footer-logo-icon",children:h.jsx("img",{src:Tb,alt:"AmmaFoods",style:{width:"40px",height:"40px",objectFit:"contain",borderRadius:"50%"}})}),h.jsx("span",{children:"AmmaFoods"})]}),h.jsx("p",{children:"India's trusted source for premium herbal supplements, organic foods, and natural wellness products. 100% natural, lab-tested, and FSSAI certified."}),h.jsxs("div",{className:"footer-social",children:[h.jsx("a",{href:"#","aria-label":"Instagram",children:h.jsx(dE,{size:18})}),h.jsx("a",{href:"#","aria-label":"Facebook",children:h.jsx(sE,{size:18})}),h.jsx("a",{href:"#","aria-label":"YouTube",children:h.jsx(YE,{size:18})}),h.jsx("a",{href:"#","aria-label":"Twitter",children:h.jsx(UE,{size:18})})]})]}),h.jsxs("div",{className:"footer-col",children:[h.jsx("h4",{children:"Quick Links"}),h.jsx("ul",{children:[["/","Home"],["/products","All Products"],["/products?tag=bestseller","Best Sellers"],["/products?category=Super+Saver+Combos","Combos"],["/products?category=Detox+Programs","Detox Programs"]].map(([a,e])=>h.jsx("li",{children:h.jsx(Te,{to:a,children:e})},e))})]}),h.jsxs("div",{className:"footer-col",children:[h.jsx("h4",{children:"Categories"}),h.jsx("ul",{children:["Herbal Supplements","Teas & Infusions","Organic Foods","Oils & Ghee","Sugar Alternatives","Gym Diet"].map(a=>h.jsx("li",{children:h.jsx(Te,{to:`/products?category=${encodeURIComponent(a)}`,children:a})},a))})]}),h.jsxs("div",{className:"footer-col",children:[h.jsx("h4",{children:"Contact Us"}),h.jsxs("div",{className:"footer-contact",children:[h.jsxs("div",{className:"contact-item",children:[h.jsx(yb,{size:14})," ",h.jsx("span",{children:"+91 98765 43210"})]}),h.jsxs("div",{className:"contact-item",children:[h.jsx(pb,{size:14})," ",h.jsx("span",{children:"support@ammafoods.com.au"})]}),h.jsxs("div",{className:"contact-item",children:[h.jsx(gb,{size:14})," ",h.jsx("span",{children:"Mumbai, Maharashtra, India"})]})]}),h.jsxs("div",{className:"footer-trust",children:[h.jsx("span",{children:" FSSAI Certified"}),h.jsx("span",{children:" Lab Tested"}),h.jsx("span",{children:" ISO 9001"})]})]})]})}),h.jsx("div",{className:"footer-bottom",children:h.jsxs("div",{className:"container footer-bottom-inner",children:[h.jsx("span",{children:" 2026 AmmaFoods. All rights reserved."}),h.jsxs("div",{className:"footer-links",children:[h.jsx(Te,{to:"/privacy-policy",children:"Privacy Policy"}),h.jsx(Te,{to:"/terms-conditions",children:"Terms & Conditions"}),h.jsx(Te,{to:"/refund-policy",children:"Refund Policy"}),h.jsx(Te,{to:"/shipping-policy",children:"Shipping Policy"})]})]})})]}),Yr=({product:a})=>{const{addToCart:e}=Da(),[i,s]=M.useState(a.packs[0]),[o,l]=M.useState(!1),d=u=>{u.preventDefault(),e({id:a.id,name:a.name,price:a.price,originalPrice:a.originalPrice,image:a.image,quantity:1,pack:i,discount:a.discount}),l(!0),setTimeout(()=>l(!1),1800)};return h.jsxs("div",{className:"product-card",children:[h.jsx(Te,{to:`/product/${a.id}`,className:"card-img-link",children:h.jsxs("div",{className:"card-img-wrap",children:[h.jsx("img",{src:a.image,alt:a.name,loading:"lazy"}),a.discount>0&&h.jsxs("span",{className:"card-discount",children:[a.discount,"% OFF"]}),a.tag&&a.tag!==`${a.discount}% OFF`&&h.jsx("span",{className:"card-tag",children:a.tag})]})}),h.jsxs("div",{className:"card-body",children:[h.jsxs("div",{className:"card-rating",children:[h.jsx(Kl,{size:12,fill:"#f9a825",color:"#f9a825"}),h.jsx("span",{children:a.rating}),h.jsxs("span",{className:"rating-count",children:["(",a.reviews.toLocaleString(),")"]})]}),h.jsx(Te,{to:`/product/${a.id}`,className:"card-name",children:a.name}),h.jsxs("div",{className:"card-price",children:[h.jsxs("span",{className:"price-now",children:["",a.price]}),h.jsxs("span",{className:"price-was",children:["",a.originalPrice]}),h.jsxs("span",{className:"price-save",children:["Save ",a.originalPrice-a.price]})]}),a.packs.length>1&&h.jsx("div",{className:"card-packs",children:a.packs.map(u=>h.jsx("button",{className:`pack-btn ${i===u?"active":""}`,onClick:()=>s(u),children:u},u))}),h.jsx("button",{className:`card-atc ${o?"added":""}`,onClick:d,children:o?h.jsxs(h.Fragment,{children:[h.jsx(mb,{size:15})," Added!"]}):h.jsxs(h.Fragment,{children:[h.jsx($h,{size:15})," Add to Cart"]})})]})]})},Zv="/assets/Aavaram_idlypodi-CXc7KiXz.jpg",$v="/assets/BeetRoot_idlypodi-DaNF3zc5.jpg",ey="/assets/BitterMelon_idlypodi-DM__NpYK.jpg",ty="/assets/BlackJamunLeaves_idlypodi-bPBh8qBU.jpg",ny="/assets/CurryLeaves_idlypodi-C_NTgTxD.jpg",iy="/assets/Fenugreekleaves_idlypodi-Bj1Aw35F.jpg",ay="/assets/FigLeaves_idlypodi-CvMmJCsG.jpg",sy="/assets/FlaxSeeds_idlypodi-DR6rh-YB.jpg",ry="/assets/HerbalMasalaTea-DX1gqtqW.jpg",oy="/assets/HerbalSpicedCoffee-CGyihuF4.jpg",ly="/assets/HibiscusFlower_idlypodi-CLlvCrDl.jpg",cy="/assets/HorseGramRasamMix_idlypodi-yk13Hmhv.jpg",uy="/assets/HorseGram_idlypodi-CdWIoQJO.jpg",dy="/assets/Kurinja_idlypodi-DAeg-a_p.jpg",hy="/assets/MangoLeaves_idlypodi-UGpnIVsU.jpg",fy="/assets/ManiththakaaliLeaves_idlypodi-DDdHUFtL.jpg",my="/assets/MoringaLeavesCrab_masala-CljRlFLs.jpg",py="/assets/MornigaLeaves_idlypodi-B3H6mtdP.jpg",gy="/assets/Mulmurunkai_idlypodi-4SDby0Hn.jpg",vy="/assets/NeemFlower_idlypodi-9WiJQV66.jpg",yy="/assets/RosellaLeaves_idlypodi-CFPs9woZ.jpg",by="/assets/Sitrakaththi_idlypodi-Ddv6SGxX.jpg",Sy="/assets/SweetPotatoLeaves_idlypodi-CUiChC3A.jpg",Ty="/assets/SweetPotato_idlypodi-BiqmfcLc.jpg",Cy="/assets/Vallaarai_idlypodi-CR35Z5Wy.jpg",ky="/assets/VineLeaves_idlypodi-C47eM8_l.jpg",xy="/assets/amla_idlypodi-Bm7185Oa.jpg",Ey="/assets/moringa%20powder_p1-BZDoADPB.webp",wy="/assets/cow_ghee-BjEAQkYe.jpg",yi=[{id:"p1",name:"Organic Moringa Powder",category:"Herbal Supplements",condition:["Nutrition Supplements","Immunity Care"],goal:["Immunity","Energy"],price:349,originalPrice:399,discount:12,image:Ey,images:[Ey],description:"Premium organic moringa leaf powder rich in vitamins, minerals, and antioxidants. Supports overall health, boosts immunity and energy levels naturally.",benefits:["Rich in vitamins A, C, E","Boosts immunity","Supports energy levels","Anti-inflammatory properties","Rich in iron for anemia"],howToUse:"Mix 1 teaspoon in water, juice, or smoothie. Best consumed in the morning.",ingredients:"100% Organic Moringa Oleifera Leaf Powder",packs:["100g","200g","500g"],rating:4.7,reviews:1284,isBestSeller:!0,tag:"Best Seller"},{id:"p2",name:"Liver & Kidney Care",category:"Herbal Supplements",condition:["Liver / Kidney Care"],goal:["Detox","Wellness"],price:449,originalPrice:549,discount:18,image:"https://images.unsplash.com/photo-1615485500704-8e990f9900f7?w=600&q=80",images:["https://images.unsplash.com/photo-1615485500704-8e990f9900f7?w=600&q=80","https://images.unsplash.com/photo-1512621776951-a57141f2eefd?w=600&q=80"],description:"A scientifically formulated blend of traditional herbs to support liver detoxification and kidney health. Contains Kutki, Punarnava, and Bhumi Amla.",benefits:["Liver detox support","Kidney function support","Reduces toxin buildup","Supports healthy digestion"],howToUse:"Take 2 capsules twice daily after meals with water.",ingredients:"Kutki, Punarnava, Bhumi Amla, Kalmegh, Giloy",packs:["60 Capsules","120 Capsules"],rating:4.5,reviews:876,isBestSeller:!0,tag:"Best Seller"},{id:"p3",name:"Psyllium Whole Husk Isabgol",category:"Herbal Supplements",condition:["Gut Care","Constipation"],goal:["Digestion","Gut Health"],price:299,originalPrice:349,discount:14,image:"https://images.unsplash.com/photo-1586201375761-83865001e31c?w=600&q=80",images:["https://images.unsplash.com/photo-1586201375761-83865001e31c?w=600&q=80","https://images.unsplash.com/photo-1543353071-087092ec393a?w=600&q=80"],description:"Natural psyllium husk (Isabgol) for digestive health. Rich in soluble fiber that supports bowel regularity and gut health.",benefits:["Relieves constipation","Supports gut health","Natural fiber source","Helps manage cholesterol"],howToUse:"Mix 1-2 teaspoons in a glass of water or juice. Drink immediately before it thickens.",ingredients:"100% Natural Psyllium Husk (Plantago Ovata)",packs:["200g","400g","1kg"],rating:4.6,reviews:2134,isBestSeller:!0},{id:"p4",name:"Simply Chamomile Tea",category:"Teas & Infusions",condition:["Sleep Care"],goal:["Sleep","Calm"],price:249,originalPrice:299,discount:17,image:"https://images.unsplash.com/photo-1597318181409-cf64d0b5d8a2?w=600&q=80",images:["https://images.unsplash.com/photo-1597318181409-cf64d0b5d8a2?w=600&q=80","https://images.unsplash.com/photo-1576090503553-f37aba1d0e45?w=600&q=80"],description:"Pure chamomile flower tea for calm and restful sleep. Contains 100% whole chamomile flowers, no additives.",benefits:["Promotes relaxation","Supports restful sleep","Soothes anxiety","Gentle on stomach"],howToUse:"Steep 1 tea bag or 1 tsp in hot water (90C) for 3-5 minutes.",ingredients:"100% Dried Chamomile Flowers",packs:["20 Tea Bags","50 Tea Bags","100g Loose Leaf"],rating:4.8,reviews:1560,isBestSeller:!0,tag:"Fan Favourite"},{id:"p5",name:"Virgin Coconut Oil",category:"Oils & Ghee",condition:["Healthy Cooking Medium"],goal:["Fitness","Wellness"],price:499,originalPrice:599,discount:17,image:"https://images.unsplash.com/photo-1474979266404-7eaacbcd87c5?w=600&q=80",images:["https://images.unsplash.com/photo-1474979266404-7eaacbcd87c5?w=600&q=80","https://images.unsplash.com/photo-1526045612212-70caf35c14df?w=600&q=80"],description:"Cold-pressed virgin coconut oil retaining all natural nutrients. Ideal for cooking, skin care, and hair care.",benefits:["Cold-pressed & unrefined","Rich in MCTs","Supports metabolism","Antimicrobial properties"],howToUse:"Use as cooking oil, or apply topically for skin and hair.",ingredients:"100% Cold-Pressed Virgin Coconut Oil",packs:["250ml","500ml","1000ml"],rating:4.6,reviews:987,isBestSeller:!0},{id:"p6",name:"Active Start Combo",category:"Super Saver Combos",condition:["Metabolism Care","Immunity Care"],goal:["Energy","Fitness"],price:799,originalPrice:999,discount:20,image:"https://images.unsplash.com/photo-1490645935967-10de6ba17061?w=600&q=80",images:["https://images.unsplash.com/photo-1490645935967-10de6ba17061?w=600&q=80","https://images.unsplash.com/photo-1543353071-087092ec393a?w=600&q=80"],description:"Start your wellness journey with our Active Start Combo  moringa powder + ashwagandha + tulsi green tea for all-day energy.",benefits:["Complete energy support","Immunity booster","Adaptogenic herbs","Great for beginners"],howToUse:"Follow individual product instructions. Best taken in morning.",ingredients:"Moringa Powder 100g, Ashwagandha 60caps, Tulsi Green Tea 20 bags",packs:["Starter Kit"],rating:4.9,reviews:654,tag:"20% OFF"},{id:"p7",name:"Calm & Balance Combo",category:"Super Saver Combos",condition:["Sleep Care"],goal:["Calm","Sleep"],price:749,originalPrice:949,discount:21,image:"https://images.unsplash.com/photo-1544787219-7f47ccb76574?w=600&q=80",images:["https://images.unsplash.com/photo-1544787219-7f47ccb76574?w=600&q=80"],description:"Find your calm with Ashwagandha, Chamomile Tea, and our Stress Relief formula  designed for modern life stress management.",benefits:["Reduces cortisol","Promotes sleep","Balances mood","Adaptogenic support"],howToUse:"Take capsules at bedtime; drink chamomile tea 30 mins before sleep.",ingredients:"Ashwagandha 60caps, Chamomile Tea 20bags, Brahmi 60caps",packs:["Full Kit"],rating:4.7,reviews:432},{id:"p8",name:"Gut Reset Combo",category:"Super Saver Combos",condition:["Gut Care","Bloating / Gas"],goal:["Digestion","Gut Health"],price:699,originalPrice:899,discount:22,image:"https://images.unsplash.com/photo-1512621776951-a57141f2eefd?w=600&q=80",images:["https://images.unsplash.com/photo-1512621776951-a57141f2eefd?w=600&q=80"],description:"Complete gut reset with Triphala, Isabgol, and Jeera-Ajwain blend. Supports healthy digestion and gut microbiome.",benefits:["Relieves bloating","Supports gut flora","Detoxifies colon","Improves digestion"],howToUse:"Follow individual product guides. Best taken before bedtime.",ingredients:"Triphala 60caps, Isabgol 200g, Jeera-Ajwain Mix 100g",packs:["Gut Kit"],rating:4.6,reviews:389},{id:"p10",name:"Clean 7 Days Detox Kit",category:"Detox Programs",condition:["Gut Care","Liver / Kidney Care"],goal:["Detox","Weight"],price:1199,originalPrice:1499,discount:20,image:"https://images.unsplash.com/photo-1547592180-85f173990554?w=600&q=80",images:["https://images.unsplash.com/photo-1547592180-85f173990554?w=600&q=80"],description:"7-day complete body cleanse with herbal detox shakes, gut cleansing capsules, and liver support formula.",benefits:["Full body detox","Liver cleanse","Gut reset","Improved energy after 7 days"],howToUse:"Follow the included 7-day schedule card. Drink plenty of water.",ingredients:"Detox Shake Mix 300g, Triphala 30caps, Liver Support 30caps",packs:["7-Day Kit"],rating:4.5,reviews:312,isNew:!0,tag:"NEW"},{id:"p11",name:"Plant Protein Powder",category:"Gym Diet",condition:["Nutrition Supplements","Muscle Care"],goal:["Fitness","Weight"],price:1299,originalPrice:1599,discount:19,image:"https://images.unsplash.com/photo-1593095948071-474c5cc2989d?w=600&q=80",images:["https://images.unsplash.com/photo-1593095948071-474c5cc2989d?w=600&q=80"],description:"100% plant-based protein blend from pea, brown rice, and hemp. 25g protein per serving, no artificial flavors.",benefits:["25g protein per serving","All 9 essential amino acids","Easy to digest","No artificial sweeteners"],howToUse:"Mix 1 scoop in 250ml water or plant milk. 1-2 servings per day.",ingredients:"Pea Protein, Brown Rice Protein, Hemp Protein",packs:["500g","1kg","2kg"],rating:4.4,reviews:789,isNew:!0},{id:"p12",name:"Raw Organic Honey",category:"Sugar Alternatives",condition:["Immunity Care"],goal:["Immunity","Wellness"],price:449,originalPrice:549,discount:18,image:"https://images.unsplash.com/photo-1558642452-9d2a7deb7f62?w=600&q=80",images:["https://images.unsplash.com/photo-1558642452-9d2a7deb7f62?w=600&q=80"],description:"Unprocessed, unfiltered raw honey straight from the hive. Rich in enzymes, antioxidants, and natural goodness.",benefits:["Antibacterial properties","Rich in antioxidants","Natural energy source","Aids wound healing"],howToUse:"Use as sweetener in beverages, on toast, or directly by spoon.",ingredients:"100% Raw Unprocessed Honey",packs:["250g","500g","1kg"],rating:4.9,reviews:1876,isBestSeller:!0},{id:"p14",name:"Tulsi Green Tea",category:"Teas & Infusions",condition:["Immunity Care","Respiratory Care"],goal:["Immunity","Detox"],price:199,originalPrice:249,discount:20,image:"https://images.unsplash.com/photo-1556679343-c7306c1976bc?w=600&q=80",images:["https://images.unsplash.com/photo-1556679343-c7306c1976bc?w=600&q=80"],description:"A refreshing blend of Indian Holy Basil (Tulsi) and premium green tea. Rich in antioxidants and adaptogenic compounds.",benefits:["Boosts immunity","Rich in antioxidants","Respiratory support","Stress adaptogen"],howToUse:"Steep 1 tea bag in hot water (80C) for 2-3 minutes.",ingredients:"Green Tea Leaves, Tulsi (Holy Basil) leaves",packs:["25 Tea Bags","50 Tea Bags"],rating:4.6,reviews:934},{id:"p15",name:"Cow Ghee (A2)",category:"Oils & Ghee",condition:["Healthy Cooking Medium","Gut Care"],goal:["Wellness","Digestion"],price:799,originalPrice:999,discount:20,image:wy,images:[wy],description:"Pure A2 Gir Cow Ghee made using traditional bilona method. Rich in butyric acid, Omega-3, vitamins A, D, E, K.",benefits:["Improves gut health","Good cholesterol source","Brain food","Lactose-free"],howToUse:"Use for cooking, or take 1 tsp on empty stomach for gut health.",ingredients:"100% A2 Gir Cow Milk Ghee",packs:["250ml","500ml","1000ml"],rating:4.8,reviews:1432,isBestSeller:!0},{id:"p16",name:"Amla Powder (Indian Gooseberry)",category:"Herbal Supplements",condition:["Immunity Care","Heart Care"],goal:["Immunity","Wellness"],price:229,originalPrice:279,discount:18,image:"https://images.unsplash.com/photo-1551218808-94e220e084d2?w=600&q=80",images:["https://images.unsplash.com/photo-1551218808-94e220e084d2?w=600&q=80"],description:"Spray-dried pure Amla (Indian Gooseberry) powder. Richest natural source of Vitamin C. Supports immunity, hair, and skin.",benefits:["Highest Vitamin C source","Hair growth support","Skin brightening","Heart health"],howToUse:"Mix 1 tsp in warm water with honey. Drink on empty stomach.",ingredients:"100% Spray-Dried Amla Powder",packs:["100g","200g","500g"],rating:4.5,reviews:1123},{id:"p17",name:"Triphala Churna",category:"Herbal Supplements",condition:["Gut Care","Constipation","Colon Cleansing"],goal:["Digestion","Detox"],price:199,originalPrice:249,discount:20,image:"https://images.unsplash.com/photo-1505576399279-565b52d4ac71?w=600&q=80",images:["https://images.unsplash.com/photo-1505576399279-565b52d4ac71?w=600&q=80"],description:"Traditional Ayurvedic blend of three fruits (Amalaki, Bibhitaki, Haritaki) for complete digestive health and colon cleanse.",benefits:["Gentle laxative","Colon cleansing","Antioxidant rich","Liver support"],howToUse:"Mix 1 tsp in warm water at bedtime.",ingredients:"Amalaki, Bibhitaki, Haritaki in equal proportions",packs:["100g","200g","500g"],rating:4.6,reviews:1876},{id:"p20",name:"Detox Green Tea",category:"Teas & Infusions",condition:["Gut Care","Liver / Kidney Care"],goal:["Detox","Weight"],price:279,originalPrice:349,discount:20,image:"https://images.unsplash.com/photo-1564890369478-c89ca6d9cde9?w=600&q=80",images:["https://images.unsplash.com/photo-1564890369478-c89ca6d9cde9?w=600&q=80"],description:"A powerful detox blend with green tea, dandelion, milk thistle, and lemon peel. Supports liver cleansing and weight management.",benefits:["Liver detox support","Weight management","Metabolism boost","Rich in antioxidants"],howToUse:"Steep 1 tea bag in hot water for 3-4 minutes. Drink 2-3 cups daily.",ingredients:"Green Tea, Dandelion, Milk Thistle, Lemon Peel, Licorice Root",packs:["25 Tea Bags","50 Tea Bags"],rating:4.5,reviews:743},{id:"p21",name:"Organic Turmeric Capsules",category:"Herbal Supplements",condition:["Joint Care","Immunity Care","Heart Care"],goal:["Immunity","Wellness"],price:349,originalPrice:449,discount:22,image:"https://images.unsplash.com/photo-1615485290382-441e4d049cb5?w=600&q=80",images:["https://images.unsplash.com/photo-1615485290382-441e4d049cb5?w=600&q=80"],description:"High-bioavailability turmeric capsules with black pepper extract (Bioperine). Contains 95% standardized curcuminoids.",benefits:["Powerful anti-inflammatory","Joint pain relief","Heart health","Brain health"],howToUse:"Take 1 capsule twice daily with meals.",ingredients:"Turmeric Root Extract 500mg (95% Curcumin), Black Pepper Extract 5mg",packs:["60 Capsules","120 Capsules"],rating:4.6,reviews:1234}],sw=yi.filter(a=>a.isBestSeller);yi.filter(a=>a.isNew);yi.filter(a=>a.category==="Super Saver Combos");const Cb=[{id:"m1",name:"Aavaram Idly Podi",category:"Maruthompal",condition:["Immunity Care","Nutrition Supplements"],goal:["Immunity","Wellness"],price:350,originalPrice:420,discount:17,image:Zv,images:[Zv],description:"Aavaram Idly Podi is a traditional herbal spice powder made from Aavaram (Senna auriculata) flowers and leaves. This unique blend adds a distinct flavour to your idly and dosa while providing medicinal benefits. Rich in antioxidants, it is a popular home remedy in South India for managing blood sugar and improving overall wellness.",benefits:["Helps regulate blood sugar levels","Rich in antioxidants and flavonoids","Supports liver health","Boosts immunity naturally","Improves digestion"],howToUse:"Mix 12 teaspoons with sesame oil or ghee and serve alongside idly, dosa, or rice. Can be mixed into hot rice with a drizzle of ghee.",ingredients:"Aavaram flower & leaf powder, Urad dal, Chana dal, Dried red chillies, Curry leaves, Rock salt, Asafoetida",packs:["100g","200g","500g"],rating:4.5,reviews:412},{id:"m2",name:"Beetroot Idly Podi",category:"Maruthompal",condition:["Nutrition Supplements","Heart Care"],goal:["Immunity","Energy"],price:280,originalPrice:340,discount:18,image:$v,images:[$v],description:"Beetroot Idly Podi is a vibrant, nutrient-rich spice powder made from sun-dried beetroot blended with traditional spices. It gives your idly and dosa a beautiful reddish hue while loading every bite with essential vitamins and minerals. Beetroot is known for its ability to improve blood circulation and stamina.",benefits:["Rich in iron and folate","Improves blood circulation","Natural energy booster","Supports heart health","Antioxidant-rich"],howToUse:"Mix 12 teaspoons with sesame oil and serve with idly or dosa. Also great as a seasoning in rice dishes.",ingredients:"Dried beetroot powder, Urad dal, Chana dal, Dried red chillies, Curry leaves, Rock salt, Sesame seeds",packs:["100g","200g","500g"],rating:4.3,reviews:287},{id:"m3",name:"Bitter Melon Idly Podi",category:"Maruthompal",condition:["Gut Care","Immunity Care"],goal:["Wellness","Detox"],price:320,originalPrice:390,discount:18,image:ey,images:[ey],description:"Bitter Melon (Pavakkai) Idly Podi is crafted from sun-dried bitter gourd combined with aromatic spices. Despite its slightly bitter taste, this podi is a powerhouse of medicinal compounds. It is especially popular among those managing diabetes and seeking detox benefits from a daily dietary addition.",benefits:["Supports healthy blood sugar levels","Natural detoxifier","Improves digestive health","Anti-inflammatory properties","Rich in Vitamin C"],howToUse:"Use 12 teaspoons mixed in oil with idly or dosa. Start with smaller amounts if new to bitter flavours.",ingredients:"Dried bitter melon powder, Urad dal, Grated coconut, Dried red chillies, Curry leaves, Rock salt, Cumin",packs:["100g","200g","500g"],rating:4.1,reviews:198},{id:"m4",name:"Black Jamun Leaves Idly Podi",category:"Maruthompal",condition:["Immunity Care","Gut Care"],goal:["Wellness","Immunity"],price:420,originalPrice:520,discount:19,image:ty,images:[ty],description:"Black Jamun Leaves Idly Podi is prepared from the dried leaves of the Java Plum (Syzygium cumini) tree, which are revered in Ayurveda for their anti-diabetic properties. This earthy, flavourful podi is an excellent addition to a health-conscious diet, especially for those seeking natural blood sugar management.",benefits:["Helps control blood sugar","Anti-diabetic compounds","Improves gut health","Rich in antioxidants","Supports kidney health"],howToUse:"Mix 12 teaspoons with gingelly (sesame) oil and serve with idly, dosa, or rice.",ingredients:"Dried Black Jamun leaf powder, Urad dal, Chana dal, Dried red chillies, Rock salt, Asafoetida, Curry leaves",packs:["100g","200g","500g"],rating:4.6,reviews:341},{id:"m5",name:"Curry Leaves Idly Podi",category:"Maruthompal",condition:["Immunity Care","Nutrition Supplements"],goal:["Immunity","Wellness"],price:250,originalPrice:310,discount:19,image:ny,images:[ny],description:"Curry Leaves (Kadi Patta) Idly Podi is a classic South Indian condiment bursting with the fresh, aromatic essence of fresh curry leaves. Curry leaves are packed with iron, calcium, and powerful antioxidants called carbazole alkaloids that support hair health, liver function, and immunity.",benefits:["Promotes hair growth and prevents hair fall","Rich in iron and calcium","Supports liver health","Strong antioxidant properties","Improves digestion"],howToUse:"Serve 12 teaspoons mixed with ghee or sesame oil alongside idly, dosa, or rice.",ingredients:"Dried curry leaf powder, Urad dal, Chana dal, Dried red chillies, Garlic, Rock salt, Asafoetida",packs:["100g","200g","500g"],rating:4.7,reviews:524},{id:"m6",name:"Fenugreek Leaves Idly Podi",category:"Maruthompal",condition:["Gut Care","Immunity Care"],goal:["Wellness","Digestion"],price:290,originalPrice:360,discount:19,image:iy,images:[iy],description:"Fenugreek Leaves (Vendhaya Keerai) Idly Podi is made from dried methi leaves blended with traditional spices. Fenugreek is one of the oldest medicinal herbs in the world, celebrated for its ability to improve digestion, control blood sugar, and support lactation in nursing mothers. This slightly bitter, flavourful podi is a wholesome addition to any meal.",benefits:["Controls blood glucose levels","Improves digestion and relieves gas","Supports lactation in nursing mothers","Anti-inflammatory benefits","Rich in fibre and iron"],howToUse:"Mix 12 teaspoons with sesame oil or ghee. Best served with idly, dosa, or rice.",ingredients:"Dried fenugreek leaf powder, Urad dal, Chana dal, Dried red chillies, Rock salt, Curry leaves, Sesame seeds",packs:["100g","200g","500g"],rating:4.4,reviews:309},{id:"m7",name:"Fig Leaves Idly Podi",category:"Maruthompal",condition:["Gut Care","Immunity Care"],goal:["Wellness","Digestion"],price:480,originalPrice:590,discount:19,image:ay,images:[ay],description:"Fig Leaves (Athi Ilai) Idly Podi is a rare and traditionally valued condiment made from dried fig leaves. Fig leaves contain compounds that benefit digestive health and have been used in traditional medicine to help manage blood sugar levels. This unique podi has a subtle, earthy flavour that pairs wonderfully with South Indian breakfast staples.",benefits:["Supports healthy blood sugar","Improves digestive health","Anti-inflammatory benefits","Rich in minerals","Supports respiratory health"],howToUse:"Mix 12 teaspoons with sesame oil and serve with idly or dosa.",ingredients:"Dried fig leaf powder, Urad dal, Sesame seeds, Dried red chillies, Rock salt, Asafoetida, Curry leaves",packs:["100g","200g"],rating:4.2,reviews:156},{id:"m8",name:"Flax Seeds Idly Podi",category:"Maruthompal",condition:["Heart Care","Nutrition Supplements"],goal:["Wellness","Fitness"],price:310,originalPrice:380,discount:18,image:sy,images:[sy],description:"Flax Seeds (Ali Virai) Idly Podi is a nutrient-dense spice blend made from roasted and ground flaxseeds. Flaxseeds are one of the richest plant sources of Omega-3 fatty acids and lignans, making this podi an excellent addition for heart health, hormone balance, and gut health. Its nutty, roasted flavour makes it a delicious everyday condiment.",benefits:["Excellent source of Omega-3 fatty acids","Supports heart health","Rich in fibre for gut health","Hormone-balancing lignans","Anti-cancer antioxidants"],howToUse:"Mix 12 teaspoons with sesame oil or ghee. Serve with idly, dosa, rice, or blend into smoothies.",ingredients:"Roasted flaxseed powder, Urad dal, Sesame seeds, Dried red chillies, Rock salt, Curry leaves, Cumin",packs:["100g","200g","500g"],rating:4.6,reviews:478},{id:"m9",name:"Herbal Masala Tea",category:"Maruthompal",condition:["Immunity Care","Respiratory Care"],goal:["Immunity","Energy"],price:450,originalPrice:560,discount:20,image:ry,images:[ry],description:"Herbal Masala Tea is an aromatic blend of premium black tea with traditional Indian spices and medicinal herbs. This warming beverage is crafted with ginger, cardamom, cinnamon, cloves, and pepper  each ingredient carefully selected for its therapeutic properties. A perfect morning ritual that energises the body and fortifies immunity.",benefits:["Boosts immunity and energy","Supports respiratory health","Relieves cold and congestion","Anti-inflammatory properties","Promotes digestive comfort"],howToUse:"Add 1 teaspoon to 150ml of boiling water/milk. Simmer for 23 minutes. Strain and enjoy with or without sweetener.",ingredients:"Black tea, Ginger, Cardamom, Cinnamon, Cloves, Black pepper, Tulsi, Star anise",packs:["50g","100g","200g"],rating:4.8,reviews:623},{id:"m10",name:"Herbal Spiced Coffee",category:"Maruthompal",condition:["Immunity Care","Metabolism Care"],goal:["Energy","Wellness"],price:520,originalPrice:640,discount:19,image:oy,images:[oy],description:"Herbal Spiced Coffee is a unique fusion of premium roasted coffee with a blend of Ayurvedic spices and adaptogens. This exceptional beverage provides the familiar comfort of coffee while incorporating the health benefits of traditional Indian herbs. It offers a smooth, spiced flavour profile with a warming, energising finish.",benefits:["Natural energy boost","Adaptogenic stress relief","Improves focus and alertness","Anti-inflammatory spices","Supports metabolism"],howToUse:"Mix 12 teaspoons in 150ml of hot water or milk. Simmer for 12 minutes. Sweeten with jaggery or honey as preferred.",ingredients:"Roasted Arabica coffee, Ashwagandha, Cardamom, Cinnamon, Ginger, Nutmeg, Black pepper",packs:["50g","100g","200g"],rating:4.7,reviews:389},{id:"m11",name:"Hibiscus Flower Idly Podi",category:"Maruthompal",condition:["Heart Care","Women's Health"],goal:["Wellness","Immunity"],price:380,originalPrice:470,discount:19,image:ly,images:[ly],description:"Hibiscus Flower (Sembaruthi) Idly Podi is made from dried hibiscus petals blended with traditional spices that lend a beautiful natural colour and a mild tangy flavour. Hibiscus is celebrated in Ayurveda and modern research for its ability to support heart health, manage blood pressure, and promote hair growth.",benefits:["Helps lower blood pressure","Rich in Vitamin C and antioxidants","Promotes hair growth","Supports liver health","Natural diuretic properties"],howToUse:"Mix 12 teaspoons with sesame oil or ghee and serve with idly or dosa.",ingredients:"Dried hibiscus flower powder, Urad dal, Sesame seeds, Dried red chillies, Rock salt, Curry leaves, Tamarind",packs:["100g","200g","500g"],rating:4.5,reviews:267},{id:"m12",name:"Horse Gram Rasam Mix",category:"Maruthompal",condition:["Gut Care","Nutrition Supplements"],goal:["Wellness","Digestion"],price:290,originalPrice:360,discount:19,image:cy,images:[cy],description:"Horse Gram Rasam Mix (Kollu Rasam) is a traditional South Indian soup mix made from earthy horse gram lentils combined with tamarind, tomato, and aromatic spices. Known in Tamil as 'Kollu', horse gram is one of the most protein-rich legumes and is celebrated for its powerful diuretic and weight management properties.",benefits:["High in protein and fibre","Supports kidney stone management","Natural diuretic properties","Aids weight management","Improves digestive health"],howToUse:"Mix 23 teaspoons in 500ml of water. Bring to a boil with a tempering of mustard seeds and curry leaves. Serve hot as a soup.",ingredients:"Horse gram powder, Tamarind, Tomato powder, Cumin, Black pepper, Garlic, Curry leaves, Rock salt, Asafoetida",packs:["100g","200g","500g"],rating:4.4,reviews:334},{id:"m13",name:"Horse Gram Idly Podi",category:"Maruthompal",condition:["Nutrition Supplements","Gut Care"],goal:["Fitness","Wellness"],price:260,originalPrice:320,discount:19,image:uy,images:[uy],description:"Horse Gram (Kollu) Idly Podi is a protein-packed traditional condiment made from roasted horse gram blended with dried red chillies, garlic, and aromatic spices. Horse gram is one of the few legumes with the highest protein content and is revered in South Indian cooking for both its nutrition and its powerful medicinal properties.",benefits:["High protein content","Supports weight management","Natural diuretic properties","Improves metabolic rate","Rich in iron and calcium"],howToUse:"Mix 12 teaspoons with sesame oil or ghee. Serve with idly, dosa, or rice.",ingredients:"Roasted horse gram powder, Dried red chillies, Garlic, Curry leaves, Rock salt, Asafoetida, Sesame seeds",packs:["100g","200g","500g"],rating:4.5,reviews:445},{id:"m14",name:"Kurinja Idly Podi",category:"Maruthompal",condition:["Gut Care","Immunity Care"],goal:["Wellness","Detox"],price:450,originalPrice:560,discount:20,image:dy,images:[dy],description:"Kurinja Idly Podi is crafted from the rare Kurinji plant (Strobilanthes kunthianus), famous for its once-in-12-years blooming cycle in the Nilgiri hills. This unique podi carries traditional medicinal properties and an earthy, distinctive taste that sets it apart from regular podis.",benefits:["Rare herbal medicinal properties","Supports respiratory health","Anti-inflammatory benefits","Natural immunity booster","Rich in unique phytonutrients"],howToUse:"Mix 1 teaspoon with sesame oil and serve alongside idly or dosa. Best consumed fresh.",ingredients:"Dried Kurinji plant powder, Urad dal, Dried red chillies, Rock salt, Sesame seeds, Curry leaves",packs:["100g","200g"],rating:4.3,reviews:142},{id:"m15",name:"Mango Leaves Idly Podi",category:"Maruthompal",condition:["Immunity Care","Gut Care"],goal:["Wellness","Immunity"],price:340,originalPrice:420,discount:19,image:hy,images:[hy],description:"Mango Leaves (Mangai Ilai) Idly Podi is prepared from tender dried mango leaves rich in mangiferin, a powerful antioxidant. In Ayurveda, mango leaves are used to manage diabetes, improve eye health, and treat kidney and gall bladder stones. This podi brings together traditional wisdom and culinary delight in every serving.",benefits:["Rich in mangiferin antioxidants","Helps manage diabetes","Supports kidney health","Improves eye health","Anti-inflammatory properties"],howToUse:"Mix 12 teaspoons with sesame oil or ghee and serve with idly or dosa.",ingredients:"Dried mango leaf powder, Urad dal, Chana dal, Dried red chillies, Rock salt, Curry leaves, Sesame seeds",packs:["100g","200g","500g"],rating:4.4,reviews:223},{id:"m16",name:"Manithakaali Leaves Idly Podi",category:"Maruthompal",condition:["Gut Care","Immunity Care"],goal:["Wellness","Digestion"],price:380,originalPrice:470,discount:19,image:fy,images:[fy],description:"Manithakaali (Black Night Shade / Manathakkali) Idly Podi is made from dried Solanum nigrum leaves and berries, a plant deeply rooted in Siddha and Ayurvedic medicine. Particularly known for its ability to heal mouth ulcers (canker sores), soothe stomach ailments, and support liver health, this podi is a precious traditional remedy in South Indian homes.",benefits:["Heals mouth ulcers effectively","Soothes stomach and intestinal ulcers","Supports liver health","Anti-inflammatory and analgesic","Rich in alkaloids and antioxidants"],howToUse:"Mix 12 teaspoons with sesame oil or ghee. Serve with idly, dosa, or rice.",ingredients:"Dried Manathakkali leaf and berry powder, Urad dal, Dried red chillies, Rock salt, Curry leaves, Cumin, Sesame seeds",packs:["100g","200g","500g"],rating:4.6,reviews:389},{id:"m17",name:"Moringa Leaves Crab Masala",category:"Maruthompal",condition:["Nutrition Supplements","Immunity Care"],goal:["Energy","Wellness"],price:650,originalPrice:800,discount:19,image:my,images:[my],description:"Moringa Leaves Crab Masala is a premium spice blend combining the nutritional powerhouse of moringa leaves with the bold, coastal flavours of traditional crab masala. This unique fusion spice mix is perfect for seafood dishes, especially crab curry, and adds both exceptional flavour and a rich nutritional profile to your meals.",benefits:["92 nutrients in moringa","Boosts energy and immunity","Rich in Vitamin C and iron","Supports bone health","Powerful antioxidant blend"],howToUse:"Use 23 teaspoons as a marinade or curry base for crab or other seafood. Can also be used for chicken and vegetarian dishes.",ingredients:"Dried moringa leaf powder, Coriander, Cumin, Red chillies, Black pepper, Fennel, Turmeric, Cinnamon, Cloves, Rock salt, Garlic",packs:["100g","200g"],rating:4.7,reviews:178},{id:"m18",name:"Moringa Leaves Idly Podi",category:"Maruthompal",condition:["Nutrition Supplements","Immunity Care"],goal:["Energy","Immunity"],price:300,originalPrice:370,discount:19,image:py,images:[py],description:"Moringa Leaves (Murungai Keerai) Idly Podi is made from the world's most nutritious plant  Moringa oleifera. This podi is packed with 92 nutrients, 46 antioxidants, and all essential amino acids. It is a perfect daily supplement disguised as a delicious condiment, making it easy to incorporate the benefits of moringa into every meal.",benefits:["92 nutrients and 46 antioxidants","All 9 essential amino acids","Boosts immunity and energy","Supports bone health","Iron-rich for anemia"],howToUse:"Mix 12 teaspoons with sesame oil or ghee. Serve with idly, dosa, or rice.",ingredients:"Dried moringa leaf powder, Urad dal, Sesame seeds, Dried red chillies, Garlic, Rock salt, Curry leaves",packs:["100g","200g","500g"],rating:4.8,reviews:567},{id:"m19",name:"Mulmurunkai Idly Podi",category:"Maruthompal",condition:["Immunity Care","Nutrition Supplements"],goal:["Immunity","Wellness"],price:420,originalPrice:520,discount:19,image:gy,images:[gy],description:"Mulmurunkai (Erythrina indica / Indian Coral Tree) Idly Podi is prepared from the dried leaves of the coral tree, a plant used in Siddha medicine for centuries. The leaves of Mulmurunkai are known for their anti-rheumatic, anti-inflammatory, and sedative properties, making this podi a truly medicinal condiment.",benefits:["Anti-inflammatory properties","Supports joint health","Calming and sedative effects","Antioxidant compounds","Traditional Siddha medicinal herb"],howToUse:"Mix 1 teaspoon with sesame oil and serve with idly or dosa. Use in moderation.",ingredients:"Dried Mulmurunkai leaf powder, Urad dal, Dried red chillies, Rock salt, Curry leaves, Sesame seeds",packs:["100g","200g"],rating:4.3,reviews:134},{id:"m20",name:"Neem Flower Idly Podi",category:"Maruthompal",condition:["Immunity Care","Gut Care"],goal:["Detox","Wellness"],price:360,originalPrice:450,discount:20,image:vy,images:[vy],description:"Neem Flower (Veppam Poo) Idly Podi is a traditional South Indian condiment made from dried neem flowers, celebrated for their intense bitter flavour and powerful medicinal properties. In Ayurveda, neem flowers are prized for purifying the blood, supporting liver function, and eliminating toxins from the body.",benefits:["Powerful blood purifier","Detoxifies the liver","Anti-diabetic properties","Eliminates intestinal worms","Supports skin health"],howToUse:"Mix 1 teaspoon with sesame oil and serve sparingly with idly or rice. Best consumed in small quantities due to intense bitter taste.",ingredients:"Dried neem flower powder, Urad dal, Dried red chillies, Rock salt, Asafoetida, Cumin, Sesame seeds",packs:["100g","200g"],rating:4.2,reviews:212},{id:"m21",name:"Rosella Leaves Idly Podi",category:"Maruthompal",condition:["Heart Care","Immunity Care"],goal:["Wellness","Immunity"],price:390,originalPrice:480,discount:19,image:yy,images:[yy],description:"Rosella Leaves (Gongura / Pulicha Keerai) Idly Podi is made from the tangy, iron-rich rosella plant that is iconic in Andhra and Tamil cuisine. Rich in Vitamin C and iron, this podi has a pleasantly sour taste and is known for its ability to improve haemoglobin levels and support digestion.",benefits:["Rich in iron and Vitamin C","Improves haemoglobin levels","Supports digestive health","Antioxidant-rich","Natural appetiser"],howToUse:"Mix 12 teaspoons with sesame oil and serve with idly, dosa, or rice.",ingredients:"Dried rosella leaf powder, Urad dal, Chana dal, Dried red chillies, Garlic, Rock salt, Cumin, Sesame seeds",packs:["100g","200g","500g"],rating:4.5,reviews:298},{id:"m22",name:"Sitrakaththi Idly Podi",category:"Maruthompal",condition:["Immunity Care","Gut Care"],goal:["Wellness","Immunity"],price:440,originalPrice:550,discount:20,image:by,images:[by],description:"Sitrakaththi (Andrographis paniculata / Kalmegh) Idly Podi is crafted from the 'King of Bitters', a plant revered in Siddha and Ayurvedic medicine for its exceptional immune-boosting and fever-fighting properties. This intensely bitter podi is a potent medicinal condiment traditionally used to ward off infections and support liver function.",benefits:["Potent immunity booster","Reduces fever naturally","Strong liver protector","Anti-viral and anti-bacterial","Bitter compounds aid digestion"],howToUse:"Mix 1 teaspoon with sesame oil and serve sparingly with idly, dosa, or rice.",ingredients:"Dried Andrographis leaf powder, Urad dal, Dried red chillies, Rock salt, Cumin, Black pepper, Curry leaves",packs:["100g","200g"],rating:4.4,reviews:167},{id:"m23",name:"Sweet Potato Leaves Idly Podi",category:"Maruthompal",condition:["Nutrition Supplements","Immunity Care"],goal:["Wellness","Immunity"],price:320,originalPrice:400,discount:20,image:Sy,images:[Sy],description:"Sweet Potato Leaves Idly Podi is prepared from the nutrient-dense leaves of the sweet potato plant (Ipomoea batatas), which are often more nutritious than the tuber itself. Rich in protein and antioxidants, these leaves are used in traditional cuisine across South and Southeast Asia and are now becoming increasingly popular in health-conscious diets.",benefits:["High in protein and iron","Rich in beta-carotene (Vitamin A)","Strong antioxidant properties","Supports eye health","Boosts immunity"],howToUse:"Mix 12 teaspoons with sesame oil and serve with idly, dosa, or rice.",ingredients:"Dried sweet potato leaf powder, Urad dal, Chana dal, Dried red chillies, Garlic, Rock salt, Sesame seeds, Curry leaves",packs:["100g","200g","500g"],rating:4.3,reviews:189},{id:"m24",name:"Sweet Potato Idly Podi",category:"Maruthompal",condition:["Nutrition Supplements","Gut Care"],goal:["Energy","Wellness"],price:270,originalPrice:340,discount:21,image:Ty,images:[Ty],description:"Sweet Potato (Sakkaraivalli Kizhangu) Idly Podi is made from sun-dried sweet potato blended with traditional spices. Sweet potato is a superfood rich in beta-carotene, complex carbohydrates, and dietary fibre. This mildly sweet and spiced podi is a healthy and delicious alternative to conventional idly podis.",benefits:["Rich in beta-carotene (Vitamin A)","Excellent source of dietary fibre","Sustained energy release","Gut-friendly prebiotic fibre","Immune-supporting antioxidants"],howToUse:"Mix 12 teaspoons with sesame oil or ghee and serve with idly, dosa, or rice.",ingredients:"Dried sweet potato powder, Urad dal, Sesame seeds, Dried red chillies, Rock salt, Curry leaves, Cumin",packs:["100g","200g","500g"],rating:4.4,reviews:302},{id:"m25",name:"Vallaarai Idly Podi",category:"Maruthompal",condition:["Immunity Care","Nutrition Supplements"],goal:["Wellness","Energy"],price:460,originalPrice:570,discount:19,image:Cy,images:[Cy],description:"Vallaarai (Centella asiatica / Gotu Kola) Idly Podi is made from one of the most prized herbs in Ayurveda and Siddha medicine. Vallaarai is revered as a brain tonic that enhances memory, concentration, and cognitive function. This earthy, mildly bitter podi is a delicious way to nourish the mind and nervous system daily.",benefits:["Enhances memory and concentration","Natural brain tonic (nootropic)","Reduces anxiety and stress","Supports wound healing","Improves blood circulation"],howToUse:"Mix 12 teaspoons with sesame oil or ghee and serve with idly, dosa, or rice.",ingredients:"Dried Vallaarai leaf powder, Urad dal, Sesame seeds, Dried red chillies, Rock salt, Curry leaves, Cumin",packs:["100g","200g","500g"],rating:4.7,reviews:512},{id:"m26",name:"Vine Leaves Idly Podi",category:"Maruthompal",condition:["Gut Care","Immunity Care"],goal:["Wellness","Digestion"],price:350,originalPrice:440,discount:20,image:ky,images:[ky],description:"Vine Leaves (Grape Leaves / Draksha Ilai) Idly Podi is a unique condiment made from dried grape vine leaves, which are rich in polyphenols, flavonoids, and antioxidants. Grape leaves have been used in Mediterranean and Ayurvedic traditions for their anti-inflammatory, digestive, and circulatory benefits.",benefits:["Rich in polyphenols and antioxidants","Supports healthy circulation","Anti-inflammatory properties","Aids digestive health","Rich in Vitamin K"],howToUse:"Mix 12 teaspoons with sesame oil and serve with idly, dosa, or rice.",ingredients:"Dried grape vine leaf powder, Urad dal, Chana dal, Dried red chillies, Rock salt, Sesame seeds, Cumin",packs:["100g","200g"],rating:4.2,reviews:127},{id:"m27",name:"Amla Idly Podi",category:"Maruthompal",condition:["Immunity Care","Heart Care"],goal:["Immunity","Wellness"],price:290,originalPrice:360,discount:19,image:xy,images:[xy],description:"Amla (Indian Gooseberry / Nellikai) Idly Podi is made from sun-dried amla, the richest natural source of Vitamin C. With 20 times more Vitamin C than oranges, amla is a true superfruit that supports immunity, hair growth, skin health, and eye health. This tangy, flavourful podi adds both taste and immense nutritional value to your daily meals.",benefits:["20x more Vitamin C than oranges","Promotes hair growth and reduces hair fall","Brightens skin naturally","Strengthens immunity","Supports eye and liver health"],howToUse:"Mix 12 teaspoons with sesame oil or ghee and serve with idly, dosa, or rice.",ingredients:"Dried amla powder, Urad dal, Sesame seeds, Dried red chillies, Rock salt, Curry leaves, Cumin",packs:["100g","200g","500g"],rating:4.6,reviews:456}],kb=()=>[...yi,...Cb],rw=a=>kb().find(e=>e.id===a),Vi=a=>yi.filter(e=>e.goal.includes(a));Vi("Energy"),Vi("Calm"),Vi("Digestion"),Vi("Immunity"),Vi("Detox"),Vi("Fitness"),Vi("Sleep"),Vi("Weight");const ys=[{title:"Nature's Best for Your Health",sub:"Premium Herbal Supplements, Organic Foods & Teas",cta:"Shop Now",link:"/products",bg:"linear-gradient(135deg, #1b5e20 0%, #2e7d32 50%, #388e3c 100%)",img:"https://images.unsplash.com/photo-1505576399279-565b52d4ac71?w=800&q=80"},{title:"Super Saver Combos",sub:"Curated wellness bundles  Up to 25% OFF",cta:"Explore Combos",link:"/products?category=Super+Saver+Combos",bg:"linear-gradient(135deg, #e65100 0%, #f57c00 100%)",img:"https://images.unsplash.com/photo-1622979135225-d2ba269cf1ac?w=800&q=80"},{title:"PAN-India Free Delivery",sub:"COD Available  Authentic Products  5 Lakh+ Customers",cta:"Browse Products",link:"/products",bg:"linear-gradient(135deg, #1a237e 0%, #283593 100%)",img:"https://images.unsplash.com/photo-1556909114-44e3e70034e2?w=800&q=80"}],ow=[{icon:"",label:"Energy",color:"#ff6b35"},{icon:"",label:"Calm",color:"#7b68ee"},{icon:"",label:"Digestion",color:"#2e7d32"},{icon:"",label:"Immunity",color:"#e65100"},{icon:"",label:"Detox",color:"#00838f"},{icon:"",label:"Fitness",color:"#1565c0"},{icon:"",label:"Sleep",color:"#4a148c"},{icon:"",label:"Weight",color:"#bf360c"}],Yd=yi.slice(0,6),Jd=sw.slice(0,8),lw=[{name:"Priya S.",loc:"Mumbai",rating:5,text:"The Moringa Powder has transformed my energy levels. I feel so much more active!",avatar:"P"},{name:"Raj K.",loc:"Delhi",rating:5,text:"Liver & Kidney Care capsules are incredible. My liver enzymes are back to normal.",avatar:"R"},{name:"Ananya M.",loc:"Bangalore",rating:5,text:"Chamomile Tea is my nightly ritual now. Deep, restful sleep every night!",avatar:"A"}],cw=()=>{const[a,e]=M.useState(0),[i,s]=M.useState(0),[o,l]=M.useState(0),d=M.useRef(null);e1.useEffect(()=>(d.current=window.setInterval(()=>e(p=>(p+1)%ys.length),5e3),()=>{d.current!==null&&clearInterval(d.current)}),[]);const u=Yd.slice(i,i+4),f=Jd.slice(o,o+4);return h.jsxs("main",{className:"page-content",children:[h.jsx("section",{className:"hero-section",children:h.jsxs("div",{className:"hero-slider",children:[ys.map((p,v)=>h.jsxs("div",{className:`hero-slide ${v===a?"active":""}`,style:{background:p.bg},children:[h.jsx("div",{className:"hero-img-wrap",children:h.jsx("img",{src:p.img,alt:p.title})}),h.jsxs("div",{className:"hero-content",children:[h.jsx("h1",{className:"hero-title",children:p.title}),h.jsx("p",{className:"hero-sub",children:p.sub}),h.jsxs("div",{className:"hero-ctas",children:[h.jsx(Te,{to:p.link,className:"btn btn-accent",children:p.cta}),h.jsx(Te,{to:"/products",className:"btn btn-outline hero-outline",children:"View All Products"})]})]})]},v)),h.jsx("div",{className:"hero-dots",children:ys.map((p,v)=>h.jsx("button",{className:`hero-dot ${v===a?"active":""}`,onClick:()=>e(v)},v))}),h.jsx("button",{className:"hero-arrow left",onClick:()=>e(p=>(p-1+ys.length)%ys.length),children:h.jsx(Nl,{size:20})}),h.jsx("button",{className:"hero-arrow right",onClick:()=>e(p=>(p+1)%ys.length),children:h.jsx(Al,{size:20})})]})}),h.jsx("section",{className:"badges-section",children:h.jsxs("div",{className:"container badges-inner",children:[h.jsxs("div",{className:"trust-badge",children:[h.jsx(Yl,{size:22}),h.jsx("span",{children:"Free PAN-India Delivery"})]}),h.jsxs("div",{className:"trust-badge",children:[h.jsx(_E,{size:22}),h.jsx("span",{children:"100% Authentic Products"})]}),h.jsxs("div",{className:"trust-badge",children:[h.jsx(Kl,{size:22}),h.jsx("span",{children:"5 Lakh+ Happy Customers"})]}),h.jsxs("div",{className:"trust-badge",children:[h.jsx(Sb,{size:22}),h.jsx("span",{children:"Easy Returns & Refunds"})]})]})}),h.jsx("section",{className:"section goals-section",children:h.jsxs("div",{className:"container",children:[h.jsx("h2",{className:"section-title",children:"Shop By Goal"}),h.jsx("p",{className:"section-sub",children:"Find the right products tailored to your health goals"}),h.jsx("div",{className:"goal-tiles",children:ow.map(p=>h.jsxs(Te,{to:`/products?goal=${p.label}`,className:"goal-pill",style:{"--gc":p.color},children:[h.jsx("span",{className:"goal-pill-icon",children:p.icon}),h.jsx("span",{children:p.label})]},p.label))})]})}),h.jsx("section",{className:"section carousel-section",children:h.jsxs("div",{className:"container",children:[h.jsxs("div",{className:"section-header",children:[h.jsxs("div",{children:[h.jsx("h2",{className:"section-title",style:{textAlign:"left",marginBottom:0},children:"Featured Products"}),h.jsx("p",{className:"section-sub",style:{textAlign:"left",marginBottom:0},children:"Handpicked for your wellness journey"})]}),h.jsxs("div",{className:"carousel-arrows",children:[h.jsx("button",{className:"carousel-btn",onClick:()=>s(Math.max(0,i-1)),disabled:i===0,children:h.jsx(Nl,{size:18})}),h.jsx("button",{className:"carousel-btn",onClick:()=>s(Math.min(Yd.length-4,i+1)),disabled:i>=Yd.length-4,children:h.jsx(Al,{size:18})})]})]}),h.jsx("div",{className:"products-grid",children:u.map(p=>h.jsx(Yr,{product:p},p.id))})]})}),h.jsx("section",{className:"section carousel-section bestsellers-bg",children:h.jsxs("div",{className:"container",children:[h.jsxs("div",{className:"section-header",children:[h.jsxs("div",{children:[h.jsx("h2",{className:"section-title",style:{textAlign:"left",marginBottom:0},children:" Our Best Sellers"}),h.jsx("p",{className:"section-sub",style:{textAlign:"left",marginBottom:0},children:"Most loved by our customers"})]}),h.jsxs("div",{className:"carousel-arrows",children:[h.jsx("button",{className:"carousel-btn",onClick:()=>l(Math.max(0,o-1)),disabled:o===0,children:h.jsx(Nl,{size:18})}),h.jsx("button",{className:"carousel-btn",onClick:()=>l(Math.min(Jd.length-4,o+1)),disabled:o>=Jd.length-4,children:h.jsx(Al,{size:18})})]})]}),h.jsx("div",{className:"products-grid",children:f.map(p=>h.jsx(Yr,{product:p},p.id))}),h.jsx("div",{style:{textAlign:"center",marginTop:28},children:h.jsx(Te,{to:"/products?tag=bestseller",className:"view-all-cta",children:"View All Best Sellers "})})]})}),h.jsx("section",{className:"section why-section",children:h.jsxs("div",{className:"container",children:[h.jsx("h2",{className:"section-title",children:"Why Choose AmmaFoods?"}),h.jsx("div",{className:"why-grid",children:[{icon:"",title:"100% Natural",desc:"All products are made from pure, natural ingredients  no synthetic additives."},{icon:"",title:"Lab Tested",desc:"Every batch is tested for quality, purity, and potency by third-party labs."},{icon:"",title:"FSSAI Certified",desc:"All products comply with Indian food safety standards and AYUSH guidelines."},{icon:"",title:"Free Delivery",desc:"Free shipping across India on orders above 499. COD available."},{icon:"",title:"Eco-Friendly",desc:"Sustainable packaging, minimal plastic, and carbon-conscious operations."},{icon:"",title:"5 Lakh+ Happy Customers",desc:"Over 5 lakh satisfied customers trust AmmaFoods for their health needs."}].map(p=>h.jsxs("div",{className:"why-card",children:[h.jsx("div",{className:"why-icon",children:p.icon}),h.jsx("h3",{children:p.title}),h.jsx("p",{children:p.desc})]},p.title))})]})}),h.jsx("section",{className:"section testimonial-section",children:h.jsxs("div",{className:"container",children:[h.jsx("h2",{className:"section-title",children:"What Our Customers Say"}),h.jsx("div",{className:"testimonials-grid",children:lw.map(p=>h.jsxs("div",{className:"testimonial-card",children:[h.jsx("div",{className:"t-stars",children:Array.from({length:p.rating}).map((v,y)=>h.jsx(Kl,{size:14,fill:"#f9a825",color:"#f9a825"},y))}),h.jsxs("p",{className:"t-text",children:['"',p.text,'"']}),h.jsxs("div",{className:"t-author",children:[h.jsx("div",{className:"t-avatar",children:p.avatar}),h.jsxs("div",{children:[h.jsx("strong",{children:p.name}),h.jsx("span",{children:p.loc})]})]})]},p.name))})]})})]})},uw=["Popularity","Price: Low to High","Price: High to Low","Discount","Rating"],dw=[...new Set(yi.map(a=>a.category))],hw=[...new Set(yi.flatMap(a=>a.goal))],fw=()=>{const[a]=Px(),[e,i]=M.useState("Popularity"),[s,o]=M.useState([]),[l,d]=M.useState([]),[u,f]=M.useState(2e3),[p,v]=M.useState(!1),[y,S]=M.useState(""),C=a.get("q")||"",_=a.get("category")||"",x=a.get("goal")||"",k=a.get("condition")||"",R=a.get("tag")||"",O=M.useMemo(()=>{let j=[...yi];switch(C&&(j=j.filter(H=>H.name.toLowerCase().includes(C.toLowerCase())||H.description.toLowerCase().includes(C.toLowerCase()))),_&&(j=j.filter(H=>H.category===_)),x&&(j=j.filter(H=>H.goal.includes(x))),k&&(j=j.filter(H=>H.condition.includes(k))),R==="bestseller"&&(j=j.filter(H=>H.isBestSeller)),s.length&&(j=j.filter(H=>s.includes(H.category))),l.length&&(j=j.filter(H=>H.goal.some(Z=>l.includes(Z)))),j=j.filter(H=>H.price<=u),y&&(j=j.filter(H=>H.name.toLowerCase().includes(y.toLowerCase()))),e){case"Price: Low to High":j.sort((H,Z)=>H.price-Z.price);break;case"Price: High to Low":j.sort((H,Z)=>Z.price-H.price);break;case"Discount":j.sort((H,Z)=>Z.discount-H.discount);break;case"Rating":j.sort((H,Z)=>Z.rating-H.rating);break}return j},[C,_,x,k,R,s,l,u,e,y]),L=j=>o(H=>H.includes(j)?H.filter(Z=>Z!==j):[...H,j]),D=j=>d(H=>H.includes(j)?H.filter(Z=>Z!==j):[...H,j]),I=_||x||k||(R==="bestseller"?"Best Sellers":"")||C||"All Products";return h.jsx("main",{className:"page-content plp-page",children:h.jsxs("div",{className:"container",children:[h.jsxs("div",{className:"plp-header",children:[h.jsxs("div",{children:[h.jsx("h1",{className:"plp-title",children:I}),h.jsxs("p",{className:"plp-count",children:[O.length," products found"]})]}),h.jsxs("div",{className:"plp-controls",children:[h.jsxs("div",{className:"plp-search",children:[h.jsx(vh,{size:16}),h.jsx("input",{placeholder:"Filter products...",value:y,onChange:j=>S(j.target.value)})]}),h.jsx("select",{className:"sort-select",value:e,onChange:j=>i(j.target.value),children:uw.map(j=>h.jsx("option",{children:j},j))}),h.jsxs("button",{className:"filter-btn hide-desktop",onClick:()=>v(!0),children:[h.jsx(oE,{size:16})," Filters"]})]})]}),h.jsxs("div",{className:"plp-layout",children:[h.jsxs("aside",{className:`plp-sidebar ${p?"open":""}`,children:[h.jsxs("div",{className:"sidebar-header",children:[h.jsx("h3",{children:"Filters"}),h.jsx("button",{className:"sidebar-close hide-desktop",onClick:()=>v(!1),children:h.jsx(uc,{size:18})})]}),h.jsxs("div",{className:"filter-group",children:[h.jsxs("h4",{children:["Category ",h.jsx(Gl,{size:14})]}),dw.map(j=>h.jsxs("label",{className:"filter-label",children:[h.jsx("input",{type:"checkbox",checked:s.includes(j),onChange:()=>L(j)}),h.jsx("span",{children:j})]},j))]}),h.jsxs("div",{className:"filter-group",children:[h.jsxs("h4",{children:["Health Goal ",h.jsx(Gl,{size:14})]}),hw.map(j=>h.jsxs("label",{className:"filter-label",children:[h.jsx("input",{type:"checkbox",checked:l.includes(j),onChange:()=>D(j)}),h.jsx("span",{children:j})]},j))]}),h.jsxs("div",{className:"filter-group",children:[h.jsxs("h4",{children:["Max Price: ",u]}),h.jsx("input",{type:"range",min:100,max:2e3,step:50,value:u,onChange:j=>f(+j.target.value),className:"price-range"}),h.jsxs("div",{className:"range-labels",children:[h.jsx("span",{children:"100"}),h.jsx("span",{children:"2000"})]})]}),h.jsx("button",{className:"clear-filters",onClick:()=>{o([]),d([]),f(2e3),S("")},children:"Clear All Filters"})]}),p&&h.jsx("div",{className:"overlay hide-desktop",onClick:()=>v(!1)}),h.jsx("div",{className:"plp-grid",children:O.length===0?h.jsxs("div",{className:"no-products",children:[h.jsx("div",{style:{fontSize:"3rem"},children:""}),h.jsx("h3",{children:"No products found"}),h.jsxs("p",{children:["Try different filters or ",h.jsx(Te,{to:"/products",children:"browse all products"})]})]}):O.map(j=>h.jsx(Yr,{product:j},j.id))})]})]})})},mw=()=>{const{id:a}=V1(),e=rw(a||""),{addToCart:i}=Da(),[s,o]=M.useState(0),[l,d]=M.useState(e?.packs[0]||""),[u,f]=M.useState(1),[p,v]=M.useState(!1),[y,S]=M.useState("description");if(!e)return h.jsx("main",{className:"page-content",children:h.jsxs("div",{className:"container",style:{textAlign:"center",padding:"80px 0"},children:[h.jsx("div",{style:{fontSize:"3rem"},children:""}),h.jsx("h2",{children:"Product not found"}),h.jsx(Te,{to:"/products",className:"btn btn-primary",style:{marginTop:20,display:"inline-flex"},children:"Browse Products"})]})});const C=kb().filter(x=>x.category===e.category&&x.id!==e.id).slice(0,4),_=()=>{i({id:e.id,name:e.name,price:e.price,originalPrice:e.originalPrice,image:e.image,quantity:u,pack:l,discount:e.discount}),v(!0),setTimeout(()=>v(!1),2e3)};return h.jsx("main",{className:"page-content",children:h.jsxs("div",{className:"container",children:[h.jsxs("nav",{className:"breadcrumb",children:[h.jsx(Te,{to:"/",children:"Home"})," / ",h.jsx(Te,{to:"/products",children:"Products"})," / ",h.jsx(Te,{to:`/products?category=${encodeURIComponent(e.category)}`,children:e.category})," / ",h.jsx("span",{children:e.name})]}),h.jsxs("div",{className:"pdp-layout",children:[h.jsxs("div",{className:"pdp-gallery",children:[h.jsxs("div",{className:"main-img-wrap",children:[h.jsx("img",{src:e.images[s],alt:e.name}),e.images.length>1&&h.jsxs(h.Fragment,{children:[h.jsx("button",{className:"gallery-arrow left",onClick:()=>o(x=>(x-1+e.images.length)%e.images.length),children:h.jsx(Nl,{size:18})}),h.jsx("button",{className:"gallery-arrow right",onClick:()=>o(x=>(x+1)%e.images.length),children:h.jsx(Al,{size:18})})]}),e.discount>0&&h.jsxs("span",{className:"pdp-discount-badge",children:[e.discount,"% OFF"]})]}),h.jsx("div",{className:"thumbnails",children:e.images.map((x,k)=>h.jsx("button",{className:`thumb ${k===s?"active":""}`,onClick:()=>o(k),children:h.jsx("img",{src:x,alt:`${e.name} view ${k+1}`})},k))})]}),h.jsxs("div",{className:"pdp-info",children:[h.jsx("div",{className:"pdp-category-tag",children:e.category}),h.jsx("h1",{className:"pdp-title",children:e.name}),h.jsxs("div",{className:"pdp-rating",children:[Array.from({length:5}).map((x,k)=>h.jsx(Kl,{size:16,fill:k<Math.round(e.rating)?"#f9a825":"none",color:k<Math.round(e.rating)?"#f9a825":"#ccc"},k)),h.jsx("span",{className:"rating-val",children:e.rating}),h.jsxs("span",{className:"rating-rev",children:["(",e.reviews.toLocaleString()," reviews)"]})]}),h.jsxs("div",{className:"pdp-price-block",children:[h.jsxs("span",{className:"pdp-price",children:["",e.price]}),h.jsxs("span",{className:"pdp-was",children:["",e.originalPrice]}),h.jsxs("span",{className:"pdp-saving",children:["You save ",e.originalPrice-e.price," (",e.discount,"%)"]})]}),h.jsxs("div",{className:"pdp-free-delivery",children:[h.jsx(Yl,{size:16})," ",h.jsx("span",{children:"Free delivery on orders above 499  COD Available"})]}),h.jsx("div",{className:"pdp-section-label",children:"Choose Pack Size"}),h.jsx("div",{className:"pdp-packs",children:e.packs.map(x=>h.jsx("button",{className:`pdp-pack ${l===x?"active":""}`,onClick:()=>d(x),children:x},x))}),h.jsx("div",{className:"pdp-section-label",children:"Quantity"}),h.jsxs("div",{className:"pdp-qty",children:[h.jsx("button",{onClick:()=>f(x=>Math.max(1,x-1)),children:h.jsx(vb,{size:16})}),h.jsx("span",{children:u}),h.jsx("button",{onClick:()=>f(x=>x+1),children:h.jsx(bb,{size:16})})]}),h.jsx("button",{className:`pdp-atc ${p?"added":""}`,onClick:_,children:p?h.jsxs(h.Fragment,{children:[h.jsx(mb,{size:18})," Added to Cart!"]}):h.jsxs(h.Fragment,{children:[h.jsx($h,{size:18})," Add to Cart"]})}),h.jsxs("div",{className:"pdp-trust",children:[h.jsxs("div",{className:"trust-item",children:[h.jsx(NE,{size:16}),h.jsx("span",{children:"100% Natural & Authentic"})]}),h.jsxs("div",{className:"trust-item",children:[h.jsx(Sb,{size:16}),h.jsx("span",{children:"7-Day Easy Returns"})]}),h.jsxs("div",{className:"trust-item",children:[h.jsx(Yl,{size:16}),h.jsx("span",{children:"PAN-India Delivery"})]})]})]})]}),h.jsx("div",{className:"pdp-tabs",children:["description","benefits","howToUse","ingredients"].map(x=>h.jsx("button",{className:`tab-btn ${y===x?"active":""}`,onClick:()=>S(x),children:x==="howToUse"?"How to Use":x.charAt(0).toUpperCase()+x.slice(1)},x))}),h.jsxs("div",{className:"tab-content",children:[y==="description"&&h.jsx("p",{children:e.description}),y==="benefits"&&h.jsx("ul",{className:"benefits-list",children:e.benefits.map(x=>h.jsxs("li",{children:[" ",x]},x))}),y==="howToUse"&&h.jsx("p",{children:e.howToUse}),y==="ingredients"&&h.jsx("p",{children:e.ingredients})]}),C.length>0&&h.jsxs("section",{className:"related-section",children:[h.jsx("h2",{className:"section-title",style:{textAlign:"left",marginBottom:20},children:"You May Also Like"}),h.jsx("div",{className:"related-grid",children:C.map(x=>h.jsx(Yr,{product:x},x.id))})]})]})})},pw=["Andhra Pradesh","Arunachal Pradesh","Assam","Bihar","Chhattisgarh","Goa","Gujarat","Haryana","Himachal Pradesh","Jharkhand","Karnataka","Kerala","Madhya Pradesh","Maharashtra","Manipur","Meghalaya","Mizoram","Nagaland","Odisha","Punjab","Rajasthan","Sikkim","Tamil Nadu","Telangana","Tripura","Uttar Pradesh","Uttarakhand","West Bengal","Delhi","J&K","Ladakh","Chandigarh","Puducherry"],gw=[{label:"Home",icon:h.jsx(cE,{size:16})},{label:"Friends",icon:h.jsx(zE,{size:16})},{label:"Work",icon:h.jsx(Xx,{size:16})},{label:"Other",icon:h.jsx(iE,{size:16})}],vw=()=>{const{state:a,cartTotal:e}=Da(),i=Ma(),[s,o]=M.useState({fullName:"",email:"",phone:"",pincode:"",address:"",state:"Maharashtra",saveAs:"Home"}),[l,d]=M.useState({}),u=e>=499?0:49,f=()=>{const y={};return s.fullName.trim()||(y.fullName="Full name is required"),s.email.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/)||(y.email="Valid email required"),s.phone.match(/^[6-9]\d{9}$/)||(y.phone="Valid 10-digit mobile number required"),s.pincode.match(/^\d{6}$/)||(y.pincode="Valid 6-digit pincode required"),(!s.address.trim()||s.address.trim().length<10)&&(y.address="Please enter your full address (min 10 characters)"),s.state||(y.state="Please select your state"),d(y),Object.keys(y).length===0},p=y=>{y.preventDefault(),f()&&(localStorage.setItem("checkout_address",JSON.stringify(s)),i("/order-summary"))},v=(y,S)=>{o(C=>({...C,[y]:S})),l[y]&&d(C=>({...C,[y]:void 0}))};return a.items.length===0?h.jsx("main",{className:"page-content",children:h.jsxs("div",{className:"container empty-checkout",children:[h.jsx("div",{style:{fontSize:"3rem"},children:""}),h.jsx("h2",{children:"Your cart is empty"}),h.jsx("button",{className:"btn btn-primary",onClick:()=>i("/products"),children:"Shop Now"})]})}):h.jsx("main",{className:"page-content",children:h.jsxs("div",{className:"container",children:[h.jsxs("div",{className:"checkout-progress",children:[h.jsxs("div",{className:"step active",children:[h.jsx("div",{className:"step-num",children:"1"}),h.jsx("span",{children:"Delivery Address"})]}),h.jsx("div",{className:"step-line"}),h.jsxs("div",{className:"step",children:[h.jsx("div",{className:"step-num",children:"2"}),h.jsx("span",{children:"Order Summary"})]}),h.jsx("div",{className:"step-line"}),h.jsxs("div",{className:"step",children:[h.jsx("div",{className:"step-num",children:"3"}),h.jsx("span",{children:"Payment"})]})]}),h.jsxs("div",{className:"checkout-layout",children:[h.jsxs("div",{className:"checkout-form-wrap",children:[h.jsx("h2",{className:"form-title",children:"Delivery Address"}),h.jsxs("form",{onSubmit:p,className:"checkout-form",noValidate:!0,children:[h.jsx("div",{className:"form-row",children:h.jsxs("div",{className:`form-field ${l.fullName?"error":""}`,children:[h.jsxs("label",{children:[h.jsx(qE,{size:14})," Full Name *"]}),h.jsx("input",{type:"text",placeholder:"Enter your full name",value:s.fullName,onChange:y=>v("fullName",y.target.value)}),l.fullName&&h.jsx("span",{className:"field-error",children:l.fullName})]})}),h.jsxs("div",{className:"form-row two-col",children:[h.jsxs("div",{className:`form-field ${l.email?"error":""}`,children:[h.jsxs("label",{children:[h.jsx(pb,{size:14})," Email Address *"]}),h.jsx("input",{type:"email",placeholder:"you@example.com",value:s.email,onChange:y=>v("email",y.target.value)}),l.email&&h.jsx("span",{className:"field-error",children:l.email})]}),h.jsxs("div",{className:`form-field ${l.phone?"error":""}`,children:[h.jsxs("label",{children:[h.jsx(yb,{size:14})," Mobile Number *"]}),h.jsxs("div",{className:"phone-field",children:[h.jsx("span",{className:"country-code",children:" +91"}),h.jsx("input",{type:"tel",placeholder:"10-digit number",maxLength:10,value:s.phone,onChange:y=>v("phone",y.target.value.replace(/\D/g,""))})]}),l.phone&&h.jsx("span",{className:"field-error",children:l.phone})]})]}),h.jsxs("div",{className:"form-row two-col",children:[h.jsxs("div",{className:`form-field ${l.pincode?"error":""}`,children:[h.jsxs("label",{children:[h.jsx(gb,{size:14})," Pincode *"]}),h.jsx("input",{type:"text",placeholder:"6-digit pincode",maxLength:6,value:s.pincode,onChange:y=>v("pincode",y.target.value.replace(/\D/g,""))}),l.pincode&&h.jsx("span",{className:"field-error",children:l.pincode})]}),h.jsxs("div",{className:`form-field ${l.state?"error":""}`,children:[h.jsx("label",{children:"State *"}),h.jsx("select",{value:s.state,onChange:y=>v("state",y.target.value),children:pw.map(y=>h.jsx("option",{children:y},y))}),l.state&&h.jsx("span",{className:"field-error",children:l.state})]})]}),h.jsxs("div",{className:`form-field ${l.address?"error":""}`,children:[h.jsx("label",{children:"Full Address *"}),h.jsx("textarea",{placeholder:"House/flat no., building name, street, area, city...",rows:3,value:s.address,onChange:y=>v("address",y.target.value)}),l.address&&h.jsx("span",{className:"field-error",children:l.address})]}),h.jsxs("div",{className:"form-field",children:[h.jsx("label",{children:"Save Address As"}),h.jsx("div",{className:"save-as-options",children:gw.map(y=>h.jsxs("button",{type:"button",className:`save-as-btn ${s.saveAs===y.label?"active":""}`,onClick:()=>v("saveAs",y.label),children:[y.icon," ",y.label]},y.label))}),h.jsxs("p",{className:"save-as-note",children:[" This address will be secured with OTP on AmmaFoods checkouts. ",h.jsx("span",{children:"View Terms and conditions and Privacy Policy"})]})]}),h.jsx("button",{type:"submit",className:"submit-btn",children:"Save & Continue "})]})]}),h.jsxs("div",{className:"checkout-sidebar",children:[h.jsx("h3",{children:"Order Summary"}),h.jsx("div",{className:"mini-order",children:a.items.map(y=>h.jsxs("div",{className:"mini-item",children:[h.jsx("img",{src:y.image,alt:y.name}),h.jsxs("div",{children:[h.jsx("span",{className:"mini-name",children:y.name}),h.jsxs("span",{className:"mini-pack",children:[y.pack,"  ",y.quantity]})]}),h.jsxs("span",{className:"mini-price",children:["",(y.price*y.quantity).toLocaleString()]})]},`${y.id}-${y.pack}`))}),h.jsxs("div",{className:"checkout-totals",children:[h.jsxs("div",{className:"total-row",children:[h.jsx("span",{children:"Subtotal"}),h.jsxs("span",{children:["",e.toLocaleString()]})]}),h.jsxs("div",{className:"total-row",children:[h.jsx("span",{children:"Delivery"}),h.jsx("span",{children:u===0?"FREE":`${u}`})]}),h.jsxs("div",{className:"total-row grand",children:[h.jsx("span",{children:"Total"}),h.jsxs("span",{children:["",(e+u).toLocaleString()]})]})]})]})]})]})})},yw=()=>{const{state:a,cartTotal:e,cartSavings:i}=Da(),s=Ma(),o=JSON.parse(localStorage.getItem("checkout_address")||"{}"),l=e>=499?0:49,d=e+l;return a.items.length===0?(s("/"),null):h.jsx("main",{className:"page-content",children:h.jsxs("div",{className:"container",children:[h.jsxs("div",{className:"checkout-progress",children:[h.jsxs("div",{className:"step done",children:[h.jsx("div",{className:"step-num",children:""}),h.jsx("span",{children:"Delivery Address"})]}),h.jsx("div",{className:"step-line active-line"}),h.jsxs("div",{className:"step active",children:[h.jsx("div",{className:"step-num",children:"2"}),h.jsx("span",{children:"Order Summary"})]}),h.jsx("div",{className:"step-line"}),h.jsxs("div",{className:"step",children:[h.jsx("div",{className:"step-num",children:"3"}),h.jsx("span",{children:"Payment"})]})]}),h.jsxs("div",{className:"os-layout",children:[h.jsxs("div",{className:"os-main",children:[h.jsxs("div",{className:"os-card",children:[h.jsx("h2",{children:"Order Items"}),a.items.map(u=>h.jsxs("div",{className:"os-item",children:[h.jsx("img",{src:u.image,alt:u.name}),h.jsxs("div",{className:"os-item-info",children:[h.jsx("span",{className:"os-item-name",children:u.name}),h.jsxs("span",{className:"os-item-pack",children:["Pack: ",u.pack]}),h.jsxs("span",{className:"os-item-qty",children:["Qty: ",u.quantity]})]}),h.jsxs("div",{className:"os-item-prices",children:[h.jsxs("span",{className:"os-price",children:["",(u.price*u.quantity).toLocaleString()]}),h.jsxs("span",{className:"os-was",children:["",(u.originalPrice*u.quantity).toLocaleString()]})]})]},`${u.id}-${u.pack}`))]}),h.jsxs("div",{className:"os-card",children:[h.jsx("h2",{children:"Delivery Address"}),h.jsxs("div",{className:"address-display",children:[h.jsx("strong",{children:o.fullName}),h.jsx("p",{children:o.address}),h.jsxs("p",{children:[o.state,"  ",o.pincode]}),h.jsxs("p",{children:[" +91 ",o.phone]}),h.jsxs("p",{children:[" ",o.email]}),h.jsx("span",{className:"address-type-tag",children:o.saveAs||"Home"})]}),h.jsx("button",{className:"change-btn",onClick:()=>s("/checkout"),children:"Change Address"})]})]}),h.jsx("div",{className:"os-sidebar",children:h.jsxs("div",{className:"os-totals-card",children:[h.jsx("h3",{children:"Price Details"}),h.jsxs("div",{className:"os-total-rows",children:[h.jsxs("div",{className:"os-row",children:[h.jsxs("span",{children:["Price (",a.items.reduce((u,f)=>u+f.quantity,0)," items)"]}),h.jsxs("span",{children:["",(e+i).toLocaleString()]})]}),i>0&&h.jsxs("div",{className:"os-row green",children:[h.jsx("span",{children:"Discount"}),h.jsxs("span",{children:["-",i.toLocaleString()]})]}),h.jsxs("div",{className:"os-row",children:[h.jsx("span",{children:"Delivery Charges"}),h.jsx("span",{className:l===0?"free-label":"",children:l===0?" FREE":`${l}`})]}),h.jsxs("div",{className:"os-row grand",children:[h.jsx("span",{children:"Total Payable"}),h.jsxs("span",{children:["",d.toLocaleString()]})]}),i>0&&h.jsxs("div",{className:"os-savings-note",children:[" You will save ",i.toLocaleString()," on this order"]})]}),h.jsxs("button",{className:"proceed-btn",onClick:()=>s("/payment"),children:["Proceed to Pay ",d.toLocaleString()," "]}),h.jsx("div",{className:"secure-note",children:" 100% Safe & Secure Payments"})]})})]})]})})},_y=["State Bank of India","HDFC Bank","ICICI Bank","Axis Bank","Kotak Mahindra","Punjab National Bank","Bank of Baroda","Yes Bank","Canara Bank","Union Bank"],bw=()=>{const{cartTotal:a,clearCart:e}=Da(),[i,s]=M.useState("upi"),[o,l]=M.useState(""),[d,u]=M.useState({number:"",expiry:"",cvv:"",name:""}),[f,p]=M.useState(_y[0]),[v,y]=M.useState(!1),S=Ma(),C=a>=499?0:49,_=a+C,x=()=>{y(!0),setTimeout(()=>{e(),S("/order-confirmed")},2e3)},k=O=>O.replace(/\D/g,"").slice(0,16).replace(/(.{4})/g,"$1 ").trim(),R=O=>{const L=O.replace(/\D/g,"").slice(0,4);return L.length>=3?`${L.slice(0,2)}/${L.slice(2)}`:L};return h.jsx("main",{className:"page-content",children:h.jsxs("div",{className:"container",children:[h.jsxs("div",{className:"checkout-progress",children:[h.jsxs("div",{className:"step done",children:[h.jsx("div",{className:"step-num",children:""}),h.jsx("span",{children:"Delivery Address"})]}),h.jsx("div",{className:"step-line active-line"}),h.jsxs("div",{className:"step done",children:[h.jsx("div",{className:"step-num",children:""}),h.jsx("span",{children:"Order Summary"})]}),h.jsx("div",{className:"step-line active-line"}),h.jsxs("div",{className:"step active",children:[h.jsx("div",{className:"step-num",children:"3"}),h.jsx("span",{children:"Payment"})]})]}),h.jsxs("div",{className:"payment-layout",children:[h.jsxs("div",{className:"payment-methods",children:[h.jsx("h2",{children:"Choose Payment Method"}),h.jsx("div",{className:"method-tabs",children:[["upi"," UPI"],["card"," Card"],["netbanking"," Net Banking"],["cod"," Cash on Delivery"]].map(([O,L])=>h.jsx("button",{className:`method-tab ${i===O?"active":""}`,onClick:()=>s(O),children:L},O))}),i==="upi"&&h.jsxs("div",{className:"method-content",children:[h.jsx("div",{className:"upi-apps",children:["Google Pay","PhonePe","Paytm","BHIM"].map(O=>h.jsxs("div",{className:"upi-app-btn",children:[O==="Google Pay"?"":O==="PhonePe"?"":O==="Paytm"?"":""," ",O]},O))}),h.jsx("div",{className:"divider-or",children:h.jsx("span",{children:"or enter UPI ID"})}),h.jsxs("div",{className:"upi-input-wrap",children:[h.jsx("input",{type:"text",placeholder:"yourname@upi",value:o,onChange:O=>l(O.target.value),className:"pay-input"}),h.jsx("button",{className:"verify-btn",children:"Verify"})]})]}),i==="card"&&h.jsxs("div",{className:"method-content",children:[h.jsxs("div",{className:"card-visual",children:[h.jsx("div",{className:"card-num-display",children:d.number||"   "}),h.jsxs("div",{className:"card-bottom",children:[h.jsxs("div",{children:[h.jsx("div",{className:"card-lbl",children:"CARD HOLDER"}),h.jsx("div",{children:d.name||"YOUR NAME"})]}),h.jsxs("div",{children:[h.jsx("div",{className:"card-lbl",children:"EXPIRES"}),h.jsx("div",{children:d.expiry||"MM/YY"})]})]})]}),h.jsxs("div",{className:"card-fields",children:[h.jsxs("div",{className:"form-field",children:[h.jsx("label",{children:"Card Number"}),h.jsx("input",{type:"text",className:"pay-input",placeholder:"1234 5678 9012 3456",maxLength:19,value:d.number,onChange:O=>u(L=>({...L,number:k(O.target.value)}))})]}),h.jsxs("div",{className:"form-field",children:[h.jsx("label",{children:"Name on Card"}),h.jsx("input",{type:"text",className:"pay-input",placeholder:"Full name as on card",value:d.name,onChange:O=>u(L=>({...L,name:O.target.value}))})]}),h.jsxs("div",{className:"card-row-two",children:[h.jsxs("div",{className:"form-field",children:[h.jsx("label",{children:"Expiry Date"}),h.jsx("input",{type:"text",className:"pay-input",placeholder:"MM/YY",maxLength:5,value:d.expiry,onChange:O=>u(L=>({...L,expiry:R(O.target.value)}))})]}),h.jsxs("div",{className:"form-field",children:[h.jsx("label",{children:"CVV"}),h.jsx("input",{type:"password",className:"pay-input",placeholder:"",maxLength:3,value:d.cvv,onChange:O=>u(L=>({...L,cvv:O.target.value.replace(/\D/g,"").slice(0,3)}))})]})]})]})]}),i==="netbanking"&&h.jsxs("div",{className:"method-content",children:[h.jsxs("label",{className:"form-field",children:[h.jsx("span",{children:"Select Your Bank"}),h.jsx("select",{className:"pay-input",value:f,onChange:O=>p(O.target.value),children:_y.map(O=>h.jsx("option",{children:O},O))})]}),h.jsx("p",{className:"nb-note",children:"You will be redirected to your bank's secure portal to complete the payment."})]}),i==="cod"&&h.jsxs("div",{className:"method-content cod-content",children:[h.jsx("div",{className:"cod-icon",children:""}),h.jsx("h3",{children:"Cash on Delivery"}),h.jsx("p",{children:"Pay in cash when your order arrives at your doorstep. No additional charges."}),h.jsxs("ul",{children:[h.jsx("li",{children:" No extra COD fees"}),h.jsx("li",{children:" Available PAN-India"}),h.jsx("li",{children:" Pay only after inspection"})]})]}),h.jsx("button",{className:"pay-now-btn",onClick:x,disabled:v,children:v?h.jsxs(h.Fragment,{children:[h.jsx("span",{className:"spinner"})," Processing..."]}):`${i==="cod"?"Place Order":"Pay Now"} ${_.toLocaleString()}`}),h.jsx("p",{className:"secure-label",children:" Your payment is safe & secured with 256-bit SSL encryption"})]}),h.jsxs("div",{className:"payment-summary",children:[h.jsx("h3",{children:"Order Total"}),h.jsxs("div",{className:"pay-rows",children:[h.jsxs("div",{className:"pay-row",children:[h.jsx("span",{children:"Subtotal"}),h.jsxs("span",{children:["",a.toLocaleString()]})]}),h.jsxs("div",{className:"pay-row",children:[h.jsx("span",{children:"Delivery"}),h.jsx("span",{children:C===0?"FREE":`${C}`})]}),h.jsxs("div",{className:"pay-row grand",children:[h.jsx("span",{children:"Total"}),h.jsxs("span",{children:["",_.toLocaleString()]})]})]}),h.jsxs("div",{className:"payment-badges",children:[h.jsx("span",{children:" SSL Secured"}),h.jsx("span",{children:" RBI Compliant"}),h.jsx("span",{children:" PCI DSS"})]})]})]})]})})},Sw=()=>{const[a]=M.useState(()=>`HN${Date.now().toString().slice(-8)}`),[e,i]=M.useState(!1);M.useEffect(()=>{setTimeout(()=>i(!0),100)},[]);const s=new Date;s.setDate(s.getDate()+5);const o=s.toLocaleDateString("en-IN",{weekday:"long",day:"numeric",month:"long"});return h.jsx("main",{className:"page-content",children:h.jsx("div",{className:"container",children:h.jsxs("div",{className:`oc-wrapper ${e?"visible":""}`,children:[h.jsx("div",{className:"oc-success-icon",children:h.jsx("div",{className:"oc-circle",children:""})}),h.jsx("h1",{className:"oc-title",children:"Order Placed Successfully!"}),h.jsx("p",{className:"oc-sub",children:"Thank you for shopping with AmmaFoods! "}),h.jsxs("div",{className:"oc-order-card",children:[h.jsxs("div",{className:"oc-row",children:[h.jsx("span",{children:"Order ID"}),h.jsxs("strong",{children:["#",a]})]}),h.jsxs("div",{className:"oc-row",children:[h.jsx("span",{children:"Estimated Delivery"}),h.jsx("strong",{children:o})]}),h.jsxs("div",{className:"oc-row",children:[h.jsx("span",{children:"Status"}),h.jsx("span",{className:"oc-status",children:"Confirmed "})]})]}),h.jsx("div",{className:"oc-steps",children:[{icon:"",label:"Order Confirmed",done:!0},{icon:"",label:"Being Packed",done:!1},{icon:"",label:"Out for Delivery",done:!1},{icon:"",label:"Delivered",done:!1}].map((l,d)=>h.jsxs("div",{className:`oc-step ${l.done?"done":""}`,children:[h.jsx("div",{className:"oc-step-icon",children:l.icon}),h.jsx("span",{children:l.label})]},d))}),h.jsxs("div",{className:"oc-actions",children:[h.jsx(Te,{to:"/products",className:"btn btn-primary",children:"Continue Shopping"}),h.jsx(Te,{to:"/",className:"btn btn-outline",children:"Back to Home"})]}),h.jsx("p",{className:"oc-note",children:"You will receive an SMS and email confirmation shortly. For support, contact support@ammafoods.com.au"})]})})})};var Ry={};function Tw(a,e){return e.forEach(function(i){i&&typeof i!="string"&&!Array.isArray(i)&&Object.keys(i).forEach(function(s){if(s!=="default"&&!(s in a)){var o=Object.getOwnPropertyDescriptor(i,s);Object.defineProperty(a,s,o.get?o:{enumerable:!0,get:function(){return i[s]}})}})}),Object.freeze(a)}var Cw=Object.defineProperty,kw=(a,e,i)=>e in a?Cw(a,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[e]=i,Ny=(a,e,i)=>kw(a,typeof e!="symbol"?e+"":e,i);let It=class{constructor(){Ny(this,"_locking"),Ny(this,"_locks"),this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){this._locks+=1;let e;const i=new Promise(o=>e=()=>{this._locks-=1,o()}),s=this._locking.then(()=>e);return this._locking=this._locking.then(()=>i),s}};function st(a,e){if(!a)throw new Error(e)}const xw=34028234663852886e22,Ew=-34028234663852886e22,ww=4294967295,_w=2147483647,Rw=-2147483648;function Ml(a){if(typeof a!="number")throw new Error("invalid int 32: "+typeof a);if(!Number.isInteger(a)||a>_w||a<Rw)throw new Error("invalid int 32: "+a)}function yh(a){if(typeof a!="number")throw new Error("invalid uint 32: "+typeof a);if(!Number.isInteger(a)||a>ww||a<0)throw new Error("invalid uint 32: "+a)}function xb(a){if(typeof a!="number")throw new Error("invalid float 32: "+typeof a);if(Number.isFinite(a)&&(a>xw||a<Ew))throw new Error("invalid float 32: "+a)}const Eb=Symbol("@bufbuild/protobuf/enum-type");function Nw(a){const e=a[Eb];return st(e,"missing enum type on enum object"),e}function wb(a,e,i,s){a[Eb]=_b(e,i.map(o=>({no:o.no,name:o.name,localName:a[o.no]})))}function _b(a,e,i){const s=Object.create(null),o=Object.create(null),l=[];for(const d of e){const u=Rb(d);l.push(u),s[d.name]=u,o[d.no]=u}return{typeName:a,values:l,findName(d){return s[d]},findNumber(d){return o[d]}}}function Aw(a,e,i){const s={};for(const o of e){const l=Rb(o);s[l.localName]=l.no,s[l.no]=l.localName}return wb(s,a,e),s}function Rb(a){return"localName"in a?a:Object.assign(Object.assign({},a),{localName:a.name})}class ef{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,i){const s=this.getType(),o=s.runtime.bin,l=o.makeReadOptions(i);return o.readMessage(this,l.readerFactory(e),e.byteLength,l),this}fromJson(e,i){const s=this.getType(),o=s.runtime.json,l=o.makeReadOptions(i);return o.readMessage(s,e,l,this),this}fromJsonString(e,i){let s;try{s=JSON.parse(e)}catch(o){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(o instanceof Error?o.message:String(o)))}return this.fromJson(s,i)}toBinary(e){const i=this.getType(),s=i.runtime.bin,o=s.makeWriteOptions(e),l=o.writerFactory();return s.writeMessage(this,l,o),l.finish()}toJson(e){const i=this.getType(),s=i.runtime.json,o=s.makeWriteOptions(e);return s.writeMessage(this,o)}toJsonString(e){var i;const s=this.toJson(e);return JSON.stringify(s,null,(i=e?.prettySpaces)!==null&&i!==void 0?i:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function Mw(a,e,i,s){var o;const l=(o=s?.localName)!==null&&o!==void 0?o:e.substring(e.lastIndexOf(".")+1),d={[l]:function(u){a.util.initFields(this),a.util.initPartial(u,this)}}[l];return Object.setPrototypeOf(d.prototype,new ef),Object.assign(d,{runtime:a,typeName:e,fields:a.util.newFieldList(i),fromBinary(u,f){return new d().fromBinary(u,f)},fromJson(u,f){return new d().fromJson(u,f)},fromJsonString(u,f){return new d().fromJsonString(u,f)},equals(u,f){return a.util.equals(d,u,f)}}),d}function Dw(){let a=0,e=0;for(let s=0;s<28;s+=7){let o=this.buf[this.pos++];if(a|=(o&127)<<s,(o&128)==0)return this.assertBounds(),[a,e]}let i=this.buf[this.pos++];if(a|=(i&15)<<28,e=(i&112)>>4,(i&128)==0)return this.assertBounds(),[a,e];for(let s=3;s<=31;s+=7){let o=this.buf[this.pos++];if(e|=(o&127)<<s,(o&128)==0)return this.assertBounds(),[a,e]}throw new Error("invalid varint")}function Qd(a,e,i){for(let l=0;l<28;l=l+7){const d=a>>>l,u=!(!(d>>>7)&&e==0),f=(u?d|128:d)&255;if(i.push(f),!u)return}const s=a>>>28&15|(e&7)<<4,o=e>>3!=0;if(i.push((o?s|128:s)&255),!!o){for(let l=3;l<31;l=l+7){const d=e>>>l,u=!!(d>>>7),f=(u?d|128:d)&255;if(i.push(f),!u)return}i.push(e>>>31&1)}}const Dl=4294967296;function Ay(a){const e=a[0]==="-";e&&(a=a.slice(1));const i=1e6;let s=0,o=0;function l(d,u){const f=Number(a.slice(d,u));o*=i,s=s*i+f,s>=Dl&&(o=o+(s/Dl|0),s=s%Dl)}return l(-24,-18),l(-18,-12),l(-12,-6),l(-6),e?Ab(s,o):tf(s,o)}function Ow(a,e){let i=tf(a,e);const s=i.hi&2147483648;s&&(i=Ab(i.lo,i.hi));const o=Nb(i.lo,i.hi);return s?"-"+o:o}function Nb(a,e){if({lo:a,hi:e}=jw(a,e),e<=2097151)return String(Dl*e+a);const i=a&16777215,s=(a>>>24|e<<8)&16777215,o=e>>16&65535;let l=i+s*6777216+o*6710656,d=s+o*8147497,u=o*2;const f=1e7;return l>=f&&(d+=Math.floor(l/f),l%=f),d>=f&&(u+=Math.floor(d/f),d%=f),u.toString()+My(d)+My(l)}function jw(a,e){return{lo:a>>>0,hi:e>>>0}}function tf(a,e){return{lo:a|0,hi:e|0}}function Ab(a,e){return e=~e,a?a=~a+1:e+=1,tf(a,e)}const My=a=>{const e=String(a);return"0000000".slice(e.length)+e};function Dy(a,e){if(a>=0){for(;a>127;)e.push(a&127|128),a=a>>>7;e.push(a)}else{for(let i=0;i<9;i++)e.push(a&127|128),a=a>>7;e.push(1)}}function Pw(){let a=this.buf[this.pos++],e=a&127;if((a&128)==0)return this.assertBounds(),e;if(a=this.buf[this.pos++],e|=(a&127)<<7,(a&128)==0)return this.assertBounds(),e;if(a=this.buf[this.pos++],e|=(a&127)<<14,(a&128)==0)return this.assertBounds(),e;if(a=this.buf[this.pos++],e|=(a&127)<<21,(a&128)==0)return this.assertBounds(),e;a=this.buf[this.pos++],e|=(a&15)<<28;for(let i=5;(a&128)!==0&&i<10;i++)a=this.buf[this.pos++];if((a&128)!=0)throw new Error("invalid varint");return this.assertBounds(),e>>>0}function Iw(){const a=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof a.getBigInt64=="function"&&typeof a.getBigUint64=="function"&&typeof a.setBigInt64=="function"&&typeof a.setBigUint64=="function"&&(typeof process!="object"||typeof Ry!="object"||Ry.BUF_BIGINT_DISABLE!=="1")){const o=BigInt("-9223372036854775808"),l=BigInt("9223372036854775807"),d=BigInt("0"),u=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(f){const p=typeof f=="bigint"?f:BigInt(f);if(p>l||p<o)throw new Error("int64 invalid: ".concat(f));return p},uParse(f){const p=typeof f=="bigint"?f:BigInt(f);if(p>u||p<d)throw new Error("uint64 invalid: ".concat(f));return p},enc(f){return a.setBigInt64(0,this.parse(f),!0),{lo:a.getInt32(0,!0),hi:a.getInt32(4,!0)}},uEnc(f){return a.setBigInt64(0,this.uParse(f),!0),{lo:a.getInt32(0,!0),hi:a.getInt32(4,!0)}},dec(f,p){return a.setInt32(0,f,!0),a.setInt32(4,p,!0),a.getBigInt64(0,!0)},uDec(f,p){return a.setInt32(0,f,!0),a.setInt32(4,p,!0),a.getBigUint64(0,!0)}}}const i=o=>st(/^-?[0-9]+$/.test(o),"int64 invalid: ".concat(o)),s=o=>st(/^[0-9]+$/.test(o),"uint64 invalid: ".concat(o));return{zero:"0",supported:!1,parse(o){return typeof o!="string"&&(o=o.toString()),i(o),o},uParse(o){return typeof o!="string"&&(o=o.toString()),s(o),o},enc(o){return typeof o!="string"&&(o=o.toString()),i(o),Ay(o)},uEnc(o){return typeof o!="string"&&(o=o.toString()),s(o),Ay(o)},dec(o,l){return Ow(o,l)},uDec(o,l){return Nb(o,l)}}}const et=Iw();var W;(function(a){a[a.DOUBLE=1]="DOUBLE",a[a.FLOAT=2]="FLOAT",a[a.INT64=3]="INT64",a[a.UINT64=4]="UINT64",a[a.INT32=5]="INT32",a[a.FIXED64=6]="FIXED64",a[a.FIXED32=7]="FIXED32",a[a.BOOL=8]="BOOL",a[a.STRING=9]="STRING",a[a.BYTES=12]="BYTES",a[a.UINT32=13]="UINT32",a[a.SFIXED32=15]="SFIXED32",a[a.SFIXED64=16]="SFIXED64",a[a.SINT32=17]="SINT32",a[a.SINT64=18]="SINT64"})(W||(W={}));var Zi;(function(a){a[a.BIGINT=0]="BIGINT",a[a.STRING=1]="STRING"})(Zi||(Zi={}));function Gi(a,e,i){if(e===i)return!0;if(a==W.BYTES){if(!(e instanceof Uint8Array)||!(i instanceof Uint8Array)||e.length!==i.length)return!1;for(let s=0;s<e.length;s++)if(e[s]!==i[s])return!1;return!0}switch(a){case W.UINT64:case W.FIXED64:case W.INT64:case W.SFIXED64:case W.SINT64:return e==i}return!1}function Ms(a,e){switch(a){case W.BOOL:return!1;case W.UINT64:case W.FIXED64:case W.INT64:case W.SFIXED64:case W.SINT64:return e==0?et.zero:"0";case W.DOUBLE:case W.FLOAT:return 0;case W.BYTES:return new Uint8Array(0);case W.STRING:return"";default:return 0}}function Mb(a,e){switch(a){case W.BOOL:return e===!1;case W.STRING:return e==="";case W.BYTES:return e instanceof Uint8Array&&!e.byteLength;default:return e==0}}var dt;(function(a){a[a.Varint=0]="Varint",a[a.Bit64=1]="Bit64",a[a.LengthDelimited=2]="LengthDelimited",a[a.StartGroup=3]="StartGroup",a[a.EndGroup=4]="EndGroup",a[a.Bit32=5]="Bit32"})(dt||(dt={}));class Lw{constructor(e){this.stack=[],this.textEncoder=e??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let o=0;o<this.chunks.length;o++)e+=this.chunks[o].length;let i=new Uint8Array(e),s=0;for(let o=0;o<this.chunks.length;o++)i.set(this.chunks[o],s),s+=this.chunks[o].length;return this.chunks=[],i}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),i=this.stack.pop();if(!i)throw new Error("invalid state, fork stack empty");return this.chunks=i.chunks,this.buf=i.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,i){return this.uint32((e<<3|i)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(yh(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return Ml(e),Dy(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let i=this.textEncoder.encode(e);return this.uint32(i.byteLength),this.raw(i)}float(e){xb(e);let i=new Uint8Array(4);return new DataView(i.buffer).setFloat32(0,e,!0),this.raw(i)}double(e){let i=new Uint8Array(8);return new DataView(i.buffer).setFloat64(0,e,!0),this.raw(i)}fixed32(e){yh(e);let i=new Uint8Array(4);return new DataView(i.buffer).setUint32(0,e,!0),this.raw(i)}sfixed32(e){Ml(e);let i=new Uint8Array(4);return new DataView(i.buffer).setInt32(0,e,!0),this.raw(i)}sint32(e){return Ml(e),e=(e<<1^e>>31)>>>0,Dy(e,this.buf),this}sfixed64(e){let i=new Uint8Array(8),s=new DataView(i.buffer),o=et.enc(e);return s.setInt32(0,o.lo,!0),s.setInt32(4,o.hi,!0),this.raw(i)}fixed64(e){let i=new Uint8Array(8),s=new DataView(i.buffer),o=et.uEnc(e);return s.setInt32(0,o.lo,!0),s.setInt32(4,o.hi,!0),this.raw(i)}int64(e){let i=et.enc(e);return Qd(i.lo,i.hi,this.buf),this}sint64(e){let i=et.enc(e),s=i.hi>>31,o=i.lo<<1^s,l=(i.hi<<1|i.lo>>>31)^s;return Qd(o,l,this.buf),this}uint64(e){let i=et.uEnc(e);return Qd(i.lo,i.hi,this.buf),this}}class Uw{constructor(e,i){this.varint64=Dw,this.uint32=Pw,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=i??new TextDecoder}tag(){let e=this.uint32(),i=e>>>3,s=e&7;if(i<=0||s<0||s>5)throw new Error("illegal tag: field no "+i+" wire type "+s);return[i,s]}skip(e,i){let s=this.pos;switch(e){case dt.Varint:for(;this.buf[this.pos++]&128;);break;case dt.Bit64:this.pos+=4;case dt.Bit32:this.pos+=4;break;case dt.LengthDelimited:let o=this.uint32();this.pos+=o;break;case dt.StartGroup:for(;;){const[l,d]=this.tag();if(d===dt.EndGroup){if(i!==void 0&&l!==i)throw new Error("invalid end group tag");break}this.skip(d,l)}break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(s,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return et.dec(...this.varint64())}uint64(){return et.uDec(...this.varint64())}sint64(){let[e,i]=this.varint64(),s=-(e&1);return e=(e>>>1|(i&1)<<31)^s,i=i>>>1^s,et.dec(e,i)}bool(){let[e,i]=this.varint64();return e!==0||i!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return et.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return et.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),i=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(i,i+e)}string(){return this.textDecoder.decode(this.bytes())}}function Bw(a,e,i,s){let o;return{typeName:e,extendee:i,get field(){if(!o){const l=typeof s=="function"?s():s;l.name=e.split(".").pop(),l.jsonName="[".concat(e,"]"),o=a.util.newFieldList([l]).list()[0]}return o},runtime:a}}function Db(a){const e=a.field.localName,i=Object.create(null);return i[e]=qw(a),[i,()=>i[e]]}function qw(a){const e=a.field;if(e.repeated)return[];if(e.default!==void 0)return e.default;switch(e.kind){case"enum":return e.T.values[0].no;case"scalar":return Ms(e.T,e.L);case"message":const i=e.T,s=new i;return i.fieldWrapper?i.fieldWrapper.unwrapField(s):s;case"map":throw"map fields are not allowed to be extensions"}}function Fw(a,e){if(!e.repeated&&(e.kind=="enum"||e.kind=="scalar")){for(let i=a.length-1;i>=0;--i)if(a[i].no==e.no)return[a[i]];return[]}return a.filter(i=>i.no===e.no)}let hi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),dc=[];for(let a=0;a<hi.length;a++)dc[hi[a].charCodeAt(0)]=a;dc[45]=hi.indexOf("+");dc[95]=hi.indexOf("/");const Ob={dec(a){let e=a.length*3/4;a[a.length-2]=="="?e-=2:a[a.length-1]=="="&&(e-=1);let i=new Uint8Array(e),s=0,o=0,l,d=0;for(let u=0;u<a.length;u++){if(l=dc[a.charCodeAt(u)],l===void 0)switch(a[u]){case"=":o=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(o){case 0:d=l,o=1;break;case 1:i[s++]=d<<2|(l&48)>>4,d=l,o=2;break;case 2:i[s++]=(d&15)<<4|(l&60)>>2,d=l,o=3;break;case 3:i[s++]=(d&3)<<6|l,o=0;break}}if(o==1)throw Error("invalid base64 string.");return i.subarray(0,s)},enc(a){let e="",i=0,s,o=0;for(let l=0;l<a.length;l++)switch(s=a[l],i){case 0:e+=hi[s>>2],o=(s&3)<<4,i=1;break;case 1:e+=hi[o|s>>4],o=(s&15)<<2,i=2;break;case 2:e+=hi[o|s>>6],e+=hi[s&63],i=0;break}return i&&(e+=hi[o],e+="=",i==1&&(e+="=")),e}};function zw(a,e,i){Pb(e,a);const s=e.runtime.bin.makeReadOptions(i),o=Fw(a.getType().runtime.bin.listUnknownFields(a),e.field),[l,d]=Db(e);for(const u of o)e.runtime.bin.readField(l,s.readerFactory(u.data),e.field,u.wireType,s);return d()}function Hw(a,e,i,s){Pb(e,a);const o=e.runtime.bin.makeReadOptions(s),l=e.runtime.bin.makeWriteOptions(s);if(jb(a,e)){const p=a.getType().runtime.bin.listUnknownFields(a).filter(v=>v.no!=e.field.no);a.getType().runtime.bin.discardUnknownFields(a);for(const v of p)a.getType().runtime.bin.onUnknownField(a,v.no,v.wireType,v.data)}const d=l.writerFactory();let u=e.field;!u.opt&&!u.repeated&&(u.kind=="enum"||u.kind=="scalar")&&(u=Object.assign(Object.assign({},e.field),{opt:!0})),e.runtime.bin.writeField(u,i,d,l);const f=o.readerFactory(d.finish());for(;f.pos<f.len;){const[p,v]=f.tag(),y=f.skip(v,p);a.getType().runtime.bin.onUnknownField(a,p,v,y)}}function jb(a,e){const i=a.getType();return e.extendee.typeName===i.typeName&&!!i.runtime.bin.listUnknownFields(a).find(s=>s.no==e.field.no)}function Pb(a,e){st(a.extendee.typeName==e.getType().typeName,"extension ".concat(a.typeName," can only be applied to message ").concat(a.extendee.typeName))}function Ib(a,e){const i=a.localName;if(a.repeated)return e[i].length>0;if(a.oneof)return e[a.oneof.localName].case===i;switch(a.kind){case"enum":case"scalar":return a.opt||a.req?e[i]!==void 0:a.kind=="enum"?e[i]!==a.T.values[0].no:!Mb(a.T,e[i]);case"message":return e[i]!==void 0;case"map":return Object.keys(e[i]).length>0}}function Oy(a,e){const i=a.localName,s=!a.opt&&!a.req;if(a.repeated)e[i]=[];else if(a.oneof)e[a.oneof.localName]={case:void 0};else switch(a.kind){case"map":e[i]={};break;case"enum":e[i]=s?a.T.values[0].no:void 0;break;case"scalar":e[i]=s?Ms(a.T,a.L):void 0;break;case"message":e[i]=void 0;break}}function fi(a,e){if(a===null||typeof a!="object"||!Object.getOwnPropertyNames(ef.prototype).every(s=>s in a&&typeof a[s]=="function"))return!1;const i=a.getType();return i===null||typeof i!="function"||!("typeName"in i)||typeof i.typeName!="string"?!1:e===void 0?!0:i.typeName==e.typeName}function Lb(a,e){return fi(e)||!a.fieldWrapper?e:a.fieldWrapper.wrapField(e)}W.DOUBLE,W.FLOAT,W.INT64,W.UINT64,W.INT32,W.UINT32,W.BOOL,W.STRING,W.BYTES;const jy={ignoreUnknownFields:!1},Py={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function Vw(a){return a?Object.assign(Object.assign({},jy),a):jy}function Gw(a){return a?Object.assign(Object.assign({},Py),a):Py}const Jl=Symbol(),Ol=Symbol();function Kw(){return{makeReadOptions:Vw,makeWriteOptions:Gw,readMessage(a,e,i,s){if(e==null||Array.isArray(e)||typeof e!="object")throw new Error("cannot decode message ".concat(a.typeName," from JSON: ").concat(Un(e)));s=s??new a;const o=new Map,l=i.typeRegistry;for(const[d,u]of Object.entries(e)){const f=a.fields.findJsonName(d);if(f){if(f.oneof){if(u===null&&f.kind=="scalar")continue;const p=o.get(f.oneof);if(p!==void 0)throw new Error("cannot decode message ".concat(a.typeName,' from JSON: multiple keys for oneof "').concat(f.oneof.name,'" present: "').concat(p,'", "').concat(d,'"'));o.set(f.oneof,d)}Iy(s,u,f,i,a)}else{let p=!1;if(l?.findExtension&&d.startsWith("[")&&d.endsWith("]")){const v=l.findExtension(d.substring(1,d.length-1));if(v&&v.extendee.typeName==a.typeName){p=!0;const[y,S]=Db(v);Iy(y,u,v.field,i,v),Hw(s,v,S(),i)}}if(!p&&!i.ignoreUnknownFields)throw new Error("cannot decode message ".concat(a.typeName,' from JSON: key "').concat(d,'" is unknown'))}}return s},writeMessage(a,e){const i=a.getType(),s={};let o;try{for(o of i.fields.byNumber()){if(!Ib(o,a)){if(o.req)throw"required field not set";if(!e.emitDefaultValues||!Jw(o))continue}const d=o.oneof?a[o.oneof.localName].value:a[o.localName],u=Ly(o,d,e);u!==void 0&&(s[e.useProtoFieldName?o.name:o.jsonName]=u)}const l=e.typeRegistry;if(l?.findExtensionFor)for(const d of i.runtime.bin.listUnknownFields(a)){const u=l.findExtensionFor(i.typeName,d.no);if(u&&jb(a,u)){const f=zw(a,u,e),p=Ly(u.field,f,e);p!==void 0&&(s[u.field.jsonName]=p)}}}catch(l){const d=o?"cannot encode field ".concat(i.typeName,".").concat(o.name," to JSON"):"cannot encode message ".concat(i.typeName," to JSON"),u=l instanceof Error?l.message:String(l);throw new Error(d+(u.length>0?": ".concat(u):""))}return s},readScalar(a,e,i){return qr(a,e,i??Zi.BIGINT,!0)},writeScalar(a,e,i){if(e!==void 0&&(i||Mb(a,e)))return jl(a,e)},debug:Un}}function Un(a){if(a===null)return"null";switch(typeof a){case"object":return Array.isArray(a)?"array":"object";case"string":return a.length>100?"string":'"'.concat(a.split('"').join('\\"'),'"');default:return String(a)}}function Iy(a,e,i,s,o){let l=i.localName;if(i.repeated){if(st(i.kind!="map"),e===null)return;if(!Array.isArray(e))throw new Error("cannot decode field ".concat(o.typeName,".").concat(i.name," from JSON: ").concat(Un(e)));const d=a[l];for(const u of e){if(u===null)throw new Error("cannot decode field ".concat(o.typeName,".").concat(i.name," from JSON: ").concat(Un(u)));switch(i.kind){case"message":d.push(i.T.fromJson(u,s));break;case"enum":const f=Wd(i.T,u,s.ignoreUnknownFields,!0);f!==Ol&&d.push(f);break;case"scalar":try{d.push(qr(i.T,u,i.L,!0))}catch(p){let v="cannot decode field ".concat(o.typeName,".").concat(i.name," from JSON: ").concat(Un(u));throw p instanceof Error&&p.message.length>0&&(v+=": ".concat(p.message)),new Error(v)}break}}}else if(i.kind=="map"){if(e===null)return;if(typeof e!="object"||Array.isArray(e))throw new Error("cannot decode field ".concat(o.typeName,".").concat(i.name," from JSON: ").concat(Un(e)));const d=a[l];for(const[u,f]of Object.entries(e)){if(f===null)throw new Error("cannot decode field ".concat(o.typeName,".").concat(i.name," from JSON: map value null"));let p;try{p=Yw(i.K,u)}catch(v){let y="cannot decode map key for field ".concat(o.typeName,".").concat(i.name," from JSON: ").concat(Un(e));throw v instanceof Error&&v.message.length>0&&(y+=": ".concat(v.message)),new Error(y)}switch(i.V.kind){case"message":d[p]=i.V.T.fromJson(f,s);break;case"enum":const v=Wd(i.V.T,f,s.ignoreUnknownFields,!0);v!==Ol&&(d[p]=v);break;case"scalar":try{d[p]=qr(i.V.T,f,Zi.BIGINT,!0)}catch(y){let S="cannot decode map value for field ".concat(o.typeName,".").concat(i.name," from JSON: ").concat(Un(e));throw y instanceof Error&&y.message.length>0&&(S+=": ".concat(y.message)),new Error(S)}break}}}else switch(i.oneof&&(a=a[i.oneof.localName]={case:l},l="value"),i.kind){case"message":const d=i.T;if(e===null&&d.typeName!="google.protobuf.Value")return;let u=a[l];fi(u)?u.fromJson(e,s):(a[l]=u=d.fromJson(e,s),d.fieldWrapper&&!i.oneof&&(a[l]=d.fieldWrapper.unwrapField(u)));break;case"enum":const f=Wd(i.T,e,s.ignoreUnknownFields,!1);switch(f){case Jl:Oy(i,a);break;case Ol:break;default:a[l]=f;break}break;case"scalar":try{const p=qr(i.T,e,i.L,!1);p===Jl?Oy(i,a):a[l]=p}catch(p){let v="cannot decode field ".concat(o.typeName,".").concat(i.name," from JSON: ").concat(Un(e));throw p instanceof Error&&p.message.length>0&&(v+=": ".concat(p.message)),new Error(v)}break}}function Yw(a,e){if(a===W.BOOL)switch(e){case"true":e=!0;break;case"false":e=!1;break}return qr(a,e,Zi.BIGINT,!0).toString()}function qr(a,e,i,s){if(e===null)return s?Ms(a,i):Jl;switch(a){case W.DOUBLE:case W.FLOAT:if(e==="NaN")return Number.NaN;if(e==="Infinity")return Number.POSITIVE_INFINITY;if(e==="-Infinity")return Number.NEGATIVE_INFINITY;if(e===""||typeof e=="string"&&e.trim().length!==e.length||typeof e!="string"&&typeof e!="number")break;const o=Number(e);if(Number.isNaN(o)||!Number.isFinite(o))break;return a==W.FLOAT&&xb(o),o;case W.INT32:case W.FIXED32:case W.SFIXED32:case W.SINT32:case W.UINT32:let l;if(typeof e=="number"?l=e:typeof e=="string"&&e.length>0&&e.trim().length===e.length&&(l=Number(e)),l===void 0)break;return a==W.UINT32||a==W.FIXED32?yh(l):Ml(l),l;case W.INT64:case W.SFIXED64:case W.SINT64:if(typeof e!="number"&&typeof e!="string")break;const d=et.parse(e);return i?d.toString():d;case W.FIXED64:case W.UINT64:if(typeof e!="number"&&typeof e!="string")break;const u=et.uParse(e);return i?u.toString():u;case W.BOOL:if(typeof e!="boolean")break;return e;case W.STRING:if(typeof e!="string")break;try{encodeURIComponent(e)}catch{throw new Error("invalid UTF8")}return e;case W.BYTES:if(e==="")return new Uint8Array(0);if(typeof e!="string")break;return Ob.dec(e)}throw new Error}function Wd(a,e,i,s){if(e===null)return a.typeName=="google.protobuf.NullValue"?0:s?a.values[0].no:Jl;switch(typeof e){case"number":if(Number.isInteger(e))return e;break;case"string":const o=a.findName(e);if(o!==void 0)return o.no;if(i)return Ol;break}throw new Error("cannot decode enum ".concat(a.typeName," from JSON: ").concat(Un(e)))}function Jw(a){return a.repeated||a.kind=="map"?!0:!(a.oneof||a.kind=="message"||a.opt||a.req)}function Ly(a,e,i){if(a.kind=="map"){st(typeof e=="object"&&e!=null);const s={},o=Object.entries(e);switch(a.V.kind){case"scalar":for(const[d,u]of o)s[d.toString()]=jl(a.V.T,u);break;case"message":for(const[d,u]of o)s[d.toString()]=u.toJson(i);break;case"enum":const l=a.V.T;for(const[d,u]of o)s[d.toString()]=Xd(l,u,i.enumAsInteger);break}return i.emitDefaultValues||o.length>0?s:void 0}if(a.repeated){st(Array.isArray(e));const s=[];switch(a.kind){case"scalar":for(let o=0;o<e.length;o++)s.push(jl(a.T,e[o]));break;case"enum":for(let o=0;o<e.length;o++)s.push(Xd(a.T,e[o],i.enumAsInteger));break;case"message":for(let o=0;o<e.length;o++)s.push(e[o].toJson(i));break}return i.emitDefaultValues||s.length>0?s:void 0}switch(a.kind){case"scalar":return jl(a.T,e);case"enum":return Xd(a.T,e,i.enumAsInteger);case"message":return Lb(a.T,e).toJson(i)}}function Xd(a,e,i){var s;if(st(typeof e=="number"),a.typeName=="google.protobuf.NullValue")return null;if(i)return e;const o=a.findNumber(e);return(s=o?.name)!==null&&s!==void 0?s:e}function jl(a,e){switch(a){case W.INT32:case W.SFIXED32:case W.SINT32:case W.FIXED32:case W.UINT32:return st(typeof e=="number"),e;case W.FLOAT:case W.DOUBLE:return st(typeof e=="number"),Number.isNaN(e)?"NaN":e===Number.POSITIVE_INFINITY?"Infinity":e===Number.NEGATIVE_INFINITY?"-Infinity":e;case W.STRING:return st(typeof e=="string"),e;case W.BOOL:return st(typeof e=="boolean"),e;case W.UINT64:case W.FIXED64:case W.INT64:case W.SFIXED64:case W.SINT64:return st(typeof e=="bigint"||typeof e=="string"||typeof e=="number"),e.toString();case W.BYTES:return st(e instanceof Uint8Array),Ob.enc(e)}}const bs=Symbol("@bufbuild/protobuf/unknown-fields"),Uy={readUnknownFields:!0,readerFactory:a=>new Uw(a)},By={writeUnknownFields:!0,writerFactory:()=>new Lw};function Qw(a){return a?Object.assign(Object.assign({},Uy),a):Uy}function Ww(a){return a?Object.assign(Object.assign({},By),a):By}function Xw(){return{makeReadOptions:Qw,makeWriteOptions:Ww,listUnknownFields(a){var e;return(e=a[bs])!==null&&e!==void 0?e:[]},discardUnknownFields(a){delete a[bs]},writeUnknownFields(a,e){const s=a[bs];if(s)for(const o of s)e.tag(o.no,o.wireType).raw(o.data)},onUnknownField(a,e,i,s){const o=a;Array.isArray(o[bs])||(o[bs]=[]),o[bs].push({no:e,wireType:i,data:s})},readMessage(a,e,i,s,o){const l=a.getType(),d=o?e.len:e.pos+i;let u,f;for(;e.pos<d&&([u,f]=e.tag(),!(o===!0&&f==dt.EndGroup));){const p=l.fields.find(u);if(!p){const v=e.skip(f,u);s.readUnknownFields&&this.onUnknownField(a,u,f,v);continue}qy(a,e,p,f,s)}if(o&&(f!=dt.EndGroup||u!==i))throw new Error("invalid end group tag")},readField:qy,writeMessage(a,e,i){const s=a.getType();for(const o of s.fields.byNumber()){if(!Ib(o,a)){if(o.req)throw new Error("cannot encode field ".concat(s.typeName,".").concat(o.name," to binary: required field not set"));continue}const l=o.oneof?a[o.oneof.localName].value:a[o.localName];Fy(o,l,e,i)}return i.writeUnknownFields&&this.writeUnknownFields(a,e),e},writeField(a,e,i,s){e!==void 0&&Fy(a,e,i,s)}}}function qy(a,e,i,s,o){let{repeated:l,localName:d}=i;switch(i.oneof&&(a=a[i.oneof.localName],a.case!=d&&delete a.value,a.case=d,d="value"),i.kind){case"scalar":case"enum":const u=i.kind=="enum"?W.INT32:i.T;let f=Ql;if(i.kind=="scalar"&&i.L>0&&(f=$w),l){let S=a[d];if(s==dt.LengthDelimited&&u!=W.STRING&&u!=W.BYTES){let _=e.uint32()+e.pos;for(;e.pos<_;)S.push(f(e,u))}else S.push(f(e,u))}else a[d]=f(e,u);break;case"message":const p=i.T;l?a[d].push(Pl(e,new p,o,i)):fi(a[d])?Pl(e,a[d],o,i):(a[d]=Pl(e,new p,o,i),p.fieldWrapper&&!i.oneof&&!i.repeated&&(a[d]=p.fieldWrapper.unwrapField(a[d])));break;case"map":let[v,y]=Zw(i,e,o);a[d][v]=y;break}}function Pl(a,e,i,s){const o=e.getType().runtime.bin,l=s?.delimited;return o.readMessage(e,a,l?s.no:a.uint32(),i,l),e}function Zw(a,e,i){const s=e.uint32(),o=e.pos+s;let l,d;for(;e.pos<o;){const[u]=e.tag();switch(u){case 1:l=Ql(e,a.K);break;case 2:switch(a.V.kind){case"scalar":d=Ql(e,a.V.T);break;case"enum":d=e.int32();break;case"message":d=Pl(e,new a.V.T,i,void 0);break}break}}if(l===void 0&&(l=Ms(a.K,Zi.BIGINT)),typeof l!="string"&&typeof l!="number"&&(l=l.toString()),d===void 0)switch(a.V.kind){case"scalar":d=Ms(a.V.T,Zi.BIGINT);break;case"enum":d=a.V.T.values[0].no;break;case"message":d=new a.V.T;break}return[l,d]}function $w(a,e){const i=Ql(a,e);return typeof i=="bigint"?i.toString():i}function Ql(a,e){switch(e){case W.STRING:return a.string();case W.BOOL:return a.bool();case W.DOUBLE:return a.double();case W.FLOAT:return a.float();case W.INT32:return a.int32();case W.INT64:return a.int64();case W.UINT64:return a.uint64();case W.FIXED64:return a.fixed64();case W.BYTES:return a.bytes();case W.FIXED32:return a.fixed32();case W.SFIXED32:return a.sfixed32();case W.SFIXED64:return a.sfixed64();case W.SINT64:return a.sint64();case W.UINT32:return a.uint32();case W.SINT32:return a.sint32()}}function Fy(a,e,i,s){st(e!==void 0);const o=a.repeated;switch(a.kind){case"scalar":case"enum":let l=a.kind=="enum"?W.INT32:a.T;if(o)if(st(Array.isArray(e)),a.packed)t_(i,l,a.no,e);else for(const d of e)Fr(i,l,a.no,d);else Fr(i,l,a.no,e);break;case"message":if(o){st(Array.isArray(e));for(const d of e)zy(i,s,a,d)}else zy(i,s,a,e);break;case"map":st(typeof e=="object"&&e!=null);for(const[d,u]of Object.entries(e))e_(i,s,a,d,u);break}}function e_(a,e,i,s,o){a.tag(i.no,dt.LengthDelimited),a.fork();let l=s;switch(i.K){case W.INT32:case W.FIXED32:case W.UINT32:case W.SFIXED32:case W.SINT32:l=Number.parseInt(s);break;case W.BOOL:st(s=="true"||s=="false"),l=s=="true";break}switch(Fr(a,i.K,1,l),i.V.kind){case"scalar":Fr(a,i.V.T,2,o);break;case"enum":Fr(a,W.INT32,2,o);break;case"message":st(o!==void 0),a.tag(2,dt.LengthDelimited).bytes(o.toBinary(e));break}a.join()}function zy(a,e,i,s){const o=Lb(i.T,s);i.delimited?a.tag(i.no,dt.StartGroup).raw(o.toBinary(e)).tag(i.no,dt.EndGroup):a.tag(i.no,dt.LengthDelimited).bytes(o.toBinary(e))}function Fr(a,e,i,s){st(s!==void 0);let[o,l]=Ub(e);a.tag(i,o)[l](s)}function t_(a,e,i,s){if(!s.length)return;a.tag(i,dt.LengthDelimited).fork();let[,o]=Ub(e);for(let l=0;l<s.length;l++)a[o](s[l]);a.join()}function Ub(a){let e=dt.Varint;switch(a){case W.BYTES:case W.STRING:e=dt.LengthDelimited;break;case W.DOUBLE:case W.FIXED64:case W.SFIXED64:e=dt.Bit64;break;case W.FIXED32:case W.SFIXED32:case W.FLOAT:e=dt.Bit32;break}const i=W[a].toLowerCase();return[e,i]}function n_(){return{setEnumType:wb,initPartial(a,e){if(a===void 0)return;const i=e.getType();for(const s of i.fields.byMember()){const o=s.localName,l=e,d=a;if(d[o]!=null)switch(s.kind){case"oneof":const u=d[o].case;if(u===void 0)continue;const f=s.findField(u);let p=d[o].value;f&&f.kind=="message"&&!fi(p,f.T)?p=new f.T(p):f&&f.kind==="scalar"&&f.T===W.BYTES&&(p=Dr(p)),l[o]={case:u,value:p};break;case"scalar":case"enum":let v=d[o];s.T===W.BYTES&&(v=s.repeated?v.map(Dr):Dr(v)),l[o]=v;break;case"map":switch(s.V.kind){case"scalar":case"enum":if(s.V.T===W.BYTES)for(const[C,_]of Object.entries(d[o]))l[o][C]=Dr(_);else Object.assign(l[o],d[o]);break;case"message":const S=s.V.T;for(const C of Object.keys(d[o])){let _=d[o][C];S.fieldWrapper||(_=new S(_)),l[o][C]=_}break}break;case"message":const y=s.T;if(s.repeated)l[o]=d[o].map(S=>fi(S,y)?S:new y(S));else{const S=d[o];y.fieldWrapper?y.typeName==="google.protobuf.BytesValue"?l[o]=Dr(S):l[o]=S:l[o]=fi(S,y)?S:new y(S)}break}}},equals(a,e,i){return e===i?!0:!e||!i?!1:a.fields.byMember().every(s=>{const o=e[s.localName],l=i[s.localName];if(s.repeated){if(o.length!==l.length)return!1;switch(s.kind){case"message":return o.every((d,u)=>s.T.equals(d,l[u]));case"scalar":return o.every((d,u)=>Gi(s.T,d,l[u]));case"enum":return o.every((d,u)=>Gi(W.INT32,d,l[u]))}throw new Error("repeated cannot contain ".concat(s.kind))}switch(s.kind){case"message":let d=o,u=l;return s.T.fieldWrapper&&(d!==void 0&&!fi(d)&&(d=s.T.fieldWrapper.wrapField(d)),u!==void 0&&!fi(u)&&(u=s.T.fieldWrapper.wrapField(u))),s.T.equals(d,u);case"enum":return Gi(W.INT32,o,l);case"scalar":return Gi(s.T,o,l);case"oneof":if(o.case!==l.case)return!1;const f=s.findField(o.case);if(f===void 0)return!0;switch(f.kind){case"message":return f.T.equals(o.value,l.value);case"enum":return Gi(W.INT32,o.value,l.value);case"scalar":return Gi(f.T,o.value,l.value)}throw new Error("oneof cannot contain ".concat(f.kind));case"map":const p=Object.keys(o).concat(Object.keys(l));switch(s.V.kind){case"message":const v=s.V.T;return p.every(S=>v.equals(o[S],l[S]));case"enum":return p.every(S=>Gi(W.INT32,o[S],l[S]));case"scalar":const y=s.V.T;return p.every(S=>Gi(y,o[S],l[S]))}break}})},clone(a){const e=a.getType(),i=new e,s=i;for(const o of e.fields.byMember()){const l=a[o.localName];let d;if(o.repeated)d=l.map(xl);else if(o.kind=="map"){d=s[o.localName];for(const[u,f]of Object.entries(l))d[u]=xl(f)}else o.kind=="oneof"?d=o.findField(l.case)?{case:l.case,value:xl(l.value)}:{case:void 0}:d=xl(l);s[o.localName]=d}for(const o of e.runtime.bin.listUnknownFields(a))e.runtime.bin.onUnknownField(s,o.no,o.wireType,o.data);return i}}}function xl(a){if(a===void 0)return a;if(fi(a))return a.clone();if(a instanceof Uint8Array){const e=new Uint8Array(a.byteLength);return e.set(a),e}return a}function Dr(a){return a instanceof Uint8Array?a:new Uint8Array(a)}function i_(a,e,i){return{syntax:a,json:Kw(),bin:Xw(),util:Object.assign(Object.assign({},n_()),{newFieldList:e,initFields:i}),makeMessageType(s,o,l){return Mw(this,s,o,l)},makeEnum:Aw,makeEnumType:_b,getEnumType:Nw,makeExtension(s,o,l){return Bw(this,s,o,l)}}}class a_{constructor(e,i){this._fields=e,this._normalizer=i}findJsonName(e){if(!this.jsonNames){const i={};for(const s of this.list())i[s.jsonName]=i[s.name]=s;this.jsonNames=i}return this.jsonNames[e]}find(e){if(!this.numbers){const i={};for(const s of this.list())i[s.no]=s;this.numbers=i}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,i)=>e.no-i.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let i;for(const s of this.list())s.oneof?s.oneof!==i&&(i=s.oneof,e.push(i)):e.push(s)}return this.members}}function Bb(a,e){const i=qb(a);return e?i:u_(c_(i))}function s_(a){return Bb(a,!1)}const r_=qb;function qb(a){let e=!1;const i=[];for(let s=0;s<a.length;s++){let o=a.charAt(s);switch(o){case"_":e=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":i.push(o),e=!1;break;default:e&&(e=!1,o=o.toUpperCase()),i.push(o);break}}return i.join("")}const o_=new Set(["constructor","toString","toJSON","valueOf"]),l_=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),Fb=a=>"".concat(a,"$"),c_=a=>l_.has(a)?Fb(a):a,u_=a=>o_.has(a)?Fb(a):a;class d_{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.req=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=s_(e)}addField(e){st(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let i=0;i<this.fields.length;i++)this._lookup[this.fields[i].localName]=this.fields[i]}return this._lookup[e]}}function h_(a,e){var i,s,o,l,d,u;const f=[];let p;for(const v of typeof a=="function"?a():a){const y=v;if(y.localName=Bb(v.name,v.oneof!==void 0),y.jsonName=(i=v.jsonName)!==null&&i!==void 0?i:r_(v.name),y.repeated=(s=v.repeated)!==null&&s!==void 0?s:!1,v.kind=="scalar"&&(y.L=(o=v.L)!==null&&o!==void 0?o:Zi.BIGINT),y.delimited=(l=v.delimited)!==null&&l!==void 0?l:!1,y.req=(d=v.req)!==null&&d!==void 0?d:!1,y.opt=(u=v.opt)!==null&&u!==void 0?u:!1,v.packed===void 0&&(y.packed=v.kind=="enum"||v.kind=="scalar"&&v.T!=W.BYTES&&v.T!=W.STRING),v.oneof!==void 0){const S=typeof v.oneof=="string"?v.oneof:v.oneof.name;(!p||p.name!=S)&&(p=new d_(S)),y.oneof=p,p.addField(y)}f.push(y)}return f}const U=i_("proto3",a=>new a_(a,e=>h_(e)),a=>{for(const e of a.getType().fields.byMember()){if(e.opt)continue;const i=e.localName,s=a;if(e.repeated){s[i]=[];continue}switch(e.kind){case"oneof":s[i]={case:void 0};break;case"enum":s[i]=0;break;case"map":s[i]={};break;case"scalar":s[i]=Ms(e.T,e.L);break}}});class Gt extends ef{constructor(e){super(),this.seconds=et.zero,this.nanos=0,U.util.initPartial(e,this)}fromJson(e,i){if(typeof e!="string")throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(U.json.debug(e)));const s=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!s)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const o=Date.parse(s[1]+"-"+s[2]+"-"+s[3]+"T"+s[4]+":"+s[5]+":"+s[6]+(s[8]?s[8]:"Z"));if(Number.isNaN(o))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(o<Date.parse("0001-01-01T00:00:00Z")||o>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=et.parse(o/1e3),this.nanos=0,s[7]&&(this.nanos=parseInt("1"+s[7]+"0".repeat(9-s[7].length))-1e9),this}toJson(e){const i=Number(this.seconds)*1e3;if(i<Date.parse("0001-01-01T00:00:00Z")||i>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let s="Z";if(this.nanos>0){const o=(this.nanos+1e9).toString().substring(1);o.substring(3)==="000000"?s="."+o.substring(0,3)+"Z":o.substring(6)==="000"?s="."+o.substring(0,6)+"Z":s="."+o+"Z"}return new Date(i).toISOString().replace(".000Z",s)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return Gt.fromDate(new Date)}static fromDate(e){const i=e.getTime();return new Gt({seconds:et.parse(Math.floor(i/1e3)),nanos:i%1e3*1e6})}static fromBinary(e,i){return new Gt().fromBinary(e,i)}static fromJson(e,i){return new Gt().fromJson(e,i)}static fromJsonString(e,i){return new Gt().fromJsonString(e,i)}static equals(e,i){return U.util.equals(Gt,e,i)}}Gt.runtime=U;Gt.typeName="google.protobuf.Timestamp";Gt.fields=U.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);const f_=U.makeMessageType("livekit.MetricsBatch",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:Gt},{no:3,name:"str_data",kind:"scalar",T:9,repeated:!0},{no:4,name:"time_series",kind:"message",T:m_,repeated:!0},{no:5,name:"events",kind:"message",T:g_,repeated:!0}]),m_=U.makeMessageType("livekit.TimeSeriesMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"samples",kind:"message",T:p_,repeated:!0},{no:5,name:"rid",kind:"scalar",T:13}]),p_=U.makeMessageType("livekit.MetricSample",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:Gt},{no:3,name:"value",kind:"scalar",T:2}]),g_=U.makeMessageType("livekit.EventMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"start_timestamp_ms",kind:"scalar",T:3},{no:5,name:"end_timestamp_ms",kind:"scalar",T:3,opt:!0},{no:6,name:"normalized_start_timestamp",kind:"message",T:Gt},{no:7,name:"normalized_end_timestamp",kind:"message",T:Gt,opt:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"rid",kind:"scalar",T:13}]),zb=U.makeEnum("livekit.BackupCodecPolicy",[{no:0,name:"PREFER_REGRESSION"},{no:1,name:"SIMULCAST"},{no:2,name:"REGRESSION"}]),_n=U.makeEnum("livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]),vt=U.makeEnum("livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]),nf=U.makeEnum("livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]),Ur=U.makeEnum("livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]),Jr=U.makeEnum("livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]),An=U.makeEnum("livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"},{no:8,name:"MIGRATION"},{no:9,name:"SIGNAL_CLOSE"},{no:10,name:"ROOM_CLOSED"},{no:11,name:"USER_UNAVAILABLE"},{no:12,name:"USER_REJECTED"},{no:13,name:"SIP_TRUNK_FAILURE"},{no:14,name:"CONNECTION_TIMEOUT"},{no:15,name:"MEDIA_FAILURE"}]),ka=U.makeEnum("livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]),v_=U.makeEnum("livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]),Tt=U.makeEnum("livekit.AudioTrackFeature",[{no:0,name:"TF_STEREO"},{no:1,name:"TF_NO_DTX"},{no:2,name:"TF_AUTO_GAIN_CONTROL"},{no:3,name:"TF_ECHO_CANCELLATION"},{no:4,name:"TF_NOISE_SUPPRESSION"},{no:5,name:"TF_ENHANCED_NOISE_CANCELLATION"},{no:6,name:"TF_PRECONNECT_BUFFER"}]),hc=U.makeMessageType("livekit.Room",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:14,name:"departure_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:15,name:"creation_time_ms",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:Wl,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8},{no:13,name:"version",kind:"message",T:tS}]),Wl=U.makeMessageType("livekit.Codec",()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]),y_=U.makeMessageType("livekit.ParticipantPermission",()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:U.getEnumType(vt),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8},{no:12,name:"can_subscribe_metrics",kind:"scalar",T:8}]),Ra=U.makeMessageType("livekit.ParticipantInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:U.getEnumType(xs)},{no:4,name:"tracks",kind:"message",T:Ts,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:17,name:"joined_at_ms",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:y_},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8},{no:14,name:"kind",kind:"enum",T:U.getEnumType(Qr)},{no:15,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:16,name:"disconnect_reason",kind:"enum",T:U.getEnumType(An)},{no:18,name:"kind_details",kind:"enum",T:U.getEnumType(b_),repeated:!0},{no:19,name:"data_tracks",kind:"message",T:af,repeated:!0}]),xs=U.makeEnum("livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]),Qr=U.makeEnum("livekit.ParticipantInfo.Kind",[{no:0,name:"STANDARD"},{no:1,name:"INGRESS"},{no:2,name:"EGRESS"},{no:3,name:"SIP"},{no:4,name:"AGENT"},{no:7,name:"CONNECTOR"},{no:8,name:"BRIDGE"}]),b_=U.makeEnum("livekit.ParticipantInfo.KindDetail",[{no:0,name:"CLOUD_AGENT"},{no:1,name:"FORWARDED"},{no:2,name:"CONNECTOR_WHATSAPP"},{no:3,name:"CONNECTOR_TWILIO"},{no:4,name:"BRIDGE_RTSP"}]),ht=U.makeEnum("livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]),S_=U.makeMessageType("livekit.SimulcastCodecInfo",()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:Wi,repeated:!0},{no:5,name:"video_layer_mode",kind:"enum",T:U.getEnumType(Hb)},{no:6,name:"sdp_cid",kind:"scalar",T:9}]),Ts=U.makeMessageType("livekit.TrackInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:U.getEnumType(_n)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:U.getEnumType(vt)},{no:10,name:"layers",kind:"message",T:Wi,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:S_,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:U.getEnumType(ht)},{no:17,name:"stream",kind:"scalar",T:9},{no:18,name:"version",kind:"message",T:tS},{no:19,name:"audio_features",kind:"enum",T:U.getEnumType(Tt),repeated:!0},{no:20,name:"backup_codec_policy",kind:"enum",T:U.getEnumType(zb)}]),af=U.makeMessageType("livekit.DataTrackInfo",()=>[{no:1,name:"pub_handle",kind:"scalar",T:13},{no:2,name:"sid",kind:"scalar",T:9},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"encryption",kind:"enum",T:U.getEnumType(ht)}]),T_=U.makeMessageType("livekit.DataTrackSubscriptionOptions",()=>[{no:1,name:"target_fps",kind:"scalar",T:13,opt:!0}]),Wi=U.makeMessageType("livekit.VideoLayer",()=>[{no:1,name:"quality",kind:"enum",T:U.getEnumType(nf)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13},{no:6,name:"spatial_layer",kind:"scalar",T:5},{no:7,name:"rid",kind:"scalar",T:9},{no:8,name:"repair_ssrc",kind:"scalar",T:13}]),Hb=U.makeEnum("livekit.VideoLayer.Mode",[{no:0,name:"MODE_UNUSED"},{no:1,name:"ONE_SPATIAL_LAYER_PER_STREAM"},{no:2,name:"MULTIPLE_SPATIAL_LAYERS_PER_STREAM"},{no:3,name:"ONE_SPATIAL_LAYER_PER_STREAM_INCOMPLETE_RTCP_SR"}]),Pt=U.makeMessageType("livekit.DataPacket",()=>[{no:1,name:"kind",kind:"enum",T:U.getEnumType(Ce)},{no:4,name:"participant_identity",kind:"scalar",T:9},{no:5,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:2,name:"user",kind:"message",T:sf,oneof:"value"},{no:3,name:"speaker",kind:"message",T:C_,oneof:"value"},{no:6,name:"sip_dtmf",kind:"message",T:Yb,oneof:"value"},{no:7,name:"transcription",kind:"message",T:k_,oneof:"value"},{no:8,name:"metrics",kind:"message",T:f_,oneof:"value"},{no:9,name:"chat_message",kind:"message",T:Xl,oneof:"value"},{no:10,name:"rpc_request",kind:"message",T:rf,oneof:"value"},{no:11,name:"rpc_ack",kind:"message",T:of,oneof:"value"},{no:12,name:"rpc_response",kind:"message",T:lf,oneof:"value"},{no:13,name:"stream_header",kind:"message",T:Zl,oneof:"value"},{no:14,name:"stream_chunk",kind:"message",T:$l,oneof:"value"},{no:15,name:"stream_trailer",kind:"message",T:ec,oneof:"value"},{no:18,name:"encrypted_packet",kind:"message",T:Vb,oneof:"value"},{no:16,name:"sequence",kind:"scalar",T:13},{no:17,name:"participant_sid",kind:"scalar",T:9}]),Ce=U.makeEnum("livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]),Vb=U.makeMessageType("livekit.EncryptedPacket",()=>[{no:1,name:"encryption_type",kind:"enum",T:U.getEnumType(ht)},{no:2,name:"iv",kind:"scalar",T:12},{no:3,name:"key_index",kind:"scalar",T:13},{no:4,name:"encrypted_value",kind:"scalar",T:12}]),Gb=U.makeMessageType("livekit.EncryptedPacketPayload",()=>[{no:1,name:"user",kind:"message",T:sf,oneof:"value"},{no:3,name:"chat_message",kind:"message",T:Xl,oneof:"value"},{no:4,name:"rpc_request",kind:"message",T:rf,oneof:"value"},{no:5,name:"rpc_ack",kind:"message",T:of,oneof:"value"},{no:6,name:"rpc_response",kind:"message",T:lf,oneof:"value"},{no:7,name:"stream_header",kind:"message",T:Zl,oneof:"value"},{no:8,name:"stream_chunk",kind:"message",T:$l,oneof:"value"},{no:9,name:"stream_trailer",kind:"message",T:ec,oneof:"value"}]),C_=U.makeMessageType("livekit.ActiveSpeakerUpdate",()=>[{no:1,name:"speakers",kind:"message",T:Kb,repeated:!0}]),Kb=U.makeMessageType("livekit.SpeakerInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]),sf=U.makeMessageType("livekit.UserPacket",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0},{no:8,name:"id",kind:"scalar",T:9,opt:!0},{no:9,name:"start_time",kind:"scalar",T:4,opt:!0},{no:10,name:"end_time",kind:"scalar",T:4,opt:!0},{no:11,name:"nonce",kind:"scalar",T:12}]),Yb=U.makeMessageType("livekit.SipDTMF",()=>[{no:3,name:"code",kind:"scalar",T:13},{no:4,name:"digit",kind:"scalar",T:9}]),k_=U.makeMessageType("livekit.Transcription",()=>[{no:2,name:"transcribed_participant_identity",kind:"scalar",T:9},{no:3,name:"track_id",kind:"scalar",T:9},{no:4,name:"segments",kind:"message",T:x_,repeated:!0}]),x_=U.makeMessageType("livekit.TranscriptionSegment",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"text",kind:"scalar",T:9},{no:3,name:"start_time",kind:"scalar",T:4},{no:4,name:"end_time",kind:"scalar",T:4},{no:5,name:"final",kind:"scalar",T:8},{no:6,name:"language",kind:"scalar",T:9}]),Xl=U.makeMessageType("livekit.ChatMessage",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"edit_timestamp",kind:"scalar",T:3,opt:!0},{no:4,name:"message",kind:"scalar",T:9},{no:5,name:"deleted",kind:"scalar",T:8},{no:6,name:"generated",kind:"scalar",T:8}]),rf=U.makeMessageType("livekit.RpcRequest",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"method",kind:"scalar",T:9},{no:3,name:"payload",kind:"scalar",T:9},{no:4,name:"response_timeout_ms",kind:"scalar",T:13},{no:5,name:"version",kind:"scalar",T:13}]),of=U.makeMessageType("livekit.RpcAck",()=>[{no:1,name:"request_id",kind:"scalar",T:9}]),lf=U.makeMessageType("livekit.RpcResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:9,oneof:"value"},{no:3,name:"error",kind:"message",T:Jb,oneof:"value"}]),Jb=U.makeMessageType("livekit.RpcError",()=>[{no:1,name:"code",kind:"scalar",T:13},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"data",kind:"scalar",T:9}]),Qb=U.makeMessageType("livekit.ParticipantTracks",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]),Wb=U.makeMessageType("livekit.ServerInfo",()=>[{no:1,name:"edition",kind:"enum",T:U.getEnumType(Xb)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9},{no:7,name:"agent_protocol",kind:"scalar",T:5}]),Xb=U.makeEnum("livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]),Zb=U.makeMessageType("livekit.ClientInfo",()=>[{no:1,name:"sdk",kind:"enum",T:U.getEnumType($b)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9},{no:11,name:"other_sdks",kind:"scalar",T:9}]),$b=U.makeEnum("livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"},{no:11,name:"UNITY_WEB"},{no:12,name:"NODE"},{no:13,name:"UNREAL"},{no:14,name:"ESP32"}]),eS=U.makeMessageType("livekit.ClientConfiguration",()=>[{no:1,name:"video",kind:"message",T:Hy},{no:2,name:"screen",kind:"message",T:Hy},{no:3,name:"resume_connection",kind:"enum",T:U.getEnumType(Jr)},{no:4,name:"disabled_codecs",kind:"message",T:E_},{no:5,name:"force_relay",kind:"enum",T:U.getEnumType(Jr)}]),Hy=U.makeMessageType("livekit.VideoConfiguration",()=>[{no:1,name:"hardware_encoder",kind:"enum",T:U.getEnumType(Jr)}]),E_=U.makeMessageType("livekit.DisabledCodecs",()=>[{no:1,name:"codecs",kind:"message",T:Wl,repeated:!0},{no:2,name:"publish",kind:"message",T:Wl,repeated:!0}]),tS=U.makeMessageType("livekit.TimedVersion",()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]),bh=U.makeEnum("livekit.DataStream.OperationType",[{no:0,name:"CREATE"},{no:1,name:"UPDATE"},{no:2,name:"DELETE"},{no:3,name:"REACTION"}]),nS=U.makeMessageType("livekit.DataStream.TextHeader",()=>[{no:1,name:"operation_type",kind:"enum",T:U.getEnumType(bh)},{no:2,name:"version",kind:"scalar",T:5},{no:3,name:"reply_to_stream_id",kind:"scalar",T:9},{no:4,name:"attached_stream_ids",kind:"scalar",T:9,repeated:!0},{no:5,name:"generated",kind:"scalar",T:8}],{localName:"DataStream_TextHeader"}),iS=U.makeMessageType("livekit.DataStream.ByteHeader",()=>[{no:1,name:"name",kind:"scalar",T:9}],{localName:"DataStream_ByteHeader"}),Zl=U.makeMessageType("livekit.DataStream.Header",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"topic",kind:"scalar",T:9},{no:4,name:"mime_type",kind:"scalar",T:9},{no:5,name:"total_length",kind:"scalar",T:4,opt:!0},{no:7,name:"encryption_type",kind:"enum",T:U.getEnumType(ht)},{no:8,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:9,name:"text_header",kind:"message",T:nS,oneof:"content_header"},{no:10,name:"byte_header",kind:"message",T:iS,oneof:"content_header"}],{localName:"DataStream_Header"}),$l=U.makeMessageType("livekit.DataStream.Chunk",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"chunk_index",kind:"scalar",T:4},{no:3,name:"content",kind:"scalar",T:12},{no:4,name:"version",kind:"scalar",T:5},{no:5,name:"iv",kind:"scalar",T:12,opt:!0}],{localName:"DataStream_Chunk"}),ec=U.makeMessageType("livekit.DataStream.Trailer",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"reason",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}}],{localName:"DataStream_Trailer"}),w_=U.makeMessageType("livekit.SubscribedAudioCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"enabled",kind:"scalar",T:8}]),Rn=U.makeEnum("livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]),Sh=U.makeEnum("livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]),__=U.makeEnum("livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]),R_=U.makeMessageType("livekit.SignalRequest",()=>[{no:1,name:"offer",kind:"message",T:$i,oneof:"message"},{no:2,name:"answer",kind:"message",T:$i,oneof:"message"},{no:3,name:"trickle",kind:"message",T:fc,oneof:"message"},{no:4,name:"add_track",kind:"message",T:Wr,oneof:"message"},{no:5,name:"mute",kind:"message",T:mc,oneof:"message"},{no:6,name:"subscription",kind:"message",T:pc,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:oS,oneof:"message"},{no:8,name:"leave",kind:"message",T:gc,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:cS,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:hS,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:ff,oneof:"message"},{no:13,name:"simulate",kind:"message",T:Ln,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:df,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:pS,oneof:"message"},{no:17,name:"update_audio_track",kind:"message",T:uf,oneof:"message"},{no:18,name:"update_video_track",kind:"message",T:lS,oneof:"message"},{no:19,name:"publish_data_track_request",kind:"message",T:aS,oneof:"message"},{no:20,name:"unpublish_data_track_request",kind:"message",T:rS,oneof:"message"},{no:21,name:"update_data_subscription",kind:"message",T:I_,oneof:"message"}]),Vy=U.makeMessageType("livekit.SignalResponse",()=>[{no:1,name:"join",kind:"message",T:D_,oneof:"message"},{no:2,name:"answer",kind:"message",T:$i,oneof:"message"},{no:3,name:"offer",kind:"message",T:$i,oneof:"message"},{no:4,name:"trickle",kind:"message",T:fc,oneof:"message"},{no:5,name:"update",kind:"message",T:P_,oneof:"message"},{no:6,name:"track_published",kind:"message",T:cf,oneof:"message"},{no:8,name:"leave",kind:"message",T:gc,oneof:"message"},{no:9,name:"mute",kind:"message",T:mc,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:U_,oneof:"message"},{no:11,name:"room_update",kind:"message",T:B_,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:F_,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:H_,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:G_,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:Y_,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:j_,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:O_,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:Q_,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:Z_,oneof:"message"},{no:22,name:"request_response",kind:"message",T:$_,oneof:"message"},{no:23,name:"track_subscribed",kind:"message",T:eR,oneof:"message"},{no:24,name:"room_moved",kind:"message",T:J_,oneof:"message"},{no:25,name:"media_sections_requirement",kind:"message",T:aR,oneof:"message"},{no:26,name:"subscribed_audio_codec_update",kind:"message",T:K_,oneof:"message"},{no:27,name:"publish_data_track_response",kind:"message",T:sS,oneof:"message"},{no:28,name:"unpublish_data_track_response",kind:"message",T:N_,oneof:"message"},{no:29,name:"data_track_subscriber_handles",kind:"message",T:A_,oneof:"message"}]),Th=U.makeMessageType("livekit.SimulcastCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:Wi,repeated:!0},{no:5,name:"video_layer_mode",kind:"enum",T:U.getEnumType(Hb)}]),Wr=U.makeMessageType("livekit.AddTrackRequest",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:U.getEnumType(_n)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:U.getEnumType(vt)},{no:9,name:"layers",kind:"message",T:Wi,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:Th,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:U.getEnumType(ht)},{no:15,name:"stream",kind:"scalar",T:9},{no:16,name:"backup_codec_policy",kind:"enum",T:U.getEnumType(zb)},{no:17,name:"audio_features",kind:"enum",T:U.getEnumType(Tt),repeated:!0}]),aS=U.makeMessageType("livekit.PublishDataTrackRequest",()=>[{no:1,name:"pub_handle",kind:"scalar",T:13},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"encryption",kind:"enum",T:U.getEnumType(ht)}]),sS=U.makeMessageType("livekit.PublishDataTrackResponse",()=>[{no:1,name:"info",kind:"message",T:af}]),rS=U.makeMessageType("livekit.UnpublishDataTrackRequest",()=>[{no:1,name:"pub_handle",kind:"scalar",T:13}]),N_=U.makeMessageType("livekit.UnpublishDataTrackResponse",()=>[{no:1,name:"info",kind:"message",T:af}]),A_=U.makeMessageType("livekit.DataTrackSubscriberHandles",()=>[{no:1,name:"sub_handles",kind:"map",K:13,V:{kind:"message",T:M_}}]),M_=U.makeMessageType("livekit.DataTrackSubscriberHandles.PublishedDataTrack",()=>[{no:1,name:"publisher_identity",kind:"scalar",T:9},{no:2,name:"publisher_sid",kind:"scalar",T:9},{no:3,name:"track_sid",kind:"scalar",T:9}],{localName:"DataTrackSubscriberHandles_PublishedDataTrack"}),fc=U.makeMessageType("livekit.TrickleRequest",()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:U.getEnumType(Rn)},{no:3,name:"final",kind:"scalar",T:8}]),mc=U.makeMessageType("livekit.MuteTrackRequest",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]),D_=U.makeMessageType("livekit.JoinResponse",()=>[{no:1,name:"room",kind:"message",T:hc},{no:2,name:"participant",kind:"message",T:Ra},{no:3,name:"other_participants",kind:"message",T:Ra,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:uS,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:eS},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:Wb},{no:13,name:"sif_trailer",kind:"scalar",T:12},{no:14,name:"enabled_publish_codecs",kind:"message",T:Wl,repeated:!0},{no:15,name:"fast_publish",kind:"scalar",T:8}]),O_=U.makeMessageType("livekit.ReconnectResponse",()=>[{no:1,name:"ice_servers",kind:"message",T:uS,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:eS},{no:3,name:"server_info",kind:"message",T:Wb},{no:4,name:"last_message_seq",kind:"scalar",T:13}]),cf=U.makeMessageType("livekit.TrackPublishedResponse",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:Ts}]),j_=U.makeMessageType("livekit.TrackUnpublishedResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]),$i=U.makeMessageType("livekit.SessionDescription",()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9},{no:3,name:"id",kind:"scalar",T:13},{no:4,name:"mid_to_track_id",kind:"map",K:9,V:{kind:"scalar",T:9}}]),P_=U.makeMessageType("livekit.ParticipantUpdate",()=>[{no:1,name:"participants",kind:"message",T:Ra,repeated:!0}]),pc=U.makeMessageType("livekit.UpdateSubscription",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:Qb,repeated:!0}]),I_=U.makeMessageType("livekit.UpdateDataSubscription",()=>[{no:1,name:"updates",kind:"message",T:L_,repeated:!0}]),L_=U.makeMessageType("livekit.UpdateDataSubscription.Update",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"options",kind:"message",T:T_}],{localName:"UpdateDataSubscription_Update"}),oS=U.makeMessageType("livekit.UpdateTrackSettings",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:U.getEnumType(nf)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]),uf=U.makeMessageType("livekit.UpdateLocalAudioTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"features",kind:"enum",T:U.getEnumType(Tt),repeated:!0}]),lS=U.makeMessageType("livekit.UpdateLocalVideoTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13}]),gc=U.makeMessageType("livekit.LeaveRequest",()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:U.getEnumType(An)},{no:3,name:"action",kind:"enum",T:U.getEnumType(Es)},{no:4,name:"regions",kind:"message",T:W_}]),Es=U.makeEnum("livekit.LeaveRequest.Action",[{no:0,name:"DISCONNECT"},{no:1,name:"RESUME"},{no:2,name:"RECONNECT"}]),cS=U.makeMessageType("livekit.UpdateVideoLayers",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:Wi,repeated:!0}]),df=U.makeMessageType("livekit.UpdateParticipantMetadata",()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:4,name:"request_id",kind:"scalar",T:13}]),uS=U.makeMessageType("livekit.ICEServer",()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]),U_=U.makeMessageType("livekit.SpeakersChanged",()=>[{no:1,name:"speakers",kind:"message",T:Kb,repeated:!0}]),B_=U.makeMessageType("livekit.RoomUpdate",()=>[{no:1,name:"room",kind:"message",T:hc}]),q_=U.makeMessageType("livekit.ConnectionQualityInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:U.getEnumType(Ur)},{no:3,name:"score",kind:"scalar",T:2}]),F_=U.makeMessageType("livekit.ConnectionQualityUpdate",()=>[{no:1,name:"updates",kind:"message",T:q_,repeated:!0}]),z_=U.makeMessageType("livekit.StreamStateInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:U.getEnumType(Sh)}]),H_=U.makeMessageType("livekit.StreamStateUpdate",()=>[{no:1,name:"stream_states",kind:"message",T:z_,repeated:!0}]),hf=U.makeMessageType("livekit.SubscribedQuality",()=>[{no:1,name:"quality",kind:"enum",T:U.getEnumType(nf)},{no:2,name:"enabled",kind:"scalar",T:8}]),V_=U.makeMessageType("livekit.SubscribedCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:hf,repeated:!0}]),G_=U.makeMessageType("livekit.SubscribedQualityUpdate",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:hf,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:V_,repeated:!0}]),K_=U.makeMessageType("livekit.SubscribedAudioCodecUpdate",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_audio_codecs",kind:"message",T:w_,repeated:!0}]),dS=U.makeMessageType("livekit.TrackPermission",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]),hS=U.makeMessageType("livekit.SubscriptionPermission",()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:dS,repeated:!0}]),Y_=U.makeMessageType("livekit.SubscriptionPermissionUpdate",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]),J_=U.makeMessageType("livekit.RoomMovedResponse",()=>[{no:1,name:"room",kind:"message",T:hc},{no:2,name:"token",kind:"scalar",T:9},{no:3,name:"participant",kind:"message",T:Ra},{no:4,name:"other_participants",kind:"message",T:Ra,repeated:!0}]),ff=U.makeMessageType("livekit.SyncState",()=>[{no:1,name:"answer",kind:"message",T:$i},{no:2,name:"subscription",kind:"message",T:pc},{no:3,name:"publish_tracks",kind:"message",T:cf,repeated:!0},{no:4,name:"data_channels",kind:"message",T:mS,repeated:!0},{no:5,name:"offer",kind:"message",T:$i},{no:6,name:"track_sids_disabled",kind:"scalar",T:9,repeated:!0},{no:7,name:"datachannel_receive_states",kind:"message",T:fS,repeated:!0},{no:8,name:"publish_data_tracks",kind:"message",T:sS,repeated:!0}]),fS=U.makeMessageType("livekit.DataChannelReceiveState",()=>[{no:1,name:"publisher_sid",kind:"scalar",T:9},{no:2,name:"last_seq",kind:"scalar",T:13}]),mS=U.makeMessageType("livekit.DataChannelInfo",()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:U.getEnumType(Rn)}]),Ln=U.makeMessageType("livekit.SimulateScenario",()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:U.getEnumType(__),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"},{no:7,name:"disconnect_signal_on_resume",kind:"scalar",T:8,oneof:"scenario"},{no:8,name:"disconnect_signal_on_resume_no_messages",kind:"scalar",T:8,oneof:"scenario"},{no:9,name:"leave_request_full_reconnect",kind:"scalar",T:8,oneof:"scenario"}]),pS=U.makeMessageType("livekit.Ping",()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]),Q_=U.makeMessageType("livekit.Pong",()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]),W_=U.makeMessageType("livekit.RegionSettings",()=>[{no:1,name:"regions",kind:"message",T:X_,repeated:!0}]),X_=U.makeMessageType("livekit.RegionInfo",()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]),Z_=U.makeMessageType("livekit.SubscriptionResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:U.getEnumType(v_)}]),$_=U.makeMessageType("livekit.RequestResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:13},{no:2,name:"reason",kind:"enum",T:U.getEnumType(mf)},{no:3,name:"message",kind:"scalar",T:9},{no:4,name:"trickle",kind:"message",T:fc,oneof:"request"},{no:5,name:"add_track",kind:"message",T:Wr,oneof:"request"},{no:6,name:"mute",kind:"message",T:mc,oneof:"request"},{no:7,name:"update_metadata",kind:"message",T:df,oneof:"request"},{no:8,name:"update_audio_track",kind:"message",T:uf,oneof:"request"},{no:9,name:"update_video_track",kind:"message",T:lS,oneof:"request"},{no:10,name:"publish_data_track",kind:"message",T:aS,oneof:"request"},{no:11,name:"unpublish_data_track",kind:"message",T:rS,oneof:"request"}]),mf=U.makeEnum("livekit.RequestResponse.Reason",[{no:0,name:"OK"},{no:1,name:"NOT_FOUND"},{no:2,name:"NOT_ALLOWED"},{no:3,name:"LIMIT_EXCEEDED"},{no:4,name:"QUEUED"},{no:5,name:"UNSUPPORTED_TYPE"},{no:6,name:"UNCLASSIFIED_ERROR"},{no:7,name:"INVALID_HANDLE"},{no:8,name:"INVALID_NAME"},{no:9,name:"DUPLICATE_HANDLE"},{no:10,name:"DUPLICATE_NAME"}]),eR=U.makeMessageType("livekit.TrackSubscribed",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]),gS=U.makeMessageType("livekit.ConnectionSettings",()=>[{no:1,name:"auto_subscribe",kind:"scalar",T:8},{no:2,name:"adaptive_stream",kind:"scalar",T:8},{no:3,name:"subscriber_allow_pause",kind:"scalar",T:8,opt:!0},{no:4,name:"disable_ice_lite",kind:"scalar",T:8},{no:5,name:"auto_subscribe_data_track",kind:"scalar",T:8,opt:!0}]),tR=U.makeMessageType("livekit.JoinRequest",()=>[{no:1,name:"client_info",kind:"message",T:Zb},{no:2,name:"connection_settings",kind:"message",T:gS},{no:3,name:"metadata",kind:"scalar",T:9},{no:4,name:"participant_attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:5,name:"add_track_requests",kind:"message",T:Wr,repeated:!0},{no:6,name:"publisher_offer",kind:"message",T:$i},{no:7,name:"reconnect",kind:"scalar",T:8},{no:8,name:"reconnect_reason",kind:"enum",T:U.getEnumType(ka)},{no:9,name:"participant_sid",kind:"scalar",T:9},{no:10,name:"sync_state",kind:"message",T:ff}]),nR=U.makeMessageType("livekit.WrappedJoinRequest",()=>[{no:1,name:"compression",kind:"enum",T:U.getEnumType(iR)},{no:2,name:"join_request",kind:"scalar",T:12}]),iR=U.makeEnum("livekit.WrappedJoinRequest.Compression",[{no:0,name:"NONE"},{no:1,name:"GZIP"}]),aR=U.makeMessageType("livekit.MediaSectionsRequirement",()=>[{no:1,name:"num_audios",kind:"scalar",T:13},{no:2,name:"num_videos",kind:"scalar",T:13}]);function sR(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var Il={exports:{}},rR=Il.exports,Gy;function oR(){return Gy||(Gy=1,(function(a){(function(e,i){a.exports?a.exports=i():e.log=i()})(rR,function(){var e=function(){},i="undefined",s=typeof window!==i&&typeof window.navigator!==i&&/Trident\/|MSIE /.test(window.navigator.userAgent),o=["trace","debug","info","warn","error"],l={},d=null;function u(x,k){var R=x[k];if(typeof R.bind=="function")return R.bind(x);try{return Function.prototype.bind.call(R,x)}catch{return function(){return Function.prototype.apply.apply(R,[x,arguments])}}}function f(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function p(x){return x==="debug"&&(x="log"),typeof console===i?!1:x==="trace"&&s?f:console[x]!==void 0?u(console,x):console.log!==void 0?u(console,"log"):e}function v(){for(var x=this.getLevel(),k=0;k<o.length;k++){var R=o[k];this[R]=k<x?e:this.methodFactory(R,x,this.name)}if(this.log=this.debug,typeof console===i&&x<this.levels.SILENT)return"No console available for logging"}function y(x){return function(){typeof console!==i&&(v.call(this),this[x].apply(this,arguments))}}function S(x,k,R){return p(x)||y.apply(this,arguments)}function C(x,k){var R=this,O,L,D,I="loglevel";typeof x=="string"?I+=":"+x:typeof x=="symbol"&&(I=void 0);function j(re){var ue=(o[re]||"silent").toUpperCase();if(!(typeof window===i||!I)){try{window.localStorage[I]=ue;return}catch{}try{window.document.cookie=encodeURIComponent(I)+"="+ue+";"}catch{}}}function H(){var re;if(!(typeof window===i||!I)){try{re=window.localStorage[I]}catch{}if(typeof re===i)try{var ue=window.document.cookie,Me=encodeURIComponent(I),We=ue.indexOf(Me+"=");We!==-1&&(re=/^([^;]+)/.exec(ue.slice(We+Me.length+1))[1])}catch{}return R.levels[re]===void 0&&(re=void 0),re}}function Z(){if(!(typeof window===i||!I)){try{window.localStorage.removeItem(I)}catch{}try{window.document.cookie=encodeURIComponent(I)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function ee(re){var ue=re;if(typeof ue=="string"&&R.levels[ue.toUpperCase()]!==void 0&&(ue=R.levels[ue.toUpperCase()]),typeof ue=="number"&&ue>=0&&ue<=R.levels.SILENT)return ue;throw new TypeError("log.setLevel() called with invalid level: "+re)}R.name=x,R.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},R.methodFactory=k||S,R.getLevel=function(){return D??L??O},R.setLevel=function(re,ue){return D=ee(re),ue!==!1&&j(D),v.call(R)},R.setDefaultLevel=function(re){L=ee(re),H()||R.setLevel(re,!1)},R.resetLevel=function(){D=null,Z(),v.call(R)},R.enableAll=function(re){R.setLevel(R.levels.TRACE,re)},R.disableAll=function(re){R.setLevel(R.levels.SILENT,re)},R.rebuild=function(){if(d!==R&&(O=ee(d.getLevel())),v.call(R),d===R)for(var re in l)l[re].rebuild()},O=ee(d?d.getLevel():"WARN");var te=H();te!=null&&(D=ee(te)),v.call(R)}d=new C,d.getLogger=function(k){if(typeof k!="symbol"&&typeof k!="string"||k==="")throw new TypeError("You must supply a name when creating a logger.");var R=l[k];return R||(R=l[k]=new C(k,d.methodFactory)),R};var _=typeof window!==i?window.log:void 0;return d.noConflict=function(){return typeof window!==i&&window.log===d&&(window.log=_),d},d.getLoggers=function(){return l},d.default=d,d})})(Il)),Il.exports}var vc=oR(),Ch;(function(a){a[a.trace=0]="trace",a[a.debug=1]="debug",a[a.info=2]="info",a[a.warn=3]="warn",a[a.error=4]="error",a[a.silent=5]="silent"})(Ch||(Ch={}));var Sn;(function(a){a.Default="livekit",a.Room="livekit-room",a.TokenSource="livekit-token-source",a.Participant="livekit-participant",a.Track="livekit-track",a.Publication="livekit-track-publication",a.Engine="livekit-engine",a.Signal="livekit-signal",a.PCManager="livekit-pc-manager",a.PCTransport="livekit-pc-transport",a.E2EE="lk-e2ee",a.DataTracks="livekit-data-tracks"})(Sn||(Sn={}));let Se=vc.getLogger("livekit");Object.values(Sn).map(a=>vc.getLogger(a));Se.setDefaultLevel(Ch.info);function qn(a){const e=vc.getLogger(a);return e.setDefaultLevel(Se.getLevel()),e}const lR=vc.getLogger("lk-e2ee"),Or=7e3,cR=[0,300,4*300,9*300,16*300,Or,Or,Or,Or,Or];class uR{constructor(e){this._retryDelays=e!==void 0?[...e]:cR}nextRetryDelayInMs(e){if(e.retryCount>=this._retryDelays.length)return null;const i=this._retryDelays[e.retryCount];return e.retryCount<=1?i:i+Math.random()*1e3}}function dR(a,e){var i={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&e.indexOf(s)<0&&(i[s]=a[s]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(a);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(a,s[o])&&(i[s[o]]=a[s[o]]);return i}function E(a,e,i,s){function o(l){return l instanceof i?l:new i(function(d){d(l)})}return new(i||(i=Promise))(function(l,d){function u(v){try{p(s.next(v))}catch(y){d(y)}}function f(v){try{p(s.throw(v))}catch(y){d(y)}}function p(v){v.done?l(v.value):o(v.value).then(u,f)}p((s=s.apply(a,e||[])).next())})}function Ky(a){var e=typeof Symbol=="function"&&Symbol.iterator,i=e&&a[e],s=0;if(i)return i.call(a);if(a&&typeof a.length=="number")return{next:function(){return a&&s>=a.length&&(a=void 0),{value:a&&a[s++],done:!a}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function mi(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=a[Symbol.asyncIterator],i;return e?e.call(a):(a=typeof Ky=="function"?Ky(a):a[Symbol.iterator](),i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i);function s(l){i[l]=a[l]&&function(d){return new Promise(function(u,f){d=a[l](d),o(u,f,d.done,d.value)})}}function o(l,d,u,f){Promise.resolve(f).then(function(p){l({value:p,done:u})},d)}}var El={exports:{}},Yy;function hR(){if(Yy)return El.exports;Yy=1;var a=typeof Reflect=="object"?Reflect:null,e=a&&typeof a.apply=="function"?a.apply:function(I,j,H){return Function.prototype.apply.call(I,j,H)},i;a&&typeof a.ownKeys=="function"?i=a.ownKeys:Object.getOwnPropertySymbols?i=function(I){return Object.getOwnPropertyNames(I).concat(Object.getOwnPropertySymbols(I))}:i=function(I){return Object.getOwnPropertyNames(I)};function s(D){console&&console.warn&&console.warn(D)}var o=Number.isNaN||function(I){return I!==I};function l(){l.init.call(this)}El.exports=l,El.exports.once=R,l.EventEmitter=l,l.prototype._events=void 0,l.prototype._eventsCount=0,l.prototype._maxListeners=void 0;var d=10;function u(D){if(typeof D!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof D)}Object.defineProperty(l,"defaultMaxListeners",{enumerable:!0,get:function(){return d},set:function(D){if(typeof D!="number"||D<0||o(D))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+D+".");d=D}}),l.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},l.prototype.setMaxListeners=function(I){if(typeof I!="number"||I<0||o(I))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+I+".");return this._maxListeners=I,this};function f(D){return D._maxListeners===void 0?l.defaultMaxListeners:D._maxListeners}l.prototype.getMaxListeners=function(){return f(this)},l.prototype.emit=function(I){for(var j=[],H=1;H<arguments.length;H++)j.push(arguments[H]);var Z=I==="error",ee=this._events;if(ee!==void 0)Z=Z&&ee.error===void 0;else if(!Z)return!1;if(Z){var te;if(j.length>0&&(te=j[0]),te instanceof Error)throw te;var re=new Error("Unhandled error."+(te?" ("+te.message+")":""));throw re.context=te,re}var ue=ee[I];if(ue===void 0)return!1;if(typeof ue=="function")e(ue,this,j);else for(var Me=ue.length,We=_(ue,Me),H=0;H<Me;++H)e(We[H],this,j);return!0};function p(D,I,j,H){var Z,ee,te;if(u(j),ee=D._events,ee===void 0?(ee=D._events=Object.create(null),D._eventsCount=0):(ee.newListener!==void 0&&(D.emit("newListener",I,j.listener?j.listener:j),ee=D._events),te=ee[I]),te===void 0)te=ee[I]=j,++D._eventsCount;else if(typeof te=="function"?te=ee[I]=H?[j,te]:[te,j]:H?te.unshift(j):te.push(j),Z=f(D),Z>0&&te.length>Z&&!te.warned){te.warned=!0;var re=new Error("Possible EventEmitter memory leak detected. "+te.length+" "+String(I)+" listeners added. Use emitter.setMaxListeners() to increase limit");re.name="MaxListenersExceededWarning",re.emitter=D,re.type=I,re.count=te.length,s(re)}return D}l.prototype.addListener=function(I,j){return p(this,I,j,!1)},l.prototype.on=l.prototype.addListener,l.prototype.prependListener=function(I,j){return p(this,I,j,!0)};function v(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function y(D,I,j){var H={fired:!1,wrapFn:void 0,target:D,type:I,listener:j},Z=v.bind(H);return Z.listener=j,H.wrapFn=Z,Z}l.prototype.once=function(I,j){return u(j),this.on(I,y(this,I,j)),this},l.prototype.prependOnceListener=function(I,j){return u(j),this.prependListener(I,y(this,I,j)),this},l.prototype.removeListener=function(I,j){var H,Z,ee,te,re;if(u(j),Z=this._events,Z===void 0)return this;if(H=Z[I],H===void 0)return this;if(H===j||H.listener===j)--this._eventsCount===0?this._events=Object.create(null):(delete Z[I],Z.removeListener&&this.emit("removeListener",I,H.listener||j));else if(typeof H!="function"){for(ee=-1,te=H.length-1;te>=0;te--)if(H[te]===j||H[te].listener===j){re=H[te].listener,ee=te;break}if(ee<0)return this;ee===0?H.shift():x(H,ee),H.length===1&&(Z[I]=H[0]),Z.removeListener!==void 0&&this.emit("removeListener",I,re||j)}return this},l.prototype.off=l.prototype.removeListener,l.prototype.removeAllListeners=function(I){var j,H,Z;if(H=this._events,H===void 0)return this;if(H.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):H[I]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete H[I]),this;if(arguments.length===0){var ee=Object.keys(H),te;for(Z=0;Z<ee.length;++Z)te=ee[Z],te!=="removeListener"&&this.removeAllListeners(te);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(j=H[I],typeof j=="function")this.removeListener(I,j);else if(j!==void 0)for(Z=j.length-1;Z>=0;Z--)this.removeListener(I,j[Z]);return this};function S(D,I,j){var H=D._events;if(H===void 0)return[];var Z=H[I];return Z===void 0?[]:typeof Z=="function"?j?[Z.listener||Z]:[Z]:j?k(Z):_(Z,Z.length)}l.prototype.listeners=function(I){return S(this,I,!0)},l.prototype.rawListeners=function(I){return S(this,I,!1)},l.listenerCount=function(D,I){return typeof D.listenerCount=="function"?D.listenerCount(I):C.call(D,I)},l.prototype.listenerCount=C;function C(D){var I=this._events;if(I!==void 0){var j=I[D];if(typeof j=="function")return 1;if(j!==void 0)return j.length}return 0}l.prototype.eventNames=function(){return this._eventsCount>0?i(this._events):[]};function _(D,I){for(var j=new Array(I),H=0;H<I;++H)j[H]=D[H];return j}function x(D,I){for(;I+1<D.length;I++)D[I]=D[I+1];D.pop()}function k(D){for(var I=new Array(D.length),j=0;j<I.length;++j)I[j]=D[j].listener||D[j];return I}function R(D,I){return new Promise(function(j,H){function Z(te){D.removeListener(I,ee),H(te)}function ee(){typeof D.removeListener=="function"&&D.removeListener("error",Z),j([].slice.call(arguments))}L(D,I,ee,{once:!0}),I!=="error"&&O(D,Z,{once:!0})})}function O(D,I,j){typeof D.on=="function"&&L(D,"error",I,j)}function L(D,I,j,H){if(typeof D.on=="function")H.once?D.once(I,j):D.on(I,j);else if(typeof D.addEventListener=="function")D.addEventListener(I,function Z(ee){H.once&&D.removeEventListener(I,Z),j(ee)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof D)}return El.exports}var Vn=hR();let vS=!0,yS=!0;function Br(a,e,i){const s=a.match(e);return s&&s.length>=i&&parseFloat(s[i],10)}function Oa(a,e,i){if(!a.RTCPeerConnection)return;const s=a.RTCPeerConnection.prototype,o=s.addEventListener;s.addEventListener=function(d,u){if(d!==e)return o.apply(this,arguments);const f=p=>{const v=i(p);v&&(u.handleEvent?u.handleEvent(v):u(v))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(u,f),o.apply(this,[d,f])};const l=s.removeEventListener;s.removeEventListener=function(d,u){if(d!==e||!this._eventMap||!this._eventMap[e])return l.apply(this,arguments);if(!this._eventMap[e].has(u))return l.apply(this,arguments);const f=this._eventMap[e].get(u);return this._eventMap[e].delete(u),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,l.apply(this,[d,f])},Object.defineProperty(s,"on"+e,{get(){return this["_on"+e]},set(d){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),d&&this.addEventListener(e,this["_on"+e]=d)},enumerable:!0,configurable:!0})}function fR(a){return typeof a!="boolean"?new Error("Argument type: "+typeof a+". Please use a boolean."):(vS=a,a?"adapter.js logging disabled":"adapter.js logging enabled")}function mR(a){return typeof a!="boolean"?new Error("Argument type: "+typeof a+". Please use a boolean."):(yS=!a,"adapter.js deprecation warnings "+(a?"disabled":"enabled"))}function bS(){if(typeof window=="object"){if(vS)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function pf(a,e){yS&&console.warn(a+" is deprecated, please use "+e+" instead.")}function pR(a){const e={browser:null,version:null};if(typeof a>"u"||!a.navigator||!a.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:i}=a;if(i.userAgentData&&i.userAgentData.brands){const s=i.userAgentData.brands.find(o=>o.brand==="Chromium");if(s)return{browser:"chrome",version:parseInt(s.version,10)}}if(i.mozGetUserMedia)e.browser="firefox",e.version=parseInt(Br(i.userAgent,/Firefox\/(\d+)\./,1));else if(i.webkitGetUserMedia||a.isSecureContext===!1&&a.webkitRTCPeerConnection)e.browser="chrome",e.version=parseInt(Br(i.userAgent,/Chrom(e|ium)\/(\d+)\./,2));else if(a.RTCPeerConnection&&i.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=parseInt(Br(i.userAgent,/AppleWebKit\/(\d+)\./,1)),e.supportsUnifiedPlan=a.RTCRtpTransceiver&&"currentDirection"in a.RTCRtpTransceiver.prototype,e._safariVersion=Br(i.userAgent,/Version\/(\d+(\.?\d+))/,1);else return e.browser="Not a supported browser.",e;return e}function Jy(a){return Object.prototype.toString.call(a)==="[object Object]"}function SS(a){return Jy(a)?Object.keys(a).reduce(function(e,i){const s=Jy(a[i]),o=s?SS(a[i]):a[i],l=s&&!Object.keys(o).length;return o===void 0||l?e:Object.assign(e,{[i]:o})},{}):a}function kh(a,e,i){!e||i.has(e.id)||(i.set(e.id,e),Object.keys(e).forEach(s=>{s.endsWith("Id")?kh(a,a.get(e[s]),i):s.endsWith("Ids")&&e[s].forEach(o=>{kh(a,a.get(o),i)})}))}function Qy(a,e,i){const s=i?"outbound-rtp":"inbound-rtp",o=new Map;if(e===null)return o;const l=[];return a.forEach(d=>{d.type==="track"&&d.trackIdentifier===e.id&&l.push(d)}),l.forEach(d=>{a.forEach(u=>{u.type===s&&u.trackId===d.id&&kh(a,u,o)})}),o}const Wy=bS;function TS(a,e){const i=a&&a.navigator;if(!i.mediaDevices)return;const s=function(u){if(typeof u!="object"||u.mandatory||u.optional)return u;const f={};return Object.keys(u).forEach(p=>{if(p==="require"||p==="advanced"||p==="mediaSource")return;const v=typeof u[p]=="object"?u[p]:{ideal:u[p]};v.exact!==void 0&&typeof v.exact=="number"&&(v.min=v.max=v.exact);const y=function(S,C){return S?S+C.charAt(0).toUpperCase()+C.slice(1):C==="deviceId"?"sourceId":C};if(v.ideal!==void 0){f.optional=f.optional||[];let S={};typeof v.ideal=="number"?(S[y("min",p)]=v.ideal,f.optional.push(S),S={},S[y("max",p)]=v.ideal,f.optional.push(S)):(S[y("",p)]=v.ideal,f.optional.push(S))}v.exact!==void 0&&typeof v.exact!="number"?(f.mandatory=f.mandatory||{},f.mandatory[y("",p)]=v.exact):["min","max"].forEach(S=>{v[S]!==void 0&&(f.mandatory=f.mandatory||{},f.mandatory[y(S,p)]=v[S])})}),u.advanced&&(f.optional=(f.optional||[]).concat(u.advanced)),f},o=function(u,f){if(e.version>=61)return f(u);if(u=JSON.parse(JSON.stringify(u)),u&&typeof u.audio=="object"){const p=function(v,y,S){y in v&&!(S in v)&&(v[S]=v[y],delete v[y])};u=JSON.parse(JSON.stringify(u)),p(u.audio,"autoGainControl","googAutoGainControl"),p(u.audio,"noiseSuppression","googNoiseSuppression"),u.audio=s(u.audio)}if(u&&typeof u.video=="object"){let p=u.video.facingMode;p=p&&(typeof p=="object"?p:{ideal:p});const v=e.version<66;if(p&&(p.exact==="user"||p.exact==="environment"||p.ideal==="user"||p.ideal==="environment")&&!(i.mediaDevices.getSupportedConstraints&&i.mediaDevices.getSupportedConstraints().facingMode&&!v)){delete u.video.facingMode;let y;if(p.exact==="environment"||p.ideal==="environment"?y=["back","rear"]:(p.exact==="user"||p.ideal==="user")&&(y=["front"]),y)return i.mediaDevices.enumerateDevices().then(S=>{S=S.filter(_=>_.kind==="videoinput");let C=S.find(_=>y.some(x=>_.label.toLowerCase().includes(x)));return!C&&S.length&&y.includes("back")&&(C=S[S.length-1]),C&&(u.video.deviceId=p.exact?{exact:C.deviceId}:{ideal:C.deviceId}),u.video=s(u.video),Wy("chrome: "+JSON.stringify(u)),f(u)})}u.video=s(u.video)}return Wy("chrome: "+JSON.stringify(u)),f(u)},l=function(u){return e.version>=64?u:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[u.name]||u.name,message:u.message,constraint:u.constraint||u.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},d=function(u,f,p){o(u,v=>{i.webkitGetUserMedia(v,f,y=>{p&&p(l(y))})})};if(i.getUserMedia=d.bind(i),i.mediaDevices.getUserMedia){const u=i.mediaDevices.getUserMedia.bind(i.mediaDevices);i.mediaDevices.getUserMedia=function(f){return o(f,p=>u(p).then(v=>{if(p.audio&&!v.getAudioTracks().length||p.video&&!v.getVideoTracks().length)throw v.getTracks().forEach(y=>{y.stop()}),new DOMException("","NotFoundError");return v},v=>Promise.reject(l(v))))}}}function CS(a){a.MediaStream=a.MediaStream||a.webkitMediaStream}function kS(a){if(typeof a=="object"&&a.RTCPeerConnection&&!("ontrack"in a.RTCPeerConnection.prototype)){Object.defineProperty(a.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(i){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=i)},enumerable:!0,configurable:!0});const e=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=s=>{s.stream.addEventListener("addtrack",o=>{let l;a.RTCPeerConnection.prototype.getReceivers?l=this.getReceivers().find(u=>u.track&&u.track.id===o.track.id):l={track:o.track};const d=new Event("track");d.track=o.track,d.receiver=l,d.transceiver={receiver:l},d.streams=[s.stream],this.dispatchEvent(d)}),s.stream.getTracks().forEach(o=>{let l;a.RTCPeerConnection.prototype.getReceivers?l=this.getReceivers().find(u=>u.track&&u.track.id===o.id):l={track:o};const d=new Event("track");d.track=o,d.receiver=l,d.transceiver={receiver:l},d.streams=[s.stream],this.dispatchEvent(d)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else Oa(a,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function xS(a){if(typeof a=="object"&&a.RTCPeerConnection&&!("getSenders"in a.RTCPeerConnection.prototype)&&"createDTMFSender"in a.RTCPeerConnection.prototype){const e=function(o,l){return{track:l,get dtmf(){return this._dtmf===void 0&&(l.kind==="audio"?this._dtmf=o.createDTMFSender(l):this._dtmf=null),this._dtmf},_pc:o}};if(!a.RTCPeerConnection.prototype.getSenders){a.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const o=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=function(u,f){let p=o.apply(this,arguments);return p||(p=e(this,u),this._senders.push(p)),p};const l=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(u){l.apply(this,arguments);const f=this._senders.indexOf(u);f!==-1&&this._senders.splice(f,1)}}const i=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(l){this._senders=this._senders||[],i.apply(this,[l]),l.getTracks().forEach(d=>{this._senders.push(e(this,d))})};const s=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(l){this._senders=this._senders||[],s.apply(this,[l]),l.getTracks().forEach(d=>{const u=this._senders.find(f=>f.track===d);u&&this._senders.splice(this._senders.indexOf(u),1)})}}else if(typeof a=="object"&&a.RTCPeerConnection&&"getSenders"in a.RTCPeerConnection.prototype&&"createDTMFSender"in a.RTCPeerConnection.prototype&&a.RTCRtpSender&&!("dtmf"in a.RTCRtpSender.prototype)){const e=a.RTCPeerConnection.prototype.getSenders;a.RTCPeerConnection.prototype.getSenders=function(){const s=e.apply(this,[]);return s.forEach(o=>o._pc=this),s},Object.defineProperty(a.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function ES(a){if(!(typeof a=="object"&&a.RTCPeerConnection&&a.RTCRtpSender&&a.RTCRtpReceiver))return;if(!("getStats"in a.RTCRtpSender.prototype)){const i=a.RTCPeerConnection.prototype.getSenders;i&&(a.RTCPeerConnection.prototype.getSenders=function(){const l=i.apply(this,[]);return l.forEach(d=>d._pc=this),l});const s=a.RTCPeerConnection.prototype.addTrack;s&&(a.RTCPeerConnection.prototype.addTrack=function(){const l=s.apply(this,arguments);return l._pc=this,l}),a.RTCRtpSender.prototype.getStats=function(){const l=this;return this._pc.getStats().then(d=>Qy(d,l.track,!0))}}if(!("getStats"in a.RTCRtpReceiver.prototype)){const i=a.RTCPeerConnection.prototype.getReceivers;i&&(a.RTCPeerConnection.prototype.getReceivers=function(){const o=i.apply(this,[]);return o.forEach(l=>l._pc=this),o}),Oa(a,"track",s=>(s.receiver._pc=s.srcElement,s)),a.RTCRtpReceiver.prototype.getStats=function(){const o=this;return this._pc.getStats().then(l=>Qy(l,o.track,!1))}}if(!("getStats"in a.RTCRtpSender.prototype&&"getStats"in a.RTCRtpReceiver.prototype))return;const e=a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof a.MediaStreamTrack){const s=arguments[0];let o,l,d;return this.getSenders().forEach(u=>{u.track===s&&(o?d=!0:o=u)}),this.getReceivers().forEach(u=>(u.track===s&&(l?d=!0:l=u),u.track===s)),d||o&&l?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):o?o.getStats():l?l.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function wS(a){a.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(d=>this._shimmedLocalStreams[d][0])};const e=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=function(d,u){if(!u)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const f=e.apply(this,arguments);return this._shimmedLocalStreams[u.id]?this._shimmedLocalStreams[u.id].indexOf(f)===-1&&this._shimmedLocalStreams[u.id].push(f):this._shimmedLocalStreams[u.id]=[u,f],f};const i=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(d){this._shimmedLocalStreams=this._shimmedLocalStreams||{},d.getTracks().forEach(p=>{if(this.getSenders().find(y=>y.track===p))throw new DOMException("Track already exists.","InvalidAccessError")});const u=this.getSenders();i.apply(this,arguments);const f=this.getSenders().filter(p=>u.indexOf(p)===-1);this._shimmedLocalStreams[d.id]=[d].concat(f)};const s=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(d){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[d.id],s.apply(this,arguments)};const o=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(d){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},d&&Object.keys(this._shimmedLocalStreams).forEach(u=>{const f=this._shimmedLocalStreams[u].indexOf(d);f!==-1&&this._shimmedLocalStreams[u].splice(f,1),this._shimmedLocalStreams[u].length===1&&delete this._shimmedLocalStreams[u]}),o.apply(this,arguments)}}function _S(a,e){if(!a.RTCPeerConnection)return;if(a.RTCPeerConnection.prototype.addTrack&&e.version>=65)return wS(a);const i=a.RTCPeerConnection.prototype.getLocalStreams;a.RTCPeerConnection.prototype.getLocalStreams=function(){const v=i.apply(this);return this._reverseStreams=this._reverseStreams||{},v.map(y=>this._reverseStreams[y.id])};const s=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(v){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},v.getTracks().forEach(y=>{if(this.getSenders().find(C=>C.track===y))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[v.id]){const y=new a.MediaStream(v.getTracks());this._streams[v.id]=y,this._reverseStreams[y.id]=v,v=y}s.apply(this,[v])};const o=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(v){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},o.apply(this,[this._streams[v.id]||v]),delete this._reverseStreams[this._streams[v.id]?this._streams[v.id].id:v.id],delete this._streams[v.id]},a.RTCPeerConnection.prototype.addTrack=function(v,y){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const S=[].slice.call(arguments,1);if(S.length!==1||!S[0].getTracks().find(x=>x===v))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(x=>x.track===v))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const _=this._streams[y.id];if(_)_.addTrack(v),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const x=new a.MediaStream([v]);this._streams[y.id]=x,this._reverseStreams[x.id]=y,this.addStream(x)}return this.getSenders().find(x=>x.track===v)};function l(p,v){let y=v.sdp;return Object.keys(p._reverseStreams||[]).forEach(S=>{const C=p._reverseStreams[S],_=p._streams[C.id];y=y.replace(new RegExp(_.id,"g"),C.id)}),new RTCSessionDescription({type:v.type,sdp:y})}function d(p,v){let y=v.sdp;return Object.keys(p._reverseStreams||[]).forEach(S=>{const C=p._reverseStreams[S],_=p._streams[C.id];y=y.replace(new RegExp(C.id,"g"),_.id)}),new RTCSessionDescription({type:v.type,sdp:y})}["createOffer","createAnswer"].forEach(function(p){const v=a.RTCPeerConnection.prototype[p],y={[p](){const S=arguments;return arguments.length&&typeof arguments[0]=="function"?v.apply(this,[_=>{const x=l(this,_);S[0].apply(null,[x])},_=>{S[1]&&S[1].apply(null,_)},arguments[2]]):v.apply(this,arguments).then(_=>l(this,_))}};a.RTCPeerConnection.prototype[p]=y[p]});const u=a.RTCPeerConnection.prototype.setLocalDescription;a.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?u.apply(this,arguments):(arguments[0]=d(this,arguments[0]),u.apply(this,arguments))};const f=Object.getOwnPropertyDescriptor(a.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(a.RTCPeerConnection.prototype,"localDescription",{get(){const p=f.get.apply(this);return p.type===""?p:l(this,p)}}),a.RTCPeerConnection.prototype.removeTrack=function(v){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!v._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(v._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let S;Object.keys(this._streams).forEach(C=>{this._streams[C].getTracks().find(x=>v.track===x)&&(S=this._streams[C])}),S&&(S.getTracks().length===1?this.removeStream(this._reverseStreams[S.id]):S.removeTrack(v.track),this.dispatchEvent(new Event("negotiationneeded")))}}function xh(a,e){!a.RTCPeerConnection&&a.webkitRTCPeerConnection&&(a.RTCPeerConnection=a.webkitRTCPeerConnection),a.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(i){const s=a.RTCPeerConnection.prototype[i],o={[i](){return arguments[0]=new(i==="addIceCandidate"?a.RTCIceCandidate:a.RTCSessionDescription)(arguments[0]),s.apply(this,arguments)}};a.RTCPeerConnection.prototype[i]=o[i]})}function RS(a,e){Oa(a,"negotiationneeded",i=>{const s=i.target;if(!((e.version<72||s.getConfiguration&&s.getConfiguration().sdpSemantics==="plan-b")&&s.signalingState!=="stable"))return i})}var Xy=Object.freeze({__proto__:null,fixNegotiationNeeded:RS,shimAddTrackRemoveTrack:_S,shimAddTrackRemoveTrackWithNative:wS,shimGetSendersWithDtmf:xS,shimGetUserMedia:TS,shimMediaStream:CS,shimOnTrack:kS,shimPeerConnection:xh,shimSenderReceiverGetStats:ES});function NS(a,e){const i=a&&a.navigator,s=a&&a.MediaStreamTrack;if(i.getUserMedia=function(o,l,d){pf("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),i.mediaDevices.getUserMedia(o).then(l,d)},!(e.version>55&&"autoGainControl"in i.mediaDevices.getSupportedConstraints())){const o=function(d,u,f){u in d&&!(f in d)&&(d[f]=d[u],delete d[u])},l=i.mediaDevices.getUserMedia.bind(i.mediaDevices);if(i.mediaDevices.getUserMedia=function(d){return typeof d=="object"&&typeof d.audio=="object"&&(d=JSON.parse(JSON.stringify(d)),o(d.audio,"autoGainControl","mozAutoGainControl"),o(d.audio,"noiseSuppression","mozNoiseSuppression")),l(d)},s&&s.prototype.getSettings){const d=s.prototype.getSettings;s.prototype.getSettings=function(){const u=d.apply(this,arguments);return o(u,"mozAutoGainControl","autoGainControl"),o(u,"mozNoiseSuppression","noiseSuppression"),u}}if(s&&s.prototype.applyConstraints){const d=s.prototype.applyConstraints;s.prototype.applyConstraints=function(u){return this.kind==="audio"&&typeof u=="object"&&(u=JSON.parse(JSON.stringify(u)),o(u,"autoGainControl","mozAutoGainControl"),o(u,"noiseSuppression","mozNoiseSuppression")),d.apply(this,[u])}}}}function gR(a,e){a.navigator.mediaDevices&&"getDisplayMedia"in a.navigator.mediaDevices||a.navigator.mediaDevices&&(a.navigator.mediaDevices.getDisplayMedia=function(s){if(!(s&&s.video)){const o=new DOMException("getDisplayMedia without video constraints is undefined");return o.name="NotFoundError",o.code=8,Promise.reject(o)}return s.video===!0?s.video={mediaSource:e}:s.video.mediaSource=e,a.navigator.mediaDevices.getUserMedia(s)})}function AS(a){typeof a=="object"&&a.RTCTrackEvent&&"receiver"in a.RTCTrackEvent.prototype&&!("transceiver"in a.RTCTrackEvent.prototype)&&Object.defineProperty(a.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Eh(a,e){if(typeof a!="object"||!(a.RTCPeerConnection||a.mozRTCPeerConnection))return;!a.RTCPeerConnection&&a.mozRTCPeerConnection&&(a.RTCPeerConnection=a.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(o){const l=a.RTCPeerConnection.prototype[o],d={[o](){return arguments[0]=new(o==="addIceCandidate"?a.RTCIceCandidate:a.RTCSessionDescription)(arguments[0]),l.apply(this,arguments)}};a.RTCPeerConnection.prototype[o]=d[o]});const i={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},s=a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(){const[l,d,u]=arguments;return s.apply(this,[l||null]).then(f=>{if(e.version<53&&!d)try{f.forEach(p=>{p.type=i[p.type]||p.type})}catch(p){if(p.name!=="TypeError")throw p;f.forEach((v,y)=>{f.set(y,Object.assign({},v,{type:i[v.type]||v.type}))})}return f}).then(d,u)}}function MS(a){if(!(typeof a=="object"&&a.RTCPeerConnection&&a.RTCRtpSender)||a.RTCRtpSender&&"getStats"in a.RTCRtpSender.prototype)return;const e=a.RTCPeerConnection.prototype.getSenders;e&&(a.RTCPeerConnection.prototype.getSenders=function(){const o=e.apply(this,[]);return o.forEach(l=>l._pc=this),o});const i=a.RTCPeerConnection.prototype.addTrack;i&&(a.RTCPeerConnection.prototype.addTrack=function(){const o=i.apply(this,arguments);return o._pc=this,o}),a.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function DS(a){if(!(typeof a=="object"&&a.RTCPeerConnection&&a.RTCRtpSender)||a.RTCRtpSender&&"getStats"in a.RTCRtpReceiver.prototype)return;const e=a.RTCPeerConnection.prototype.getReceivers;e&&(a.RTCPeerConnection.prototype.getReceivers=function(){const s=e.apply(this,[]);return s.forEach(o=>o._pc=this),s}),Oa(a,"track",i=>(i.receiver._pc=i.srcElement,i)),a.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function OS(a){!a.RTCPeerConnection||"removeStream"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.removeStream=function(i){pf("removeStream","removeTrack"),this.getSenders().forEach(s=>{s.track&&i.getTracks().includes(s.track)&&this.removeTrack(s)})})}function jS(a){a.DataChannel&&!a.RTCDataChannel&&(a.RTCDataChannel=a.DataChannel)}function PS(a){if(!(typeof a=="object"&&a.RTCPeerConnection))return;const e=a.RTCPeerConnection.prototype.addTransceiver;e&&(a.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let s=arguments[1]&&arguments[1].sendEncodings;s===void 0&&(s=[]),s=[...s];const o=s.length>0;o&&s.forEach(d=>{if("rid"in d&&!/^[a-z0-9]{0,16}$/i.test(d.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in d&&!(parseFloat(d.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in d&&!(parseFloat(d.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const l=e.apply(this,arguments);if(o){const{sender:d}=l,u=d.getParameters();(!("encodings"in u)||u.encodings.length===1&&Object.keys(u.encodings[0]).length===0)&&(u.encodings=s,d.sendEncodings=s,this.setParametersPromises.push(d.setParameters(u).then(()=>{delete d.sendEncodings}).catch(()=>{delete d.sendEncodings})))}return l})}function IS(a){if(!(typeof a=="object"&&a.RTCRtpSender))return;const e=a.RTCRtpSender.prototype.getParameters;e&&(a.RTCRtpSender.prototype.getParameters=function(){const s=e.apply(this,arguments);return"encodings"in s||(s.encodings=[].concat(this.sendEncodings||[{}])),s})}function LS(a){if(!(typeof a=="object"&&a.RTCPeerConnection))return;const e=a.RTCPeerConnection.prototype.createOffer;a.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function US(a){if(!(typeof a=="object"&&a.RTCPeerConnection))return;const e=a.RTCPeerConnection.prototype.createAnswer;a.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}var Zy=Object.freeze({__proto__:null,shimAddTransceiver:PS,shimCreateAnswer:US,shimCreateOffer:LS,shimGetDisplayMedia:gR,shimGetParameters:IS,shimGetUserMedia:NS,shimOnTrack:AS,shimPeerConnection:Eh,shimRTCDataChannel:jS,shimReceiverGetStats:DS,shimRemoveStream:OS,shimSenderGetStats:MS});function BS(a){if(!(typeof a!="object"||!a.RTCPeerConnection)){if("getLocalStreams"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in a.RTCPeerConnection.prototype)){const e=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addStream=function(s){this._localStreams||(this._localStreams=[]),this._localStreams.includes(s)||this._localStreams.push(s),s.getAudioTracks().forEach(o=>e.call(this,o,s)),s.getVideoTracks().forEach(o=>e.call(this,o,s))},a.RTCPeerConnection.prototype.addTrack=function(s){for(var o=arguments.length,l=new Array(o>1?o-1:0),d=1;d<o;d++)l[d-1]=arguments[d];return l&&l.forEach(u=>{this._localStreams?this._localStreams.includes(u)||this._localStreams.push(u):this._localStreams=[u]}),e.apply(this,arguments)}}"removeStream"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.removeStream=function(i){this._localStreams||(this._localStreams=[]);const s=this._localStreams.indexOf(i);if(s===-1)return;this._localStreams.splice(s,1);const o=i.getTracks();this.getSenders().forEach(l=>{o.includes(l.track)&&this.removeTrack(l)})})}}function qS(a){if(!(typeof a!="object"||!a.RTCPeerConnection)&&("getRemoteStreams"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in a.RTCPeerConnection.prototype))){Object.defineProperty(a.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(i){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=i),this.addEventListener("track",this._onaddstreampoly=s=>{s.streams.forEach(o=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(o))return;this._remoteStreams.push(o);const l=new Event("addstream");l.stream=o,this.dispatchEvent(l)})})}});const e=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){const s=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(o){o.streams.forEach(l=>{if(s._remoteStreams||(s._remoteStreams=[]),s._remoteStreams.indexOf(l)>=0)return;s._remoteStreams.push(l);const d=new Event("addstream");d.stream=l,s.dispatchEvent(d)})}),e.apply(s,arguments)}}}function FS(a){if(typeof a!="object"||!a.RTCPeerConnection)return;const e=a.RTCPeerConnection.prototype,i=e.createOffer,s=e.createAnswer,o=e.setLocalDescription,l=e.setRemoteDescription,d=e.addIceCandidate;e.createOffer=function(p,v){const y=arguments.length>=2?arguments[2]:arguments[0],S=i.apply(this,[y]);return v?(S.then(p,v),Promise.resolve()):S},e.createAnswer=function(p,v){const y=arguments.length>=2?arguments[2]:arguments[0],S=s.apply(this,[y]);return v?(S.then(p,v),Promise.resolve()):S};let u=function(f,p,v){const y=o.apply(this,[f]);return v?(y.then(p,v),Promise.resolve()):y};e.setLocalDescription=u,u=function(f,p,v){const y=l.apply(this,[f]);return v?(y.then(p,v),Promise.resolve()):y},e.setRemoteDescription=u,u=function(f,p,v){const y=d.apply(this,[f]);return v?(y.then(p,v),Promise.resolve()):y},e.addIceCandidate=u}function zS(a){const e=a&&a.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const i=e.mediaDevices,s=i.getUserMedia.bind(i);e.mediaDevices.getUserMedia=o=>s(HS(o))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(s,o,l){e.mediaDevices.getUserMedia(s).then(o,l)}).bind(e))}function HS(a){return a&&a.video!==void 0?Object.assign({},a,{video:SS(a.video)}):a}function VS(a){if(!a.RTCPeerConnection)return;const e=a.RTCPeerConnection;a.RTCPeerConnection=function(s,o){if(s&&s.iceServers){const l=[];for(let d=0;d<s.iceServers.length;d++){let u=s.iceServers[d];u.urls===void 0&&u.url?(pf("RTCIceServer.url","RTCIceServer.urls"),u=JSON.parse(JSON.stringify(u)),u.urls=u.url,delete u.url,l.push(u)):l.push(s.iceServers[d])}s.iceServers=l}return new e(s,o)},a.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(a.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function GS(a){typeof a=="object"&&a.RTCTrackEvent&&"receiver"in a.RTCTrackEvent.prototype&&!("transceiver"in a.RTCTrackEvent.prototype)&&Object.defineProperty(a.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function KS(a){const e=a.RTCPeerConnection.prototype.createOffer;a.RTCPeerConnection.prototype.createOffer=function(s){if(s){typeof s.offerToReceiveAudio<"u"&&(s.offerToReceiveAudio=!!s.offerToReceiveAudio);const o=this.getTransceivers().find(d=>d.receiver.track.kind==="audio");s.offerToReceiveAudio===!1&&o?o.direction==="sendrecv"?o.setDirection?o.setDirection("sendonly"):o.direction="sendonly":o.direction==="recvonly"&&(o.setDirection?o.setDirection("inactive"):o.direction="inactive"):s.offerToReceiveAudio===!0&&!o&&this.addTransceiver("audio",{direction:"recvonly"}),typeof s.offerToReceiveVideo<"u"&&(s.offerToReceiveVideo=!!s.offerToReceiveVideo);const l=this.getTransceivers().find(d=>d.receiver.track.kind==="video");s.offerToReceiveVideo===!1&&l?l.direction==="sendrecv"?l.setDirection?l.setDirection("sendonly"):l.direction="sendonly":l.direction==="recvonly"&&(l.setDirection?l.setDirection("inactive"):l.direction="inactive"):s.offerToReceiveVideo===!0&&!l&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function YS(a){typeof a!="object"||a.AudioContext||(a.AudioContext=a.webkitAudioContext)}var $y=Object.freeze({__proto__:null,shimAudioContext:YS,shimCallbacksAPI:FS,shimConstraints:HS,shimCreateOfferLegacy:KS,shimGetUserMedia:zS,shimLocalStreamsAPI:BS,shimRTCIceServerUrls:VS,shimRemoteStreamsAPI:qS,shimTrackEventTransceiver:GS}),Zd={exports:{}},e0;function vR(){return e0||(e0=1,(function(a){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(i){return i.trim().split(`
`).map(s=>s.trim())},e.splitSections=function(i){return i.split(`
m=`).map((o,l)=>(l>0?"m="+o:o).trim()+`\r
`)},e.getDescription=function(i){const s=e.splitSections(i);return s&&s[0]},e.getMediaSections=function(i){const s=e.splitSections(i);return s.shift(),s},e.matchPrefix=function(i,s){return e.splitLines(i).filter(o=>o.indexOf(s)===0)},e.parseCandidate=function(i){let s;i.indexOf("a=candidate:")===0?s=i.substring(12).split(" "):s=i.substring(10).split(" ");const o={foundation:s[0],component:{1:"rtp",2:"rtcp"}[s[1]]||s[1],protocol:s[2].toLowerCase(),priority:parseInt(s[3],10),ip:s[4],address:s[4],port:parseInt(s[5],10),type:s[7]};for(let l=8;l<s.length;l+=2)switch(s[l]){case"raddr":o.relatedAddress=s[l+1];break;case"rport":o.relatedPort=parseInt(s[l+1],10);break;case"tcptype":o.tcpType=s[l+1];break;case"ufrag":o.ufrag=s[l+1],o.usernameFragment=s[l+1];break;default:o[s[l]]===void 0&&(o[s[l]]=s[l+1]);break}return o},e.writeCandidate=function(i){const s=[];s.push(i.foundation);const o=i.component;o==="rtp"?s.push(1):o==="rtcp"?s.push(2):s.push(o),s.push(i.protocol.toUpperCase()),s.push(i.priority),s.push(i.address||i.ip),s.push(i.port);const l=i.type;return s.push("typ"),s.push(l),l!=="host"&&i.relatedAddress&&i.relatedPort&&(s.push("raddr"),s.push(i.relatedAddress),s.push("rport"),s.push(i.relatedPort)),i.tcpType&&i.protocol.toLowerCase()==="tcp"&&(s.push("tcptype"),s.push(i.tcpType)),(i.usernameFragment||i.ufrag)&&(s.push("ufrag"),s.push(i.usernameFragment||i.ufrag)),"candidate:"+s.join(" ")},e.parseIceOptions=function(i){return i.substring(14).split(" ")},e.parseRtpMap=function(i){let s=i.substring(9).split(" ");const o={payloadType:parseInt(s.shift(),10)};return s=s[0].split("/"),o.name=s[0],o.clockRate=parseInt(s[1],10),o.channels=s.length===3?parseInt(s[2],10):1,o.numChannels=o.channels,o},e.writeRtpMap=function(i){let s=i.payloadType;i.preferredPayloadType!==void 0&&(s=i.preferredPayloadType);const o=i.channels||i.numChannels||1;return"a=rtpmap:"+s+" "+i.name+"/"+i.clockRate+(o!==1?"/"+o:"")+`\r
`},e.parseExtmap=function(i){const s=i.substring(9).split(" ");return{id:parseInt(s[0],10),direction:s[0].indexOf("/")>0?s[0].split("/")[1]:"sendrecv",uri:s[1],attributes:s.slice(2).join(" ")}},e.writeExtmap=function(i){return"a=extmap:"+(i.id||i.preferredId)+(i.direction&&i.direction!=="sendrecv"?"/"+i.direction:"")+" "+i.uri+(i.attributes?" "+i.attributes:"")+`\r
`},e.parseFmtp=function(i){const s={};let o;const l=i.substring(i.indexOf(" ")+1).split(";");for(let d=0;d<l.length;d++)o=l[d].trim().split("="),s[o[0].trim()]=o[1];return s},e.writeFmtp=function(i){let s="",o=i.payloadType;if(i.preferredPayloadType!==void 0&&(o=i.preferredPayloadType),i.parameters&&Object.keys(i.parameters).length){const l=[];Object.keys(i.parameters).forEach(d=>{i.parameters[d]!==void 0?l.push(d+"="+i.parameters[d]):l.push(d)}),s+="a=fmtp:"+o+" "+l.join(";")+`\r
`}return s},e.parseRtcpFb=function(i){const s=i.substring(i.indexOf(" ")+1).split(" ");return{type:s.shift(),parameter:s.join(" ")}},e.writeRtcpFb=function(i){let s="",o=i.payloadType;return i.preferredPayloadType!==void 0&&(o=i.preferredPayloadType),i.rtcpFeedback&&i.rtcpFeedback.length&&i.rtcpFeedback.forEach(l=>{s+="a=rtcp-fb:"+o+" "+l.type+(l.parameter&&l.parameter.length?" "+l.parameter:"")+`\r
`}),s},e.parseSsrcMedia=function(i){const s=i.indexOf(" "),o={ssrc:parseInt(i.substring(7,s),10)},l=i.indexOf(":",s);return l>-1?(o.attribute=i.substring(s+1,l),o.value=i.substring(l+1)):o.attribute=i.substring(s+1),o},e.parseSsrcGroup=function(i){const s=i.substring(13).split(" ");return{semantics:s.shift(),ssrcs:s.map(o=>parseInt(o,10))}},e.getMid=function(i){const s=e.matchPrefix(i,"a=mid:")[0];if(s)return s.substring(6)},e.parseFingerprint=function(i){const s=i.substring(14).split(" ");return{algorithm:s[0].toLowerCase(),value:s[1].toUpperCase()}},e.getDtlsParameters=function(i,s){return{role:"auto",fingerprints:e.matchPrefix(i+s,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(i,s){let o="a=setup:"+s+`\r
`;return i.fingerprints.forEach(l=>{o+="a=fingerprint:"+l.algorithm+" "+l.value+`\r
`}),o},e.parseCryptoLine=function(i){const s=i.substring(9).split(" ");return{tag:parseInt(s[0],10),cryptoSuite:s[1],keyParams:s[2],sessionParams:s.slice(3)}},e.writeCryptoLine=function(i){return"a=crypto:"+i.tag+" "+i.cryptoSuite+" "+(typeof i.keyParams=="object"?e.writeCryptoKeyParams(i.keyParams):i.keyParams)+(i.sessionParams?" "+i.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(i){if(i.indexOf("inline:")!==0)return null;const s=i.substring(7).split("|");return{keyMethod:"inline",keySalt:s[0],lifeTime:s[1],mkiValue:s[2]?s[2].split(":")[0]:void 0,mkiLength:s[2]?s[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(i){return i.keyMethod+":"+i.keySalt+(i.lifeTime?"|"+i.lifeTime:"")+(i.mkiValue&&i.mkiLength?"|"+i.mkiValue+":"+i.mkiLength:"")},e.getCryptoParameters=function(i,s){return e.matchPrefix(i+s,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(i,s){const o=e.matchPrefix(i+s,"a=ice-ufrag:")[0],l=e.matchPrefix(i+s,"a=ice-pwd:")[0];return o&&l?{usernameFragment:o.substring(12),password:l.substring(10)}:null},e.writeIceParameters=function(i){let s="a=ice-ufrag:"+i.usernameFragment+`\r
a=ice-pwd:`+i.password+`\r
`;return i.iceLite&&(s+=`a=ice-lite\r
`),s},e.parseRtpParameters=function(i){const s={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},l=e.splitLines(i)[0].split(" ");s.profile=l[2];for(let u=3;u<l.length;u++){const f=l[u],p=e.matchPrefix(i,"a=rtpmap:"+f+" ")[0];if(p){const v=e.parseRtpMap(p),y=e.matchPrefix(i,"a=fmtp:"+f+" ");switch(v.parameters=y.length?e.parseFmtp(y[0]):{},v.rtcpFeedback=e.matchPrefix(i,"a=rtcp-fb:"+f+" ").map(e.parseRtcpFb),s.codecs.push(v),v.name.toUpperCase()){case"RED":case"ULPFEC":s.fecMechanisms.push(v.name.toUpperCase());break}}}e.matchPrefix(i,"a=extmap:").forEach(u=>{s.headerExtensions.push(e.parseExtmap(u))});const d=e.matchPrefix(i,"a=rtcp-fb:* ").map(e.parseRtcpFb);return s.codecs.forEach(u=>{d.forEach(f=>{u.rtcpFeedback.find(v=>v.type===f.type&&v.parameter===f.parameter)||u.rtcpFeedback.push(f)})}),s},e.writeRtpDescription=function(i,s){let o="";o+="m="+i+" ",o+=s.codecs.length>0?"9":"0",o+=" "+(s.profile||"UDP/TLS/RTP/SAVPF")+" ",o+=s.codecs.map(d=>d.preferredPayloadType!==void 0?d.preferredPayloadType:d.payloadType).join(" ")+`\r
`,o+=`c=IN IP4 0.0.0.0\r
`,o+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,s.codecs.forEach(d=>{o+=e.writeRtpMap(d),o+=e.writeFmtp(d),o+=e.writeRtcpFb(d)});let l=0;return s.codecs.forEach(d=>{d.maxptime>l&&(l=d.maxptime)}),l>0&&(o+="a=maxptime:"+l+`\r
`),s.headerExtensions&&s.headerExtensions.forEach(d=>{o+=e.writeExtmap(d)}),o},e.parseRtpEncodingParameters=function(i){const s=[],o=e.parseRtpParameters(i),l=o.fecMechanisms.indexOf("RED")!==-1,d=o.fecMechanisms.indexOf("ULPFEC")!==-1,u=e.matchPrefix(i,"a=ssrc:").map(S=>e.parseSsrcMedia(S)).filter(S=>S.attribute==="cname"),f=u.length>0&&u[0].ssrc;let p;const v=e.matchPrefix(i,"a=ssrc-group:FID").map(S=>S.substring(17).split(" ").map(_=>parseInt(_,10)));v.length>0&&v[0].length>1&&v[0][0]===f&&(p=v[0][1]),o.codecs.forEach(S=>{if(S.name.toUpperCase()==="RTX"&&S.parameters.apt){let C={ssrc:f,codecPayloadType:parseInt(S.parameters.apt,10)};f&&p&&(C.rtx={ssrc:p}),s.push(C),l&&(C=JSON.parse(JSON.stringify(C)),C.fec={ssrc:f,mechanism:d?"red+ulpfec":"red"},s.push(C))}}),s.length===0&&f&&s.push({ssrc:f});let y=e.matchPrefix(i,"b=");return y.length&&(y[0].indexOf("b=TIAS:")===0?y=parseInt(y[0].substring(7),10):y[0].indexOf("b=AS:")===0?y=parseInt(y[0].substring(5),10)*1e3*.95-2e3*8:y=void 0,s.forEach(S=>{S.maxBitrate=y})),s},e.parseRtcpParameters=function(i){const s={},o=e.matchPrefix(i,"a=ssrc:").map(u=>e.parseSsrcMedia(u)).filter(u=>u.attribute==="cname")[0];o&&(s.cname=o.value,s.ssrc=o.ssrc);const l=e.matchPrefix(i,"a=rtcp-rsize");s.reducedSize=l.length>0,s.compound=l.length===0;const d=e.matchPrefix(i,"a=rtcp-mux");return s.mux=d.length>0,s},e.writeRtcpParameters=function(i){let s="";return i.reducedSize&&(s+=`a=rtcp-rsize\r
`),i.mux&&(s+=`a=rtcp-mux\r
`),i.ssrc!==void 0&&i.cname&&(s+="a=ssrc:"+i.ssrc+" cname:"+i.cname+`\r
`),s},e.parseMsid=function(i){let s;const o=e.matchPrefix(i,"a=msid:");if(o.length===1)return s=o[0].substring(7).split(" "),{stream:s[0],track:s[1]};const l=e.matchPrefix(i,"a=ssrc:").map(d=>e.parseSsrcMedia(d)).filter(d=>d.attribute==="msid");if(l.length>0)return s=l[0].value.split(" "),{stream:s[0],track:s[1]}},e.parseSctpDescription=function(i){const s=e.parseMLine(i),o=e.matchPrefix(i,"a=max-message-size:");let l;o.length>0&&(l=parseInt(o[0].substring(19),10)),isNaN(l)&&(l=65536);const d=e.matchPrefix(i,"a=sctp-port:");if(d.length>0)return{port:parseInt(d[0].substring(12),10),protocol:s.fmt,maxMessageSize:l};const u=e.matchPrefix(i,"a=sctpmap:");if(u.length>0){const f=u[0].substring(10).split(" ");return{port:parseInt(f[0],10),protocol:f[1],maxMessageSize:l}}},e.writeSctpDescription=function(i,s){let o=[];return i.protocol!=="DTLS/SCTP"?o=["m="+i.kind+" 9 "+i.protocol+" "+s.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+s.port+`\r
`]:o=["m="+i.kind+" 9 "+i.protocol+" "+s.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+s.port+" "+s.protocol+` 65535\r
`],s.maxMessageSize!==void 0&&o.push("a=max-message-size:"+s.maxMessageSize+`\r
`),o.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(i,s,o){let l;const d=s!==void 0?s:2;return i?l=i:l=e.generateSessionId(),`v=0\r
o=`+(o||"thisisadapterortc")+" "+l+" "+d+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(i,s){const o=e.splitLines(i);for(let l=0;l<o.length;l++)switch(o[l]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return o[l].substring(2)}return s?e.getDirection(s):"sendrecv"},e.getKind=function(i){return e.splitLines(i)[0].split(" ")[0].substring(2)},e.isRejected=function(i){return i.split(" ",2)[1]==="0"},e.parseMLine=function(i){const o=e.splitLines(i)[0].substring(2).split(" ");return{kind:o[0],port:parseInt(o[1],10),protocol:o[2],fmt:o.slice(3).join(" ")}},e.parseOLine=function(i){const o=e.matchPrefix(i,"o=")[0].substring(2).split(" ");return{username:o[0],sessionId:o[1],sessionVersion:parseInt(o[2],10),netType:o[3],addressType:o[4],address:o[5]}},e.isValidSDP=function(i){if(typeof i!="string"||i.length===0)return!1;const s=e.splitLines(i);for(let o=0;o<s.length;o++)if(s[o].length<2||s[o].charAt(1)!=="=")return!1;return!0},a.exports=e})(Zd)),Zd.exports}var JS=vR(),ws=sR(JS),yR=Tw({__proto__:null,default:ws},[JS]);function Ll(a){if(!a.RTCIceCandidate||a.RTCIceCandidate&&"foundation"in a.RTCIceCandidate.prototype)return;const e=a.RTCIceCandidate;a.RTCIceCandidate=function(s){if(typeof s=="object"&&s.candidate&&s.candidate.indexOf("a=")===0&&(s=JSON.parse(JSON.stringify(s)),s.candidate=s.candidate.substring(2)),s.candidate&&s.candidate.length){const o=new e(s),l=ws.parseCandidate(s.candidate);for(const d in l)d in o||Object.defineProperty(o,d,{value:l[d]});return o.toJSON=function(){return{candidate:o.candidate,sdpMid:o.sdpMid,sdpMLineIndex:o.sdpMLineIndex,usernameFragment:o.usernameFragment}},o}return new e(s)},a.RTCIceCandidate.prototype=e.prototype,Oa(a,"icecandidate",i=>(i.candidate&&Object.defineProperty(i,"candidate",{value:new a.RTCIceCandidate(i.candidate),writable:"false"}),i))}function wh(a){!a.RTCIceCandidate||a.RTCIceCandidate&&"relayProtocol"in a.RTCIceCandidate.prototype||Oa(a,"icecandidate",e=>{if(e.candidate){const i=ws.parseCandidate(e.candidate.candidate);i.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[i.priority>>24])}return e})}function Ul(a,e){if(!a.RTCPeerConnection)return;"sctp"in a.RTCPeerConnection.prototype||Object.defineProperty(a.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const i=function(u){if(!u||!u.sdp)return!1;const f=ws.splitSections(u.sdp);return f.shift(),f.some(p=>{const v=ws.parseMLine(p);return v&&v.kind==="application"&&v.protocol.indexOf("SCTP")!==-1})},s=function(u){const f=u.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(f===null||f.length<2)return-1;const p=parseInt(f[1],10);return p!==p?-1:p},o=function(u){let f=65536;return e.browser==="firefox"&&(e.version<57?u===-1?f=16384:f=2147483637:e.version<60?f=e.version===57?65535:65536:f=2147483637),f},l=function(u,f){let p=65536;e.browser==="firefox"&&e.version===57&&(p=65535);const v=ws.matchPrefix(u.sdp,"a=max-message-size:");return v.length>0?p=parseInt(v[0].substring(19),10):e.browser==="firefox"&&f!==-1&&(p=2147483637),p},d=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:f}=this.getConfiguration();f==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(i(arguments[0])){const f=s(arguments[0]),p=o(f),v=l(arguments[0],f);let y;p===0&&v===0?y=Number.POSITIVE_INFINITY:p===0||v===0?y=Math.max(p,v):y=Math.min(p,v);const S={};Object.defineProperty(S,"maxMessageSize",{get(){return y}}),this._sctp=S}return d.apply(this,arguments)}}function Bl(a){if(!(a.RTCPeerConnection&&"createDataChannel"in a.RTCPeerConnection.prototype))return;function e(s,o){const l=s.send;s.send=function(){const u=arguments[0],f=u.length||u.size||u.byteLength;if(s.readyState==="open"&&o.sctp&&f>o.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+o.sctp.maxMessageSize+" bytes)");return l.apply(s,arguments)}}const i=a.RTCPeerConnection.prototype.createDataChannel;a.RTCPeerConnection.prototype.createDataChannel=function(){const o=i.apply(this,arguments);return e(o,this),o},Oa(a,"datachannel",s=>(e(s.channel,s.target),s))}function _h(a){if(!a.RTCPeerConnection||"connectionState"in a.RTCPeerConnection.prototype)return;const e=a.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(i){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),i&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=i)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(i=>{const s=e[i];e[i]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=o=>{const l=o.target;if(l._lastConnectionState!==l.connectionState){l._lastConnectionState=l.connectionState;const d=new Event("connectionstatechange",o);l.dispatchEvent(d)}return o},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),s.apply(this,arguments)}})}function Rh(a,e){if(!a.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e._safariVersion>=13.1)return;const i=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(o){if(o&&o.sdp&&o.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const l=o.sdp.split(`
`).filter(d=>d.trim()!=="a=extmap-allow-mixed").join(`
`);a.RTCSessionDescription&&o instanceof a.RTCSessionDescription?arguments[0]=new a.RTCSessionDescription({type:o.type,sdp:l}):o.sdp=l}return i.apply(this,arguments)}}function ql(a,e){if(!(a.RTCPeerConnection&&a.RTCPeerConnection.prototype))return;const i=a.RTCPeerConnection.prototype.addIceCandidate;!i||i.length===0||(a.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():i.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function Fl(a,e){if(!(a.RTCPeerConnection&&a.RTCPeerConnection.prototype))return;const i=a.RTCPeerConnection.prototype.setLocalDescription;!i||i.length===0||(a.RTCPeerConnection.prototype.setLocalDescription=function(){let o=arguments[0]||{};if(typeof o!="object"||o.type&&o.sdp)return i.apply(this,arguments);if(o={type:o.type,sdp:o.sdp},!o.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":o.type="offer";break;default:o.type="answer";break}return o.sdp||o.type!=="offer"&&o.type!=="answer"?i.apply(this,[o]):(o.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(d=>i.apply(this,[d]))})}var bR=Object.freeze({__proto__:null,removeExtmapAllowMixed:Rh,shimAddIceCandidateNullOrEmpty:ql,shimConnectionState:_h,shimMaxMessageSize:Ul,shimParameterlessSetLocalDescription:Fl,shimRTCIceCandidate:Ll,shimRTCIceCandidateRelayProtocol:wh,shimSendThrowTypeError:Bl});function SR(){let{window:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const i=bS,s=pR(a),o={browserDetails:s,commonShim:bR,extractVersion:Br,disableLog:fR,disableWarnings:mR,sdp:yR};switch(s.browser){case"chrome":if(!Xy||!xh||!e.shimChrome)return i("Chrome shim is not included in this adapter release."),o;if(s.version===null)return i("Chrome shim can not determine version, not shimming."),o;i("adapter.js shimming chrome."),o.browserShim=Xy,ql(a,s),Fl(a),TS(a,s),CS(a),xh(a,s),kS(a),_S(a,s),xS(a),ES(a),RS(a,s),Ll(a),wh(a),_h(a),Ul(a,s),Bl(a),Rh(a,s);break;case"firefox":if(!Zy||!Eh||!e.shimFirefox)return i("Firefox shim is not included in this adapter release."),o;i("adapter.js shimming firefox."),o.browserShim=Zy,ql(a,s),Fl(a),NS(a,s),Eh(a,s),AS(a),OS(a),MS(a),DS(a),jS(a),PS(a),IS(a),LS(a),US(a),Ll(a),_h(a),Ul(a,s),Bl(a);break;case"safari":if(!$y||!e.shimSafari)return i("Safari shim is not included in this adapter release."),o;i("adapter.js shimming safari."),o.browserShim=$y,ql(a,s),Fl(a),VS(a),KS(a),FS(a),BS(a),qS(a),GS(a),zS(a),YS(a),Ll(a),wh(a),Ul(a,s),Bl(a),Rh(a,s);break;default:i("Unsupported browser!");break}return o}SR({window:typeof window>"u"?void 0:window});var Nh,QS;class Mt extends(QS=Promise){constructor(e){super(e)}catch(e){return super.catch(e)}static reject(e){return super.reject(e)}static all(e){return super.all(e)}static race(e){return super.race(e)}}Nh=Mt;Mt.resolve=a=>Reflect.get(QS,"resolve",Nh).call(Nh,a);const TR=/version\/(\d+(\.?_?\d+)+)/i;let $d;function Yt(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(typeof navigator>"u")return;const i=navigator.userAgent.toLowerCase();if($d===void 0||e){const s=CR.find(o=>{let{test:l}=o;return l.test(i)});$d=s?.describe(i)}return $d}const CR=[{test:/firefox|iceweasel|fxios/i,describe(a){return{name:"Firefox",version:zl(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,a),os:a.toLowerCase().includes("fxios")?"iOS":void 0,osVersion:eh(a)}}},{test:/chrom|crios|crmo/i,describe(a){return{name:"Chrome",version:zl(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,a),os:a.toLowerCase().includes("crios")?"iOS":void 0,osVersion:eh(a)}}},{test:/safari|applewebkit/i,describe(a){return{name:"Safari",version:zl(TR,a),os:a.includes("mobile/")?"iOS":"macOS",osVersion:eh(a)}}}];function zl(a,e){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const s=e.match(a);return s&&s.length>=i&&s[i]||""}function eh(a){return a.includes("mac os")?zl(/\(.+?(\d+_\d+(:?_\d+)?)/,a,1).replace(/_/g,"."):void 0}var kR="2.17.2";const xR=kR,ER=16;class ta extends Error{constructor(e,i,s){super(i||"an error has occurred"),this.name="LiveKitError",this.code=e,typeof s?.cause<"u"&&(this.cause=s?.cause)}}class gf extends ta{}var Qe;(function(a){a[a.NotAllowed=0]="NotAllowed",a[a.ServerUnreachable=1]="ServerUnreachable",a[a.InternalError=2]="InternalError",a[a.Cancelled=3]="Cancelled",a[a.LeaveRequest=4]="LeaveRequest",a[a.Timeout=5]="Timeout",a[a.WebSocket=6]="WebSocket",a[a.ServiceNotFound=7]="ServiceNotFound"})(Qe||(Qe={}));class me extends gf{constructor(e,i,s,o){super(1,e),this.name="ConnectionError",this.status=s,this.reason=i,this.context=o,this.reasonName=Qe[i]}static notAllowed(e,i,s){return new me(e,Qe.NotAllowed,i,s)}static timeout(e){return new me(e,Qe.Timeout)}static leaveRequest(e,i){return new me(e,Qe.LeaveRequest,void 0,i)}static internal(e,i){return new me(e,Qe.InternalError,void 0,i)}static cancelled(e){return new me(e,Qe.Cancelled)}static serverUnreachable(e,i){return new me(e,Qe.ServerUnreachable,i)}static websocket(e,i,s){return new me(e,Qe.WebSocket,i,s)}static serviceNotFound(e,i){return new me(e,Qe.ServiceNotFound,void 0,i)}}class vf extends ta{constructor(e){super(21,e??"device is unsupported"),this.name="DeviceUnsupportedError"}}class pi extends ta{constructor(e){super(20,e??"track is invalid"),this.name="TrackInvalidError"}}class wR extends ta{constructor(e){super(10,e??"unsupported server"),this.name="UnsupportedServer"}}class ut extends ta{constructor(e){super(12,e??"unexpected connection state"),this.name="UnexpectedConnectionState"}}class Ea extends ta{constructor(e){super(13,e??"unable to negotiate"),this.name="NegotiationError"}}class t0 extends ta{constructor(e,i){super(15,e),this.name="PublishTrackError",this.status=i}}class n0 extends gf{constructor(e,i){super(15,e),this.name="SignalRequestError",this.reason=i,this.reasonName=typeof i=="string"?i:mf[i]}}var jt;(function(a){a[a.AlreadyOpened=0]="AlreadyOpened",a[a.AbnormalEnd=1]="AbnormalEnd",a[a.DecodeFailed=2]="DecodeFailed",a[a.LengthExceeded=3]="LengthExceeded",a[a.Incomplete=4]="Incomplete",a[a.HandlerAlreadyRegistered=7]="HandlerAlreadyRegistered",a[a.EncryptionTypeMismatch=8]="EncryptionTypeMismatch"})(jt||(jt={}));class yn extends gf{constructor(e,i){super(16,e),this.name="DataStreamError",this.reason=i,this.reasonName=jt[i]}}class Ss extends ta{constructor(e){super(18,e),this.name="SignalReconnectError"}}var tc;(function(a){a.PermissionDenied="PermissionDenied",a.NotFound="NotFound",a.DeviceInUse="DeviceInUse",a.Other="Other"})(tc||(tc={}));(function(a){function e(i){if(i&&"name"in i)return i.name==="NotFoundError"||i.name==="DevicesNotFoundError"?a.NotFound:i.name==="NotAllowedError"||i.name==="PermissionDeniedError"?a.PermissionDenied:i.name==="NotReadableError"||i.name==="TrackStartError"?a.DeviceInUse:a.Other}a.getFailure=e})(tc||(tc={}));class Rt{}Rt.setTimeout=function(){return setTimeout(...arguments)};Rt.setInterval=function(){return setInterval(...arguments)};Rt.clearTimeout=function(){return clearTimeout(...arguments)};Rt.clearInterval=function(){return clearInterval(...arguments)};var X;(function(a){a.Connected="connected",a.Reconnecting="reconnecting",a.SignalReconnecting="signalReconnecting",a.Reconnected="reconnected",a.Disconnected="disconnected",a.ConnectionStateChanged="connectionStateChanged",a.Moved="moved",a.MediaDevicesChanged="mediaDevicesChanged",a.ParticipantConnected="participantConnected",a.ParticipantDisconnected="participantDisconnected",a.TrackPublished="trackPublished",a.TrackSubscribed="trackSubscribed",a.TrackSubscriptionFailed="trackSubscriptionFailed",a.TrackUnpublished="trackUnpublished",a.TrackUnsubscribed="trackUnsubscribed",a.TrackMuted="trackMuted",a.TrackUnmuted="trackUnmuted",a.LocalTrackPublished="localTrackPublished",a.LocalTrackUnpublished="localTrackUnpublished",a.LocalAudioSilenceDetected="localAudioSilenceDetected",a.ActiveSpeakersChanged="activeSpeakersChanged",a.ParticipantMetadataChanged="participantMetadataChanged",a.ParticipantNameChanged="participantNameChanged",a.ParticipantAttributesChanged="participantAttributesChanged",a.ParticipantActive="participantActive",a.RoomMetadataChanged="roomMetadataChanged",a.DataReceived="dataReceived",a.SipDTMFReceived="sipDTMFReceived",a.TranscriptionReceived="transcriptionReceived",a.ConnectionQualityChanged="connectionQualityChanged",a.TrackStreamStateChanged="trackStreamStateChanged",a.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",a.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",a.AudioPlaybackStatusChanged="audioPlaybackChanged",a.VideoPlaybackStatusChanged="videoPlaybackChanged",a.MediaDevicesError="mediaDevicesError",a.ParticipantPermissionsChanged="participantPermissionsChanged",a.SignalConnected="signalConnected",a.RecordingStatusChanged="recordingStatusChanged",a.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",a.EncryptionError="encryptionError",a.DCBufferStatusChanged="dcBufferStatusChanged",a.ActiveDeviceChanged="activeDeviceChanged",a.ChatMessage="chatMessage",a.LocalTrackSubscribed="localTrackSubscribed",a.MetricsReceived="metricsReceived"})(X||(X={}));var ae;(function(a){a.TrackPublished="trackPublished",a.TrackSubscribed="trackSubscribed",a.TrackSubscriptionFailed="trackSubscriptionFailed",a.TrackUnpublished="trackUnpublished",a.TrackUnsubscribed="trackUnsubscribed",a.TrackMuted="trackMuted",a.TrackUnmuted="trackUnmuted",a.LocalTrackPublished="localTrackPublished",a.LocalTrackUnpublished="localTrackUnpublished",a.LocalTrackCpuConstrained="localTrackCpuConstrained",a.LocalSenderCreated="localSenderCreated",a.ParticipantMetadataChanged="participantMetadataChanged",a.ParticipantNameChanged="participantNameChanged",a.DataReceived="dataReceived",a.SipDTMFReceived="sipDTMFReceived",a.TranscriptionReceived="transcriptionReceived",a.IsSpeakingChanged="isSpeakingChanged",a.ConnectionQualityChanged="connectionQualityChanged",a.TrackStreamStateChanged="trackStreamStateChanged",a.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",a.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",a.TrackCpuConstrained="trackCpuConstrained",a.MediaDevicesError="mediaDevicesError",a.AudioStreamAcquired="audioStreamAcquired",a.ParticipantPermissionsChanged="participantPermissionsChanged",a.PCTrackAdded="pcTrackAdded",a.AttributesChanged="attributesChanged",a.LocalTrackSubscribed="localTrackSubscribed",a.ChatMessage="chatMessage",a.Active="active"})(ae||(ae={}));var ie;(function(a){a.TransportsCreated="transportsCreated",a.Connected="connected",a.Disconnected="disconnected",a.Resuming="resuming",a.Resumed="resumed",a.Restarting="restarting",a.Restarted="restarted",a.SignalResumed="signalResumed",a.SignalRestarted="signalRestarted",a.Closing="closing",a.MediaTrackAdded="mediaTrackAdded",a.ActiveSpeakersUpdate="activeSpeakersUpdate",a.DataPacketReceived="dataPacketReceived",a.RTPVideoMapUpdate="rtpVideoMapUpdate",a.DCBufferStatusChanged="dcBufferStatusChanged",a.ParticipantUpdate="participantUpdate",a.RoomUpdate="roomUpdate",a.SpeakersChanged="speakersChanged",a.StreamStateChanged="streamStateChanged",a.ConnectionQualityUpdate="connectionQualityUpdate",a.SubscriptionError="subscriptionError",a.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",a.RemoteMute="remoteMute",a.SubscribedQualityUpdate="subscribedQualityUpdate",a.LocalTrackUnpublished="localTrackUnpublished",a.LocalTrackSubscribed="localTrackSubscribed",a.Offline="offline",a.SignalRequestResponse="signalRequestResponse",a.SignalConnected="signalConnected",a.RoomMoved="roomMoved"})(ie||(ie={}));var $;(function(a){a.Message="message",a.Muted="muted",a.Unmuted="unmuted",a.Restarted="restarted",a.Ended="ended",a.Subscribed="subscribed",a.Unsubscribed="unsubscribed",a.CpuConstrained="cpuConstrained",a.UpdateSettings="updateSettings",a.UpdateSubscription="updateSubscription",a.AudioPlaybackStarted="audioPlaybackStarted",a.AudioPlaybackFailed="audioPlaybackFailed",a.AudioSilenceDetected="audioSilenceDetected",a.VisibilityChanged="visibilityChanged",a.VideoDimensionsChanged="videoDimensionsChanged",a.VideoPlaybackStarted="videoPlaybackStarted",a.VideoPlaybackFailed="videoPlaybackFailed",a.ElementAttached="elementAttached",a.ElementDetached="elementDetached",a.UpstreamPaused="upstreamPaused",a.UpstreamResumed="upstreamResumed",a.SubscriptionPermissionChanged="subscriptionPermissionChanged",a.SubscriptionStatusChanged="subscriptionStatusChanged",a.SubscriptionFailed="subscriptionFailed",a.TrackProcessorUpdate="trackProcessorUpdate",a.AudioTrackFeatureUpdate="audioTrackFeatureUpdate",a.TranscriptionReceived="transcriptionReceived",a.TimeSyncUpdate="timeSyncUpdate",a.PreConnectBufferFlushed="preConnectBufferFlushed"})($||($={}));function _R(a){return typeof a>"u"?a:typeof structuredClone=="function"?typeof a=="object"&&a!==null?structuredClone(Object.assign({},a)):structuredClone(a):JSON.parse(JSON.stringify(a))}class Ke{constructor(e,i,s,o,l){if(typeof e=="object")this.width=e.width,this.height=e.height,this.aspectRatio=e.aspectRatio,this.encoding={maxBitrate:e.maxBitrate,maxFramerate:e.maxFramerate,priority:e.priority};else if(i!==void 0&&s!==void 0)this.width=e,this.height=i,this.aspectRatio=e/i,this.encoding={maxBitrate:s,maxFramerate:o,priority:l};else throw new TypeError("Unsupported options: provide at least width, height and maxBitrate")}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.aspectRatio}}}const RR=["vp8","h264"],NR=["vp8","h264","vp9","av1","h265"];function AR(a){return!!RR.find(e=>e===a)}const MR=AR;var i0;(function(a){a[a.PREFER_REGRESSION=0]="PREFER_REGRESSION",a[a.SIMULCAST=1]="SIMULCAST",a[a.REGRESSION=2]="REGRESSION"})(i0||(i0={}));var Ah;(function(a){a.telephone={maxBitrate:12e3},a.speech={maxBitrate:24e3},a.music={maxBitrate:48e3},a.musicStereo={maxBitrate:64e3},a.musicHighQuality={maxBitrate:96e3},a.musicHighQualityStereo={maxBitrate:128e3}})(Ah||(Ah={}));const Xr={h90:new Ke(160,90,9e4,20),h180:new Ke(320,180,16e4,20),h216:new Ke(384,216,18e4,20),h360:new Ke(640,360,45e4,20),h540:new Ke(960,540,8e5,25),h720:new Ke(1280,720,17e5,30),h1080:new Ke(1920,1080,3e6,30),h1440:new Ke(2560,1440,5e6,30),h2160:new Ke(3840,2160,8e6,30)},Mh={h120:new Ke(160,120,7e4,20),h180:new Ke(240,180,125e3,20),h240:new Ke(320,240,14e4,20),h360:new Ke(480,360,33e4,20),h480:new Ke(640,480,5e5,20),h540:new Ke(720,540,6e5,25),h720:new Ke(960,720,13e5,30),h1080:new Ke(1440,1080,23e5,30),h1440:new Ke(1920,1440,38e5,30)},yf={h360fps3:new Ke(640,360,2e5,3,"medium"),h360fps15:new Ke(640,360,4e5,15,"medium"),h720fps5:new Ke(1280,720,8e5,5,"medium"),h720fps15:new Ke(1280,720,15e5,15,"medium"),h720fps30:new Ke(1280,720,2e6,30,"medium"),h1080fps15:new Ke(1920,1080,25e5,15,"medium"),h1080fps30:new Ke(1920,1080,5e6,30,"medium"),original:new Ke(0,0,7e6,30,"medium")};function WS(a,e,i){var s,o,l,d;const{optionsWithoutProcessor:u,audioProcessor:f,videoProcessor:p}=$S(a??{}),v=e?.processor,y=i?.processor,S=u??{};return S.audio===!0&&(S.audio={}),S.video===!0&&(S.video={}),S.audio&&(Dh(S.audio,e),(s=(l=S.audio).deviceId)!==null&&s!==void 0||(l.deviceId={ideal:"default"}),(f||v)&&(S.audio.processor=f??v)),S.video&&(Dh(S.video,i),(o=(d=S.video).deviceId)!==null&&o!==void 0||(d.deviceId={ideal:"default"}),(p||y)&&(S.video.processor=p??y)),S}function Dh(a,e){return Object.keys(e).forEach(i=>{a[i]===void 0&&(a[i]=e[i])}),a}function bf(a){var e,i,s,o;const l={};if(a.video)if(typeof a.video=="object"){const d={},u=d,f=a.video;Object.keys(f).forEach(p=>{p==="resolution"?Dh(u,f.resolution):u[p]=f[p]}),l.video=d,(e=(s=l.video).deviceId)!==null&&e!==void 0||(s.deviceId={ideal:"default"})}else l.video=a.video?{deviceId:{ideal:"default"}}:!1;else l.video=!1;return a.audio?typeof a.audio=="object"?(l.audio=a.audio,(i=(o=l.audio).deviceId)!==null&&i!==void 0||(o.deviceId={ideal:"default"})):l.audio={deviceId:{ideal:"default"}}:l.audio=!1,l}function XS(a){return E(this,arguments,void 0,function(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200;return(function*(){const s=ZS();if(s){const o=s.createAnalyser();o.fftSize=2048;const l=o.frequencyBinCount,d=new Uint8Array(l);s.createMediaStreamSource(new MediaStream([e.mediaStreamTrack])).connect(o),yield Nt(i),o.getByteTimeDomainData(d);const f=d.some(p=>p!==128&&p!==0);return s.close(),!f}return!1})()})}function ZS(){var a;const e=typeof window<"u"&&(window.AudioContext||window.webkitAudioContext);if(e){const i=new e({latencyHint:"interactive"});if(i.state==="suspended"&&typeof window<"u"&&(!((a=window.document)===null||a===void 0)&&a.body)){const s=()=>E(this,void 0,void 0,function*(){var o;try{i.state==="suspended"&&(yield i.resume())}catch(l){console.warn("Error trying to auto-resume audio context",l)}finally{(o=window.document.body)===null||o===void 0||o.removeEventListener("click",s)}});i.addEventListener("statechange",()=>{var o;i.state==="closed"&&((o=window.document.body)===null||o===void 0||o.removeEventListener("click",s))}),window.document.body.addEventListener("click",s)}return i}}function DR(a){return a==="audioinput"?Q.Source.Microphone:a==="videoinput"?Q.Source.Camera:Q.Source.Unknown}function Oh(a){return a===Q.Source.Microphone?"audioinput":a===Q.Source.Camera?"videoinput":void 0}function OR(a){var e,i;let s=(e=a.video)!==null&&e!==void 0?e:!0;return a.resolution&&a.resolution.width>0&&a.resolution.height>0&&(s=typeof s=="boolean"?{}:s,Aa()?s=Object.assign(Object.assign({},s),{width:{max:a.resolution.width},height:{max:a.resolution.height},frameRate:a.resolution.frameRate}):s=Object.assign(Object.assign({},s),{width:{ideal:a.resolution.width},height:{ideal:a.resolution.height},frameRate:a.resolution.frameRate})),{audio:(i=a.audio)!==null&&i!==void 0?i:!1,video:s,controller:a.controller,selfBrowserSurface:a.selfBrowserSurface,surfaceSwitching:a.surfaceSwitching,systemAudio:a.systemAudio,preferCurrentTab:a.preferCurrentTab}}function zr(a){return a.split("/")[1].toLowerCase()}function jR(a){const e=[];return a.forEach(i=>{i.track!==void 0&&e.push(new cf({cid:i.track.mediaStreamID,track:i.trackInfo}))}),e}function Ee(a){return"mediaStreamTrack"in a?{trackID:a.sid,source:a.source,muted:a.isMuted,enabled:a.mediaStreamTrack.enabled,kind:a.kind,streamID:a.mediaStreamID,streamTrackID:a.mediaStreamTrack.id}:{trackID:a.trackSid,enabled:a.isEnabled,muted:a.isMuted,trackInfo:Object.assign({mimeType:a.mimeType,name:a.trackName,encrypted:a.isEncrypted,kind:a.kind,source:a.source},a.track?Ee(a.track):{})}}function PR(){return typeof RTCRtpReceiver<"u"&&"getSynchronizationSources"in RTCRtpReceiver}function IR(a,e){var i;a===void 0&&(a={}),e===void 0&&(e={});const s=[...Object.keys(e),...Object.keys(a)],o={};for(const l of s)a[l]!==e[l]&&(o[l]=(i=e[l])!==null&&i!==void 0?i:"");return o}function $S(a){const e=Object.assign({},a);let i,s;return typeof e.audio=="object"&&e.audio.processor&&(i=e.audio.processor,e.audio=Object.assign(Object.assign({},e.audio),{processor:void 0})),typeof e.video=="object"&&e.video.processor&&(s=e.video.processor,e.video=Object.assign(Object.assign({},e.video),{processor:void 0})),{audioProcessor:i,videoProcessor:s,optionsWithoutProcessor:_R(e)}}function LR(a){switch(a){case vt.CAMERA:return Q.Source.Camera;case vt.MICROPHONE:return Q.Source.Microphone;case vt.SCREEN_SHARE:return Q.Source.ScreenShare;case vt.SCREEN_SHARE_AUDIO:return Q.Source.ScreenShareAudio;default:return Q.Source.Unknown}}function a0(a,e){return a.width*a.height<e.width*e.height}function UR(a,e){var i;return(i=a.layers)===null||i===void 0?void 0:i.find(s=>s.quality===e)}const BR=5e3,jr=[];var rn;(function(a){a[a.LOW=0]="LOW",a[a.MEDIUM=1]="MEDIUM",a[a.HIGH=2]="HIGH"})(rn||(rn={}));class Q extends Vn.EventEmitter{get streamState(){return this._streamState}setStreamState(e){this._streamState=e}constructor(e,i){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var o;super(),this.attachedElements=[],this.isMuted=!1,this._streamState=Q.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.log=Se,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),document.visibilityState==="hidden"?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),BR):this.handleAppVisibilityChanged()},this.log=qn((o=s.loggerName)!==null&&o!==void 0?o:Sn.Track),this.loggerContextCb=s.loggerContextCb,this.setMaxListeners(100),this.kind=i,this._mediaStreamTrack=e,this._mediaStreamID=e.id,this.source=Q.Source.Unknown}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),Ee(this))}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(e){let i="audio";this.kind===Q.Kind.Video&&(i="video"),this.attachedElements.length===0&&this.kind===Q.Kind.Video&&this.addAppVisibilityListener(),e||(i==="audio"&&(jr.forEach(l=>{l.parentElement===null&&!e&&(e=l)}),e&&jr.splice(jr.indexOf(e),1)),e||(e=document.createElement(i))),this.attachedElements.includes(e)||this.attachedElements.push(e),Cs(this.mediaStreamTrack,e);const s=e.srcObject.getTracks(),o=s.some(l=>l.kind==="audio");return e.play().then(()=>{this.emit(o?$.AudioPlaybackStarted:$.VideoPlaybackStarted)}).catch(l=>{l.name==="NotAllowedError"?this.emit(o?$.AudioPlaybackFailed:$.VideoPlaybackFailed,l):l.name==="AbortError"?Se.debug("".concat(o?"audio":"video"," playback aborted, likely due to new play request")):Se.warn("could not playback ".concat(o?"audio":"video"),l),o&&e&&s.some(d=>d.kind==="video")&&l.name==="NotAllowedError"&&(e.muted=!0,e.play().catch(()=>{}))}),this.emit($.ElementAttached,e),e}detach(e){try{if(e){_s(this.mediaStreamTrack,e);const s=this.attachedElements.indexOf(e);return s>=0&&(this.attachedElements.splice(s,1),this.recycleElement(e),this.emit($.ElementDetached,e)),e}const i=[];return this.attachedElements.forEach(s=>{_s(this.mediaStreamTrack,s),i.push(s),this.recycleElement(s),this.emit($.ElementDetached,s)}),this.attachedElements=[],i}finally{this.attachedElements.length===0&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval),this.timeSyncHandle&&cancelAnimationFrame(this.timeSyncHandle)}updateLoggerOptions(e){e.loggerName&&(this.log=qn(e.loggerName)),e.loggerContextCb&&(this.loggerContextCb=e.loggerContextCb)}recycleElement(e){if(e instanceof HTMLAudioElement){let i=!0;e.pause(),jr.forEach(s=>{s.parentElement||(i=!1)}),i&&jr.push(e)}}handleAppVisibilityChanged(){return E(this,void 0,void 0,function*(){this.isInBackground=document.visibilityState==="hidden",!this.isInBackground&&this.kind===Q.Kind.Video&&setTimeout(()=>this.attachedElements.forEach(e=>e.play().catch(()=>{})),0)})}addAppVisibilityListener(){Kt()?(this.isInBackground=document.visibilityState==="hidden",document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){Kt()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function Cs(a,e){let i;e.srcObject instanceof MediaStream?i=e.srcObject:i=new MediaStream;let s;a.kind==="audio"?s=i.getAudioTracks():s=i.getVideoTracks(),s.includes(a)||(s.forEach(o=>{i.removeTrack(o)}),i.addTrack(a)),(!Aa()||!(e instanceof HTMLVideoElement))&&(e.autoplay=!0),e.muted=i.getAudioTracks().length===0,e instanceof HTMLVideoElement&&(e.playsInline=!0),e.srcObject!==i&&(e.srcObject=i,(Aa()||Na())&&e instanceof HTMLVideoElement&&setTimeout(()=>{e.srcObject=i,e.play().catch(()=>{})},0))}function _s(a,e){if(e.srcObject instanceof MediaStream){const i=e.srcObject;i.removeTrack(a),i.getTracks().length>0?e.srcObject=i:e.srcObject=null}}(function(a){let e;(function(p){p.Audio="audio",p.Video="video",p.Unknown="unknown"})(e=a.Kind||(a.Kind={}));let i;(function(p){p.Camera="camera",p.Microphone="microphone",p.ScreenShare="screen_share",p.ScreenShareAudio="screen_share_audio",p.Unknown="unknown"})(i=a.Source||(a.Source={}));let s;(function(p){p.Active="active",p.Paused="paused",p.Unknown="unknown"})(s=a.StreamState||(a.StreamState={}));function o(p){switch(p){case e.Audio:return _n.AUDIO;case e.Video:return _n.VIDEO;default:return _n.DATA}}a.kindToProto=o;function l(p){switch(p){case _n.AUDIO:return e.Audio;case _n.VIDEO:return e.Video;default:return e.Unknown}}a.kindFromProto=l;function d(p){switch(p){case i.Camera:return vt.CAMERA;case i.Microphone:return vt.MICROPHONE;case i.ScreenShare:return vt.SCREEN_SHARE;case i.ScreenShareAudio:return vt.SCREEN_SHARE_AUDIO;default:return vt.UNKNOWN}}a.sourceToProto=d;function u(p){switch(p){case vt.CAMERA:return i.Camera;case vt.MICROPHONE:return i.Microphone;case vt.SCREEN_SHARE:return i.ScreenShare;case vt.SCREEN_SHARE_AUDIO:return i.ScreenShareAudio;default:return i.Unknown}}a.sourceFromProto=u;function f(p){switch(p){case Sh.ACTIVE:return s.Active;case Sh.PAUSED:return s.Paused;default:return s.Unknown}}a.streamStateFromProto=f})(Q||(Q={}));const qR="|",s0="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function FR(a){const e=a.split(qR);return e.length>1?[e[0],a.substr(e[0].length+1)]:[a,""]}function Nt(a){return new Mt(e=>Rt.setTimeout(e,a))}function jh(){return"addTransceiver"in RTCPeerConnection.prototype}function Ph(){return"addTrack"in RTCPeerConnection.prototype}function zR(){if(!("getCapabilities"in RTCRtpSender)||Aa()||Na())return!1;const a=RTCRtpSender.getCapabilities("video");let e=!1;if(a){for(const i of a.codecs)if(i.mimeType.toLowerCase()==="video/av1"){e=!0;break}}return e}function HR(){if(!("getCapabilities"in RTCRtpSender)||Na())return!1;if(Aa()){const i=Yt();if(i?.version&&zn(i.version,"16")<0||i?.os==="iOS"&&i?.osVersion&&zn(i.osVersion,"16")<0)return!1}const a=RTCRtpSender.getCapabilities("video");let e=!1;if(a){for(const i of a.codecs)if(i.mimeType.toLowerCase()==="video/vp9"){e=!0;break}}return e}function Nn(a){return a==="av1"||a==="vp9"}function Ih(a){return!document||Zr()?!1:(a||(a=document.createElement("audio")),"setSinkId"in a)}function VR(){return typeof RTCPeerConnection>"u"?!1:jh()||Ph()}function Na(){var a;return((a=Yt())===null||a===void 0?void 0:a.name)==="Firefox"}function r0(){const a=Yt();return!!a&&a.name==="Chrome"&&a.os!=="iOS"}function Aa(){var a;return((a=Yt())===null||a===void 0?void 0:a.name)==="Safari"}function Zr(){const a=Yt();return a?.name==="Safari"||a?.os==="iOS"}function GR(){const a=Yt();return a?.name==="Safari"&&a.version.startsWith("17.")||a?.os==="iOS"&&!!a?.osVersion&&zn(a.osVersion,"17")>=0}function KR(a){return a||(a=Yt()),a?.name==="Safari"&&zn(a.version,"18.3")>0||a?.os==="iOS"&&!!a?.osVersion&&zn(a.osVersion,"18.3")>0}function eT(){var a,e;return Kt()?(e=(a=navigator.userAgentData)===null||a===void 0?void 0:a.mobile)!==null&&e!==void 0?e:/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent):!1}function YR(){const a=Yt(),e="17.2";if(a)return a.name!=="Safari"&&a.os!=="iOS"||a.os==="iOS"&&a.osVersion&&zn(a.osVersion,e)>=0?!0:a.name==="Safari"&&zn(a.version,e)>=0}function Kt(){return typeof document<"u"}function Fn(){return navigator.product=="ReactNative"}function Ds(a){return a.hostname.endsWith(".livekit.cloud")||a.hostname.endsWith(".livekit.run")}function th(a){return Ds(a)?a.hostname.split(".")[0]:null}function tT(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function nT(){if(!Fn())return;let a=tT();if(a)return a.platform}function o0(){if(Kt())return window.devicePixelRatio;if(Fn()){let a=tT();if(a)return a.devicePixelRatio}return 1}function zn(a,e){const i=a.split("."),s=e.split("."),o=Math.min(i.length,s.length);for(let l=0;l<o;++l){const d=parseInt(i[l],10),u=parseInt(s[l],10);if(d>u)return 1;if(d<u)return-1;if(l===o-1&&d===u)return 0}return a===""&&e!==""?-1:e===""?1:i.length==s.length?0:i.length<s.length?-1:1}function JR(a){for(const e of a)e.target.handleResize(e)}function QR(a){for(const e of a)e.target.handleVisibilityChanged(e)}let nh=null;const l0=()=>(nh||(nh=new ResizeObserver(JR)),nh);let ih=null;const c0=()=>(ih||(ih=new IntersectionObserver(QR,{root:null,rootMargin:"0px"})),ih);function WR(){var a;const e=new Zb({sdk:$b.JS,protocol:ER,version:xR});return Fn()&&(e.os=(a=nT())!==null&&a!==void 0?a:""),e}function u0(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=document.createElement("canvas");o.width=a,o.height=e;const l=o.getContext("2d");l?.fillRect(0,0,o.width,o.height),s&&l&&(l.beginPath(),l.arc(a/2,e/2,50,0,Math.PI*2,!0),l.closePath(),l.fillStyle="grey",l.fill());const d=o.captureStream(),[u]=d.getTracks();if(!u)throw Error("Could not get empty media stream video track");return u.enabled=i,u}let Pr;function ah(){if(!Pr){const a=new AudioContext,e=a.createOscillator(),i=a.createGain();i.gain.setValueAtTime(0,0);const s=a.createMediaStreamDestination();if(e.connect(i),i.connect(s),e.start(),[Pr]=s.stream.getAudioTracks(),!Pr)throw Error("Could not get empty media stream audio track");Pr.enabled=!1}return Pr.clone()}class bn{get isResolved(){return this._isResolved}constructor(e,i){this._isResolved=!1,this.onFinally=i,this.promise=new Promise((s,o)=>E(this,void 0,void 0,function*(){this.resolve=s,this.reject=o,e&&(yield e(s,o))})).finally(()=>{var s;this._isResolved=!0,(s=this.onFinally)===null||s===void 0||s.call(this)})}}function XR(a){return NR.includes(a)}function wa(a){if(typeof a=="string"||typeof a=="number")return a;if(Array.isArray(a))return a[0];if(a.exact!==void 0)return Array.isArray(a.exact)?a.exact[0]:a.exact;if(a.ideal!==void 0)return Array.isArray(a.ideal)?a.ideal[0]:a.ideal;throw Error("could not unwrap constraint")}function ZR(a){return a.startsWith("http")?a.replace(/^(http)/,"ws"):a}function $r(a){return a.startsWith("ws")?a.replace(/^(ws)/,"http"):a}function $R(a,e){return a.segments.map(i=>{let{id:s,text:o,language:l,startTime:d,endTime:u,final:f}=i;var p;const v=(p=e.get(s))!==null&&p!==void 0?p:Date.now(),y=Date.now();return f?e.delete(s):e.set(s,v),{id:s,text:o,startTime:Number.parseInt(d.toString()),endTime:Number.parseInt(u.toString()),final:f,language:l,firstReceivedTime:v,lastReceivedTime:y}})}function eN(a){const{id:e,timestamp:i,message:s,editTimestamp:o}=a;return{id:e,timestamp:Number.parseInt(i.toString()),editTimestamp:o?Number.parseInt(o.toString()):void 0,message:s}}function d0(a){switch(a.reason){case Qe.LeaveRequest:return a.context;case Qe.Cancelled:return An.CLIENT_INITIATED;case Qe.NotAllowed:return An.USER_REJECTED;case Qe.ServerUnreachable:return An.JOIN_FAILURE;default:return An.UNKNOWN_REASON}}function Hl(a){return a!==void 0?Number(a):void 0}function xa(a){return a!==void 0?BigInt(a):void 0}function Rs(a){return!!a&&!(a instanceof MediaStreamTrack)&&a.isLocal}function Bn(a){return!!a&&a.kind==Q.Kind.Audio}function na(a){return!!a&&a.kind==Q.Kind.Video}function Ki(a){return Rs(a)&&na(a)}function ci(a){return Rs(a)&&Bn(a)}function Lh(a){return!!a&&!a.isLocal}function tN(a){return!!a&&!a.isLocal}function sh(a){return Lh(a)&&na(a)}function nN(a){return a.isLocal}function iN(a,e){const i=[];let s=new TextEncoder().encode(a);for(;s.length>e;){let o=e;for(;o>0;){const l=s[o];if(l!==void 0&&(l&192)!==128)break;o--}i.push(s.slice(0,o)),s=s.slice(o)}return s.length>0&&i.push(s),i}function aN(a){var e;const i=a.get("Cache-Control");if(i){const s=(e=i.match(/(?:^|[,\s])max-age=(\d+)/))===null||e===void 0?void 0:e[1];if(s)return parseInt(s,10)}}function sN(a,e){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=rN(a,e);return i?s:Sf(s,"v1")}function rN(a,e){const i=new URL(ZR(a));return e.forEach((s,o)=>{i.searchParams.set(o,s)}),Sf(i,"rtc")}function oN(a){const e=new URL($r(a));return Sf(e,"validate")}function iT(a){return a.endsWith("/")?a:"".concat(a,"/")}function Sf(a,e){return a.pathname="".concat(iT(a.pathname)).concat(e),a}function h0(a){if(typeof a=="string")return Vy.fromJson(JSON.parse(a),{ignoreUnknownFields:!0});if(a instanceof ArrayBuffer)return Vy.fromBinary(new Uint8Array(a));throw new Error("could not decode websocket message: ".concat(typeof a))}function lN(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Unknown reason";if(!(a instanceof AbortSignal))return e;const i=a.reason;switch(typeof i){case"string":return i;case"object":return i instanceof Error?i.message:e;default:return"toString"in i?i.toString():e}}const cN=10,Ir="lk_e2ee",uN="LKFrameEncryptionKey",dN={sharedKey:!1,ratchetSalt:uN,ratchetWindowSize:8,failureTolerance:cN,keyringSize:16};var Xi;(function(a){a.SetKey="setKey",a.RatchetRequest="ratchetRequest",a.KeyRatcheted="keyRatcheted"})(Xi||(Xi={}));var f0;(function(a){a.KeyRatcheted="keyRatcheted"})(f0||(f0={}));var Qi;(function(a){a.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",a.EncryptionError="encryptionError"})(Qi||(Qi={}));var m0;(function(a){a.Error="cryptorError"})(m0||(m0={}));function hN(){return fN()||Uh()}function Uh(){return typeof window.RTCRtpScriptTransform<"u"}function fN(){return typeof window.RTCRtpSender<"u"&&typeof window.RTCRtpSender.prototype.createEncodedStreams<"u"}function mN(a){var e,i,s,o,l;if(((e=a.value)===null||e===void 0?void 0:e.case)!=="sipDtmf"&&((i=a.value)===null||i===void 0?void 0:i.case)!=="metrics"&&((s=a.value)===null||s===void 0?void 0:s.case)!=="speaker"&&((o=a.value)===null||o===void 0?void 0:o.case)!=="transcription"&&((l=a.value)===null||l===void 0?void 0:l.case)!=="encryptedPacket")return new Gb({value:a.value})}class lM extends Vn.EventEmitter{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this.onKeyRatcheted=(i,s,o)=>{Se.debug("key ratcheted event received",{ratchetResult:i,participantId:s,keyIndex:o})},this.keyInfoMap=new Map,this.options=Object.assign(Object.assign({},dN),e),this.on(Xi.KeyRatcheted,this.onKeyRatcheted)}onSetEncryptionKey(e,i,s){const o={key:e,participantIdentity:i,keyIndex:s};if(!this.options.sharedKey&&!i)throw new Error("participant identity needs to be passed for encryption key if sharedKey option is false");this.keyInfoMap.set("".concat(i??"shared","-").concat(s??0),o),this.emit(Xi.SetKey,o)}getKeys(){return Array.from(this.keyInfoMap.values())}getOptions(){return this.options}ratchetKey(e,i){this.emit(Xi.RatchetRequest,e,i)}}var p0;(function(a){a[a.InvalidKey=0]="InvalidKey",a[a.MissingKey=1]="MissingKey",a[a.InternalError=2]="InternalError"})(p0||(p0={}));class pN extends Vn.EventEmitter{constructor(e,i){super(),this.decryptDataRequests=new Map,this.encryptDataRequests=new Map,this.onWorkerMessage=s=>{var o,l;const{kind:d,data:u}=s.data;switch(d){case"error":if(Se.error(u.error.message),u.uuid){const v=this.decryptDataRequests.get(u.uuid);if(v?.reject){v.reject(u.error);break}const y=this.encryptDataRequests.get(u.uuid);if(y?.reject){y.reject(u.error);break}}this.emit(Qi.EncryptionError,u.error,u.participantIdentity);break;case"initAck":u.enabled&&this.keyProvider.getKeys().forEach(v=>{this.postKey(v)});break;case"enable":if(u.enabled&&this.keyProvider.getKeys().forEach(v=>{this.postKey(v)}),this.encryptionEnabled!==u.enabled&&u.participantIdentity===((o=this.room)===null||o===void 0?void 0:o.localParticipant.identity))this.emit(Qi.ParticipantEncryptionStatusChanged,u.enabled,this.room.localParticipant),this.encryptionEnabled=u.enabled;else if(u.participantIdentity){const v=(l=this.room)===null||l===void 0?void 0:l.getParticipantByIdentity(u.participantIdentity);if(!v)throw TypeError("couldn't set encryption status, participant not found".concat(u.participantIdentity));this.emit(Qi.ParticipantEncryptionStatusChanged,u.enabled,v)}break;case"ratchetKey":this.keyProvider.emit(Xi.KeyRatcheted,u.ratchetResult,u.participantIdentity,u.keyIndex);break;case"decryptDataResponse":const f=this.decryptDataRequests.get(u.uuid);f?.resolve&&f.resolve(u);break;case"encryptDataResponse":const p=this.encryptDataRequests.get(u.uuid);p?.resolve&&p.resolve(u);break}},this.onWorkerError=s=>{Se.error("e2ee worker encountered an error:",{error:s.error}),this.emit(Qi.EncryptionError,s.error,void 0)},this.keyProvider=e.keyProvider,this.worker=e.worker,this.encryptionEnabled=!1,this.dataChannelEncryptionEnabled=i}get isEnabled(){return this.encryptionEnabled}get isDataChannelEncryptionEnabled(){return this.isEnabled&&this.dataChannelEncryptionEnabled}setup(e){if(!hN())throw new vf("tried to setup end-to-end encryption on an unsupported browser");if(Se.info("setting up e2ee"),e!==this.room){this.room=e,this.setupEventListeners(e,this.keyProvider);const i={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions(),loglevel:lR.getLevel()}};this.worker&&(Se.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(i))}}setParticipantCryptorEnabled(e,i){Se.debug("set e2ee to ".concat(e," for participant ").concat(i)),this.postEnable(e,i)}setSifTrailer(e){!e||e.length===0?Se.warn("ignoring server sent trailer as it's empty"):this.postSifTrailer(e)}setupEngine(e){e.on(ie.RTPVideoMapUpdate,i=>{this.postRTPMap(i)})}setupEventListeners(e,i){e.on(X.TrackPublished,(s,o)=>this.setParticipantCryptorEnabled(s.trackInfo.encryption!==ht.NONE,o.identity)),e.on(X.ConnectionStateChanged,s=>{s===Ie.Connected&&e.remoteParticipants.forEach(o=>{o.trackPublications.forEach(l=>{this.setParticipantCryptorEnabled(l.trackInfo.encryption!==ht.NONE,o.identity)})})}).on(X.TrackUnsubscribed,(s,o,l)=>{var d;const u={kind:"removeTransform",data:{participantIdentity:l.identity,trackId:s.mediaStreamID}};(d=this.worker)===null||d===void 0||d.postMessage(u)}).on(X.TrackSubscribed,(s,o,l)=>{this.setupE2EEReceiver(s,l.identity,o.trackInfo)}).on(X.SignalConnected,()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");i.getKeys().forEach(s=>{this.postKey(s)}),this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity)}),e.localParticipant.on(ae.LocalSenderCreated,(s,o)=>E(this,void 0,void 0,function*(){this.setupE2EESender(o,s)})),e.localParticipant.on(ae.LocalTrackPublished,s=>{if(!na(s.track)||!Zr())return;const o={kind:"updateCodec",data:{trackId:s.track.mediaStreamID,codec:zr(s.trackInfo.codecs[0].mimeType),participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(o)}),i.on(Xi.SetKey,s=>this.postKey(s)).on(Xi.RatchetRequest,(s,o)=>this.postRatchetRequest(s,o))}encryptData(e){return E(this,void 0,void 0,function*(){if(!this.worker)throw Error("could not encrypt data, worker is missing");const i=crypto.randomUUID(),s={kind:"encryptDataRequest",data:{uuid:i,payload:e,participantIdentity:this.room.localParticipant.identity}},o=new bn;return o.onFinally=()=>{this.encryptDataRequests.delete(i)},this.encryptDataRequests.set(i,o),this.worker.postMessage(s),o.promise})}handleEncryptedData(e,i,s,o){if(!this.worker)throw Error("could not handle encrypted data, worker is missing");const l=crypto.randomUUID(),d={kind:"decryptDataRequest",data:{uuid:l,payload:e,iv:i,participantIdentity:s,keyIndex:o}},u=new bn;return u.onFinally=()=>{this.decryptDataRequests.delete(l)},this.decryptDataRequests.set(l,u),this.worker.postMessage(d),u.promise}postRatchetRequest(e,i){if(!this.worker)throw Error("could not ratchet key, worker is missing");const s={kind:"ratchetRequest",data:{participantIdentity:e,keyIndex:i}};this.worker.postMessage(s)}postKey(e){let{key:i,participantIdentity:s,keyIndex:o}=e;var l;if(!this.worker)throw Error("could not set key, worker is missing");const d={kind:"setKey",data:{participantIdentity:s,isPublisher:s===((l=this.room)===null||l===void 0?void 0:l.localParticipant.identity),key:i,keyIndex:o}};this.worker.postMessage(d)}postEnable(e,i){if(this.worker){const s={kind:"enable",data:{enabled:e,participantIdentity:i}};this.worker.postMessage(s)}else throw new ReferenceError("failed to enable e2ee, worker is not ready")}postRTPMap(e){var i;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(!((i=this.room)===null||i===void 0)&&i.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const s={kind:"setRTPMap",data:{map:e,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(s)}postSifTrailer(e){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const i={kind:"setSifTrailer",data:{trailer:e}};this.worker.postMessage(i)}setupE2EEReceiver(e,i,s){if(e.receiver){if(!s?.mimeType||s.mimeType==="")throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(e.receiver,e.mediaStreamID,i,e.kind==="video"?zr(s.mimeType):void 0)}}setupE2EESender(e,i){if(!Rs(e)||!i){i||Se.warn("early return because sender is not ready");return}this.handleSender(i,e.mediaStreamID,void 0)}handleReceiver(e,i,s,o){return E(this,void 0,void 0,function*(){if(this.worker){if(Uh()&&!r0()){const l={kind:"decode",participantIdentity:s,trackId:i,codec:o};e.transform=new RTCRtpScriptTransform(this.worker,l)}else{if(Ir in e&&o){const f={kind:"updateCodec",data:{trackId:i,codec:o,participantIdentity:s}};this.worker.postMessage(f);return}let l=e.writableStream,d=e.readableStream;if(!l||!d){const f=e.createEncodedStreams();e.writableStream=f.writable,l=f.writable,e.readableStream=f.readable,d=f.readable}const u={kind:"decode",data:{readableStream:d,writableStream:l,trackId:i,codec:o,participantIdentity:s,isReuse:Ir in e}};this.worker.postMessage(u,[d,l])}e[Ir]=!0}})}handleSender(e,i,s){var o;if(!(Ir in e||!this.worker)){if(!(!((o=this.room)===null||o===void 0)&&o.localParticipant.identity)||this.room.localParticipant.identity==="")throw TypeError("local identity needs to be known in order to set up encrypted sender");if(Uh()&&!r0()){Se.info("initialize script transform");const l={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:i,codec:s};e.transform=new RTCRtpScriptTransform(this.worker,l)}else{Se.info("initialize encoded streams");const l=e.createEncodedStreams(),d={kind:"encode",data:{readableStream:l.readable,writableStream:l.writable,codec:s,trackId:i,participantIdentity:this.room.localParticipant.identity,isReuse:!1}};this.worker.postMessage(d,[l.readable,l.writable])}e[Ir]=!0}}}const gN=500,vN=15e3;class Ns{constructor(){this.failedConnectionAttempts=new Map,this.backOffPromises=new Map}static getInstance(){return this._instance||(this._instance=new Ns),this._instance}addFailedConnectionAttempt(e){var i;const s=new URL(e),o=th(s);if(!o)return;let l=(i=this.failedConnectionAttempts.get(o))!==null&&i!==void 0?i:0;this.failedConnectionAttempts.set(o,l+1),this.backOffPromises.set(o,Nt(Math.min(gN*Math.pow(2,l),vN)))}getBackOffPromise(e){const i=new URL(e),s=i&&th(i);return s&&this.backOffPromises.get(s)||Promise.resolve()}resetFailedConnectionAttempts(e){const i=new URL(e),s=i&&th(i);s&&(this.failedConnectionAttempts.set(s,0),this.backOffPromises.set(s,Promise.resolve()))}resetAll(){this.backOffPromises.clear(),this.failedConnectionAttempts.clear()}}Ns._instance=null;const rh="default";class Ct{constructor(){this._previousDevices=[]}static getInstance(){return this.instance===void 0&&(this.instance=new Ct),this.instance}get previousDevices(){return this._previousDevices}getDevices(e){return E(this,arguments,void 0,function(i){var s=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return(function*(){var l;if(((l=Ct.userMediaPromiseMap)===null||l===void 0?void 0:l.size)>0){Se.debug("awaiting getUserMedia promise");try{i?yield Ct.userMediaPromiseMap.get(i):yield Promise.all(Ct.userMediaPromiseMap.values())}catch{Se.warn("error waiting for media permissons")}}let d=yield navigator.mediaDevices.enumerateDevices();if(o&&!(Aa()&&s.hasDeviceInUse(i))&&(d.filter(f=>f.kind===i).length===0||d.some(f=>{const p=f.label==="",v=i?f.kind===i:!0;return p&&v}))){const f={video:i!=="audioinput"&&i!=="audiooutput",audio:i!=="videoinput"&&{deviceId:{ideal:"default"}}},p=yield navigator.mediaDevices.getUserMedia(f);d=yield navigator.mediaDevices.enumerateDevices(),p.getTracks().forEach(v=>{v.stop()})}return s._previousDevices=d,i&&(d=d.filter(u=>u.kind===i)),d})()})}normalizeDeviceId(e,i,s){return E(this,void 0,void 0,function*(){if(i!==rh)return i;const o=yield this.getDevices(e),l=o.find(u=>u.deviceId===rh);if(!l){Se.warn("could not reliably determine default device");return}const d=o.find(u=>u.deviceId!==rh&&u.groupId===(s??l.groupId));if(!d){Se.warn("could not reliably determine default device");return}return d?.deviceId})}hasDeviceInUse(e){return e?Ct.userMediaPromiseMap.has(e):Ct.userMediaPromiseMap.size>0}}Ct.mediaDeviceKinds=["audioinput","audiooutput","videoinput"];Ct.userMediaPromiseMap=new Map;var Hr;(function(a){a[a.WAITING=0]="WAITING",a[a.RUNNING=1]="RUNNING",a[a.COMPLETED=2]="COMPLETED"})(Hr||(Hr={}));class yN{constructor(){this.pendingTasks=new Map,this.taskMutex=new It,this.nextTaskIndex=0}run(e){return E(this,void 0,void 0,function*(){const i={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:Hr.WAITING};this.pendingTasks.set(i.id,i);const s=yield this.taskMutex.lock();try{return i.executedAt=Date.now(),i.status=Hr.RUNNING,yield e()}finally{i.status=Hr.COMPLETED,this.pendingTasks.delete(i.id),s()}})}flush(){return E(this,void 0,void 0,function*(){return this.run(()=>E(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}class bN{get readyState(){return this.ws.readyState}constructor(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var s,o;if(!((s=i.signal)===null||s===void 0)&&s.aborted)throw new DOMException("This operation was aborted","AbortError");this.url=e;const l=new WebSocket(e,(o=i.protocols)!==null&&o!==void 0?o:[]);l.binaryType="arraybuffer",this.ws=l;const d=function(){let{closeCode:u,reason:f}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return l.close(u,f)};this.opened=new Mt((u,f)=>{const p=()=>{f(me.websocket("Encountered websocket error during connection establishment"))};l.onopen=()=>{u({readable:new ReadableStream({start(v){l.onmessage=y=>{let{data:S}=y;return v.enqueue(S)},l.onerror=y=>v.error(y)},cancel:d}),writable:new WritableStream({write(v){l.send(v)},abort(){l.close()},close:d}),protocol:l.protocol,extensions:l.extensions}),l.removeEventListener("error",p)},l.addEventListener("error",p)}),this.closed=new Mt((u,f)=>{const p=()=>E(this,void 0,void 0,function*(){const v=new Mt(S=>{l.readyState!==WebSocket.CLOSED&&l.addEventListener("close",C=>{S(C)},{once:!0})}),y=yield Mt.race([Nt(250),v]);y?u(y):f(me.websocket("Encountered unspecified websocket error without a timely close event"))});l.onclose=v=>{let{code:y,reason:S}=v;u({closeCode:y,reason:S}),l.removeEventListener("error",p)},l.addEventListener("error",p)}),i.signal&&(i.signal.onabort=()=>l.close()),this.close=d}}const SN=["syncState","trickle","offer","answer","simulate","leave"];function TN(a){const e=SN.indexOf(a.case)>=0;return Se.trace("request allowed to bypass queue:",{canPass:e,req:a}),e}var Je;(function(a){a[a.CONNECTING=0]="CONNECTING",a[a.CONNECTED=1]="CONNECTED",a[a.RECONNECTING=2]="RECONNECTING",a[a.DISCONNECTING=3]="DISCONNECTING",a[a.DISCONNECTED=4]="DISCONNECTED"})(Je||(Je={}));const CN=250;class Tf{get currentState(){return this.state}get isDisconnected(){return this.state===Je.DISCONNECTING||this.state===Je.DISCONNECTED}get isEstablishingConnection(){return this.state===Je.CONNECTING||this.state===Je.RECONNECTING}getNextRequestId(){return this._requestId+=1,this._requestId}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var s;this.rtt=0,this.state=Je.DISCONNECTED,this.log=Se,this._requestId=0,this.useV0SignalPath=!1,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0,this.onMediaSectionsRequirement=void 0},this.log=qn((s=i.loggerName)!==null&&s!==void 0?s:Sn.Signal),this.loggerContextCb=i.loggerContextCb,this.useJSON=e,this.requestQueue=new yN,this.queuedRequests=[],this.closingLock=new It,this.connectionLock=new It,this.state=Je.DISCONNECTED}get logContext(){var e,i;return(i=(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this))!==null&&i!==void 0?i:{}}join(e,i,s,o){return E(this,arguments,void 0,function(l,d,u,f){var p=this;let v=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;return(function*(){return p.state=Je.CONNECTING,p.options=u,yield p.connect(l,d,u,f,v)})()})}reconnect(e,i,s,o){return E(this,void 0,void 0,function*(){if(!this.options){this.log.warn("attempted to reconnect without signal options being set, ignoring",this.logContext);return}return this.state=Je.RECONNECTING,this.clearPingInterval(),yield this.connect(e,i,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:s,reconnectReason:o}),void 0,this.useV0SignalPath)})}connect(e,i,s,o){return E(this,arguments,void 0,function(l,d,u,f){var p=this;let v=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;return(function*(){const y=yield p.connectionLock.lock();p.connectOptions=u,p.useV0SignalPath=v;const S=WR(),C=v?kN(d,S,u):xN(d,S,u),_=sN(l,C,v).toString(),x=oN(_).toString();return new Promise((k,R)=>E(p,void 0,void 0,function*(){var O,L;try{let D=!1;const I=te=>E(this,void 0,void 0,function*(){if(D)return;D=!0;const re=te instanceof Event?te.currentTarget:te,ue=lN(re,"Abort handler called");this.streamWriter&&!this.isDisconnected?this.sendLeave().then(()=>this.close(ue)).catch(Me=>{this.log.error(Me),this.close()}):this.close(),j(),R(me.cancelled(ue))});f?.addEventListener("abort",I);const j=()=>{clearTimeout(H),f?.removeEventListener("abort",I)},H=setTimeout(()=>{I(me.timeout("room connection has timed out (signal)"))},u.websocketTimeout),Z=(te,re)=>{this.handleSignalConnected(te,H,re)},ee=new URL(_);ee.searchParams.has("access_token")&&ee.searchParams.set("access_token","<redacted>"),this.log.debug("connecting to ".concat(ee),Object.assign({reconnect:u.reconnect,reconnectReason:u.reconnectReason},this.logContext)),this.ws&&(yield this.close(!1)),this.ws=new bN(_);try{this.ws.closed.then(z=>{var ne;this.isEstablishingConnection&&R(me.internal("Websocket got closed during a (re)connection attempt: ".concat(z.reason))),z.closeCode!==1e3&&(this.log.warn("websocket closed",Object.assign(Object.assign({},this.logContext),{reason:z.reason,code:z.closeCode,wasClean:z.closeCode===1e3,state:this.state})),this.state===Je.CONNECTED&&this.handleOnClose((ne=z.reason)!==null&&ne!==void 0?ne:"Unexpected WS error"))}).catch(z=>{this.isEstablishingConnection&&R(me.internal("Websocket error during a (re)connection attempt: ".concat(z)))});const te=yield this.ws.opened.catch(z=>E(this,void 0,void 0,function*(){if(this.state!==Je.CONNECTED){this.state=Je.DISCONNECTED,clearTimeout(H);const ne=yield this.handleConnectionError(z,x);R(ne);return}this.handleWSError(z),R(z)}));if(clearTimeout(H),!te)return;const re=te.readable.getReader();this.streamWriter=te.writable.getWriter();const ue=yield re.read();if(re.releaseLock(),!ue.value)throw me.internal("no message received as first message");const Me=h0(ue.value),We=this.validateFirstMessage(Me,(O=u.reconnect)!==null&&O!==void 0?O:!1);if(!We.isValid){R(We.error);return}((L=Me.message)===null||L===void 0?void 0:L.case)==="join"&&(this.pingTimeoutDuration=Me.message.value.pingTimeout,this.pingIntervalDuration=Me.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&this.log.debug("ping config",Object.assign(Object.assign({},this.logContext),{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration})));const ze=We.shouldProcessFirstMessage?Me:void 0;Z(te,ze),k(We.response)}catch(te){R(te)}finally{j()}}finally{y()}}))})()})}startReadingLoop(e,i){return E(this,void 0,void 0,function*(){for(i&&this.handleSignalResponse(i);;){this.signalLatency&&(yield Nt(this.signalLatency));const{done:s,value:o}=yield e.read();if(s)break;const l=h0(o);this.handleSignalResponse(l)}})}close(){return E(this,arguments,void 0,function(){var e=this;let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Close method called on signal client";return(function*(){if([Je.DISCONNECTING||Je.DISCONNECTED].includes(e.state)){e.log.debug("ignoring signal close as it's already in disconnecting state");return}const o=yield e.closingLock.lock();try{if(e.clearPingInterval(),i&&(e.state=Je.DISCONNECTING),e.ws){e.ws.close({closeCode:1e3,reason:s});const l=e.ws.closed;e.ws=void 0,e.streamWriter=void 0,yield Promise.race([l,Nt(CN)])}}catch(l){e.log.debug("websocket error while closing",Object.assign(Object.assign({},e.logContext),{error:l}))}finally{i&&(e.state=Je.DISCONNECTED),o()}})()})}sendOffer(e,i){this.log.debug("sending offer",Object.assign(Object.assign({},this.logContext),{offerSdp:e.sdp})),this.sendRequest({case:"offer",value:ks(e,i)})}sendAnswer(e,i){return this.log.debug("sending answer",Object.assign(Object.assign({},this.logContext),{answerSdp:e.sdp})),this.sendRequest({case:"answer",value:ks(e,i)})}sendIceCandidate(e,i){return this.log.debug("sending ice candidate",Object.assign(Object.assign({},this.logContext),{candidate:e})),this.sendRequest({case:"trickle",value:new fc({candidateInit:JSON.stringify(e),target:i})})}sendMuteTrack(e,i){return this.sendRequest({case:"mute",value:new mc({sid:e,muted:i})})}sendAddTrack(e){return this.sendRequest({case:"addTrack",value:e})}sendUpdateLocalMetadata(e,i){return E(this,arguments,void 0,function(s,o){var l=this;let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return(function*(){const u=l.getNextRequestId();return yield l.sendRequest({case:"updateMetadata",value:new df({requestId:u,metadata:s,name:o,attributes:d})}),u})()})}sendUpdateTrackSettings(e){this.sendRequest({case:"trackSetting",value:e})}sendUpdateSubscription(e){return this.sendRequest({case:"subscription",value:e})}sendSyncState(e){return this.sendRequest({case:"syncState",value:e})}sendUpdateVideoLayers(e,i){return this.sendRequest({case:"updateLayers",value:new cS({trackSid:e,layers:i})})}sendUpdateSubscriptionPermissions(e,i){return this.sendRequest({case:"subscriptionPermission",value:new hS({allParticipants:e,trackPermissions:i})})}sendSimulateScenario(e){return this.sendRequest({case:"simulate",value:e})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:et.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new pS({timestamp:et.parse(Date.now()),rtt:et.parse(this.rtt)})})])}sendUpdateLocalAudioTrack(e,i){return this.sendRequest({case:"updateAudioTrack",value:new uf({trackSid:e,features:i})})}sendLeave(){return this.sendRequest({case:"leave",value:new gc({reason:An.CLIENT_INITIATED,action:Es.DISCONNECT})})}sendRequest(e){return E(this,arguments,void 0,function(i){var s=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return(function*(){if(!o&&!TN(i)&&s.state===Je.RECONNECTING){s.queuedRequests.push(()=>E(s,void 0,void 0,function*(){yield this.sendRequest(i,!0)}));return}if(o||(yield s.requestQueue.flush()),s.signalLatency&&(yield Nt(s.signalLatency)),s.isDisconnected){s.log.debug("skipping signal request (type: ".concat(i.case,") - SignalClient disconnected"));return}if(!s.streamWriter){s.log.error("cannot send signal request before connected, type: ".concat(i?.case),s.logContext);return}const d=new R_({message:i});try{s.useJSON?yield s.streamWriter.write(d.toJsonString()):yield s.streamWriter.write(d.toBinary())}catch(u){s.log.error("error sending signal message",Object.assign(Object.assign({},s.logContext),{error:u}))}})()})}handleSignalResponse(e){var i,s;const o=e.message;if(o==null){this.log.debug("received unsupported message",this.logContext);return}let l=!1;if(o.case==="answer"){const d=g0(o.value);this.onAnswer&&this.onAnswer(d,o.value.id,o.value.midToTrackId)}else if(o.case==="offer"){const d=g0(o.value);this.onOffer&&this.onOffer(d,o.value.id,o.value.midToTrackId)}else if(o.case==="trickle"){const d=JSON.parse(o.value.candidateInit);this.onTrickle&&this.onTrickle(d,o.value.target)}else o.case==="update"?this.onParticipantUpdate&&this.onParticipantUpdate((i=o.value.participants)!==null&&i!==void 0?i:[]):o.case==="trackPublished"?this.onLocalTrackPublished&&this.onLocalTrackPublished(o.value):o.case==="speakersChanged"?this.onSpeakersChanged&&this.onSpeakersChanged((s=o.value.speakers)!==null&&s!==void 0?s:[]):o.case==="leave"?this.onLeave&&this.onLeave(o.value):o.case==="mute"?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(o.value.sid,o.value.muted):o.case==="roomUpdate"?this.onRoomUpdate&&o.value.room&&this.onRoomUpdate(o.value.room):o.case==="connectionQuality"?this.onConnectionQuality&&this.onConnectionQuality(o.value):o.case==="streamStateUpdate"?this.onStreamStateUpdate&&this.onStreamStateUpdate(o.value):o.case==="subscribedQualityUpdate"?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(o.value):o.case==="subscriptionPermissionUpdate"?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(o.value):o.case==="refreshToken"?this.onTokenRefresh&&this.onTokenRefresh(o.value):o.case==="trackUnpublished"?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(o.value):o.case==="subscriptionResponse"?this.onSubscriptionError&&this.onSubscriptionError(o.value):o.case==="pong"||(o.case==="pongResp"?(this.rtt=Date.now()-Number.parseInt(o.value.lastPingTimestamp.toString()),this.resetPingTimeout(),l=!0):o.case==="requestResponse"?this.onRequestResponse&&this.onRequestResponse(o.value):o.case==="trackSubscribed"?this.onLocalTrackSubscribed&&this.onLocalTrackSubscribed(o.value.trackSid):o.case==="roomMoved"?(this.onTokenRefresh&&this.onTokenRefresh(o.value.token),this.onRoomMoved&&this.onRoomMoved(o.value)):o.case==="mediaSectionsRequirement"?this.onMediaSectionsRequirement&&this.onMediaSectionsRequirement(o.value):this.log.debug("unsupported message",Object.assign(Object.assign({},this.logContext),{msgCase:o.case})));l||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){const e=this.queuedRequests.shift();e&&this.requestQueue.run(e)}}handleOnClose(e){return E(this,void 0,void 0,function*(){if(this.state===Je.DISCONNECTED)return;const i=this.onClose;yield this.close(void 0,e),this.log.debug("websocket connection closed: ".concat(e),Object.assign(Object.assign({},this.logContext),{reason:e})),i&&i(e)})}handleWSError(e){this.log.error("websocket error",Object.assign(Object.assign({},this.logContext),{error:e}))}resetPingTimeout(){if(this.clearPingTimeout(),!this.pingTimeoutDuration){this.log.warn("ping timeout duration not set",this.logContext);return}this.pingTimeout=Rt.setTimeout(()=>{this.log.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-this.pingTimeoutDuration*1e3).toUTCString()),this.logContext),this.handleOnClose("ping timeout")},this.pingTimeoutDuration*1e3)}clearPingTimeout(){this.pingTimeout&&Rt.clearTimeout(this.pingTimeout)}startPingInterval(){if(this.clearPingInterval(),this.resetPingTimeout(),!this.pingIntervalDuration){this.log.warn("ping interval duration not set",this.logContext);return}this.log.debug("start ping interval",this.logContext),this.pingInterval=Rt.setInterval(()=>{this.sendPing()},this.pingIntervalDuration*1e3)}clearPingInterval(){this.log.debug("clearing ping interval",this.logContext),this.clearPingTimeout(),this.pingInterval&&Rt.clearInterval(this.pingInterval)}handleSignalConnected(e,i,s){this.state=Je.CONNECTED,clearTimeout(i),this.startPingInterval(),this.startReadingLoop(e.readable.getReader(),s)}validateFirstMessage(e,i){var s,o,l,d,u;return((s=e.message)===null||s===void 0?void 0:s.case)==="join"?{isValid:!0,response:e.message.value}:this.state===Je.RECONNECTING&&((o=e.message)===null||o===void 0?void 0:o.case)!=="leave"?((l=e.message)===null||l===void 0?void 0:l.case)==="reconnect"?{isValid:!0,response:e.message.value}:(this.log.debug("declaring signal reconnected without reconnect response received",this.logContext),{isValid:!0,response:void 0,shouldProcessFirstMessage:!0}):this.isEstablishingConnection&&((d=e.message)===null||d===void 0?void 0:d.case)==="leave"?{isValid:!1,error:me.leaveRequest("Received leave request while trying to (re)connect",e.message.value.reason)}:i?{isValid:!1,error:me.internal("Unexpected first message")}:{isValid:!1,error:me.internal("did not receive join response, got ".concat((u=e.message)===null||u===void 0?void 0:u.case," instead"))}}handleConnectionError(e,i){return E(this,void 0,void 0,function*(){try{const s=yield fetch(i);switch(s.status){case 404:return me.serviceNotFound("v1 RTC path not found. Consider upgrading your LiveKit server version","v0-rtc");case 401:case 403:const o=yield s.text();return me.notAllowed(o,s.status);default:break}return e instanceof me?e:me.internal("Encountered unknown websocket error during connection: ".concat(e),{status:s.status,statusText:s.statusText})}catch(s){return s instanceof me?s:me.serverUnreachable(s instanceof Error?s.message:"server was not reachable")}})}}function g0(a){const e={type:"offer",sdp:a.sdp};switch(a.type){case"answer":case"offer":case"pranswer":case"rollback":e.type=a.type;break}return e}function ks(a,e){return new $i({sdp:a.sdp,type:a.type,id:e})}function kN(a,e,i){var s;const o=new URLSearchParams;return o.set("access_token",a),i.reconnect&&(o.set("reconnect","1"),i.sid&&o.set("sid",i.sid)),o.set("auto_subscribe",i.autoSubscribe?"1":"0"),o.set("sdk",Fn()?"reactnative":"js"),o.set("version",e.version),o.set("protocol",e.protocol.toString()),e.deviceModel&&o.set("device_model",e.deviceModel),e.os&&o.set("os",e.os),e.osVersion&&o.set("os_version",e.osVersion),e.browser&&o.set("browser",e.browser),e.browserVersion&&o.set("browser_version",e.browserVersion),i.adaptiveStream&&o.set("adaptive_stream","1"),i.reconnectReason&&o.set("reconnect_reason",i.reconnectReason.toString()),!((s=navigator.connection)===null||s===void 0)&&s.type&&o.set("network",navigator.connection.type),o}function xN(a,e,i){const s=new URLSearchParams;s.set("access_token",a);const o=new tR({clientInfo:e,connectionSettings:new gS({autoSubscribe:!!i.autoSubscribe,adaptiveStream:!!i.adaptiveStream}),reconnect:!!i.reconnect,participantSid:i.sid?i.sid:void 0});i.reconnectReason&&(o.reconnectReason=i.reconnectReason);const l=new nR({joinRequest:o.toBinary()});return s.set("join_request",btoa(new TextDecoder("utf-8").decode(l.toBinary()))),s}class v0{constructor(){this.buffer=[],this._totalSize=0}push(e){this.buffer.push(e),this._totalSize+=e.data.byteLength}pop(){const e=this.buffer.shift();return e&&(this._totalSize-=e.data.byteLength),e}getAll(){return this.buffer.slice()}popToSequence(e){for(;this.buffer.length>0&&this.buffer[0].sequence<=e;)this.pop()}alignBufferedAmount(e){for(;this.buffer.length>0;){const i=this.buffer[0];if(this._totalSize-i.data.byteLength<=e)break;this.pop()}}get length(){return this.buffer.length}}class EN{constructor(e){this._map=new Map,this._lastCleanup=0,this.ttl=e}set(e,i){const s=Date.now();s-this._lastCleanup>this.ttl/2&&this.cleanup();const o=s+this.ttl;return this._map.set(e,{value:i,expiresAt:o}),this}get(e){const i=this._map.get(e);if(i){if(i.expiresAt<Date.now()){this._map.delete(e);return}return i.value}}has(e){const i=this._map.get(e);return i?i.expiresAt<Date.now()?(this._map.delete(e),!1):!0:!1}delete(e){return this._map.delete(e)}clear(){this._map.clear()}cleanup(){const e=Date.now();for(const[i,s]of this._map.entries())s.expiresAt<e&&this._map.delete(i);this._lastCleanup=e}get size(){return this.cleanup(),this._map.size}forEach(e){this.cleanup();for(const[i,s]of this._map.entries())s.expiresAt>=Date.now()&&e(s.value,i,this.asValueMap())}map(e){this.cleanup();const i=[],s=this.asValueMap();for(const[o,l]of s.entries())i.push(e(l,o,s));return i}asValueMap(){const e=new Map;for(const[i,s]of this._map.entries())s.expiresAt>=Date.now()&&e.set(i,s.value);return e}}var En={},oh={},lh={exports:{}},y0;function Cf(){if(y0)return lh.exports;y0=1;var a=lh.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return e.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return e.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return e.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var i="candidate:%s %d %s %d %s %d typ %s";return i+=e.raddr!=null?" raddr %s rport %d":"%v%v",i+=e.tcptype!=null?" tcptype %s":"%v",e.generation!=null&&(i+=" generation %d"),i+=e["network-id"]!=null?" network-id %d":"%v",i+=e["network-cost"]!=null?" network-cost %d":"%v",i}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var i="ssrc:%d";return e.attribute!=null&&(i+=" %s",e.value!=null&&(i+=":%s")),i}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return e.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(e.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var i="mediaclk:";return i+=e.id!=null?"id=%s %s":"%v%s",i+=e.mediaClockValue!=null?"=%s":"",i+=e.rateNumerator!=null?" rate=%s":"",i+=e.rateDenominator!=null?"/%s":"",i}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};return Object.keys(a).forEach(function(e){var i=a[e];i.forEach(function(s){s.reg||(s.reg=/(.*)/),s.format||(s.format="%s")})}),lh.exports}var b0;function wN(){return b0||(b0=1,(function(a){var e=function(u){return String(Number(u))===u?Number(u):u},i=function(u,f,p,v){if(v&&!p)f[v]=e(u[1]);else for(var y=0;y<p.length;y+=1)u[y+1]!=null&&(f[p[y]]=e(u[y+1]))},s=function(u,f,p){var v=u.name&&u.names;u.push&&!f[u.push]?f[u.push]=[]:v&&!f[u.name]&&(f[u.name]={});var y=u.push?{}:v?f[u.name]:f;i(p.match(u.reg),y,u.names,u.name),u.push&&f[u.push].push(y)},o=Cf(),l=RegExp.prototype.test.bind(/^([a-z])=(.*)/);a.parse=function(u){var f={},p=[],v=f;return u.split(/(\r\n|\r|\n)/).filter(l).forEach(function(y){var S=y[0],C=y.slice(2);S==="m"&&(p.push({rtp:[],fmtp:[]}),v=p[p.length-1]);for(var _=0;_<(o[S]||[]).length;_+=1){var x=o[S][_];if(x.reg.test(C))return s(x,v,C)}}),f.media=p,f};var d=function(u,f){var p=f.split(/=(.+)/,2);return p.length===2?u[p[0]]=e(p[1]):p.length===1&&f.length>1&&(u[p[0]]=void 0),u};a.parseParams=function(u){return u.split(/;\s?/).reduce(d,{})},a.parseFmtpConfig=a.parseParams,a.parsePayloads=function(u){return u.toString().split(" ").map(Number)},a.parseRemoteCandidates=function(u){for(var f=[],p=u.split(" ").map(e),v=0;v<p.length;v+=3)f.push({component:p[v],ip:p[v+1],port:p[v+2]});return f},a.parseImageAttributes=function(u){return u.split(" ").map(function(f){return f.substring(1,f.length-1).split(",").reduce(d,{})})},a.parseSimulcastStreamList=function(u){return u.split(";").map(function(f){return f.split(",").map(function(p){var v,y=!1;return p[0]!=="~"?v=e(p):(v=e(p.substring(1,p.length)),y=!0),{scid:v,paused:y}})})}})(oh)),oh}var ch,S0;function _N(){if(S0)return ch;S0=1;var a=Cf(),e=/%[sdv%]/g,i=function(d){var u=1,f=arguments,p=f.length;return d.replace(e,function(v){if(u>=p)return v;var y=f[u];switch(u+=1,v){case"%%":return"%";case"%s":return String(y);case"%d":return Number(y);case"%v":return""}})},s=function(d,u,f){var p=u.format instanceof Function?u.format(u.push?f:f[u.name]):u.format,v=[d+"="+p];if(u.names)for(var y=0;y<u.names.length;y+=1){var S=u.names[y];u.name?v.push(f[u.name][S]):v.push(f[u.names[y]])}else v.push(f[u.name]);return i.apply(null,v)},o=["v","o","s","i","u","e","p","c","b","t","r","z","a"],l=["i","c","b","a"];return ch=function(d,u){u=u||{},d.version==null&&(d.version=0),d.name==null&&(d.name=" "),d.media.forEach(function(y){y.payloads==null&&(y.payloads="")});var f=u.outerOrder||o,p=u.innerOrder||l,v=[];return f.forEach(function(y){a[y].forEach(function(S){S.name in d&&d[S.name]!=null?v.push(s(y,S,d)):S.push in d&&d[S.push]!=null&&d[S.push].forEach(function(C){v.push(s(y,S,C))})})}),d.media.forEach(function(y){v.push(s("m",a.m[0],y)),p.forEach(function(S){a[S].forEach(function(C){C.name in y&&y[C.name]!=null?v.push(s(S,C,y)):C.push in y&&y[C.push]!=null&&y[C.push].forEach(function(_){v.push(s(S,C,_))})})})}),v.join(`\r
`)+`\r
`},ch}var T0;function RN(){if(T0)return En;T0=1;var a=wN(),e=_N(),i=Cf();return En.grammar=i,En.write=e,En.parse=a.parse,En.parseParams=a.parseParams,En.parseFmtpConfig=a.parseFmtpConfig,En.parsePayloads=a.parsePayloads,En.parseRemoteCandidates=a.parseRemoteCandidates,En.parseImageAttributes=a.parseImageAttributes,En.parseSimulcastStreamList=a.parseSimulcastStreamList,En}var Yi=RN();function kf(a,e,i){var s,o,l;e===void 0&&(e=50),i===void 0&&(i={});var d=(s=i.isImmediate)!=null&&s,u=(o=i.callback)!=null&&o,f=i.maxWait,p=Date.now(),v=[];function y(){if(f!==void 0){var C=Date.now()-p;if(C+e>=f)return f-C}return e}var S=function(){var C=[].slice.call(arguments),_=this;return new Promise(function(x,k){var R=d&&l===void 0;if(l!==void 0&&clearTimeout(l),l=setTimeout(function(){if(l=void 0,p=Date.now(),!d){var L=a.apply(_,C);u&&u(L),v.forEach(function(D){return(0,D.resolve)(L)}),v=[]}},y()),R){var O=a.apply(_,C);return u&&u(O),x(O)}v.push({resolve:x,reject:k})})};return S.cancel=function(C){l!==void 0&&clearTimeout(l),v.forEach(function(_){return(0,_.reject)(C)}),v=[]},S}const NN=.7,AN=20,_a={NegotiationStarted:"negotiationStarted",NegotiationComplete:"negotiationComplete",RTPVideoPayloadTypes:"rtpVideoPayloadTypes"};class C0 extends Vn.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var s;super(),this.log=Se,this.ddExtID=0,this.latestOfferId=0,this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=kf(o=>E(this,void 0,void 0,function*(){this.emit(_a.NegotiationStarted);try{yield this.createAndSendOffer()}catch(l){if(o)o(l);else throw l}}),AN),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.log=qn((s=i.loggerName)!==null&&s!==void 0?s:Sn.PCTransport),this.loggerOptions=i,this.config=e,this._pc=this.createPC(),this.offerLock=new It}createPC(){const e=new RTCPeerConnection(this.config);return e.onicecandidate=i=>{var s;i.candidate&&((s=this.onIceCandidate)===null||s===void 0||s.call(this,i.candidate))},e.onicecandidateerror=i=>{var s;(s=this.onIceCandidateError)===null||s===void 0||s.call(this,i)},e.oniceconnectionstatechange=()=>{var i;(i=this.onIceConnectionStateChange)===null||i===void 0||i.call(this,e.iceConnectionState)},e.onsignalingstatechange=()=>{var i;(i=this.onSignalingStatechange)===null||i===void 0||i.call(this,e.signalingState)},e.onconnectionstatechange=()=>{var i;(i=this.onConnectionStateChange)===null||i===void 0||i.call(this,e.connectionState)},e.ondatachannel=i=>{var s;(s=this.onDataChannel)===null||s===void 0||s.call(this,i)},e.ontrack=i=>{var s;(s=this.onTrack)===null||s===void 0||s.call(this,i)},e}get logContext(){var e,i;return Object.assign({},(i=(e=this.loggerOptions).loggerContextCb)===null||i===void 0?void 0:i.call(e))}get isICEConnected(){return this._pc!==null&&(this.pc.iceConnectionState==="connected"||this.pc.iceConnectionState==="completed")}addIceCandidate(e){return E(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)})}setRemoteDescription(e,i){return E(this,void 0,void 0,function*(){var s;if(e.type==="answer"&&this.latestOfferId>0&&i>0&&i!==this.latestOfferId)return this.log.warn("ignoring answer for old offer",Object.assign(Object.assign({},this.logContext),{offerId:i,latestOfferId:this.latestOfferId})),!1;let o;if(e.type==="offer"){let{stereoMids:l,nackMids:d}=MN(e);this.remoteStereoMids=l,this.remoteNackMids=d}else if(e.type==="answer"){const l=Yi.parse((s=e.sdp)!==null&&s!==void 0?s:"");l.media.forEach(d=>{const u=xf(d.mid);d.type==="audio"&&this.trackBitrates.some(f=>{if(!f.transceiver||u!=f.transceiver.mid)return!1;let p=0;if(d.rtp.some(y=>y.codec.toUpperCase()===f.codec.toUpperCase()?(p=y.payload,!0):!1),p===0)return!0;let v=!1;for(const y of d.fmtp)if(y.payload===p){y.config=y.config.split(";").filter(S=>!S.includes("maxaveragebitrate")).join(";"),f.maxbr>0&&(y.config+=";maxaveragebitrate=".concat(f.maxbr*1e3)),v=!0;break}return v||f.maxbr>0&&d.fmtp.push({payload:p,config:"maxaveragebitrate=".concat(f.maxbr*1e3)}),!0})}),o=Yi.write(l)}return yield this.setMungedSDP(e,o,!0),this.pendingCandidates.forEach(l=>{this.pc.addIceCandidate(l)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate?(this.renegotiate=!1,yield this.createAndSendOffer()):e.type==="answer"&&(this.emit(_a.NegotiationComplete),e.sdp&&Yi.parse(e.sdp).media.forEach(d=>{d.type==="video"&&this.emit(_a.RTPVideoPayloadTypes,d.rtp)})),!0})}createAndSendOffer(e){return E(this,void 0,void 0,function*(){var i;const s=yield this.offerLock.lock();try{if(this.onOffer===void 0)return;if(e?.iceRestart&&(this.log.debug("restarting ICE",this.logContext),this.restartingIce=!0),this._pc&&this._pc.signalingState==="have-local-offer"){const u=this._pc.remoteDescription;if(e?.iceRestart&&u)yield this._pc.setRemoteDescription(u);else{this.renegotiate=!0,this.log.debug("requesting renegotiation",Object.assign({},this.logContext));return}}else if(!this._pc||this._pc.signalingState==="closed"){this.log.warn("could not createOffer with closed peer connection",this.logContext);return}this.log.debug("starting to negotiate",this.logContext);const o=this.latestOfferId+1;this.latestOfferId=o;const l=yield this.pc.createOffer(e);this.log.debug("original offer",Object.assign({sdp:l.sdp},this.logContext));const d=Yi.parse((i=l.sdp)!==null&&i!==void 0?i:"");if(d.media.forEach(u=>{x0(u),u.type==="audio"?k0(u,["all"],[]):u.type==="video"&&this.trackBitrates.some(f=>{if(!u.msid||!f.cid||!u.msid.includes(f.cid))return!1;let p=0;if(u.rtp.some(y=>y.codec.toUpperCase()===f.codec.toUpperCase()?(p=y.payload,!0):!1),p===0||(Nn(f.codec)&&!Aa()&&this.ensureVideoDDExtensionForSVC(u,d),!Nn(f.codec)))return!0;const v=Math.round(f.maxbr*NN);for(const y of u.fmtp)if(y.payload===p){y.config.includes("x-google-start-bitrate")||(y.config+=";x-google-start-bitrate=".concat(v));break}return!0})}),this.latestOfferId>o){this.log.warn("latestOfferId mismatch",Object.assign(Object.assign({},this.logContext),{latestOfferId:this.latestOfferId,offerId:o}));return}yield this.setMungedSDP(l,Yi.write(d)),this.onOffer(l,this.latestOfferId)}finally{s()}})}createAndSetAnswer(){return E(this,void 0,void 0,function*(){var e;const i=yield this.pc.createAnswer(),s=Yi.parse((e=i.sdp)!==null&&e!==void 0?e:"");return s.media.forEach(o=>{x0(o),o.type==="audio"&&k0(o,this.remoteStereoMids,this.remoteNackMids)}),yield this.setMungedSDP(i,Yi.write(s)),i})}createDataChannel(e,i){return this.pc.createDataChannel(e,i)}addTransceiver(e,i){return this.pc.addTransceiver(e,i)}addTransceiverOfKind(e,i){return this.pc.addTransceiver(e,i)}addTrack(e){if(!this._pc)throw new ut("PC closed, cannot add track");return this._pc.addTrack(e)}setTrackCodecBitrate(e){this.trackBitrates.push(e)}setConfiguration(e){var i;if(!this._pc)throw new ut("PC closed, cannot configure");return(i=this._pc)===null||i===void 0?void 0:i.setConfiguration(e)}canRemoveTrack(){var e;return!!(!((e=this._pc)===null||e===void 0)&&e.removeTrack)}removeTrack(e){var i;return(i=this._pc)===null||i===void 0?void 0:i.removeTrack(e)}getConnectionState(){var e,i;return(i=(e=this._pc)===null||e===void 0?void 0:e.connectionState)!==null&&i!==void 0?i:"closed"}getICEConnectionState(){var e,i;return(i=(e=this._pc)===null||e===void 0?void 0:e.iceConnectionState)!==null&&i!==void 0?i:"closed"}getSignallingState(){var e,i;return(i=(e=this._pc)===null||e===void 0?void 0:e.signalingState)!==null&&i!==void 0?i:"closed"}getTransceivers(){var e,i;return(i=(e=this._pc)===null||e===void 0?void 0:e.getTransceivers())!==null&&i!==void 0?i:[]}getSenders(){var e,i;return(i=(e=this._pc)===null||e===void 0?void 0:e.getSenders())!==null&&i!==void 0?i:[]}getLocalDescription(){var e;return(e=this._pc)===null||e===void 0?void 0:e.localDescription}getRemoteDescription(){var e;return(e=this.pc)===null||e===void 0?void 0:e.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){return E(this,void 0,void 0,function*(){var e;if(!this._pc)return;let i="";const s=new Map,o=new Map;if((yield this._pc.getStats()).forEach(u=>{switch(u.type){case"transport":i=u.selectedCandidatePairId;break;case"candidate-pair":i===""&&u.selected&&(i=u.id),s.set(u.id,u);break;case"remote-candidate":o.set(u.id,"".concat(u.address,":").concat(u.port));break}}),i==="")return;const d=(e=s.get(i))===null||e===void 0?void 0:e.remoteCandidateId;if(d!==void 0)return o.get(d)})}setMungedSDP(e,i,s){return E(this,void 0,void 0,function*(){if(i){const o=e.sdp;e.sdp=i;try{this.log.debug("setting munged ".concat(s?"remote":"local"," description"),this.logContext),s?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e);return}catch(l){this.log.warn("not able to set ".concat(e.type,", falling back to unmodified sdp"),Object.assign(Object.assign({},this.logContext),{error:l,sdp:i})),e.sdp=o}}try{s?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e)}catch(o){let l="unknown error";o instanceof Error?l=o.message:typeof o=="string"&&(l=o);const d={error:l,sdp:e.sdp};throw!s&&this.pc.remoteDescription&&(d.remoteSdp=this.pc.remoteDescription),this.log.error("unable to set ".concat(e.type),Object.assign(Object.assign({},this.logContext),{fields:d})),new Ea(l)}})}ensureVideoDDExtensionForSVC(e,i){var s,o;if(!((s=e.ext)===null||s===void 0?void 0:s.some(d=>d.uri===s0))){if(this.ddExtID===0){let d=0;i.media.forEach(u=>{var f;u.type==="video"&&((f=u.ext)===null||f===void 0||f.forEach(p=>{p.value>d&&(d=p.value)}))}),this.ddExtID=d+1}(o=e.ext)===null||o===void 0||o.push({value:this.ddExtID,uri:s0})}}}function k0(a,e,i){const s=xf(a.mid);let o=0;a.rtp.some(l=>l.codec==="opus"?(o=l.payload,!0):!1),o>0&&(a.rtcpFb||(a.rtcpFb=[]),i.includes(s)&&!a.rtcpFb.some(l=>l.payload===o&&l.type==="nack")&&a.rtcpFb.push({payload:o,type:"nack"}),(e.includes(s)||e.length===1&&e[0]==="all")&&a.fmtp.some(l=>l.payload===o?(l.config.includes("stereo=1")||(l.config+=";stereo=1"),!0):!1))}function MN(a){var e;const i=[],s=[],o=Yi.parse((e=a.sdp)!==null&&e!==void 0?e:"");let l=0;return o.media.forEach(d=>{var u;const f=xf(d.mid);d.type==="audio"&&(d.rtp.some(p=>p.codec==="opus"?(l=p.payload,!0):!1),!((u=d.rtcpFb)===null||u===void 0)&&u.some(p=>p.payload===l&&p.type==="nack")&&s.push(f),d.fmtp.some(p=>p.payload===l?(p.config.includes("sprop-stereo=1")&&i.push(f),!0):!1))}),{stereoMids:i,nackMids:s}}function x0(a){if(a.connection){const e=a.connection.ip.indexOf(":")>=0;(a.connection.version===4&&e||a.connection.version===6&&!e)&&(a.connection.ip="0.0.0.0",a.connection.version=4)}}function xf(a){return typeof a=="number"?a.toFixed(0):a}const Bh="vp8",DN={audioPreset:Ah.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:yf.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:Bh,backupCodec:!0,preConnectBuffer:!1},aT={deviceId:{ideal:"default"},autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0,voiceIsolation:!0},sT={deviceId:{ideal:"default"},resolution:Xr.h720.resolution},ON={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new uR,disconnectOnPageLeave:!0,webAudioMix:!1,singlePeerConnection:!0},Ef={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};var tt;(function(a){a[a.NEW=0]="NEW",a[a.CONNECTING=1]="CONNECTING",a[a.CONNECTED=2]="CONNECTED",a[a.FAILED=3]="FAILED",a[a.CLOSING=4]="CLOSING",a[a.CLOSED=5]="CLOSED"})(tt||(tt={}));class jN{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}get mode(){return this._mode}constructor(e,i,s){var o;this.peerConnectionTimeout=Ef.peerConnectionTimeout,this.log=Se,this.updateState=()=>{var l,d;const u=this.state,f=this.requiredTransports.map(p=>p.getConnectionState());f.every(p=>p==="connected")?this.state=tt.CONNECTED:f.some(p=>p==="failed")?this.state=tt.FAILED:f.some(p=>p==="connecting")?this.state=tt.CONNECTING:f.every(p=>p==="closed")?this.state=tt.CLOSED:f.some(p=>p==="closed")?this.state=tt.CLOSING:f.every(p=>p==="new")&&(this.state=tt.NEW),u!==this.state&&(this.log.debug("pc state change: from ".concat(tt[u]," to ").concat(tt[this.state]),this.logContext),(l=this.onStateChange)===null||l===void 0||l.call(this,this.state,this.publisher.getConnectionState(),(d=this.subscriber)===null||d===void 0?void 0:d.getConnectionState()))},this.log=qn((o=s.loggerName)!==null&&o!==void 0?o:Sn.PCManager),this.loggerOptions=s,this.isPublisherConnectionRequired=i!=="subscriber-primary",this.isSubscriberConnectionRequired=i==="subscriber-primary",this.publisher=new C0(e,s),this._mode=i,i!=="publisher-only"&&(this.subscriber=new C0(e,s),this.subscriber.onConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.subscriber.onIceCandidate=l=>{var d;(d=this.onIceCandidate)===null||d===void 0||d.call(this,l,Rn.SUBSCRIBER)},this.subscriber.onDataChannel=l=>{var d;(d=this.onDataChannel)===null||d===void 0||d.call(this,l)},this.subscriber.onTrack=l=>{var d;(d=this.onTrack)===null||d===void 0||d.call(this,l)}),this.publisher.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=l=>{var d;(d=this.onIceCandidate)===null||d===void 0||d.call(this,l,Rn.PUBLISHER)},this.publisher.onTrack=l=>{var d;(d=this.onTrack)===null||d===void 0||d.call(this,l)},this.publisher.onOffer=(l,d)=>{var u;(u=this.onPublisherOffer)===null||u===void 0||u.call(this,l,d)},this.state=tt.NEW,this.connectionLock=new It,this.remoteOfferLock=new It}get logContext(){var e,i;return Object.assign({},(i=(e=this.loggerOptions).loggerContextCb)===null||i===void 0?void 0:i.call(e))}requirePublisher(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isPublisherConnectionRequired=e,this.updateState()}createAndSendPublisherOffer(e){return this.publisher.createAndSendOffer(e)}setPublisherAnswer(e,i){return this.publisher.setRemoteDescription(e,i)}removeTrack(e){return this.publisher.removeTrack(e)}close(){return E(this,void 0,void 0,function*(){var e;if(this.publisher&&this.publisher.getSignallingState()!=="closed"){const i=this.publisher;for(const s of i.getSenders())try{i.canRemoveTrack()&&i.removeTrack(s)}catch(o){this.log.warn("could not removeTrack",Object.assign(Object.assign({},this.logContext),{error:o}))}}yield Promise.all([this.publisher.close(),(e=this.subscriber)===null||e===void 0?void 0:e.close()]),this.updateState()})}triggerIceRestart(){return E(this,void 0,void 0,function*(){this.subscriber&&(this.subscriber.restartingIce=!0),this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))})}addIceCandidate(e,i){return E(this,void 0,void 0,function*(){var s;i===Rn.PUBLISHER?yield this.publisher.addIceCandidate(e):yield(s=this.subscriber)===null||s===void 0?void 0:s.addIceCandidate(e)})}createSubscriberAnswerFromOffer(e,i){return E(this,void 0,void 0,function*(){var s,o,l;this.log.debug("received server offer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,signalingState:(s=this.subscriber)===null||s===void 0?void 0:s.getSignallingState().toString()}));const d=yield this.remoteOfferLock.lock();try{return(yield(o=this.subscriber)===null||o===void 0?void 0:o.setRemoteDescription(e,i))?yield(l=this.subscriber)===null||l===void 0?void 0:l.createAndSetAnswer():void 0}finally{d()}})}updateConfiguration(e,i){var s;this.publisher.setConfiguration(e),(s=this.subscriber)===null||s===void 0||s.setConfiguration(e),i&&this.triggerIceRestart()}ensurePCTransportConnection(e,i){return E(this,void 0,void 0,function*(){var s;const o=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&this.publisher.getConnectionState()!=="connected"&&this.publisher.getConnectionState()!=="connecting"&&(this.log.debug("negotiation required, start negotiating",this.logContext),this.publisher.negotiate()),yield Promise.all((s=this.requiredTransports)===null||s===void 0?void 0:s.map(l=>this.ensureTransportConnected(l,e,i)))}finally{o()}})}negotiate(e){return E(this,void 0,void 0,function*(){return new Mt((i,s)=>E(this,void 0,void 0,function*(){let o=setTimeout(()=>{s(new Ea("negotiation timed out"))},this.peerConnectionTimeout);const l=()=>{clearTimeout(o),this.publisher.off(_a.NegotiationStarted,u),e.signal.removeEventListener("abort",d)},d=()=>{l(),s(new Ea("negotiation aborted"))},u=()=>{e.signal.aborted||(clearTimeout(o),o=setTimeout(()=>{l(),s(new Ea("negotiation timed out"))},this.peerConnectionTimeout))};e.signal.addEventListener("abort",d),this.publisher.on(_a.NegotiationStarted,u),this.publisher.once(_a.NegotiationComplete,()=>{l(),i()}),yield this.publisher.negotiate(f=>{l(),f instanceof Error?s(f):s(new Error(String(f)))})}))})}addPublisherTransceiver(e,i){return this.publisher.addTransceiver(e,i)}addPublisherTransceiverOfKind(e,i){return this.publisher.addTransceiverOfKind(e,i)}getMidForReceiver(e){const s=(this.subscriber?this.subscriber.getTransceivers():this.publisher.getTransceivers()).find(o=>o.receiver===e);return s?.mid}addPublisherTrack(e){return this.publisher.addTrack(e)}createPublisherDataChannel(e,i){return this.publisher.createDataChannel(e,i)}getConnectedAddress(e){return e===Rn.PUBLISHER?this.publisher.getConnectedAddress():e===Rn.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){const e=[];return this.isPublisherConnectionRequired&&e.push(this.publisher),this.isSubscriberConnectionRequired&&this.subscriber&&e.push(this.subscriber),e}ensureTransportConnected(e,i){return E(this,arguments,void 0,function(s,o){var l=this;let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.peerConnectionTimeout;return(function*(){if(s.getConnectionState()!=="connected")return new Promise((f,p)=>E(l,void 0,void 0,function*(){const v=()=>{this.log.warn("abort transport connection",this.logContext),Rt.clearTimeout(y),p(me.cancelled("room connection has been cancelled"))};o?.signal.aborted&&v(),o?.signal.addEventListener("abort",v);const y=Rt.setTimeout(()=>{o?.signal.removeEventListener("abort",v),p(me.internal("could not establish pc connection"))},d);for(;this.state!==tt.CONNECTED;)if(yield Nt(50),o?.signal.aborted){p(me.cancelled("room connection has been cancelled"));return}Rt.clearTimeout(y),o?.signal.removeEventListener("abort",v),f()}))})()})}}const rT=5e3,PN=3e4;class De{static fetchRegionSettings(e,i,s){return E(this,void 0,void 0,function*(){const o=yield De.fetchLock.lock();try{const l=yield fetch("".concat(IN(e),"/regions"),{headers:{authorization:"Bearer ".concat(i)},signal:s});if(l.ok){const d=aN(l.headers),u=d?d*1e3:rT;return{regionSettings:yield l.json(),updatedAtInMs:Date.now(),maxAgeInMs:u}}else throw l.status===401?me.notAllowed("Could not fetch region settings: ".concat(l.statusText),l.status):me.internal("Could not fetch region settings: ".concat(l.statusText))}catch(l){throw l instanceof me?l:s?.aborted?me.cancelled("Region fetching was aborted"):me.serverUnreachable("Could not fetch region settings, ".concat(l instanceof Error?"".concat(l.name,": ").concat(l.message):l))}finally{o()}})}static scheduleRefetch(e,i,s){return E(this,void 0,void 0,function*(){const o=De.settingsTimeouts.get(e.hostname);clearTimeout(o),De.settingsTimeouts.set(e.hostname,setTimeout(()=>E(this,void 0,void 0,function*(){try{const l=yield De.fetchRegionSettings(e,i);De.updateCachedRegionSettings(e,i,l)}catch(l){if(l instanceof me&&l.reason===Qe.NotAllowed){Se.debug("token is not valid, cancelling auto region refresh");return}Se.debug("auto refetching of region settings failed",{error:l}),De.scheduleRefetch(e,i,s)}}),s))})}static updateCachedRegionSettings(e,i,s){De.cache.set(e.hostname,s),De.scheduleRefetch(e,i,s.maxAgeInMs)}static stopRefetch(e){const i=De.settingsTimeouts.get(e);i&&(clearTimeout(i),De.settingsTimeouts.delete(e))}static scheduleCleanup(e){let i=De.connectionTrackers.get(e);i&&(i.cleanupTimeout&&clearTimeout(i.cleanupTimeout),i.cleanupTimeout=setTimeout(()=>{const s=De.connectionTrackers.get(e);s&&s.connectionCount===0&&(Se.debug("stopping region refetch after disconnect delay",{hostname:e}),De.stopRefetch(e)),s&&(s.cleanupTimeout=void 0)},PN))}static cancelCleanup(e){const i=De.connectionTrackers.get(e);i?.cleanupTimeout&&(clearTimeout(i.cleanupTimeout),i.cleanupTimeout=void 0)}notifyConnected(){const e=this.serverUrl.hostname;let i=De.connectionTrackers.get(e);i||(i={connectionCount:0},De.connectionTrackers.set(e,i)),i.connectionCount++,De.cancelCleanup(e)}notifyDisconnected(){const e=this.serverUrl.hostname,i=De.connectionTrackers.get(e);i&&(i.connectionCount=Math.max(0,i.connectionCount-1),i.connectionCount===0&&De.scheduleCleanup(e))}constructor(e,i){this.attemptedRegions=[],this.serverUrl=new URL(e),this.token=i}updateToken(e){this.token=e}isCloud(){return Ds(this.serverUrl)}getServerUrl(){return this.serverUrl}fetchRegionSettings(e){return E(this,void 0,void 0,function*(){return De.fetchRegionSettings(this.serverUrl,this.token,e)})}getNextBestRegionUrl(e){return E(this,void 0,void 0,function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");let i=De.cache.get(this.serverUrl.hostname);(!i||Date.now()-i.updatedAtInMs>i.maxAgeInMs)&&(i=yield this.fetchRegionSettings(e),De.updateCachedRegionSettings(this.serverUrl,this.token,i));const s=i.regionSettings.regions.filter(o=>!this.attemptedRegions.find(l=>l.url===o.url));if(s.length>0){const o=s[0];return this.attemptedRegions.push(o),Se.debug("next region: ".concat(o.region)),o.url}else return null})}resetAttempts(){this.attemptedRegions=[]}setServerReportedRegions(e){De.updateCachedRegionSettings(this.serverUrl,this.token,e)}}De.cache=new Map;De.settingsTimeouts=new Map;De.connectionTrackers=new Map;De.fetchLock=new It;function IN(a){return"".concat(a.protocol.replace("ws","http"),"//").concat(a.host,"/settings")}class rt extends Error{constructor(e,i,s){super(i),this.code=e,this.message=E0(i,rt.MAX_MESSAGE_BYTES),this.data=s?E0(s,rt.MAX_DATA_BYTES):void 0}static fromProto(e){return new rt(e.code,e.message,e.data)}toProto(){return new Jb({code:this.code,message:this.message,data:this.data})}static builtIn(e,i){return new rt(rt.ErrorCode[e],rt.ErrorMessage[e],i)}}rt.MAX_MESSAGE_BYTES=256;rt.MAX_DATA_BYTES=15360;rt.ErrorCode={APPLICATION_ERROR:1500,CONNECTION_TIMEOUT:1501,RESPONSE_TIMEOUT:1502,RECIPIENT_DISCONNECTED:1503,RESPONSE_PAYLOAD_TOO_LARGE:1504,SEND_FAILED:1505,UNSUPPORTED_METHOD:1400,RECIPIENT_NOT_FOUND:1401,REQUEST_PAYLOAD_TOO_LARGE:1402,UNSUPPORTED_SERVER:1403,UNSUPPORTED_VERSION:1404};rt.ErrorMessage={APPLICATION_ERROR:"Application error in method handler",CONNECTION_TIMEOUT:"Connection timeout",RESPONSE_TIMEOUT:"Response timeout",RECIPIENT_DISCONNECTED:"Recipient disconnected",RESPONSE_PAYLOAD_TOO_LARGE:"Response payload too large",SEND_FAILED:"Failed to send",UNSUPPORTED_METHOD:"Method not supported at destination",RECIPIENT_NOT_FOUND:"Recipient not found",REQUEST_PAYLOAD_TOO_LARGE:"Request payload too large",UNSUPPORTED_SERVER:"RPC not supported by server",UNSUPPORTED_VERSION:"Unsupported RPC version"};const oT=15360;function wf(a){return new TextEncoder().encode(a).length}function E0(a,e){if(wf(a)<=e)return a;let i=0,s=a.length;const o=new TextEncoder;for(;i<s;){const l=Math.floor((i+s+1)/2);o.encode(a.slice(0,l)).length<=e?i=l:s=l-1}return a.slice(0,i)}const _f=2e3;function yc(a,e){if(!e)return 0;let i,s;return"bytesReceived"in a?(i=a.bytesReceived,s=e.bytesReceived):"bytesSent"in a&&(i=a.bytesSent,s=e.bytesSent),i===void 0||s===void 0||a.timestamp===void 0||e.timestamp===void 0?0:(i-s)*8*1e3/(a.timestamp-e.timestamp)}const Rf=typeof MediaRecorder<"u";class LN{constructor(){throw new Error("MediaRecorder is not available in this environment")}}const UN=Rf?MediaRecorder:LN;class BN extends UN{constructor(e,i){if(!Rf)throw new Error("MediaRecorder is not available in this environment");super(new MediaStream([e.mediaStreamTrack]),i);let s,o;const l=()=>o===void 0,d=()=>{this.removeEventListener("dataavailable",s),this.removeEventListener("stop",d),this.removeEventListener("error",u),o?.close(),o=void 0},u=f=>{o?.error(f),this.removeEventListener("dataavailable",s),this.removeEventListener("stop",d),this.removeEventListener("error",u),o=void 0};this.byteStream=new ReadableStream({start:f=>{o=f,s=p=>E(this,void 0,void 0,function*(){let v;if(p.data.arrayBuffer){const y=yield p.data.arrayBuffer();v=new Uint8Array(y)}else if(p.data.byteArray)v=p.data.byteArray;else throw new Error("no data available!");l()||f.enqueue(v)}),this.addEventListener("dataavailable",s)},cancel:()=>{d()}}),this.addEventListener("stop",d),this.addEventListener("error",u)}}function qN(){return Rf}const FN=1e3,zN=1e4;class lT extends Q{get sender(){return this._sender}set sender(e){this._sender=e}get constraints(){return this._constraints}get hasPreConnectBuffer(){return!!this.localTrackRecorder}constructor(e,i,s){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,l=arguments.length>4?arguments[4]:void 0;super(e,i,l),this.manuallyStopped=!1,this.pendingDeviceChange=!1,this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch(()=>this.log.debug("track mute bounce got cancelled by an unmute event",this.logContext)),this.debouncedTrackMuteHandler=kf(()=>E(this,void 0,void 0,function*(){yield this.pauseUpstream()}),5e3),this.handleTrackUnmuteEvent=()=>E(this,void 0,void 0,function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()}),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit($.Ended,this)},this.reacquireTrack=!1,this.providedByUser=o,this.muteLock=new It,this.pauseUpstreamLock=new It,this.trackChangeLock=new It,this.trackChangeLock.lock().then(d=>E(this,void 0,void 0,function*(){try{yield this.setMediaStreamTrack(e,!0)}finally{d()}})),this._constraints=e.getConstraints(),s&&(this._constraints=s)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==Q.Kind.Video)return;const{width:e,height:i}=this._mediaStreamTrack.getSettings();if(e&&i)return{width:e,height:i}}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var e,i;return(i=(e=this.processor)===null||e===void 0?void 0:e.processedTrack)!==null&&i!==void 0?i:this._mediaStreamTrack}get isLocal(){return!0}getSourceTrackSettings(){return this._mediaStreamTrack.getSettings()}setMediaStreamTrack(e,i){return E(this,void 0,void 0,function*(){var s;if(e===this._mediaStreamTrack&&!i)return;this._mediaStreamTrack&&(this.attachedElements.forEach(l=>{_s(this._mediaStreamTrack,l)}),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent)),this.mediaStream=new MediaStream([e]),e&&(e.addEventListener("ended",this.handleEnded),e.addEventListener("mute",this.handleTrackMuteEvent),e.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=e.getConstraints());let o;if(this.processor&&e){if(this.log.debug("restarting processor",this.logContext),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");this.processorElement&&(Cs(e,this.processorElement),this.processorElement.muted=!0),yield this.processor.restart({track:e,kind:this.kind,element:this.processorElement}),o=this.processor.processedTrack}this.sender&&((s=this.sender.transport)===null||s===void 0?void 0:s.state)!=="closed"&&(yield this.sender.replaceTrack(o??e)),!this.providedByUser&&this._mediaStreamTrack!==e&&this._mediaStreamTrack.stop(),this._mediaStreamTrack=e,e&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach(l=>{Cs(o??e,l)}))})}waitForDimensions(){return E(this,arguments,void 0,function(){var e=this;let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:FN;return(function*(){var s;if(e.kind===Q.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");((s=Yt())===null||s===void 0?void 0:s.os)==="iOS"&&(yield Nt(10));const o=Date.now();for(;Date.now()-o<i;){const l=e.dimensions;if(l)return l;yield Nt(50)}throw new pi("unable to get track dimensions after timeout")})()})}setDeviceId(e){return E(this,void 0,void 0,function*(){return this._constraints.deviceId===e&&this._mediaStreamTrack.getSettings().deviceId===wa(e)?!0:(this._constraints.deviceId=e,this.isMuted?(this.pendingDeviceChange=!0,!0):(yield this.restartTrack(),wa(e)===this._mediaStreamTrack.getSettings().deviceId))})}getDeviceId(){return E(this,arguments,void 0,function(){var e=this;let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return(function*(){if(e.source===Q.Source.ScreenShare)return;const{deviceId:s,groupId:o}=e._mediaStreamTrack.getSettings(),l=e.kind===Q.Kind.Audio?"audioinput":"videoinput";return i?Ct.getInstance().normalizeDeviceId(l,s,o):s})()})}mute(){return E(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return E(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}replaceTrack(e,i){return E(this,void 0,void 0,function*(){const s=yield this.trackChangeLock.lock();try{if(!this.sender)throw new pi("unable to replace an unpublished track");let o,l;return typeof i=="boolean"?o=i:i!==void 0&&(o=i.userProvidedTrack,l=i.stopProcessor),this.providedByUser=o??!0,this.log.debug("replace MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(e),l&&this.processor&&(yield this.internalStopProcessor()),this}finally{s()}})}restart(e){return E(this,void 0,void 0,function*(){this.manuallyStopped=!1;const i=yield this.trackChangeLock.lock();try{e||(e=this._constraints);const{deviceId:s,facingMode:o}=e,l=dR(e,["deviceId","facingMode"]);this.log.debug("restarting track with constraints",Object.assign(Object.assign({},this.logContext),{constraints:e}));const d={audio:!1,video:!1};this.kind===Q.Kind.Video?d.video=s||o?{deviceId:s,facingMode:o}:!0:d.audio=s?Object.assign({deviceId:s},l):!0,this.attachedElements.forEach(p=>{_s(this.mediaStreamTrack,p)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const f=(yield navigator.mediaDevices.getUserMedia(d)).getTracks()[0];return this.kind===Q.Kind.Video&&(yield f.applyConstraints(l)),f.addEventListener("ended",this.handleEnded),this.log.debug("re-acquired MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(f),this._constraints=e,this.pendingDeviceChange=!1,this.emit($.Restarted,this),this.manuallyStopped&&(this.log.warn("track was stopped during a restart, stopping restarted track",this.logContext),this.stop()),this}finally{i()}})}setTrackMuted(e){this.log.debug("setting ".concat(this.kind," track ").concat(e?"muted":"unmuted"),this.logContext),!(this.isMuted===e&&this._mediaStreamTrack.enabled!==e)&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?$.Muted:$.Unmuted,this))}get needsReAcquisition(){return this._mediaStreamTrack.readyState!=="live"||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return E(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),eT()&&(this.log.debug("visibility changed, is in Background: ".concat(this.isInBackground),this.logContext),!this.isInBackground&&this.needsReAcquisition&&!this.isUserProvided&&!this.isMuted&&(this.log.debug("track needs to be reacquired, restarting ".concat(this.source),this.logContext),yield this.restart(),this.reacquireTrack=!1))})}stop(){var e;this.manuallyStopped=!0,super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),(e=this.processor)===null||e===void 0||e.destroy(),this.processor=void 0}pauseUpstream(){return E(this,void 0,void 0,function*(){var e;const i=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!0)return;if(!this.sender){this.log.warn("unable to pause upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!0,this.emit($.UpstreamPaused,this);const s=Yt();if(s?.name==="Safari"&&zn(s.version,"12.0")<0)throw new vf("pauseUpstream is not supported on Safari < 12.");((e=this.sender.transport)===null||e===void 0?void 0:e.state)!=="closed"&&(yield this.sender.replaceTrack(null))}finally{i()}})}resumeUpstream(){return E(this,void 0,void 0,function*(){var e;const i=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!1)return;if(!this.sender){this.log.warn("unable to resume upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!1,this.emit($.UpstreamResumed,this),((e=this.sender.transport)===null||e===void 0?void 0:e.state)!=="closed"&&(yield this.sender.replaceTrack(this.mediaStreamTrack))}finally{i()}})}getRTCStatsReport(){return E(this,void 0,void 0,function*(){var e;return!((e=this.sender)===null||e===void 0)&&e.getStats?yield this.sender.getStats():void 0})}setProcessor(e){return E(this,arguments,void 0,function(i){var s=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return(function*(){var l;const d=yield s.trackChangeLock.lock();try{s.log.debug("setting up processor",s.logContext);const u=document.createElement(s.kind),f={kind:s.kind,track:s._mediaStreamTrack,element:u,audioContext:s.audioContext};if(yield i.init(f),s.log.debug("processor initialized",s.logContext),s.processor&&(yield s.internalStopProcessor()),s.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");if(Cs(s._mediaStreamTrack,u),u.muted=!0,u.play().catch(p=>{p instanceof DOMException&&p.name==="AbortError"?(s.log.warn("failed to play processor element, retrying",Object.assign(Object.assign({},s.logContext),{error:p})),setTimeout(()=>{u.play().catch(v=>{s.log.error("failed to play processor element",Object.assign(Object.assign({},s.logContext),{err:v}))})},100)):s.log.error("failed to play processor element",Object.assign(Object.assign({},s.logContext),{error:p}))}),s.processor=i,s.processorElement=u,s.processor.processedTrack){for(const p of s.attachedElements)p!==s.processorElement&&o&&(_s(s._mediaStreamTrack,p),Cs(s.processor.processedTrack,p));yield(l=s.sender)===null||l===void 0?void 0:l.replaceTrack(s.processor.processedTrack)}s.emit($.TrackProcessorUpdate,s.processor)}finally{d()}})()})}getProcessor(){return this.processor}stopProcessor(){return E(this,arguments,void 0,function(){var e=this;let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return(function*(){const s=yield e.trackChangeLock.lock();try{yield e.internalStopProcessor(i)}finally{s()}})()})}internalStopProcessor(){return E(this,arguments,void 0,function(){var e=this;let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return(function*(){var s,o;e.processor&&(e.log.debug("stopping processor",e.logContext),(s=e.processor.processedTrack)===null||s===void 0||s.stop(),yield e.processor.destroy(),e.processor=void 0,i||((o=e.processorElement)===null||o===void 0||o.remove(),e.processorElement=void 0),yield e._mediaStreamTrack.applyConstraints(e._constraints),yield e.setMediaStreamTrack(e._mediaStreamTrack,!0),e.emit($.TrackProcessorUpdate))})()})}startPreConnectBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100;if(!qN()){this.log.warn("MediaRecorder is not available, cannot start preconnect buffer",this.logContext);return}if(this.localTrackRecorder){this.log.warn("preconnect buffer already started");return}else{let i="audio/webm;codecs=opus";MediaRecorder.isTypeSupported(i)||(i="video/mp4"),this.localTrackRecorder=new BN(this,{mimeType:i})}this.localTrackRecorder.start(e),this.autoStopPreConnectBuffer=setTimeout(()=>{this.log.warn("preconnect buffer timed out, stopping recording automatically",this.logContext),this.stopPreConnectBuffer()},zN)}stopPreConnectBuffer(){clearTimeout(this.autoStopPreConnectBuffer),this.localTrackRecorder&&(this.localTrackRecorder.stop(),this.localTrackRecorder=void 0)}getPreConnectBuffer(){var e;return(e=this.localTrackRecorder)===null||e===void 0?void 0:e.byteStream}getPreConnectBufferMimeType(){var e;return(e=this.localTrackRecorder)===null||e===void 0?void 0:e.mimeType}}class nc extends lT{get enhancedNoiseCancellation(){return this.isKrispNoiseFilterEnabled}constructor(e,i){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=arguments.length>3?arguments[3]:void 0,l=arguments.length>4?arguments[4]:void 0;super(e,Q.Kind.Audio,i,s,l),this.stopOnMute=!1,this.isKrispNoiseFilterEnabled=!1,this.monitorSender=()=>E(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let d;try{d=yield this.getSenderStats()}catch(u){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:u}));return}d&&this.prevStats&&(this._currentBitrate=yc(d,this.prevStats)),this.prevStats=d}),this.handleKrispNoiseFilterEnable=()=>{this.isKrispNoiseFilterEnabled=!0,this.log.debug("Krisp noise filter enabled",this.logContext),this.emit($.AudioTrackFeatureUpdate,this,Tt.TF_ENHANCED_NOISE_CANCELLATION,!0)},this.handleKrispNoiseFilterDisable=()=>{this.isKrispNoiseFilterEnabled=!1,this.log.debug("Krisp noise filter disabled",this.logContext),this.emit($.AudioTrackFeatureUpdate,this,Tt.TF_ENHANCED_NOISE_CANCELLATION,!1)},this.audioContext=o,this.checkForSilence()}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return E(this,void 0,void 0,function*(){const i=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===Q.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(this.log.debug("stopping mic track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{i()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return E(this,void 0,void 0,function*(){const i=yield this.muteLock.lock();try{return this.isMuted?(this.source===Q.Source.Microphone&&(this.stopOnMute||this._mediaStreamTrack.readyState==="ended"||this.pendingDeviceChange)&&!this.isUserProvided&&(this.log.debug("reacquiring mic track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this):(this.log.debug("Track already unmuted",this.logContext),this)}finally{i()}})}restartTrack(e){return E(this,void 0,void 0,function*(){let i;if(e){const s=bf({audio:e});typeof s.audio!="boolean"&&(i=s.audio)}yield this.restart(i)})}restart(e){const i=Object.create(null,{restart:{get:()=>super.restart}});return E(this,void 0,void 0,function*(){const s=yield i.restart.call(this,e);return this.checkForSilence(),s})}startMonitor(){Kt()&&(this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},_f)))}setProcessor(e){return E(this,void 0,void 0,function*(){var i;const s=yield this.trackChangeLock.lock();try{if(!Fn()&&!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");this.processor&&(yield this.internalStopProcessor());const o={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};this.log.debug("setting up audio processor ".concat(e.name),this.logContext),yield e.init(o),this.processor=e,this.processor.processedTrack&&(yield(i=this.sender)===null||i===void 0?void 0:i.replaceTrack(this.processor.processedTrack),this.processor.processedTrack.addEventListener("enable-lk-krisp-noise-filter",this.handleKrispNoiseFilterEnable),this.processor.processedTrack.addEventListener("disable-lk-krisp-noise-filter",this.handleKrispNoiseFilterDisable)),this.emit($.TrackProcessorUpdate,this.processor)}finally{s()}})}setAudioContext(e){this.audioContext=e}getSenderStats(){return E(this,void 0,void 0,function*(){var e;if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return;const i=yield this.sender.getStats();let s;return i.forEach(o=>{o.type==="outbound-rtp"&&(s={type:"audio",streamId:o.id,packetsSent:o.packetsSent,packetsLost:o.packetsLost,bytesSent:o.bytesSent,timestamp:o.timestamp,roundTripTime:o.roundTripTime,jitter:o.jitter})}),s})}checkForSilence(){return E(this,void 0,void 0,function*(){const e=yield XS(this);return e&&(this.isMuted||this.log.debug("silence detected on local audio track",this.logContext),this.emit($.AudioSilenceDetected)),e})}}function HN(a,e,i){switch(a.kind){case"audio":return new nc(a,e,!1,void 0,i);case"video":return new ic(a,e,!1,i);default:throw new pi("unsupported track type: ".concat(a.kind))}}const VN=Object.values(Xr),GN=Object.values(Mh),KN=Object.values(yf),YN=[Xr.h180,Xr.h360],JN=[Mh.h180,Mh.h360],QN=a=>[{scaleResolutionDownBy:2,fps:a.encoding.maxFramerate}].map(i=>{var s,o;return new Ke(Math.floor(a.width/i.scaleResolutionDownBy),Math.floor(a.height/i.scaleResolutionDownBy),Math.max(15e4,Math.floor(a.encoding.maxBitrate/(Math.pow(i.scaleResolutionDownBy,2)*(((s=a.encoding.maxFramerate)!==null&&s!==void 0?s:30)/((o=i.fps)!==null&&o!==void 0?o:30))))),i.fps,a.encoding.priority)}),qh=["q","h","f"];function Fh(a,e,i,s){var o,l;let d=s?.videoEncoding;a&&(d=s?.screenShareEncoding);const u=s?.simulcast,f=s?.scalabilityMode,p=s?.videoCodec;if(!d&&!u&&!f||!e||!i)return[{}];d||(d=XN(a,e,i,p),Se.debug("using video encoding",d));const v=d.maxFramerate,y=new Ke(e,i,d.maxBitrate,d.maxFramerate,d.priority);if(f&&Nn(p)){const _=new cT(f),x=[];if(_.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(f));const k=Yt();if(Zr()||Fn()||k?.name==="Chrome"&&zn(k?.version,"113")<0){const R=_.suffix=="h"?2:3,O=KR(k);for(let L=0;L<_.spatial;L+=1)x.push({rid:qh[2-L],maxBitrate:d.maxBitrate/Math.pow(R,L),maxFramerate:y.encoding.maxFramerate,scaleResolutionDownBy:O?Math.pow(2,L):void 0});x[0].scalabilityMode=f}else x.push({maxBitrate:d.maxBitrate,maxFramerate:y.encoding.maxFramerate,scalabilityMode:f});return y.encoding.priority&&(x[0].priority=y.encoding.priority,x[0].networkPriority=y.encoding.priority),Se.debug("using svc encoding",{encodings:x}),x}if(!u)return[d];let S=[];a?S=(o=_0(s?.screenShareSimulcastLayers))!==null&&o!==void 0?o:w0(a,y):S=(l=_0(s?.videoSimulcastLayers))!==null&&l!==void 0?l:w0(a,y);let C;if(S.length>0){const _=S[0];S.length>1&&([,C]=S);const x=Math.max(e,i);if(x>=960&&C)return uh(e,i,[_,C,y],v);if(x>=480)return uh(e,i,[_,y],v)}return uh(e,i,[y])}function WN(a,e,i){var s,o,l,d;if(!i.backupCodec||i.backupCodec===!0||i.backupCodec.codec===i.videoCodec)return;e!==i.backupCodec.codec&&Se.warn("requested a different codec than specified as backup",{serverRequested:e,backup:i.backupCodec.codec}),i.videoCodec=e,i.videoEncoding=i.backupCodec.encoding;const u=a.mediaStreamTrack.getSettings(),f=(s=u.width)!==null&&s!==void 0?s:(o=a.dimensions)===null||o===void 0?void 0:o.width,p=(l=u.height)!==null&&l!==void 0?l:(d=a.dimensions)===null||d===void 0?void 0:d.height;return a.source===Q.Source.ScreenShare&&i.simulcast&&(i.simulcast=!1),Fh(a.source===Q.Source.ScreenShare,f,p,i)}function XN(a,e,i,s){const o=ZN(a,e,i);let{encoding:l}=o[0];const d=Math.max(e,i);for(let u=0;u<o.length;u+=1){const f=o[u];if(l=f.encoding,f.width>=d)break}if(s)switch(s){case"av1":case"h265":l=Object.assign({},l),l.maxBitrate=l.maxBitrate*.7;break;case"vp9":l=Object.assign({},l),l.maxBitrate=l.maxBitrate*.85;break}return l}function ZN(a,e,i){if(a)return KN;const s=e>i?e/i:i/e;return Math.abs(s-16/9)<Math.abs(s-4/3)?VN:GN}function w0(a,e){if(a)return QN(e);const{width:i,height:s}=e,o=i>s?i/s:s/i;return Math.abs(o-16/9)<Math.abs(o-4/3)?YN:JN}function uh(a,e,i,s){const o=[];if(i.forEach((l,d)=>{if(d>=qh.length)return;const u=Math.min(a,e),p={rid:qh[d],scaleResolutionDownBy:Math.max(1,u/Math.min(l.width,l.height)),maxBitrate:l.encoding.maxBitrate},v=s&&l.encoding.maxFramerate?Math.min(s,l.encoding.maxFramerate):l.encoding.maxFramerate;v&&(p.maxFramerate=v);const y=Na()||d===0;l.encoding.priority&&y&&(p.priority=l.encoding.priority,p.networkPriority=l.encoding.priority),o.push(p)}),Fn()&&nT()==="ios"){let l;o.forEach(u=>{l?u.maxFramerate&&u.maxFramerate>l&&(l=u.maxFramerate):l=u.maxFramerate});let d=!0;o.forEach(u=>{var f;u.maxFramerate!=l&&(d&&(d=!1,Se.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),Se.info('Setting framerate of encoding "'.concat((f=u.rid)!==null&&f!==void 0?f:"",'" to ').concat(l)),u.maxFramerate=l)})}return o}function _0(a){if(a)return a.sort((e,i)=>{const{encoding:s}=e,{encoding:o}=i;return s.maxBitrate>o.maxBitrate?1:s.maxBitrate<o.maxBitrate?-1:s.maxBitrate===o.maxBitrate&&s.maxFramerate&&o.maxFramerate?s.maxFramerate>o.maxFramerate?1:-1:0})}class cT{constructor(e){const i=e.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!i)throw new Error("invalid scalability mode");if(this.spatial=parseInt(i[1]),this.temporal=parseInt(i[2]),i.length>3)switch(i[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=i[3]}}toString(){var e;return"L".concat(this.spatial,"T").concat(this.temporal).concat((e=this.suffix)!==null&&e!==void 0?e:"")}}function $N(a){return a.source===Q.Source.ScreenShare||a.constraints.height&&wa(a.constraints.height)>=1080?"maintain-resolution":"balanced"}const eA=5e3;class ic extends lT{get sender(){return this._sender}set sender(e){this._sender=e,this.degradationPreference&&this.setDegradationPreference(this.degradationPreference)}constructor(e,i){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=arguments.length>3?arguments[3]:void 0;super(e,Q.Kind.Video,i,s,o),this.simulcastCodecs=new Map,this.degradationPreference="balanced",this.isCpuConstrained=!1,this.optimizeForPerformance=!1,this.monitorSender=()=>E(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let l;try{l=yield this.getSenderStats()}catch(f){this.log.error("could not get video sender stats",Object.assign(Object.assign({},this.logContext),{error:f}));return}const d=new Map(l.map(f=>[f.rid,f])),u=l.some(f=>f.qualityLimitationReason==="cpu");if(u!==this.isCpuConstrained&&(this.isCpuConstrained=u,this.isCpuConstrained&&this.emit($.CpuConstrained)),this.prevStats){let f=0;d.forEach((p,v)=>{var y;const S=(y=this.prevStats)===null||y===void 0?void 0:y.get(v);f+=yc(p,S)}),this._currentBitrate=f}this.prevStats=d}),this.senderLock=new It}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e){var i;if(this.signalClient=e,!Kt())return;const s=(i=this.sender)===null||i===void 0?void 0:i.getParameters();s&&(this.encodings=s.encodings),!this.monitorInterval&&(this.monitorInterval=setInterval(()=>{this.monitorSender()},_f))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(e=>{e.mediaStreamTrack.stop()}),super.stop()}pauseUpstream(){const e=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});return E(this,void 0,void 0,function*(){var i,s,o,l,d;yield e.pauseUpstream.call(this);try{for(var u=!0,f=mi(this.simulcastCodecs.values()),p;p=yield f.next(),i=p.done,!i;u=!0)l=p.value,u=!1,yield(d=l.sender)===null||d===void 0?void 0:d.replaceTrack(null)}catch(v){s={error:v}}finally{try{!u&&!i&&(o=f.return)&&(yield o.call(f))}finally{if(s)throw s.error}}})}resumeUpstream(){const e=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});return E(this,void 0,void 0,function*(){var i,s,o,l,d;yield e.resumeUpstream.call(this);try{for(var u=!0,f=mi(this.simulcastCodecs.values()),p;p=yield f.next(),i=p.done,!i;u=!0){l=p.value,u=!1;const v=l;yield(d=v.sender)===null||d===void 0?void 0:d.replaceTrack(v.mediaStreamTrack)}}catch(v){s={error:v}}finally{try{!u&&!i&&(o=f.return)&&(yield o.call(f))}finally{if(s)throw s.error}}})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return E(this,void 0,void 0,function*(){const i=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===Q.Source.Camera&&!this.isUserProvided&&(this.log.debug("stopping camera track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{i()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return E(this,void 0,void 0,function*(){const i=yield this.muteLock.lock();try{return this.isMuted?(this.source===Q.Source.Camera&&!this.isUserProvided&&(this.log.debug("reacquiring camera track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this):(this.log.debug("Track already unmuted",this.logContext),this)}finally{i()}})}setTrackMuted(e){super.setTrackMuted(e);for(const i of this.simulcastCodecs.values())i.mediaStreamTrack.enabled=!e}getSenderStats(){return E(this,void 0,void 0,function*(){var e;if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return[];const i=[],s=yield this.sender.getStats();return s.forEach(o=>{var l;if(o.type==="outbound-rtp"){const d={type:"video",streamId:o.id,frameHeight:o.frameHeight,frameWidth:o.frameWidth,framesPerSecond:o.framesPerSecond,framesSent:o.framesSent,firCount:o.firCount,pliCount:o.pliCount,nackCount:o.nackCount,packetsSent:o.packetsSent,bytesSent:o.bytesSent,qualityLimitationReason:o.qualityLimitationReason,qualityLimitationDurations:o.qualityLimitationDurations,qualityLimitationResolutionChanges:o.qualityLimitationResolutionChanges,rid:(l=o.rid)!==null&&l!==void 0?l:o.id,retransmittedPacketsSent:o.retransmittedPacketsSent,targetBitrate:o.targetBitrate,timestamp:o.timestamp},u=s.get(o.remoteId);u&&(d.jitter=u.jitter,d.packetsLost=u.packetsLost,d.roundTripTime=u.roundTripTime),i.push(d)}}),i.sort((o,l)=>{var d,u;return((d=l.frameWidth)!==null&&d!==void 0?d:0)-((u=o.frameWidth)!==null&&u!==void 0?u:0)}),i})}setPublishingQuality(e){const i=[];for(let s=rn.LOW;s<=rn.HIGH;s+=1)i.push(new hf({quality:s,enabled:s<=e}));this.log.debug("setting publishing quality. max quality ".concat(e),this.logContext),this.setPublishingLayers(Nn(this.codec),i)}restartTrack(e){return E(this,void 0,void 0,function*(){var i,s,o,l,d;let u;if(e){const y=bf({video:e});typeof y.video!="boolean"&&(u=y.video)}yield this.restart(u),this.isCpuConstrained=!1;try{for(var f=!0,p=mi(this.simulcastCodecs.values()),v;v=yield p.next(),i=v.done,!i;f=!0){l=v.value,f=!1;const y=l;y.sender&&((d=y.sender.transport)===null||d===void 0?void 0:d.state)!=="closed"&&(y.mediaStreamTrack=this.mediaStreamTrack.clone(),yield y.sender.replaceTrack(y.mediaStreamTrack))}}catch(y){s={error:y}}finally{try{!f&&!i&&(o=p.return)&&(yield o.call(p))}finally{if(s)throw s.error}}})}setProcessor(e){const i=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});return E(this,arguments,void 0,function(s){var o=this;let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return(function*(){var d,u,f,p,v,y;if(yield i.setProcessor.call(o,s,l),!((v=o.processor)===null||v===void 0)&&v.processedTrack)try{for(var S=!0,C=mi(o.simulcastCodecs.values()),_;_=yield C.next(),d=_.done,!d;S=!0)p=_.value,S=!1,yield(y=p.sender)===null||y===void 0?void 0:y.replaceTrack(o.processor.processedTrack)}catch(x){u={error:x}}finally{try{!S&&!d&&(f=C.return)&&(yield f.call(C))}finally{if(u)throw u.error}}})()})}setDegradationPreference(e){return E(this,void 0,void 0,function*(){if(this.degradationPreference=e,this.sender)try{this.log.debug("setting degradationPreference to ".concat(e),this.logContext);const i=this.sender.getParameters();i.degradationPreference=e,this.sender.setParameters(i)}catch(i){this.log.warn("failed to set degradationPreference",Object.assign({error:i},this.logContext))}})}addSimulcastTrack(e,i){if(this.simulcastCodecs.has(e)){this.log.error("".concat(e," already added, skipping adding simulcast codec"),this.logContext);return}const s={codec:e,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:i};return this.simulcastCodecs.set(e,s),s}setSimulcastTrackSender(e,i){const s=this.simulcastCodecs.get(e);s&&(s.sender=i,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},eA))}setPublishingCodecs(e){return E(this,void 0,void 0,function*(){var i,s,o,l,d,u,f;if(this.log.debug("setting publishing codecs",Object.assign(Object.assign({},this.logContext),{codecs:e,currentCodec:this.codec})),!this.codec&&e.length>0)return yield this.setPublishingLayers(Nn(e[0].codec),e[0].qualities),[];this.subscribedCodecs=e;const p=[];try{for(i=!0,s=mi(e);o=yield s.next(),l=o.done,!l;i=!0){f=o.value,i=!1;const v=f;if(!this.codec||this.codec===v.codec)yield this.setPublishingLayers(Nn(v.codec),v.qualities);else{const y=this.simulcastCodecs.get(v.codec);if(this.log.debug("try setPublishingCodec for ".concat(v.codec),Object.assign(Object.assign({},this.logContext),{simulcastCodecInfo:y})),!y||!y.sender){for(const S of v.qualities)if(S.enabled){p.push(v.codec);break}}else y.encodings&&(this.log.debug("try setPublishingLayersForSender ".concat(v.codec),this.logContext),yield R0(y.sender,y.encodings,v.qualities,this.senderLock,Nn(v.codec),this.log,this.logContext))}}}catch(v){d={error:v}}finally{try{!i&&!l&&(u=s.return)&&(yield u.call(s))}finally{if(d)throw d.error}}return p})}setPublishingLayers(e,i){return E(this,void 0,void 0,function*(){if(this.optimizeForPerformance){this.log.info("skipping setPublishingLayers due to optimized publishing performance",Object.assign(Object.assign({},this.logContext),{qualities:i}));return}this.log.debug("setting publishing layers",Object.assign(Object.assign({},this.logContext),{qualities:i})),!(!this.sender||!this.encodings)&&(yield R0(this.sender,this.encodings,i,this.senderLock,e,this.log,this.logContext))})}prioritizePerformance(){return E(this,void 0,void 0,function*(){if(!this.sender)throw new Error("sender not found");const e=yield this.senderLock.lock();try{this.optimizeForPerformance=!0;const i=this.sender.getParameters();i.encodings=i.encodings.map((s,o)=>{var l;return Object.assign(Object.assign({},s),{active:o===0,scaleResolutionDownBy:Math.max(1,Math.ceil(((l=this.mediaStreamTrack.getSettings().height)!==null&&l!==void 0?l:360)/360)),scalabilityMode:o===0&&Nn(this.codec)?"L1T3":void 0,maxFramerate:o===0?15:0,maxBitrate:o===0?s.maxBitrate:0})}),this.log.debug("setting performance optimised encodings",Object.assign(Object.assign({},this.logContext),{encodings:i.encodings})),this.encodings=i.encodings,yield this.sender.setParameters(i)}catch(i){this.log.error("failed to set performance optimised encodings",Object.assign(Object.assign({},this.logContext),{error:i})),this.optimizeForPerformance=!1}finally{e()}})}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return E(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),eT()&&this.isInBackground&&this.source===Q.Source.Camera&&(this._mediaStreamTrack.enabled=!1)})}}function R0(a,e,i,s,o,l,d){return E(this,void 0,void 0,function*(){const u=yield s.lock();l.debug("setPublishingLayersForSender",Object.assign(Object.assign({},d),{sender:a,qualities:i,senderEncodings:e}));try{const f=a.getParameters(),{encodings:p}=f;if(!p)return;if(p.length!==e.length){l.warn("cannot set publishing layers, encodings mismatch",Object.assign(Object.assign({},d),{encodings:p,senderEncodings:e}));return}let v=!1;!1&&p[0].scalabilityMode||(o&&i.some(C=>C.enabled)&&i.forEach(C=>C.enabled=!0),p.forEach((S,C)=>{var _;let x=(_=S.rid)!==null&&_!==void 0?_:"";x===""&&(x="q");const k=uT(x),R=i.find(O=>O.quality===k);R&&S.active!==R.enabled&&(v=!0,S.active=R.enabled,l.debug("setting layer ".concat(R.quality," to ").concat(S.active?"enabled":"disabled"),d),Na()&&(R.enabled?(S.scaleResolutionDownBy=e[C].scaleResolutionDownBy,S.maxBitrate=e[C].maxBitrate,S.maxFrameRate=e[C].maxFrameRate):(S.scaleResolutionDownBy=4,S.maxBitrate=10,S.maxFrameRate=2)))})),v&&(f.encodings=p,l.debug("setting encodings",Object.assign(Object.assign({},d),{encodings:f.encodings})),yield a.setParameters(f))}finally{u()}})}function uT(a){switch(a){case"f":return rn.HIGH;case"h":return rn.MEDIUM;case"q":return rn.LOW;default:return rn.HIGH}}function N0(a,e,i,s){if(!i)return[new Wi({quality:rn.HIGH,width:a,height:e,bitrate:0,ssrc:0})];if(s){const o=i[0].scalabilityMode,l=new cT(o),d=[],u=l.suffix=="h"?1.5:2,f=l.suffix=="h"?2:3;for(let p=0;p<l.spatial;p+=1)d.push(new Wi({quality:Math.min(rn.HIGH,l.spatial-1)-p,width:Math.ceil(a/Math.pow(u,p)),height:Math.ceil(e/Math.pow(u,p)),bitrate:i[0].maxBitrate?Math.ceil(i[0].maxBitrate/Math.pow(f,p)):0,ssrc:0}));return d}return i.map(o=>{var l,d,u;const f=(l=o.scaleResolutionDownBy)!==null&&l!==void 0?l:1;let p=uT((d=o.rid)!==null&&d!==void 0?d:"");return new Wi({quality:p,width:Math.ceil(a/f),height:Math.ceil(e/f),bitrate:(u=o.maxBitrate)!==null&&u!==void 0?u:0,ssrc:0})})}const A0="_lossy",M0="_reliable",tA=2*1e3,dh="leave-reconnect",nA=3e4,iA=8*1024,aA=256*1024;var vn;(function(a){a[a.New=0]="New",a[a.Connected=1]="Connected",a[a.Disconnected=2]="Disconnected",a[a.Reconnecting=3]="Reconnecting",a[a.Closed=4]="Closed"})(vn||(vn={}));class sA extends Vn.EventEmitter{get isClosed(){return this._isClosed}get pendingReconnect(){return!!this.reconnectTimeout}constructor(e){var i;super(),this.options=e,this.rtcConfig={},this.peerConnectionTimeout=Ef.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.latestRemoteOfferId=0,this.subscriberPrimary=!1,this.pcState=vn.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.log=Se,this.reliableDataSequence=1,this.reliableMessageBuffer=new v0,this.reliableReceivedState=new EN(nA),this.lossyDataStatCurrentBytes=0,this.lossyDataStatByterate=0,this.lossyDataDropCount=0,this.midToTrackId={},this.isWaitingForNetworkReconnect=!1,this.handleDataChannel=s=>E(this,[s],void 0,function(o){var l=this;let{channel:d}=o;return(function*(){if(d){if(d.label===M0)l.reliableDCSub=d;else if(d.label===A0)l.lossyDCSub=d;else return;l.log.debug("on data channel ".concat(d.id,", ").concat(d.label),l.logContext),d.onmessage=l.handleDataMessage}})()}),this.handleDataMessage=s=>E(this,void 0,void 0,function*(){var o,l,d,u,f;const p=yield this.dataProcessLock.lock();try{let v;if(s.data instanceof ArrayBuffer)v=s.data;else if(s.data instanceof Blob)v=yield s.data.arrayBuffer();else{this.log.error("unsupported data type",Object.assign(Object.assign({},this.logContext),{data:s.data}));return}const y=Pt.fromBinary(new Uint8Array(v));if(y.sequence>0&&y.participantSid!==""){const S=this.reliableReceivedState.get(y.participantSid);if(S&&y.sequence<=S)return;this.reliableReceivedState.set(y.participantSid,y.sequence)}if(((o=y.value)===null||o===void 0?void 0:o.case)==="speaker")this.emit(ie.ActiveSpeakersUpdate,y.value.value.speakers);else if(((l=y.value)===null||l===void 0?void 0:l.case)==="encryptedPacket"){if(!this.e2eeManager){this.log.error("Received encrypted packet but E2EE not set up",this.logContext);return}const S=yield(d=this.e2eeManager)===null||d===void 0?void 0:d.handleEncryptedData(y.value.value.encryptedValue,y.value.value.iv,y.participantIdentity,y.value.value.keyIndex),C=Gb.fromBinary(S.payload),_=new Pt({value:C.value,participantIdentity:y.participantIdentity,participantSid:y.participantSid});((u=_.value)===null||u===void 0?void 0:u.case)==="user"&&D0(_,_.value.value),this.emit(ie.DataPacketReceived,_,y.value.value.encryptionType)}else((f=y.value)===null||f===void 0?void 0:f.case)==="user"&&D0(y,y.value.value),this.emit(ie.DataPacketReceived,y,ht.NONE)}finally{p()}}),this.handleDataError=s=>{const l=s.currentTarget.maxRetransmits===0?"lossy":"reliable";if(s instanceof ErrorEvent&&s.error){const{error:d}=s.error;this.log.error("DataChannel error on ".concat(l,": ").concat(s.message),Object.assign(Object.assign({},this.logContext),{error:d}))}else this.log.error("Unknown DataChannel error on ".concat(l),Object.assign(Object.assign({},this.logContext),{event:s}))},this.handleBufferedAmountLow=s=>{const l=s.currentTarget.maxRetransmits===0?Ce.LOSSY:Ce.RELIABLE;this.updateAndEmitDCBufferStatus(l)},this.handleDisconnect=(s,o)=>{if(this._isClosed)return;this.log.warn("".concat(s," disconnected"),this.logContext),this.reconnectAttempts===0&&(this.reconnectStart=Date.now());const l=f=>{this.log.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(f,"ms. giving up"),this.logContext),this.emit(ie.Disconnected),this.close()},d=Date.now()-this.reconnectStart;let u=this.getNextRetryDelay({elapsedMs:d,retryCount:this.reconnectAttempts});if(u===null){l(d);return}s===dh&&(u=0),this.log.debug("reconnecting in ".concat(u,"ms"),this.logContext),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=Rt.setTimeout(()=>this.attemptReconnect(o).finally(()=>this.reconnectTimeout=void 0),u)},this.waitForRestarted=()=>new Promise((s,o)=>{this.pcState===vn.Connected&&s();const l=()=>{this.off(ie.Disconnected,d),s()},d=()=>{this.off(ie.Restarted,l),o()};this.once(ie.Restarted,l),this.once(ie.Disconnected,d)}),this.updateAndEmitDCBufferStatus=s=>{if(s===Ce.RELIABLE){const l=this.dataChannelForKind(s);l&&this.reliableMessageBuffer.alignBufferedAmount(l.bufferedAmount)}const o=this.isBufferStatusLow(s);typeof o<"u"&&o!==this.dcBufferStatus.get(s)&&(this.dcBufferStatus.set(s,o),this.emit(ie.DCBufferStatusChanged,o,s))},this.isBufferStatusLow=s=>{const o=this.dataChannelForKind(s);if(o)return o.bufferedAmount<=o.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>E(this,void 0,void 0,function*(){!this.url||!(yield fetch($r(this.url),{method:"HEAD"}).then(o=>o.ok).catch(()=>!1))||(this.log.info("detected network reconnected"),(this.client.currentState===Je.RECONNECTING||this.isWaitingForNetworkReconnect&&this.client.currentState===Je.CONNECTED)&&(this.clearReconnectTimeout(),this.attemptReconnect(ka.RR_SIGNAL_DISCONNECTED),this.isWaitingForNetworkReconnect=!1))}),this.handleBrowserOffline=()=>E(this,void 0,void 0,function*(){if(this.url)try{yield Promise.race([fetch($r(this.url),{method:"HEAD"}),Nt(4e3).then(()=>Promise.reject())])}catch{window.navigator.onLine===!1&&(this.log.info("detected network interruption"),this.isWaitingForNetworkReconnect=!0)}}),this.log=qn((i=e.loggerName)!==null&&i!==void 0?i:Sn.Engine),this.loggerOptions={loggerName:e.loggerName,loggerContextCb:()=>this.logContext},this.client=new Tf(void 0,this.loggerOptions),this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.closingLock=new It,this.dataProcessLock=new It,this.dcBufferStatus=new Map([[Ce.LOSSY,!0],[Ce.RELIABLE,!0]]),this.client.onParticipantUpdate=s=>this.emit(ie.ParticipantUpdate,s),this.client.onConnectionQuality=s=>this.emit(ie.ConnectionQualityUpdate,s),this.client.onRoomUpdate=s=>this.emit(ie.RoomUpdate,s),this.client.onSubscriptionError=s=>this.emit(ie.SubscriptionError,s),this.client.onSubscriptionPermissionUpdate=s=>this.emit(ie.SubscriptionPermissionUpdate,s),this.client.onSpeakersChanged=s=>this.emit(ie.SpeakersChanged,s),this.client.onStreamStateUpdate=s=>this.emit(ie.StreamStateChanged,s),this.client.onRequestResponse=s=>this.emit(ie.SignalRequestResponse,s)}get logContext(){var e,i,s,o,l,d;return{room:(i=(e=this.latestJoinResponse)===null||e===void 0?void 0:e.room)===null||i===void 0?void 0:i.name,roomID:(o=(s=this.latestJoinResponse)===null||s===void 0?void 0:s.room)===null||o===void 0?void 0:o.sid,participant:(d=(l=this.latestJoinResponse)===null||l===void 0?void 0:l.participant)===null||d===void 0?void 0:d.identity,pID:this.participantSid}}join(e,i,s,o){return E(this,arguments,void 0,function(l,d,u,f){var p=this;let v=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;return(function*(){p.url=l,p.token=d,p.signalOpts=u,p.maxJoinAttempts=u.maxRetries;try{p.joinAttempts+=1,p.setupSignalClientCallbacks();const y=yield p.client.join(l,d,u,f,v);return p._isClosed=!1,p.latestJoinResponse=y,p.subscriberPrimary=y.subscriberPrimary,p.pcManager||(yield p.configure(y,!v)),(!p.subscriberPrimary||y.fastPublish)&&p.negotiate().catch(S=>{Se.error(S,p.logContext)}),p.registerOnLineListener(),p.clientConfiguration=y.clientConfiguration,p.emit(ie.SignalConnected,y),y}catch(y){if(y instanceof me){if(y.reason===Qe.ServerUnreachable){if(p.log.warn("Couldn't connect to server, attempt ".concat(p.joinAttempts," of ").concat(p.maxJoinAttempts),p.logContext),p.joinAttempts<p.maxJoinAttempts)return p.join(l,d,u,f,v)}else if(y.reason===Qe.ServiceNotFound)return p.log.warn("Initial connection failed: ".concat(y.message,"  Retrying")),p.join(l,d,u,f,!0)}throw y}})()})}close(){return E(this,void 0,void 0,function*(){const e=yield this.closingLock.lock();if(this.isClosed){e();return}try{this._isClosed=!0,this.joinAttempts=0,this.emit(ie.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),this.cleanupLossyDataStats(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{e()}})}cleanupPeerConnections(){return E(this,void 0,void 0,function*(){var e;yield(e=this.pcManager)===null||e===void 0?void 0:e.close(),this.pcManager=void 0;const i=s=>{s&&(s.close(),s.onbufferedamountlow=null,s.onclose=null,s.onclosing=null,s.onerror=null,s.onmessage=null,s.onopen=null)};i(this.lossyDC),i(this.lossyDCSub),i(this.reliableDC),i(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0,this.reliableMessageBuffer=new v0,this.reliableDataSequence=1,this.reliableReceivedState.clear()})}cleanupLossyDataStats(){this.lossyDataStatByterate=0,this.lossyDataStatCurrentBytes=0,this.lossyDataStatInterval&&(clearInterval(this.lossyDataStatInterval),this.lossyDataStatInterval=void 0),this.lossyDataDropCount=0}cleanupClient(){return E(this,void 0,void 0,function*(){yield this.client.close(),this.client.resetCallbacks()})}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new pi("a track with the same ID has already been published");return new Promise((i,s)=>{const o=setTimeout(()=>{delete this.pendingTrackResolvers[e.cid],s(me.timeout("publication of local track timed out, no response from server"))},1e4);this.pendingTrackResolvers[e.cid]={resolve:l=>{clearTimeout(o),i(l)},reject:()=>{clearTimeout(o),s(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(e)})}removeTrack(e){if(e.track&&this.pendingTrackResolvers[e.track.id]){const{reject:i}=this.pendingTrackResolvers[e.track.id];i&&i(),delete this.pendingTrackResolvers[e.track.id]}try{return this.pcManager.removeTrack(e),!0}catch(i){this.log.warn("failed to remove track",Object.assign(Object.assign({},this.logContext),{error:i}))}return!1}updateMuteStatus(e,i){this.client.sendMuteTrack(e,i)}get dataSubscriberReadyState(){var e;return(e=this.reliableDCSub)===null||e===void 0?void 0:e.readyState}getConnectedServerAddress(){return E(this,void 0,void 0,function*(){var e;return(e=this.pcManager)===null||e===void 0?void 0:e.getConnectedAddress()})}setRegionUrlProvider(e){this.regionUrlProvider=e}configure(e,i){return E(this,void 0,void 0,function*(){var s,o;if(this.pcManager&&this.pcManager.currentState!==tt.NEW)return;this.participantSid=(s=e.participant)===null||s===void 0?void 0:s.sid;const l=this.makeRTCConfiguration(e);this.pcManager=new jN(l,i?"publisher-only":e.subscriberPrimary?"subscriber-primary":"publisher-primary",this.loggerOptions),this.emit(ie.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(d,u)=>{this.client.sendIceCandidate(d,u)},this.pcManager.onPublisherOffer=(d,u)=>{this.client.sendOffer(d,u)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(d,u,f)=>E(this,void 0,void 0,function*(){if(this.log.debug("primary PC state changed ".concat(d),this.logContext),["closed","disconnected","failed"].includes(u)&&(this.publisherConnectionPromise=void 0),d===tt.CONNECTED){const y=this.pcState===vn.New;this.pcState=vn.Connected,y&&this.emit(ie.Connected,e)}else d===tt.FAILED&&(this.pcState===vn.Connected||this.pcState===vn.Reconnecting)&&(this.pcState=vn.Disconnected,this.handleDisconnect("peerconnection failed",f==="failed"?ka.RR_SUBSCRIBER_FAILED:ka.RR_PUBLISHER_FAILED));const p=this.client.isDisconnected||this.client.currentState===Je.RECONNECTING,v=[tt.FAILED,tt.CLOSING,tt.CLOSED].includes(d);p&&v&&!this._isClosed&&this.emit(ie.Offline)}),this.pcManager.onTrack=d=>{d.streams.length!==0&&this.emit(ie.MediaTrackAdded,d.track,d.streams[0],d.receiver)},rA((o=e.serverInfo)===null||o===void 0?void 0:o.protocol)||this.createDataChannels()})}setupSignalClientCallbacks(){this.client.onAnswer=(e,i,s)=>E(this,void 0,void 0,function*(){this.pcManager&&(this.log.debug("received server answer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,midToTrackId:s})),this.midToTrackId=s,yield this.pcManager.setPublisherAnswer(e,i))}),this.client.onTrickle=(e,i)=>{this.pcManager&&(this.log.debug("got ICE candidate from peer",Object.assign(Object.assign({},this.logContext),{candidate:e,target:i})),this.pcManager.addIceCandidate(e,i))},this.client.onOffer=(e,i,s)=>E(this,void 0,void 0,function*(){if(this.latestRemoteOfferId=i,!this.pcManager)return;this.midToTrackId=s;const o=yield this.pcManager.createSubscriberAnswerFromOffer(e,i);o&&this.client.sendAnswer(o,i)}),this.client.onLocalTrackPublished=e=>{var i;if(this.log.debug("received trackPublishedResponse",Object.assign(Object.assign({},this.logContext),{cid:e.cid,track:(i=e.track)===null||i===void 0?void 0:i.sid})),!this.pendingTrackResolvers[e.cid]){this.log.error("missing track resolver for ".concat(e.cid),Object.assign(Object.assign({},this.logContext),{cid:e.cid}));return}const{resolve:s}=this.pendingTrackResolvers[e.cid];delete this.pendingTrackResolvers[e.cid],s(e.track)},this.client.onLocalTrackUnpublished=e=>{this.emit(ie.LocalTrackUnpublished,e)},this.client.onLocalTrackSubscribed=e=>{this.emit(ie.LocalTrackSubscribed,e)},this.client.onTokenRefresh=e=>{var i;this.token=e,(i=this.regionUrlProvider)===null||i===void 0||i.updateToken(e)},this.client.onRemoteMuteChanged=(e,i)=>{this.emit(ie.RemoteMute,e,i)},this.client.onSubscribedQualityUpdate=e=>{this.emit(ie.SubscribedQualityUpdate,e)},this.client.onRoomMoved=e=>{var i;this.participantSid=(i=e.participant)===null||i===void 0?void 0:i.sid,this.latestJoinResponse&&(this.latestJoinResponse.room=e.room),this.emit(ie.RoomMoved,e)},this.client.onMediaSectionsRequirement=e=>{var i,s;const o={direction:"recvonly"};for(let l=0;l<e.numAudios;l++)(i=this.pcManager)===null||i===void 0||i.addPublisherTransceiverOfKind("audio",o);for(let l=0;l<e.numVideos;l++)(s=this.pcManager)===null||s===void 0||s.addPublisherTransceiverOfKind("video",o);this.negotiate()},this.client.onClose=()=>{this.handleDisconnect("signal",ka.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=e=>{switch(this.log.debug("client leave request",Object.assign(Object.assign({},this.logContext),{reason:e?.reason})),e.regions&&this.regionUrlProvider&&(this.log.debug("updating regions",this.logContext),this.regionUrlProvider.setServerReportedRegions({updatedAtInMs:Date.now(),maxAgeInMs:rT,regionSettings:e.regions})),e.action){case Es.DISCONNECT:this.emit(ie.Disconnected,e?.reason),this.close();break;case Es.RECONNECT:this.fullReconnectOnNext=!0,this.handleDisconnect(dh);break;case Es.RESUME:this.handleDisconnect(dh)}}}makeRTCConfiguration(e){var i;const s=Object.assign({},this.rtcConfig);if(!((i=this.signalOpts)===null||i===void 0)&&i.e2eeEnabled&&(this.log.debug("E2EE - setting up transports with insertable streams",this.logContext),s.encodedInsertableStreams=!0),e.iceServers&&!s.iceServers){const o=[];e.iceServers.forEach(l=>{const d={urls:l.urls};l.username&&(d.username=l.username),l.credential&&(d.credential=l.credential),o.push(d)}),s.iceServers=o}return e.clientConfiguration&&e.clientConfiguration.forceRelay===Jr.ENABLED&&(s.iceTransportPolicy="relay"),s.sdpSemantics="unified-plan",s.continualGatheringPolicy="gather_continually",s}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(A0,{ordered:!1,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel(M0,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow,this.cleanupLossyDataStats(),this.lossyDataStatInterval=setInterval(()=>{this.lossyDataStatByterate=this.lossyDataStatCurrentBytes,this.lossyDataStatCurrentBytes=0;const e=this.dataChannelForKind(Ce.LOSSY);if(e){const i=this.lossyDataStatByterate/10;e.bufferedAmountLowThreshold=Math.min(Math.max(i,iA),aA)}},1e3))}createSender(e,i,s){return E(this,void 0,void 0,function*(){if(jh())return yield this.createTransceiverRTCRtpSender(e,i,s);if(Ph())return this.log.warn("using add-track fallback",this.logContext),yield this.createRTCRtpSender(e.mediaStreamTrack);throw new ut("Required webRTC APIs not supported on this device")})}createSimulcastSender(e,i,s,o){return E(this,void 0,void 0,function*(){if(jh())return this.createSimulcastTransceiverSender(e,i,s,o);if(Ph())return this.log.debug("using add-track fallback",this.logContext),this.createRTCRtpSender(e.mediaStreamTrack);throw new ut("Cannot stream on this device")})}createTransceiverRTCRtpSender(e,i,s){return E(this,void 0,void 0,function*(){if(!this.pcManager)throw new ut("publisher is closed");const o=[];e.mediaStream&&o.push(e.mediaStream),na(e)&&(e.codec=i.videoCodec);const l={direction:"sendonly",streams:o};return s&&(l.sendEncodings=s),(yield this.pcManager.addPublisherTransceiver(e.mediaStreamTrack,l)).sender})}createSimulcastTransceiverSender(e,i,s,o){return E(this,void 0,void 0,function*(){if(!this.pcManager)throw new ut("publisher is closed");const l={direction:"sendonly"};o&&(l.sendEncodings=o);const d=yield this.pcManager.addPublisherTransceiver(i.mediaStreamTrack,l);if(s.videoCodec)return e.setSimulcastTrackSender(s.videoCodec,d.sender),d.sender})}createRTCRtpSender(e){return E(this,void 0,void 0,function*(){if(!this.pcManager)throw new ut("publisher is closed");return this.pcManager.addPublisherTrack(e)})}attemptReconnect(e){return E(this,void 0,void 0,function*(){var i,s,o;if(!this._isClosed){if(this.attemptingReconnect){Se.warn("already attempting reconnect, returning early",this.logContext);return}(((i=this.clientConfiguration)===null||i===void 0?void 0:i.resumeConnection)===Jr.DISABLED||((o=(s=this.pcManager)===null||s===void 0?void 0:s.currentState)!==null&&o!==void 0?o:tt.NEW)===tt.NEW)&&(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(e),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(l){this.reconnectAttempts+=1;let d=!0;l instanceof ut?(this.log.debug("received unrecoverable error",Object.assign(Object.assign({},this.logContext),{error:l})),d=!1):l instanceof Ss||(this.fullReconnectOnNext=!0),d?this.handleDisconnect("reconnect",ka.RR_UNKNOWN):(this.log.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up"),this.logContext),this.emit(ie.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}})}getNextRetryDelay(e){try{return this.reconnectPolicy.nextRetryDelayInMs(e)}catch(i){this.log.warn("encountered error in reconnect policy",Object.assign(Object.assign({},this.logContext),{error:i}))}return null}restartConnection(e){return E(this,void 0,void 0,function*(){var i,s,o;try{if(!this.url||!this.token)throw new ut("could not reconnect, url or token not saved");this.log.info("reconnecting, attempt: ".concat(this.reconnectAttempts),this.logContext),this.emit(ie.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();let l;try{if(!this.signalOpts)throw this.log.warn("attempted connection restart, without signal options present",this.logContext),new Ss;l=yield this.join(e??this.url,this.token,this.signalOpts,void 0,!this.options.singlePeerConnection)}catch(d){throw d instanceof me&&d.reason===Qe.NotAllowed?new ut("could not reconnect, token might be expired"):new Ss}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(this.client.setReconnected(),this.emit(ie.SignalRestarted,l),yield this.waitForPCReconnected(),this.client.currentState!==Je.CONNECTED)throw new Ss("Signal connection got severed during reconnect");(i=this.regionUrlProvider)===null||i===void 0||i.resetAttempts(),this.emit(ie.Restarted)}catch(l){const d=yield(s=this.regionUrlProvider)===null||s===void 0?void 0:s.getNextBestRegionUrl();if(d){yield this.restartConnection(d);return}else throw(o=this.regionUrlProvider)===null||o===void 0||o.resetAttempts(),l}})}resumeConnection(e){return E(this,void 0,void 0,function*(){var i;if(!this.url||!this.token)throw new ut("could not reconnect, url or token not saved");if(!this.pcManager)throw new ut("publisher and subscriber connections unset");this.log.info("resuming signal connection, attempt ".concat(this.reconnectAttempts),this.logContext),this.emit(ie.Resuming);let s;try{this.setupSignalClientCallbacks(),s=yield this.client.reconnect(this.url,this.token,this.participantSid,e)}catch(o){let l="";throw o instanceof Error&&(l=o.message,this.log.error(o.message,Object.assign(Object.assign({},this.logContext),{error:o}))),o instanceof me&&o.reason===Qe.NotAllowed?new ut("could not reconnect, token might be expired"):o instanceof me&&o.reason===Qe.LeaveRequest?o:new Ss(l)}if(this.emit(ie.SignalResumed),s){const o=this.makeRTCConfiguration(s);this.pcManager.updateConfiguration(o),this.latestJoinResponse&&(this.latestJoinResponse.serverInfo=s.serverInfo)}else this.log.warn("Did not receive reconnect response",this.logContext);if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.currentState!==Je.CONNECTED)throw new Ss("Signal connection got severed during reconnect");this.client.setReconnected(),((i=this.reliableDC)===null||i===void 0?void 0:i.readyState)==="open"&&this.reliableDC.id===null&&this.createDataChannels(),s?.lastMessageSeq&&this.resendReliableMessagesForResume(s.lastMessageSeq),this.emit(ie.Resumed)})}waitForPCInitialConnection(e,i){return E(this,void 0,void 0,function*(){if(!this.pcManager)throw new ut("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(i,e)})}waitForPCReconnected(){return E(this,void 0,void 0,function*(){this.pcState=vn.Reconnecting,this.log.debug("waiting for peer connection to reconnect",this.logContext);try{if(yield Nt(tA),!this.pcManager)throw new ut("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=vn.Connected}catch(e){throw this.pcState=vn.Disconnected,me.internal("could not establish PC connection, ".concat(e.message))}})}publishRpcResponse(e,i,s,o){return E(this,void 0,void 0,function*(){const l=new Pt({destinationIdentities:[e],kind:Ce.RELIABLE,value:{case:"rpcResponse",value:new lf({requestId:i,value:o?{case:"error",value:o.toProto()}:{case:"payload",value:s??""}})}});yield this.sendDataPacket(l,Ce.RELIABLE)})}publishRpcAck(e,i){return E(this,void 0,void 0,function*(){const s=new Pt({destinationIdentities:[e],kind:Ce.RELIABLE,value:{case:"rpcAck",value:new of({requestId:i})}});yield this.sendDataPacket(s,Ce.RELIABLE)})}sendDataPacket(e,i){return E(this,void 0,void 0,function*(){if(yield this.ensurePublisherConnected(i),this.e2eeManager&&this.e2eeManager.isDataChannelEncryptionEnabled){const l=mN(e);if(l){const d=yield this.e2eeManager.encryptData(l.toBinary());e.value={case:"encryptedPacket",value:new Vb({encryptedValue:d.payload,iv:d.iv,keyIndex:d.keyIndex})}}}i===Ce.RELIABLE&&(e.sequence=this.reliableDataSequence,this.reliableDataSequence+=1);const s=e.toBinary(),o=this.dataChannelForKind(i);if(o){if(i===Ce.RELIABLE)yield this.waitForBufferStatusLow(i),this.reliableMessageBuffer.push({data:s,sequence:e.sequence});else{if(!this.isBufferStatusLow(i)){this.lossyDataDropCount+=1,this.lossyDataDropCount%100===0&&this.log.warn("dropping lossy data channel messages, total dropped: ".concat(this.lossyDataDropCount),this.logContext);return}this.lossyDataStatCurrentBytes+=s.byteLength}if(this.attemptingReconnect)return;o.send(s)}this.updateAndEmitDCBufferStatus(i)})}resendReliableMessagesForResume(e){return E(this,void 0,void 0,function*(){yield this.ensurePublisherConnected(Ce.RELIABLE);const i=this.dataChannelForKind(Ce.RELIABLE);i&&(this.reliableMessageBuffer.popToSequence(e),this.reliableMessageBuffer.getAll().forEach(s=>{i.send(s.data)})),this.updateAndEmitDCBufferStatus(Ce.RELIABLE)})}waitForBufferStatusLow(e){return new Mt((i,s)=>E(this,void 0,void 0,function*(){if(this.isBufferStatusLow(e))i();else{const o=()=>s(new ut("engine closed"));for(this.once(ie.Closing,o);!this.dcBufferStatus.get(e);)yield Nt(10);this.off(ie.Closing,o),i()}}))}ensureDataTransportConnected(e){return E(this,arguments,void 0,function(i){var s=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscriberPrimary;return(function*(){var l;if(!s.pcManager)throw new ut("PC manager is closed");const d=o?s.pcManager.subscriber:s.pcManager.publisher,u=o?"Subscriber":"Publisher";if(!d)throw me.internal("".concat(u," connection not set"));let f=!1;!o&&!s.dataChannelForKind(i,o)&&(s.createDataChannels(),f=!0),!f&&!o&&!s.pcManager.publisher.isICEConnected&&s.pcManager.publisher.getICEConnectionState()!=="checking"&&(f=!0),f&&s.negotiate().catch(y=>{Se.error(y,s.logContext)});const p=s.dataChannelForKind(i,o);if(p?.readyState==="open")return;const v=new Date().getTime()+s.peerConnectionTimeout;for(;new Date().getTime()<v;){if(d.isICEConnected&&((l=s.dataChannelForKind(i,o))===null||l===void 0?void 0:l.readyState)==="open")return;yield Nt(50)}throw me.internal("could not establish ".concat(u," connection, state: ").concat(d.getICEConnectionState()))})()})}ensurePublisherConnected(e){return E(this,void 0,void 0,function*(){this.publisherConnectionPromise||(this.publisherConnectionPromise=this.ensureDataTransportConnected(e,!1)),yield this.publisherConnectionPromise})}verifyTransport(){return!(!this.pcManager||![tt.CONNECTING,tt.CONNECTED].includes(this.pcManager.currentState)||!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED)}negotiate(){return E(this,void 0,void 0,function*(){return new Mt((e,i)=>E(this,void 0,void 0,function*(){if(!this.pcManager){i(new Ea("PC manager is closed"));return}this.pcManager.requirePublisher(),this.pcManager.publisher.getTransceivers().length==0&&!this.lossyDC&&!this.reliableDC&&this.createDataChannels();const s=new AbortController,o=()=>{s.abort(),this.log.debug("engine disconnected while negotiation was ongoing",this.logContext),e()};this.isClosed&&i(new Ea("cannot negotiate on closed engine")),this.on(ie.Closing,o),this.on(ie.Restarting,o),this.pcManager.publisher.once(_a.RTPVideoPayloadTypes,l=>{const d=new Map;l.forEach(u=>{const f=u.codec.toLowerCase();XR(f)&&d.set(u.payload,f)}),this.emit(ie.RTPVideoMapUpdate,d)});try{yield this.pcManager.negotiate(s),e()}catch(l){if(s.signal.aborted){e();return}l instanceof Ea&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",ka.RR_UNKNOWN),l instanceof Error?i(l):i(new Error(String(l)))}finally{this.off(ie.Closing,o),this.off(ie.Restarting,o)}}))})}dataChannelForKind(e,i){if(i){if(e===Ce.LOSSY)return this.lossyDCSub;if(e===Ce.RELIABLE)return this.reliableDCSub}else{if(e===Ce.LOSSY)return this.lossyDC;if(e===Ce.RELIABLE)return this.reliableDC}}sendSyncState(e,i){var s,o,l,d;if(!this.pcManager){this.log.warn("sync state cannot be sent without peer connection setup",this.logContext);return}const u=this.pcManager.publisher.getLocalDescription(),f=this.pcManager.publisher.getRemoteDescription(),p=(s=this.pcManager.subscriber)===null||s===void 0?void 0:s.getRemoteDescription(),v=(o=this.pcManager.subscriber)===null||o===void 0?void 0:o.getLocalDescription(),y=(d=(l=this.signalOpts)===null||l===void 0?void 0:l.autoSubscribe)!==null&&d!==void 0?d:!0,S=new Array,C=new Array;e.forEach(_=>{_.isDesired!==y&&S.push(_.trackSid),_.isEnabled||C.push(_.trackSid)}),this.client.sendSyncState(new ff({answer:this.pcManager.mode==="publisher-only"?f?ks({sdp:f.sdp,type:f.type}):void 0:v?ks({sdp:v.sdp,type:v.type}):void 0,offer:this.pcManager.mode==="publisher-only"?u?ks({sdp:u.sdp,type:u.type}):void 0:p?ks({sdp:p.sdp,type:p.type}):void 0,subscription:new pc({trackSids:S,subscribe:!y,participantTracks:[]}),publishTracks:jR(i),dataChannels:this.dataChannelsInfo(),trackSidsDisabled:C,datachannelReceiveStates:this.reliableReceivedState.map((_,x)=>new fS({publisherSid:x,lastSeq:_}))}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){const e=[],i=(s,o)=>{s?.id!==void 0&&s.id!==null&&e.push(new mS({label:s.label,id:s.id,target:o}))};return i(this.dataChannelForKind(Ce.LOSSY),Rn.PUBLISHER),i(this.dataChannelForKind(Ce.RELIABLE),Rn.PUBLISHER),i(this.dataChannelForKind(Ce.LOSSY,!0),Rn.SUBSCRIBER),i(this.dataChannelForKind(Ce.RELIABLE,!0),Rn.SUBSCRIBER),e}clearReconnectTimeout(){this.reconnectTimeout&&Rt.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){Kt()&&(window.addEventListener("online",this.handleBrowserOnLine),window.addEventListener("offline",this.handleBrowserOffline))}deregisterOnLineListener(){Kt()&&(window.removeEventListener("online",this.handleBrowserOnLine),window.removeEventListener("offline",this.handleBrowserOffline))}getTrackIdForReceiver(e){var i;const s=(i=this.pcManager)===null||i===void 0?void 0:i.getMidForReceiver(e);if(s){const o=Object.entries(this.midToTrackId).find(l=>{let[d]=l;return d===s});if(o)return o[1]}}}function rA(a){return a!==void 0&&a>13}function D0(a,e){const i=a.participantIdentity?a.participantIdentity:e.participantIdentity;a.participantIdentity=i,e.participantIdentity=i;const s=a.destinationIdentities.length!==0?a.destinationIdentities:e.destinationIdentities;a.destinationIdentities=s,e.destinationIdentities=s}class dT{get info(){return this._info}validateBytesReceived(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(typeof this.totalByteSize!="number"||this.totalByteSize===0)){if(e&&this.bytesReceived<this.totalByteSize)throw new yn("Not enough chunk(s) received - expected ".concat(this.totalByteSize," bytes of data total, only received ").concat(this.bytesReceived," bytes"),jt.Incomplete);if(this.bytesReceived>this.totalByteSize)throw new yn("Extra chunk(s) received - expected ".concat(this.totalByteSize," bytes of data total, received ").concat(this.bytesReceived," bytes"),jt.LengthExceeded)}}constructor(e,i,s,o){this.reader=i,this.totalByteSize=s,this._info=e,this.bytesReceived=0,this.outOfBandFailureRejectingFuture=o}}class oA extends dT{handleChunkReceived(e){var i;this.bytesReceived+=e.content.byteLength,this.validateBytesReceived();const s=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;(i=this.onProgress)===null||i===void 0||i.call(this,s)}[Symbol.asyncIterator](){const e=this.reader.getReader();let i=new bn,s=null,o=null;if(this.signal){const d=this.signal;o=()=>{var u;(u=i.reject)===null||u===void 0||u.call(i,d.reason)},d.addEventListener("abort",o),s=d}const l=()=>{e.releaseLock(),s&&o&&s.removeEventListener("abort",o),this.signal=void 0};return{next:()=>E(this,void 0,void 0,function*(){var d,u;try{const{done:f,value:p}=yield Promise.race([e.read(),i.promise,(u=(d=this.outOfBandFailureRejectingFuture)===null||d===void 0?void 0:d.promise)!==null&&u!==void 0?u:new Promise(()=>{})]);return f?(this.validateBytesReceived(!0),{done:!0,value:void 0}):(this.handleChunkReceived(p),{done:!1,value:p.content})}catch(f){throw l(),f}}),return(){return E(this,void 0,void 0,function*(){return l(),{done:!0,value:void 0}})}}}withAbortSignal(e){return this.signal=e,this}readAll(){return E(this,arguments,void 0,function(){var e=this;let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(function*(){var s,o,l,d;let u=new Set;const f=i.signal?e.withAbortSignal(i.signal):e;try{for(var p=!0,v=mi(f),y;y=yield v.next(),s=y.done,!s;p=!0){d=y.value,p=!1;const S=d;u.add(S)}}catch(S){o={error:S}}finally{try{!p&&!s&&(l=v.return)&&(yield l.call(v))}finally{if(o)throw o.error}}return Array.from(u)})()})}}class lA extends dT{constructor(e,i,s,o){super(e,i,s,o),this.receivedChunks=new Map}handleChunkReceived(e){var i;const s=Hl(e.chunkIndex),o=this.receivedChunks.get(s);if(o&&o.version>e.version)return;this.receivedChunks.set(s,e),this.bytesReceived+=e.content.byteLength,this.validateBytesReceived();const l=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;(i=this.onProgress)===null||i===void 0||i.call(this,l)}[Symbol.asyncIterator](){const e=this.reader.getReader(),i=new TextDecoder("utf-8",{fatal:!0});let s=new bn,o=null,l=null;if(this.signal){const u=this.signal;l=()=>{var f;(f=s.reject)===null||f===void 0||f.call(s,u.reason)},u.addEventListener("abort",l),o=u}const d=()=>{e.releaseLock(),o&&l&&o.removeEventListener("abort",l),this.signal=void 0};return{next:()=>E(this,void 0,void 0,function*(){var u,f;try{const{done:p,value:v}=yield Promise.race([e.read(),s.promise,(f=(u=this.outOfBandFailureRejectingFuture)===null||u===void 0?void 0:u.promise)!==null&&f!==void 0?f:new Promise(()=>{})]);if(p)return this.validateBytesReceived(!0),{done:!0,value:void 0};{this.handleChunkReceived(v);let y;try{y=i.decode(v.content)}catch(S){throw new yn("Cannot decode datastream chunk ".concat(v.chunkIndex," as text: ").concat(S),jt.DecodeFailed)}return{done:!1,value:y}}}catch(p){throw d(),p}}),return(){return E(this,void 0,void 0,function*(){return d(),{done:!0,value:void 0}})}}}withAbortSignal(e){return this.signal=e,this}readAll(){return E(this,arguments,void 0,function(){var e=this;let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(function*(){var s,o,l,d;let u="";const f=i.signal?e.withAbortSignal(i.signal):e;try{for(var p=!0,v=mi(f),y;y=yield v.next(),s=y.done,!s;p=!0)d=y.value,p=!1,u+=d}catch(S){o={error:S}}finally{try{!p&&!s&&(l=v.return)&&(yield l.call(v))}finally{if(o)throw o.error}}return u})()})}}class cA{constructor(){this.log=Se,this.byteStreamControllers=new Map,this.textStreamControllers=new Map,this.byteStreamHandlers=new Map,this.textStreamHandlers=new Map}registerTextStreamHandler(e,i){if(this.textStreamHandlers.has(e))throw new yn('A text stream handler for topic "'.concat(e,'" has already been set.'),jt.HandlerAlreadyRegistered);this.textStreamHandlers.set(e,i)}unregisterTextStreamHandler(e){this.textStreamHandlers.delete(e)}registerByteStreamHandler(e,i){if(this.byteStreamHandlers.has(e))throw new yn('A byte stream handler for topic "'.concat(e,'" has already been set.'),jt.HandlerAlreadyRegistered);this.byteStreamHandlers.set(e,i)}unregisterByteStreamHandler(e){this.byteStreamHandlers.delete(e)}clearControllers(){this.byteStreamControllers.clear(),this.textStreamControllers.clear()}validateParticipantHasNoActiveDataStreams(e){var i,s,o,l;const d=Array.from(this.textStreamControllers.entries()).filter(f=>f[1].sendingParticipantIdentity===e),u=Array.from(this.byteStreamControllers.entries()).filter(f=>f[1].sendingParticipantIdentity===e);if(d.length>0||u.length>0){const f=new yn("Participant ".concat(e," unexpectedly disconnected in the middle of sending data"),jt.AbnormalEnd);for(const[p,v]of u)(s=(i=v.outOfBandFailureRejectingFuture).reject)===null||s===void 0||s.call(i,f),this.byteStreamControllers.delete(p);for(const[p,v]of d)(l=(o=v.outOfBandFailureRejectingFuture).reject)===null||l===void 0||l.call(o,f),this.textStreamControllers.delete(p)}}handleDataStreamPacket(e,i){return E(this,void 0,void 0,function*(){switch(e.value.case){case"streamHeader":return this.handleStreamHeader(e.value.value,e.participantIdentity,i);case"streamChunk":return this.handleStreamChunk(e.value.value,i);case"streamTrailer":return this.handleStreamTrailer(e.value.value,i);default:throw new Error('DataPacket of value "'.concat(e.value.case,'" is not data stream related!'))}})}handleStreamHeader(e,i,s){return E(this,void 0,void 0,function*(){var o;if(e.contentHeader.case==="byteHeader"){const l=this.byteStreamHandlers.get(e.topic);if(!l){this.log.debug("ignoring incoming byte stream due to no handler for topic",e.topic);return}let d;const u=new bn;u.promise.catch(v=>{this.log.error(v)});const f={id:e.streamId,name:(o=e.contentHeader.value.name)!==null&&o!==void 0?o:"unknown",mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:Hl(e.timestamp),attributes:e.attributes,encryptionType:s},p=new ReadableStream({start:v=>{if(d=v,this.textStreamControllers.has(e.streamId))throw new yn("A data stream read is already in progress for a stream with id ".concat(e.streamId,"."),jt.AlreadyOpened);this.byteStreamControllers.set(e.streamId,{info:f,controller:d,startTime:Date.now(),sendingParticipantIdentity:i,outOfBandFailureRejectingFuture:u})}});l(new oA(f,p,Hl(e.totalLength),u),{identity:i})}else if(e.contentHeader.case==="textHeader"){const l=this.textStreamHandlers.get(e.topic);if(!l){this.log.debug("ignoring incoming text stream due to no handler for topic",e.topic);return}let d;const u=new bn;u.promise.catch(v=>{this.log.error(v)});const f={id:e.streamId,mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:Number(e.timestamp),attributes:e.attributes,encryptionType:s,attachedStreamIds:e.contentHeader.value.attachedStreamIds},p=new ReadableStream({start:v=>{if(d=v,this.textStreamControllers.has(e.streamId))throw new yn("A data stream read is already in progress for a stream with id ".concat(e.streamId,"."),jt.AlreadyOpened);this.textStreamControllers.set(e.streamId,{info:f,controller:d,startTime:Date.now(),sendingParticipantIdentity:i,outOfBandFailureRejectingFuture:u})}});l(new lA(f,p,Hl(e.totalLength),u),{identity:i})}})}handleStreamChunk(e,i){const s=this.byteStreamControllers.get(e.streamId);s&&(s.info.encryptionType!==i?(s.controller.error(new yn("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(i,", got ").concat(s.info.encryptionType),jt.EncryptionTypeMismatch)),this.byteStreamControllers.delete(e.streamId)):e.content.length>0&&s.controller.enqueue(e));const o=this.textStreamControllers.get(e.streamId);o&&(o.info.encryptionType!==i?(o.controller.error(new yn("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(i,", got ").concat(o.info.encryptionType),jt.EncryptionTypeMismatch)),this.textStreamControllers.delete(e.streamId)):e.content.length>0&&o.controller.enqueue(e))}handleStreamTrailer(e,i){const s=this.textStreamControllers.get(e.streamId);s&&(s.info.encryptionType!==i?s.controller.error(new yn("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(i,", got ").concat(s.info.encryptionType),jt.EncryptionTypeMismatch)):(s.info.attributes=Object.assign(Object.assign({},s.info.attributes),e.attributes),s.controller.close(),this.textStreamControllers.delete(e.streamId)));const o=this.byteStreamControllers.get(e.streamId);o&&(o.info.encryptionType!==i?o.controller.error(new yn("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(i,", got ").concat(o.info.encryptionType),jt.EncryptionTypeMismatch)):(o.info.attributes=Object.assign(Object.assign({},o.info.attributes),e.attributes),o.controller.close()),this.byteStreamControllers.delete(e.streamId))}}class hT{constructor(e,i,s){this.writableStream=e,this.defaultWriter=e.getWriter(),this.onClose=s,this.info=i}write(e){return this.defaultWriter.write(e)}close(){return E(this,void 0,void 0,function*(){var e;yield this.defaultWriter.close(),this.defaultWriter.releaseLock(),(e=this.onClose)===null||e===void 0||e.call(this)})}}class uA extends hT{}class dA extends hT{}const O0=15e3;class hA{constructor(e,i){this.engine=e,this.log=i}setupEngine(e){this.engine=e}sendText(e,i){return E(this,void 0,void 0,function*(){var s;const o=crypto.randomUUID(),d=new TextEncoder().encode(e).byteLength,u=(s=i?.attachments)===null||s===void 0?void 0:s.map(()=>crypto.randomUUID()),f=new Array(u?u.length+1:1).fill(0),p=(y,S)=>{var C;f[S]=y;const _=f.reduce((x,k)=>x+k,0);(C=i?.onProgress)===null||C===void 0||C.call(i,_)},v=yield this.streamText({streamId:o,totalSize:d,destinationIdentities:i?.destinationIdentities,topic:i?.topic,attachedStreamIds:u,attributes:i?.attributes});return yield v.write(e),p(1,0),yield v.close(),i?.attachments&&u&&(yield Promise.all(i.attachments.map((y,S)=>E(this,void 0,void 0,function*(){return this._sendFile(u[S],y,{topic:i.topic,mimeType:y.type,onProgress:C=>{p(C,S+1)}})})))),v.info})}streamText(e){return E(this,void 0,void 0,function*(){var i,s,o;const l=(i=e?.streamId)!==null&&i!==void 0?i:crypto.randomUUID(),d={id:l,mimeType:"text/plain",timestamp:Date.now(),topic:(s=e?.topic)!==null&&s!==void 0?s:"",size:e?.totalSize,attributes:e?.attributes,encryptionType:!((o=this.engine.e2eeManager)===null||o===void 0)&&o.isDataChannelEncryptionEnabled?ht.GCM:ht.NONE,attachedStreamIds:e?.attachedStreamIds},u=new Zl({streamId:l,mimeType:d.mimeType,topic:d.topic,timestamp:xa(d.timestamp),totalLength:xa(e?.totalSize),attributes:d.attributes,contentHeader:{case:"textHeader",value:new nS({version:e?.version,attachedStreamIds:d.attachedStreamIds,replyToStreamId:e?.replyToStreamId,operationType:e?.type==="update"?bh.UPDATE:bh.CREATE})}}),f=e?.destinationIdentities,p=new Pt({destinationIdentities:f,value:{case:"streamHeader",value:u}});yield this.engine.sendDataPacket(p,Ce.RELIABLE);let v=0;const y=this.engine,S=new WritableStream({write(x){return E(this,void 0,void 0,function*(){for(const k of iN(x,O0)){const R=new $l({content:k,streamId:l,chunkIndex:xa(v)}),O=new Pt({destinationIdentities:f,value:{case:"streamChunk",value:R}});yield y.sendDataPacket(O,Ce.RELIABLE),v+=1}})},close(){return E(this,void 0,void 0,function*(){const x=new ec({streamId:l}),k=new Pt({destinationIdentities:f,value:{case:"streamTrailer",value:x}});yield y.sendDataPacket(k,Ce.RELIABLE)})},abort(x){console.log("Sink error:",x)}});let C=()=>E(this,void 0,void 0,function*(){yield _.close()});y.once(ie.Closing,C);const _=new uA(S,d,()=>this.engine.off(ie.Closing,C));return _})}sendFile(e,i){return E(this,void 0,void 0,function*(){const s=crypto.randomUUID();return yield this._sendFile(s,e,i),{id:s}})}_sendFile(e,i,s){return E(this,void 0,void 0,function*(){var o;const l=yield this.streamBytes({streamId:e,totalSize:i.size,name:i.name,mimeType:(o=s?.mimeType)!==null&&o!==void 0?o:i.type,topic:s?.topic,destinationIdentities:s?.destinationIdentities}),d=i.stream().getReader();for(;;){const{done:u,value:f}=yield d.read();if(u)break;yield l.write(f)}return yield l.close(),l.info})}streamBytes(e){return E(this,void 0,void 0,function*(){var i,s,o,l,d,u;const f=(i=e?.streamId)!==null&&i!==void 0?i:crypto.randomUUID(),p=e?.destinationIdentities,v={id:f,mimeType:(s=e?.mimeType)!==null&&s!==void 0?s:"application/octet-stream",topic:(o=e?.topic)!==null&&o!==void 0?o:"",timestamp:Date.now(),attributes:e?.attributes,size:e?.totalSize,name:(l=e?.name)!==null&&l!==void 0?l:"unknown",encryptionType:!((d=this.engine.e2eeManager)===null||d===void 0)&&d.isDataChannelEncryptionEnabled?ht.GCM:ht.NONE},y=new Zl({totalLength:xa((u=v.size)!==null&&u!==void 0?u:0),mimeType:v.mimeType,streamId:f,topic:v.topic,timestamp:xa(Date.now()),attributes:v.attributes,contentHeader:{case:"byteHeader",value:new iS({name:v.name})}}),S=new Pt({destinationIdentities:p,value:{case:"streamHeader",value:y}});yield this.engine.sendDataPacket(S,Ce.RELIABLE);let C=0;const _=new It,x=this.engine,k=this.log,R=new WritableStream({write(L){return E(this,void 0,void 0,function*(){const D=yield _.lock();let I=0;try{for(;I<L.byteLength;){const j=L.slice(I,I+O0),H=new Pt({destinationIdentities:p,value:{case:"streamChunk",value:new $l({content:j,streamId:f,chunkIndex:xa(C)})}});yield x.sendDataPacket(H,Ce.RELIABLE),C+=1,I+=j.byteLength}}finally{D()}})},close(){return E(this,void 0,void 0,function*(){const L=new ec({streamId:f}),D=new Pt({destinationIdentities:p,value:{case:"streamTrailer",value:L}});yield x.sendDataPacket(D,Ce.RELIABLE)})},abort(L){k.error("Sink error:",L)}});return new dA(R,v)})}}class fT extends Q{constructor(e,i,s,o,l){super(e,s,l),this.sid=i,this.receiver=o}get isLocal(){return!1}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?$.Muted:$.Unmuted,this))}setMediaStream(e){this.mediaStream=e;const i=s=>{s.track===this._mediaStreamTrack&&(e.removeEventListener("removetrack",i),this.receiver&&"playoutDelayHint"in this.receiver&&(this.receiver.playoutDelayHint=void 0),this.receiver=void 0,this._currentBitrate=0,this.emit($.Ended,this))};e.addEventListener("removetrack",i)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){return E(this,void 0,void 0,function*(){var e;return!((e=this.receiver)===null||e===void 0)&&e.getStats?yield this.receiver.getStats():void 0})}setPlayoutDelay(e){this.receiver?"playoutDelayHint"in this.receiver?this.receiver.playoutDelayHint=e:this.log.warn("Playout delay not supported in this browser"):this.log.warn("Cannot set playout delay, track already ended")}getPlayoutDelay(){if(this.receiver){if("playoutDelayHint"in this.receiver)return this.receiver.playoutDelayHint;this.log.warn("Playout delay not supported in this browser")}else this.log.warn("Cannot get playout delay, track already ended");return 0}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),_f)),PR()&&this.registerTimeSyncUpdate()}registerTimeSyncUpdate(){const e=()=>{var i;this.timeSyncHandle=requestAnimationFrame(()=>e());const s=(i=this.receiver)===null||i===void 0?void 0:i.getSynchronizationSources()[0];if(s){const{timestamp:o,rtpTimestamp:l}=s;l&&this.rtpTimestamp!==l&&(this.emit($.TimeSyncUpdate,{timestamp:o,rtpTimestamp:l}),this.rtpTimestamp=l)}};e()}}class fA extends fT{constructor(e,i,s,o,l,d){super(e,i,Q.Kind.Audio,s,d),this.monitorReceiver=()=>E(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const u=yield this.getReceiverStats();u&&this.prevStats&&this.receiver&&(this._currentBitrate=yc(u,this.prevStats)),this.prevStats=u}),this.audioContext=o,this.webAudioPluginNodes=[],l&&(this.sinkId=l.deviceId)}setVolume(e){var i;for(const s of this.attachedElements)this.audioContext?(i=this.gainNode)===null||i===void 0||i.gain.setTargetAtTime(e,0,.1):s.volume=e;Fn()&&this._mediaStreamTrack._setVolume(e),this.elementVolume=e}getVolume(){if(this.elementVolume)return this.elementVolume;if(Fn())return 1;let e=0;return this.attachedElements.forEach(i=>{i.volume>e&&(e=i.volume)}),e}setSinkId(e){return E(this,void 0,void 0,function*(){this.sinkId=e,yield Promise.all(this.attachedElements.map(i=>{if(Ih(i))return i.setSinkId(e)}))})}attach(e){const i=this.attachedElements.length===0;return e?super.attach(e):e=super.attach(),this.sinkId&&Ih(e)&&e.setSinkId(this.sinkId).catch(s=>{this.log.error("Failed to set sink id on remote audio track",s,this.logContext)}),this.audioContext&&i&&(this.log.debug("using audio context mapping",this.logContext),this.connectWebAudio(this.audioContext,e),e.volume=0,e.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),e}detach(e){let i;return e?(i=super.detach(e),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(i=super.detach(),this.disconnectWebAudio()),i}setAudioContext(e){this.audioContext=e,e&&this.attachedElements.length>0?this.connectWebAudio(e,this.attachedElements[0]):e||this.disconnectWebAudio()}setWebAudioPlugins(e){this.webAudioPluginNodes=e,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(e,i){this.disconnectWebAudio(),this.sourceNode=e.createMediaStreamSource(i.srcObject);let s=this.sourceNode;this.webAudioPluginNodes.forEach(o=>{s.connect(o),s=o}),this.gainNode=e.createGain(),s.connect(this.gainNode),this.gainNode.connect(e.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),e.state!=="running"&&e.resume().then(()=>{e.state!=="running"&&this.emit($.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(o=>{this.emit($.AudioPlaybackFailed,o)})}disconnectWebAudio(){var e,i;(e=this.gainNode)===null||e===void 0||e.disconnect(),(i=this.sourceNode)===null||i===void 0||i.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return E(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let i;return e.forEach(s=>{s.type==="inbound-rtp"&&(i={type:"audio",streamId:s.id,timestamp:s.timestamp,jitter:s.jitter,bytesReceived:s.bytesReceived,concealedSamples:s.concealedSamples,concealmentEvents:s.concealmentEvents,silentConcealedSamples:s.silentConcealedSamples,silentConcealmentEvents:s.silentConcealmentEvents,totalAudioEnergy:s.totalAudioEnergy,totalSamplesDuration:s.totalSamplesDuration})}),i})}}const hh=100;class mA extends fT{constructor(e,i,s,o,l){super(e,i,Q.Kind.Video,s,l),this.elementInfos=[],this.monitorReceiver=()=>E(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const d=yield this.getReceiverStats();d&&this.prevStats&&this.receiver&&(this._currentBitrate=yc(d,this.prevStats)),this.prevStats=d}),this.debouncedHandleResize=kf(()=>{this.updateDimensions()},hh),this.adaptiveStreamSettings=o}get isAdaptiveStream(){return this.adaptiveStreamSettings!==void 0}setStreamState(e){super.setStreamState(e),this.log.debug("setStreamState",e),this.isAdaptiveStream&&e===Q.StreamState.Active&&this.updateVisibility()}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(e){super.setMuted(e),this.attachedElements.forEach(i=>{e?_s(this._mediaStreamTrack,i):Cs(this._mediaStreamTrack,i)})}attach(e){if(e?super.attach(e):e=super.attach(),this.adaptiveStreamSettings&&this.elementInfos.find(i=>i.element===e)===void 0){const i=new pA(e);this.observeElementInfo(i)}return e}observeElementInfo(e){this.adaptiveStreamSettings&&this.elementInfos.find(i=>i===e)===void 0?(e.handleResize=()=>{this.debouncedHandleResize()},e.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(e),e.observe(),this.debouncedHandleResize(),this.updateVisibility()):this.log.warn("visibility resize observer not triggered",this.logContext)}stopObservingElementInfo(e){if(!this.isAdaptiveStream){this.log.warn("stopObservingElementInfo ignored",this.logContext);return}const i=this.elementInfos.filter(s=>s===e);for(const s of i)s.stopObserving();this.elementInfos=this.elementInfos.filter(s=>s!==e),this.updateVisibility(),this.debouncedHandleResize()}detach(e){let i=[];if(e)return this.stopObservingElement(e),super.detach(e);i=super.detach();for(const s of i)this.stopObservingElement(s);return i}getDecoderImplementation(){var e;return(e=this.prevStats)===null||e===void 0?void 0:e.decoderImplementation}getReceiverStats(){return E(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let i,s="",o=new Map;return e.forEach(l=>{l.type==="inbound-rtp"?(s=l.codecId,i={type:"video",streamId:l.id,framesDecoded:l.framesDecoded,framesDropped:l.framesDropped,framesReceived:l.framesReceived,packetsReceived:l.packetsReceived,packetsLost:l.packetsLost,frameWidth:l.frameWidth,frameHeight:l.frameHeight,pliCount:l.pliCount,firCount:l.firCount,nackCount:l.nackCount,jitter:l.jitter,timestamp:l.timestamp,bytesReceived:l.bytesReceived,decoderImplementation:l.decoderImplementation}):l.type==="codec"&&o.set(l.id,l)}),i&&s!==""&&o.get(s)&&(i.mimeType=o.get(s).mimeType),i})}stopObservingElement(e){const i=this.elementInfos.filter(s=>s.element===e);for(const s of i)this.stopObservingElementInfo(s)}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return E(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()})}updateVisibility(e){var i,s;const o=this.elementInfos.reduce((f,p)=>Math.max(f,p.visibilityChangedAt||0),0),l=!((s=(i=this.adaptiveStreamSettings)===null||i===void 0?void 0:i.pauseVideoInBackground)!==null&&s!==void 0)||s?this.isInBackground:!1,d=this.elementInfos.some(f=>f.pictureInPicture),u=this.elementInfos.some(f=>f.visible)&&!l||d;if(!(this.lastVisible===u&&!e)){if(!u&&Date.now()-o<hh){Rt.setTimeout(()=>{this.updateVisibility()},hh);return}this.lastVisible=u,this.emit($.VisibilityChanged,u,this)}}updateDimensions(){var e,i;let s=0,o=0;const l=this.getPixelDensity();for(const d of this.elementInfos){const u=d.width()*l,f=d.height()*l;u+f>s+o&&(s=u,o=f)}((e=this.lastDimensions)===null||e===void 0?void 0:e.width)===s&&((i=this.lastDimensions)===null||i===void 0?void 0:i.height)===o||(this.lastDimensions={width:s,height:o},this.emit($.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var e;const i=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pixelDensity;return i==="screen"?o0():i||(o0()>2?2:1)}}class pA{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(e,i){this.onVisibilityChanged=s=>{var o;const{target:l,isIntersecting:d}=s;l===this.element&&(this.isIntersecting=d,this.isPiP=Lr(this.element),this.visibilityChangedAt=Date.now(),(o=this.handleVisibilityChanged)===null||o===void 0||o.call(this))},this.onEnterPiP=()=>{var s,o,l;(o=(s=window.documentPictureInPicture)===null||s===void 0?void 0:s.window)===null||o===void 0||o.addEventListener("pagehide",this.onLeavePiP),this.isPiP=Lr(this.element),(l=this.handleVisibilityChanged)===null||l===void 0||l.call(this)},this.onLeavePiP=()=>{var s;this.isPiP=Lr(this.element),(s=this.handleVisibilityChanged)===null||s===void 0||s.call(this)},this.element=e,this.isIntersecting=i??zh(e),this.isPiP=Kt()&&Lr(e),this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){var e,i,s;this.isIntersecting=zh(this.element),this.isPiP=Lr(this.element),this.element.handleResize=()=>{var o;(o=this.handleResize)===null||o===void 0||o.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,c0().observe(this.element),l0().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP),(e=window.documentPictureInPicture)===null||e===void 0||e.addEventListener("enter",this.onEnterPiP),(s=(i=window.documentPictureInPicture)===null||i===void 0?void 0:i.window)===null||s===void 0||s.addEventListener("pagehide",this.onLeavePiP)}stopObserving(){var e,i,s,o,l;(e=c0())===null||e===void 0||e.unobserve(this.element),(i=l0())===null||i===void 0||i.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP),(s=window.documentPictureInPicture)===null||s===void 0||s.removeEventListener("enter",this.onEnterPiP),(l=(o=window.documentPictureInPicture)===null||o===void 0?void 0:o.window)===null||l===void 0||l.removeEventListener("pagehide",this.onLeavePiP)}}function Lr(a){var e,i;return document.pictureInPictureElement===a?!0:!((e=window.documentPictureInPicture)===null||e===void 0)&&e.window?zh(a,(i=window.documentPictureInPicture)===null||i===void 0?void 0:i.window):!1}function zh(a,e){const i=e||window;let s=a.offsetTop,o=a.offsetLeft;const l=a.offsetWidth,d=a.offsetHeight,{hidden:u}=a,{display:f}=getComputedStyle(a);for(;a.offsetParent;)a=a.offsetParent,s+=a.offsetTop,o+=a.offsetLeft;return s<i.pageYOffset+i.innerHeight&&o<i.pageXOffset+i.innerWidth&&s+d>i.pageYOffset&&o+l>i.pageXOffset&&!u&&f!=="none"}class ui extends Vn.EventEmitter{constructor(e,i,s,o){var l;super(),this.metadataMuted=!1,this.encryption=ht.NONE,this.log=Se,this.handleMuted=()=>{this.emit($.Muted)},this.handleUnmuted=()=>{this.emit($.Unmuted)},this.log=qn((l=o?.loggerName)!==null&&l!==void 0?l:Sn.Publication),this.loggerContextCb=this.loggerContextCb,this.setMaxListeners(100),this.kind=e,this.trackSid=i,this.trackName=s,this.source=Q.Source.Unknown}setTrack(e){this.track&&(this.track.off($.Muted,this.handleMuted),this.track.off($.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on($.Muted,this.handleMuted),e.on($.Unmuted,this.handleUnmuted))}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),Ee(this))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return this.track!==void 0}get isEncrypted(){return this.encryption!==ht.NONE}get audioTrack(){if(Bn(this.track))return this.track}get videoTrack(){if(na(this.track))return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=Q.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===Q.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.encryption=e.encryption,this.trackInfo=e,this.log.debug("update publication info",Object.assign(Object.assign({},this.logContext),{info:e}))}}(function(a){(function(e){e.Desired="desired",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed"})(a.SubscriptionStatus||(a.SubscriptionStatus={})),(function(e){e.Allowed="allowed",e.NotAllowed="not_allowed"})(a.PermissionStatus||(a.PermissionStatus={}))})(ui||(ui={}));class Hh extends ui{get isUpstreamPaused(){var e;return(e=this.track)===null||e===void 0?void 0:e.isUpstreamPaused}constructor(e,i,s,o){super(e,i.sid,i.name,o),this.track=void 0,this.handleTrackEnded=()=>{this.emit($.Ended)},this.handleCpuConstrained=()=>{this.track&&na(this.track)&&this.emit($.CpuConstrained,this.track)},this.updateInfo(i),this.setTrack(s)}setTrack(e){this.track&&(this.track.off($.Ended,this.handleTrackEnded),this.track.off($.CpuConstrained,this.handleCpuConstrained)),super.setTrack(e),e&&(e.on($.Ended,this.handleTrackEnded),e.on($.CpuConstrained,this.handleCpuConstrained))}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}get isLocal(){return!0}mute(){return E(this,void 0,void 0,function*(){var e;return(e=this.track)===null||e===void 0?void 0:e.mute()})}unmute(){return E(this,void 0,void 0,function*(){var e;return(e=this.track)===null||e===void 0?void 0:e.unmute()})}pauseUpstream(){return E(this,void 0,void 0,function*(){var e;yield(e=this.track)===null||e===void 0?void 0:e.pauseUpstream()})}resumeUpstream(){return E(this,void 0,void 0,function*(){var e;yield(e=this.track)===null||e===void 0?void 0:e.resumeUpstream()})}getTrackFeatures(){var e;if(Bn(this.track)){const i=this.track.getSourceTrackSettings(),s=new Set;return i.autoGainControl&&s.add(Tt.TF_AUTO_GAIN_CONTROL),i.echoCancellation&&s.add(Tt.TF_ECHO_CANCELLATION),i.noiseSuppression&&s.add(Tt.TF_NOISE_SUPPRESSION),i.channelCount&&i.channelCount>1&&s.add(Tt.TF_STEREO),!((e=this.options)===null||e===void 0)&&e.dtx||s.add(Tt.TF_NO_DTX),this.track.enhancedNoiseCancellation&&s.add(Tt.TF_ENHANCED_NOISE_CANCELLATION),Array.from(s.values())}else return[]}}function bc(a,e){return E(this,void 0,void 0,function*(){a??(a={});let i=!1;const{audioProcessor:s,videoProcessor:o,optionsWithoutProcessor:l}=$S(a);let d=l.audio,u=l.video;if(s&&typeof l.audio=="object"&&(l.audio.processor=s),o&&typeof l.video=="object"&&(l.video.processor=o),a.audio&&typeof l.audio=="object"&&typeof l.audio.deviceId=="string"){const y=l.audio.deviceId;l.audio.deviceId={exact:y},i=!0,d=Object.assign(Object.assign({},l.audio),{deviceId:{ideal:y}})}if(l.video&&typeof l.video=="object"&&typeof l.video.deviceId=="string"){const y=l.video.deviceId;l.video.deviceId={exact:y},i=!0,u=Object.assign(Object.assign({},l.video),{deviceId:{ideal:y}})}l.audio===!0?l.audio={deviceId:"default"}:typeof l.audio=="object"&&l.audio!==null&&(l.audio=Object.assign(Object.assign({},l.audio),{deviceId:l.audio.deviceId||"default"})),l.video===!0?l.video={deviceId:"default"}:typeof l.video=="object"&&!l.video.deviceId&&(l.video.deviceId="default");const f=WS(l,aT,sT),p=bf(f),v=navigator.mediaDevices.getUserMedia(p);l.audio&&(Ct.userMediaPromiseMap.set("audioinput",v),v.catch(()=>Ct.userMediaPromiseMap.delete("audioinput"))),l.video&&(Ct.userMediaPromiseMap.set("videoinput",v),v.catch(()=>Ct.userMediaPromiseMap.delete("videoinput")));try{const y=yield v;return yield Promise.all(y.getTracks().map(S=>E(this,void 0,void 0,function*(){const C=S.kind==="audio";let _=C?f.audio:f.video;(typeof _=="boolean"||!_)&&(_={});let x;const k=C?p.audio:p.video;typeof k!="boolean"&&(x=k);const R=S.getSettings().deviceId;x?.deviceId&&wa(x.deviceId)!==R?x.deviceId=R:x||(x={deviceId:R});const O=HN(S,x,e);return O.kind===Q.Kind.Video?O.source=Q.Source.Camera:O.kind===Q.Kind.Audio&&(O.source=Q.Source.Microphone),O.mediaStream=y,Bn(O)&&s?yield O.setProcessor(s):na(O)&&o&&(yield O.setProcessor(o)),O})))}catch(y){if(!i)throw y;return bc(Object.assign(Object.assign({},a),{audio:d,video:u}),e)}})}function gA(a){return E(this,void 0,void 0,function*(){return(yield bc({audio:!1,video:!0}))[0]})}function mT(a){return E(this,void 0,void 0,function*(){return(yield bc({audio:a??!0,video:!1}))[0]})}var Ji;(function(a){a.Excellent="excellent",a.Good="good",a.Poor="poor",a.Lost="lost",a.Unknown="unknown"})(Ji||(Ji={}));function vA(a){switch(a){case Ur.EXCELLENT:return Ji.Excellent;case Ur.GOOD:return Ji.Good;case Ur.POOR:return Ji.Poor;case Ur.LOST:return Ji.Lost;default:return Ji.Unknown}}class pT extends Vn.EventEmitter{get logContext(){var e,i;return Object.assign({},(i=(e=this.loggerOptions)===null||e===void 0?void 0:e.loggerContextCb)===null||i===void 0?void 0:i.call(e))}get isEncrypted(){return this.trackPublications.size>0&&Array.from(this.trackPublications.values()).every(e=>e.isEncrypted)}get isAgent(){var e;return((e=this.permissions)===null||e===void 0?void 0:e.agent)||this.kind===Qr.AGENT}get isActive(){var e;return((e=this.participantInfo)===null||e===void 0?void 0:e.state)===xs.ACTIVE}get kind(){return this._kind}get attributes(){return Object.freeze(Object.assign({},this._attributes))}constructor(e,i,s,o,l,d){let u=arguments.length>6&&arguments[6]!==void 0?arguments[6]:Qr.STANDARD;var f;super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=Ji.Unknown,this.log=Se,this.log=qn((f=d?.loggerName)!==null&&f!==void 0?f:Sn.Participant),this.loggerOptions=d,this.setMaxListeners(100),this.sid=e,this.identity=i,this.name=s,this.metadata=o,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this._kind=u,this._attributes=l??{}}getTrackPublications(){return Array.from(this.trackPublications.values())}getTrackPublication(e){for(const[,i]of this.trackPublications)if(i.source===e)return i}getTrackPublicationByName(e){for(const[,i]of this.trackPublications)if(i.trackName===e)return i}waitUntilActive(){return this.isActive?Promise.resolve():this.activeFuture?this.activeFuture.promise:(this.activeFuture=new bn,this.once(ae.Active,()=>{var e,i;(i=(e=this.activeFuture)===null||e===void 0?void 0:e.resolve)===null||i===void 0||i.call(e),this.activeFuture=void 0}),this.activeFuture.promise)}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const i=this.getTrackPublication(Q.Source.Camera);return!(!((e=i?.isMuted)!==null&&e!==void 0)||e)}get isMicrophoneEnabled(){var e;const i=this.getTrackPublication(Q.Source.Microphone);return!(!((e=i?.isMuted)!==null&&e!==void 0)||e)}get isScreenShareEnabled(){return!!this.getTrackPublication(Q.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(Number.parseInt(this.participantInfo.joinedAt.toString())*1e3):new Date}updateInfo(e){var i;return this.participantInfo&&this.participantInfo.sid===e.sid&&this.participantInfo.version>e.version?!1:(this.identity=e.identity,this.sid=e.sid,this._setName(e.name),this._setMetadata(e.metadata),this._setAttributes(e.attributes),e.state===xs.ACTIVE&&((i=this.participantInfo)===null||i===void 0?void 0:i.state)!==xs.ACTIVE&&this.emit(ae.Active),e.permission&&this.setPermissions(e.permission),this.participantInfo=e,!0)}_setMetadata(e){const i=this.metadata!==e,s=this.metadata;this.metadata=e,i&&this.emit(ae.ParticipantMetadataChanged,s)}_setName(e){const i=this.name!==e;this.name=e,i&&this.emit(ae.ParticipantNameChanged,e)}_setAttributes(e){const i=IR(this.attributes,e);this._attributes=e,Object.keys(i).length>0&&this.emit(ae.AttributesChanged,i)}setPermissions(e){var i,s,o,l,d,u;const f=this.permissions,p=e.canPublish!==((i=this.permissions)===null||i===void 0?void 0:i.canPublish)||e.canSubscribe!==((s=this.permissions)===null||s===void 0?void 0:s.canSubscribe)||e.canPublishData!==((o=this.permissions)===null||o===void 0?void 0:o.canPublishData)||e.hidden!==((l=this.permissions)===null||l===void 0?void 0:l.hidden)||e.recorder!==((d=this.permissions)===null||d===void 0?void 0:d.recorder)||e.canPublishSources.length!==this.permissions.canPublishSources.length||e.canPublishSources.some((v,y)=>{var S;return v!==((S=this.permissions)===null||S===void 0?void 0:S.canPublishSources[y])})||e.canSubscribeMetrics!==((u=this.permissions)===null||u===void 0?void 0:u.canSubscribeMetrics);return this.permissions=e,p&&this.emit(ae.ParticipantPermissionsChanged,f),p}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(ae.IsSpeakingChanged,e))}setConnectionQuality(e){const i=this._connectionQuality;this._connectionQuality=vA(e),i!==this._connectionQuality&&this.emit(ae.ConnectionQualityChanged,this._connectionQuality)}setDisconnected(){var e,i;this.activeFuture&&((i=(e=this.activeFuture).reject)===null||i===void 0||i.call(e,new Error("Participant disconnected")),this.activeFuture=void 0)}setAudioContext(e){this.audioContext=e,this.audioTrackPublications.forEach(i=>Bn(i.track)&&i.track.setAudioContext(e))}addTrackPublication(e){e.on($.Muted,()=>{this.emit(ae.TrackMuted,e)}),e.on($.Unmuted,()=>{this.emit(ae.TrackUnmuted,e)});const i=e;switch(i.track&&(i.track.sid=e.trackSid),this.trackPublications.set(e.trackSid,e),e.kind){case Q.Kind.Audio:this.audioTrackPublications.set(e.trackSid,e);break;case Q.Kind.Video:this.videoTrackPublications.set(e.trackSid,e);break}}}function yA(a){var e,i,s;if(!a.participantSid&&!a.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new dS({participantIdentity:(e=a.participantIdentity)!==null&&e!==void 0?e:"",participantSid:(i=a.participantSid)!==null&&i!==void 0?i:"",allTracks:(s=a.allowAll)!==null&&s!==void 0?s:!1,trackSids:a.allowedTrackSids||[]})}class bA extends pT{constructor(e,i,s,o,l,d){super(e,i,void 0,void 0,void 0,{loggerName:o.loggerName,loggerContextCb:()=>this.engine.logContext}),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=ht.NONE,this.enabledPublishVideoCodecs=[],this.pendingAcks=new Map,this.pendingResponses=new Map,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new bn)},this.handleReconnected=()=>{var u,f;(f=(u=this.reconnectFuture)===null||u===void 0?void 0:u.resolve)===null||f===void 0||f.call(u),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleClosing=()=>{var u,f,p,v,y,S;this.reconnectFuture&&(this.reconnectFuture.promise.catch(C=>this.log.warn(C.message,this.logContext)),(f=(u=this.reconnectFuture)===null||u===void 0?void 0:u.reject)===null||f===void 0||f.call(u,new Error("Got disconnected during reconnection attempt")),this.reconnectFuture=void 0),this.signalConnectedFuture&&((v=(p=this.signalConnectedFuture).reject)===null||v===void 0||v.call(p,new Error("Got disconnected without signal connected")),this.signalConnectedFuture=void 0),(S=(y=this.activeAgentFuture)===null||y===void 0?void 0:y.reject)===null||S===void 0||S.call(y,new Error("Got disconnected without active agent present")),this.activeAgentFuture=void 0,this.firstActiveAgent=void 0},this.handleSignalConnected=u=>{var f,p;u.participant&&this.updateInfo(u.participant),this.signalConnectedFuture||(this.signalConnectedFuture=new bn),(p=(f=this.signalConnectedFuture).resolve)===null||p===void 0||p.call(f)},this.handleSignalRequestResponse=u=>{const{requestId:f,reason:p,message:v}=u,y=this.pendingSignalRequests.get(f);y&&(p!==mf.OK&&y.reject(new n0(v,p)),this.pendingSignalRequests.delete(f))},this.handleDataPacket=u=>{switch(u.value.case){case"rpcResponse":let f=u.value.value,p=null,v=null;f.value.case==="payload"?p=f.value.value:f.value.case==="error"&&(v=rt.fromProto(f.value.value)),this.handleIncomingRpcResponse(f.requestId,p,v);break;case"rpcAck":let y=u.value.value;this.handleIncomingRpcAck(y.requestId);break}},this.updateTrackSubscriptionPermissions=()=>{this.log.debug("updating track subscription permissions",Object.assign(Object.assign({},this.logContext),{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions})),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(u=>yA(u)))},this.onTrackUnmuted=u=>{this.onTrackMuted(u,u.isUpstreamPaused)},this.onTrackMuted=(u,f)=>{if(f===void 0&&(f=!0),!u.sid){this.log.error("could not update mute status for unpublished track",Object.assign(Object.assign({},this.logContext),Ee(u)));return}this.engine.updateMuteStatus(u.sid,f)},this.onTrackUpstreamPaused=u=>{this.log.debug("upstream paused",Object.assign(Object.assign({},this.logContext),Ee(u))),this.onTrackMuted(u,!0)},this.onTrackUpstreamResumed=u=>{this.log.debug("upstream resumed",Object.assign(Object.assign({},this.logContext),Ee(u))),this.onTrackMuted(u,u.isMuted)},this.onTrackFeatureUpdate=u=>{const f=this.audioTrackPublications.get(u.sid);if(!f){this.log.warn("Could not update local audio track settings, missing publication for track ".concat(u.sid),this.logContext);return}this.engine.client.sendUpdateLocalAudioTrack(f.trackSid,f.getTrackFeatures())},this.onTrackCpuConstrained=(u,f)=>{this.log.debug("track cpu constrained",Object.assign(Object.assign({},this.logContext),Ee(f))),this.emit(ae.LocalTrackCpuConstrained,u,f)},this.handleSubscribedQualityUpdate=u=>E(this,void 0,void 0,function*(){var f,p,v,y,S;if(!(!((S=this.roomOptions)===null||S===void 0)&&S.dynacast))return;const C=this.videoTrackPublications.get(u.trackSid);if(!C){this.log.warn("received subscribed quality update for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:u.trackSid}));return}if(!C.videoTrack)return;const _=yield C.videoTrack.setPublishingCodecs(u.subscribedCodecs);try{for(var x=!0,k=mi(_),R;R=yield k.next(),f=R.done,!f;x=!0){y=R.value,x=!1;const O=y;MR(O)&&(this.log.debug("publish ".concat(O," for ").concat(C.videoTrack.sid),Object.assign(Object.assign({},this.logContext),Ee(C))),yield this.publishAdditionalCodecForTrack(C.videoTrack,O,C.options))}}catch(O){p={error:O}}finally{try{!x&&!f&&(v=k.return)&&(yield v.call(k))}finally{if(p)throw p.error}}}),this.handleLocalTrackUnpublished=u=>{const f=this.trackPublications.get(u.trackSid);if(!f){this.log.warn("received unpublished event for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:u.trackSid}));return}this.unpublishTrack(f.track)},this.handleTrackEnded=u=>E(this,void 0,void 0,function*(){if(u.source===Q.Source.ScreenShare||u.source===Q.Source.ScreenShareAudio)this.log.debug("unpublishing local track due to TrackEnded",Object.assign(Object.assign({},this.logContext),Ee(u))),this.unpublishTrack(u);else if(u.isUserProvided)yield u.mute();else if(ci(u)||Ki(u))try{if(Kt())try{const f=yield navigator?.permissions.query({name:u.source===Q.Source.Camera?"camera":"microphone"});if(f&&f.state==="denied")throw this.log.warn("user has revoked access to ".concat(u.source),Object.assign(Object.assign({},this.logContext),Ee(u))),f.onchange=()=>{f.state!=="denied"&&(u.isMuted||u.restartTrack(),f.onchange=null)},new Error("GetUserMedia Permission denied")}catch{}u.isMuted||(this.log.debug("track ended, attempting to use a different device",Object.assign(Object.assign({},this.logContext),Ee(u))),ci(u)?yield u.restartTrack({deviceId:"default"}):yield u.restartTrack())}catch{this.log.warn("could not restart track, muting instead",Object.assign(Object.assign({},this.logContext),Ee(u))),yield u.mute()}}),this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this.engine=s,this.roomOptions=o,this.setupEngine(s),this.activeDeviceMap=new Map([["audioinput","default"],["videoinput","default"],["audiooutput","default"]]),this.pendingSignalRequests=new Map,this.rpcHandlers=l,this.roomOutgoingDataStreamManager=d}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==ht.NONE}getTrackPublication(e){const i=super.getTrackPublication(e);if(i)return i}getTrackPublicationByName(e){const i=super.getTrackPublicationByName(e);if(i)return i}setupEngine(e){var i;this.engine=e,this.engine.on(ie.RemoteMute,(s,o)=>{const l=this.trackPublications.get(s);!l||!l.track||(o?l.mute():l.unmute())}),!((i=this.signalConnectedFuture)===null||i===void 0)&&i.isResolved&&(this.signalConnectedFuture=void 0),this.engine.on(ie.Connected,this.handleReconnected).on(ie.SignalConnected,this.handleSignalConnected).on(ie.SignalRestarted,this.handleReconnected).on(ie.SignalResumed,this.handleReconnected).on(ie.Restarting,this.handleReconnecting).on(ie.Resuming,this.handleReconnecting).on(ie.LocalTrackUnpublished,this.handleLocalTrackUnpublished).on(ie.SubscribedQualityUpdate,this.handleSubscribedQualityUpdate).on(ie.Closing,this.handleClosing).on(ie.SignalRequestResponse,this.handleSignalRequestResponse).on(ie.DataPacketReceived,this.handleDataPacket)}setMetadata(e){return E(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({metadata:e})})}setName(e){return E(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({name:e})})}setAttributes(e){return E(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({attributes:e})})}requestMetadataUpdate(e){return E(this,arguments,void 0,function(i){var s=this;let{metadata:o,name:l,attributes:d}=i;return(function*(){return new Mt((u,f)=>E(s,void 0,void 0,function*(){var p,v;try{let y=!1;const S=yield this.engine.client.sendUpdateLocalMetadata((p=o??this.metadata)!==null&&p!==void 0?p:"",(v=l??this.name)!==null&&v!==void 0?v:"",d),C=performance.now();for(this.pendingSignalRequests.set(S,{resolve:u,reject:_=>{f(_),y=!0},values:{name:l,metadata:o,attributes:d}});performance.now()-C<5e3&&!y;){if((!l||this.name===l)&&(!o||this.metadata===o)&&(!d||Object.entries(d).every(_=>{let[x,k]=_;return this.attributes[x]===k||k===""&&!this.attributes[x]}))){this.pendingSignalRequests.delete(S),u();return}yield Nt(50)}f(new n0("Request to update local metadata timed out","TimeoutError"))}catch(y){y instanceof Error?f(y):f(new Error(String(y)))}}))})()})}setCameraEnabled(e,i,s){return this.setTrackEnabled(Q.Source.Camera,e,i,s)}setMicrophoneEnabled(e,i,s){return this.setTrackEnabled(Q.Source.Microphone,e,i,s)}setScreenShareEnabled(e,i,s){return this.setTrackEnabled(Q.Source.ScreenShare,e,i,s)}setE2EEEnabled(e){return E(this,void 0,void 0,function*(){this.encryptionType=e?ht.GCM:ht.NONE,yield this.republishAllTracks(void 0,!1)})}setTrackEnabled(e,i,s,o){return E(this,void 0,void 0,function*(){var l,d;this.log.debug("setTrackEnabled",Object.assign(Object.assign({},this.logContext),{source:e,enabled:i})),this.republishPromise&&(yield this.republishPromise);let u=this.getTrackPublication(e);if(i)if(u)yield u.unmute();else{let f;if(this.pendingPublishing.has(e)){const p=yield this.waitForPendingPublicationOfSource(e);return p||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e})),yield p?.unmute(),p}this.pendingPublishing.add(e);try{switch(e){case Q.Source.Camera:f=yield this.createTracks({video:(l=s)!==null&&l!==void 0?l:!0});break;case Q.Source.Microphone:f=yield this.createTracks({audio:(d=s)!==null&&d!==void 0?d:!0});break;case Q.Source.ScreenShare:f=yield this.createScreenTracks(Object.assign({},s));break;default:throw new pi(e)}}catch(p){throw f?.forEach(v=>{v.stop()}),p instanceof Error&&this.emit(ae.MediaDevicesError,p,Oh(e)),this.pendingPublishing.delete(e),p}for(const p of f){const v=Object.assign(Object.assign({},this.roomOptions.publishDefaults),s);e===Q.Source.Microphone&&Bn(p)&&v.preConnectBuffer&&(this.log.info("starting preconnect buffer for microphone",Object.assign({},this.logContext)),p.startPreConnectBuffer())}try{const p=[];for(const y of f)this.log.info("publishing track",Object.assign(Object.assign({},this.logContext),Ee(y))),p.push(this.publishTrack(y,o));[u]=yield Promise.all(p)}catch(p){throw f?.forEach(v=>{v.stop()}),p}finally{this.pendingPublishing.delete(e)}}else if(!u?.track&&this.pendingPublishing.has(e)&&(u=yield this.waitForPendingPublicationOfSource(e),u||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e}))),u&&u.track)if(e===Q.Source.ScreenShare){u=yield this.unpublishTrack(u.track);const f=this.getTrackPublication(Q.Source.ScreenShareAudio);f&&f.track&&this.unpublishTrack(f.track)}else yield u.mute();return u})}enableCameraAndMicrophone(){return E(this,void 0,void 0,function*(){if(!(this.pendingPublishing.has(Q.Source.Camera)||this.pendingPublishing.has(Q.Source.Microphone))){this.pendingPublishing.add(Q.Source.Camera),this.pendingPublishing.add(Q.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map(i=>this.publishTrack(i)))}finally{this.pendingPublishing.delete(Q.Source.Camera),this.pendingPublishing.delete(Q.Source.Microphone)}}})}createTracks(e){return E(this,void 0,void 0,function*(){var i,s;e??(e={});const o=WS(e,(i=this.roomOptions)===null||i===void 0?void 0:i.audioCaptureDefaults,(s=this.roomOptions)===null||s===void 0?void 0:s.videoCaptureDefaults);try{return(yield bc(o,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext})).map(u=>(Bn(u)&&(this.microphoneError=void 0,u.setAudioContext(this.audioContext),u.source=Q.Source.Microphone,this.emit(ae.AudioStreamAcquired)),na(u)&&(this.cameraError=void 0,u.source=Q.Source.Camera),u))}catch(l){throw l instanceof Error&&(e.audio&&(this.microphoneError=l),e.video&&(this.cameraError=l)),l}})}createScreenTracks(e){return E(this,void 0,void 0,function*(){if(e===void 0&&(e={}),navigator.mediaDevices.getDisplayMedia===void 0)throw new vf("getDisplayMedia not supported");e.resolution===void 0&&!GR()&&(e.resolution=yf.h1080fps30.resolution);const i=OR(e),s=yield navigator.mediaDevices.getDisplayMedia(i),o=s.getVideoTracks();if(o.length===0)throw new pi("no video track found");const l=new ic(o[0],void 0,!1,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});l.source=Q.Source.ScreenShare,e.contentHint&&(l.mediaStreamTrack.contentHint=e.contentHint);const d=[l];if(s.getAudioTracks().length>0){this.emit(ae.AudioStreamAcquired);const u=new nc(s.getAudioTracks()[0],void 0,!1,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});u.source=Q.Source.ScreenShareAudio,d.push(u)}return d})}publishTrack(e,i){return E(this,void 0,void 0,function*(){return this.publishOrRepublishTrack(e,i)})}publishOrRepublishTrack(e,i){return E(this,arguments,void 0,function(s,o){var l=this;let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return(function*(){var u,f,p,v;ci(s)&&s.setAudioContext(l.audioContext),yield(u=l.reconnectFuture)===null||u===void 0?void 0:u.promise,l.republishPromise&&!d&&(yield l.republishPromise),Rs(s)&&l.pendingPublishPromises.has(s)&&(yield l.pendingPublishPromises.get(s));let y;if(s instanceof MediaStreamTrack)y=s.getConstraints();else{y=s.constraints;let R;switch(s.source){case Q.Source.Microphone:R="audioinput";break;case Q.Source.Camera:R="videoinput"}R&&l.activeDeviceMap.has(R)&&(y=Object.assign(Object.assign({},y),{deviceId:l.activeDeviceMap.get(R)}))}if(s instanceof MediaStreamTrack)switch(s.kind){case"audio":s=new nc(s,y,!0,l.audioContext,{loggerName:l.roomOptions.loggerName,loggerContextCb:()=>l.logContext});break;case"video":s=new ic(s,y,!0,{loggerName:l.roomOptions.loggerName,loggerContextCb:()=>l.logContext});break;default:throw new pi("unsupported MediaStreamTrack kind ".concat(s.kind))}else s.updateLoggerOptions({loggerName:l.roomOptions.loggerName,loggerContextCb:()=>l.logContext});let S;if(l.trackPublications.forEach(R=>{R.track&&R.track===s&&(S=R)}),S)return l.log.warn("track has already been published, skipping",Object.assign(Object.assign({},l.logContext),Ee(S))),S;const C=Object.assign(Object.assign({},l.roomOptions.publishDefaults),o),_="channelCount"in s.mediaStreamTrack.getSettings()&&s.mediaStreamTrack.getSettings().channelCount===2||s.mediaStreamTrack.getConstraints().channelCount===2,x=(f=C.forceStereo)!==null&&f!==void 0?f:_;x&&(C.dtx===void 0&&l.log.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work.",Object.assign(Object.assign({},l.logContext),Ee(s))),C.red===void 0&&l.log.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),(p=C.dtx)!==null&&p!==void 0||(C.dtx=!1),(v=C.red)!==null&&v!==void 0||(C.red=!1)),!YR()&&l.roomOptions.e2ee&&(l.log.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari versions and iOS browsers running iOS < v17.2",Object.assign({},l.logContext)),C.simulcast=!1),C.source&&(s.source=C.source);const k=new Promise((R,O)=>E(l,void 0,void 0,function*(){try{if(this.engine.client.currentState!==Je.CONNECTED){this.log.debug("deferring track publication until signal is connected",Object.assign(Object.assign({},this.logContext),{track:Ee(s)}));let L=!1;const D=setTimeout(()=>{L=!0,s.stop(),O(new t0("publishing rejected as engine not connected within timeout",408))},15e3);if(yield this.waitUntilEngineConnected(),clearTimeout(D),L)return;const I=yield this.publish(s,C,x);R(I)}else try{const L=yield this.publish(s,C,x);R(L)}catch(L){O(L)}}catch(L){O(L)}}));l.pendingPublishPromises.set(s,k);try{return yield k}catch(R){throw R}finally{l.pendingPublishPromises.delete(s)}})()})}waitUntilEngineConnected(){return this.signalConnectedFuture||(this.signalConnectedFuture=new bn),this.signalConnectedFuture.promise}hasPermissionsToPublish(e){if(!this.permissions)return this.log.warn("no permissions present for publishing track",Object.assign(Object.assign({},this.logContext),Ee(e))),!1;const{canPublish:i,canPublishSources:s}=this.permissions;return i&&(s.length===0||s.map(o=>LR(o)).includes(e.source))?!0:(this.log.warn("insufficient permissions to publish",Object.assign(Object.assign({},this.logContext),Ee(e))),!1)}publish(e,i,s){return E(this,void 0,void 0,function*(){var o,l,d,u,f,p,v,y,S,C;if(!this.hasPermissionsToPublish(e))throw new t0("failed to publish track, insufficient permissions",403);Array.from(this.trackPublications.values()).find(ee=>Rs(e)&&ee.source===e.source)&&e.source!==Q.Source.Unknown&&this.log.info("publishing a second track with the same source: ".concat(e.source),Object.assign(Object.assign({},this.logContext),Ee(e))),i.stopMicTrackOnMute&&Bn(e)&&(e.stopOnMute=!0),e.source===Q.Source.ScreenShare&&Na()&&(i.simulcast=!1),i.videoCodec==="av1"&&!zR()&&(i.videoCodec=void 0),i.videoCodec==="vp9"&&!HR()&&(i.videoCodec=void 0),i.videoCodec===void 0&&(i.videoCodec=Bh),this.enabledPublishVideoCodecs.length>0&&(this.enabledPublishVideoCodecs.some(ee=>i.videoCodec===zr(ee.mime))||(i.videoCodec=zr(this.enabledPublishVideoCodecs[0].mime)));const x=i.videoCodec;e.on($.Muted,this.onTrackMuted),e.on($.Unmuted,this.onTrackUnmuted),e.on($.Ended,this.handleTrackEnded),e.on($.UpstreamPaused,this.onTrackUpstreamPaused),e.on($.UpstreamResumed,this.onTrackUpstreamResumed),e.on($.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate);const k=[],R=!(!((o=i.dtx)!==null&&o!==void 0)||o),O=e.getSourceTrackSettings();O.autoGainControl&&k.push(Tt.TF_AUTO_GAIN_CONTROL),O.echoCancellation&&k.push(Tt.TF_ECHO_CANCELLATION),O.noiseSuppression&&k.push(Tt.TF_NOISE_SUPPRESSION),O.channelCount&&O.channelCount>1&&k.push(Tt.TF_STEREO),R&&k.push(Tt.TF_NO_DTX),ci(e)&&e.hasPreConnectBuffer&&k.push(Tt.TF_PRECONNECT_BUFFER);const L=new Wr({cid:e.mediaStreamTrack.id,name:i.name,type:Q.kindToProto(e.kind),muted:e.isMuted,source:Q.sourceToProto(e.source),disableDtx:R,encryption:this.encryptionType,stereo:s,disableRed:this.isE2EEEnabled||!(!((l=i.red)!==null&&l!==void 0)||l),stream:i?.stream,backupCodecPolicy:i?.backupCodecPolicy,audioFeatures:k});let D;if(e.kind===Q.Kind.Video){let ee={width:0,height:0};try{ee=yield e.waitForDimensions()}catch{const re=(u=(d=this.roomOptions.videoCaptureDefaults)===null||d===void 0?void 0:d.resolution)!==null&&u!==void 0?u:Xr.h720.resolution;ee={width:re.width,height:re.height},this.log.error("could not determine track dimensions, using defaults",Object.assign(Object.assign(Object.assign({},this.logContext),Ee(e)),{dims:ee}))}L.width=ee.width,L.height=ee.height,Ki(e)&&(Nn(x)&&(e.source===Q.Source.ScreenShare&&(i.scalabilityMode="L1T3","contentHint"in e.mediaStreamTrack&&(e.mediaStreamTrack.contentHint="motion",this.log.info("forcing contentHint to motion for screenshare with SVC codecs",Object.assign(Object.assign({},this.logContext),Ee(e))))),i.scalabilityMode=(f=i.scalabilityMode)!==null&&f!==void 0?f:"L3T3_KEY"),L.simulcastCodecs=[new Th({codec:x,cid:e.mediaStreamTrack.id})],i.backupCodec===!0&&(i.backupCodec={codec:Bh}),i.backupCodec&&x!==i.backupCodec.codec&&L.encryption===ht.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),L.simulcastCodecs.push(new Th({codec:i.backupCodec.codec,cid:""})))),D=Fh(e.source===Q.Source.ScreenShare,L.width,L.height,i),L.layers=N0(L.width,L.height,D,Nn(i.videoCodec))}else e.kind===Q.Kind.Audio&&(D=[{maxBitrate:(p=i.audioPreset)===null||p===void 0?void 0:p.maxBitrate,priority:(y=(v=i.audioPreset)===null||v===void 0?void 0:v.priority)!==null&&y!==void 0?y:"high",networkPriority:(C=(S=i.audioPreset)===null||S===void 0?void 0:S.priority)!==null&&C!==void 0?C:"high"}]);if(!this.engine||this.engine.isClosed)throw new ut("cannot publish track when not connected");const I=()=>E(this,void 0,void 0,function*(){var ee,te,re;if(!this.engine.pcManager)throw new ut("pcManager is not ready");if(e.sender=yield this.engine.createSender(e,i,D),this.emit(ae.LocalSenderCreated,e.sender,e),Ki(e)&&((ee=i.degradationPreference)!==null&&ee!==void 0||(i.degradationPreference=$N(e)),e.setDegradationPreference(i.degradationPreference)),D)if(Na()&&e.kind===Q.Kind.Audio){let ue;for(const Me of this.engine.pcManager.publisher.getTransceivers())if(Me.sender===e.sender){ue=Me;break}ue&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:ue,codec:"opus",maxbr:!((te=D[0])===null||te===void 0)&&te.maxBitrate?D[0].maxBitrate/1e3:0})}else e.codec&&Nn(e.codec)&&(!((re=D[0])===null||re===void 0)&&re.maxBitrate)&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:L.cid,codec:e.codec,maxbr:D[0].maxBitrate/1e3});yield this.engine.negotiate()});let j;const H=new Promise((ee,te)=>E(this,void 0,void 0,function*(){var re;try{j=yield this.engine.addTrack(L),ee(j)}catch(ue){e.sender&&(!((re=this.engine.pcManager)===null||re===void 0)&&re.publisher)&&(this.engine.pcManager.publisher.removeTrack(e.sender),yield this.engine.negotiate().catch(Me=>{this.log.error("failed to negotiate after removing track due to failed add track request",Object.assign(Object.assign(Object.assign({},this.logContext),Ee(e)),{error:Me}))})),te(ue)}}));if(this.enabledPublishVideoCodecs.length>0)j=(yield Promise.all([H,I()]))[0];else{j=yield H;let ee;if(j.codecs.forEach(te=>{ee===void 0&&(ee=te.mimeType)}),ee&&e.kind===Q.Kind.Video){const te=zr(ee);te!==x&&(this.log.debug("falling back to server selected codec",Object.assign(Object.assign(Object.assign({},this.logContext),Ee(e)),{codec:te})),i.videoCodec=te,D=Fh(e.source===Q.Source.ScreenShare,L.width,L.height,i))}yield I()}const Z=new Hh(e.kind,j,e,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});if(Z.on($.CpuConstrained,ee=>this.onTrackCpuConstrained(ee,Z)),Z.options=i,e.sid=j.sid,this.log.debug("publishing ".concat(e.kind," with encodings"),Object.assign(Object.assign({},this.logContext),{encodings:D,trackInfo:j})),Ki(e)?e.startMonitor(this.engine.client):ci(e)&&e.startMonitor(),this.addTrackPublication(Z),this.emit(ae.LocalTrackPublished,Z),ci(e)&&j.audioFeatures.includes(Tt.TF_PRECONNECT_BUFFER)){const ee=e.getPreConnectBuffer(),te=e.getPreConnectBufferMimeType();this.on(ae.LocalTrackSubscribed,re=>{if(re.trackSid===j.sid){if(!e.hasPreConnectBuffer){this.log.warn("subscribe event came to late, buffer already closed",this.logContext);return}this.log.debug("finished recording preconnect buffer",Object.assign(Object.assign({},this.logContext),Ee(e))),e.stopPreConnectBuffer()}}),ee&&new Promise((ue,Me)=>E(this,void 0,void 0,function*(){var We,ze,z,ne,he,Oe;try{this.log.debug("waiting for agent",Object.assign(Object.assign({},this.logContext),Ee(e)));const se=setTimeout(()=>{Me(new Error("agent not active within 10 seconds"))},1e4),le=yield this.waitUntilActiveAgentPresent();clearTimeout(se),this.log.debug("sending preconnect buffer",Object.assign(Object.assign({},this.logContext),Ee(e)));const pe=yield this.streamBytes({name:"preconnect-buffer",mimeType:te,topic:"lk.agent.pre-connect-audio-buffer",destinationIdentities:[le.identity],attributes:{trackId:Z.trackSid,sampleRate:String((he=O.sampleRate)!==null&&he!==void 0?he:"48000"),channels:String((Oe=O.channelCount)!==null&&Oe!==void 0?Oe:"1")}});try{for(var Le=!0,A=mi(ee),Y;Y=yield A.next(),We=Y.done,!We;Le=!0){ne=Y.value,Le=!1;const ye=ne;yield pe.write(ye)}}catch(ye){ze={error:ye}}finally{try{!Le&&!We&&(z=A.return)&&(yield z.call(A))}finally{if(ze)throw ze.error}}yield pe.close(),ue()}catch(se){Me(se)}})).then(()=>{this.log.debug("preconnect buffer sent successfully",Object.assign(Object.assign({},this.logContext),Ee(e)))}).catch(ue=>{this.log.error("error sending preconnect buffer",Object.assign(Object.assign(Object.assign({},this.logContext),Ee(e)),{error:ue}))})}return Z})}get isLocal(){return!0}publishAdditionalCodecForTrack(e,i,s){return E(this,void 0,void 0,function*(){var o;if(this.encryptionType!==ht.NONE)return;let l;if(this.trackPublications.forEach(C=>{C.track&&C.track===e&&(l=C)}),!l)throw new pi("track is not published");if(!Ki(e))throw new pi("track is not a video track");const d=Object.assign(Object.assign({},(o=this.roomOptions)===null||o===void 0?void 0:o.publishDefaults),s),u=WN(e,i,d);if(!u){this.log.info("backup codec has been disabled, ignoring request to add additional codec for track",Object.assign(Object.assign({},this.logContext),Ee(e)));return}const f=e.addSimulcastTrack(i,u);if(!f)return;const p=new Wr({cid:f.mediaStreamTrack.id,type:Q.kindToProto(e.kind),muted:e.isMuted,source:Q.sourceToProto(e.source),sid:e.sid,simulcastCodecs:[{codec:d.videoCodec,cid:f.mediaStreamTrack.id}]});if(p.layers=N0(p.width,p.height,u),!this.engine||this.engine.isClosed)throw new ut("cannot publish track when not connected");const v=()=>E(this,void 0,void 0,function*(){yield this.engine.createSimulcastSender(e,f,d,u),yield this.engine.negotiate()}),S=(yield Promise.all([this.engine.addTrack(p),v()]))[0];this.log.debug("published ".concat(i," for track ").concat(e.sid),Object.assign(Object.assign({},this.logContext),{encodings:u,trackInfo:S}))})}unpublishTrack(e,i){return E(this,void 0,void 0,function*(){var s,o;if(Rs(e)){const p=this.pendingPublishPromises.get(e);p&&(this.log.info("awaiting publish promise before attempting to unpublish",Object.assign(Object.assign({},this.logContext),Ee(e))),yield p)}const l=this.getPublicationForTrack(e),d=l?Ee(l):void 0;if(this.log.debug("unpublishing track",Object.assign(Object.assign({},this.logContext),d)),!l||!l.track){this.log.warn("track was not unpublished because no publication was found",Object.assign(Object.assign({},this.logContext),d));return}e=l.track,e.off($.Muted,this.onTrackMuted),e.off($.Unmuted,this.onTrackUnmuted),e.off($.Ended,this.handleTrackEnded),e.off($.UpstreamPaused,this.onTrackUpstreamPaused),e.off($.UpstreamResumed,this.onTrackUpstreamResumed),e.off($.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate),i===void 0&&(i=(o=(s=this.roomOptions)===null||s===void 0?void 0:s.stopLocalTrackOnUnpublish)!==null&&o!==void 0?o:!0),i?e.stop():e.stopMonitor();let u=!1;const f=e.sender;if(e.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<tt.FAILED&&f)try{for(const p of this.engine.pcManager.publisher.getTransceivers())p.sender===f&&(p.direction="inactive",u=!0);if(this.engine.removeTrack(f)&&(u=!0),Ki(e)){for(const[,p]of e.simulcastCodecs)p.sender&&(this.engine.removeTrack(p.sender)&&(u=!0),p.sender=void 0);e.simulcastCodecs.clear()}}catch(p){this.log.warn("failed to unpublish track",Object.assign(Object.assign(Object.assign({},this.logContext),d),{error:p}))}switch(this.trackPublications.delete(l.trackSid),l.kind){case Q.Kind.Audio:this.audioTrackPublications.delete(l.trackSid);break;case Q.Kind.Video:this.videoTrackPublications.delete(l.trackSid);break}return this.emit(ae.LocalTrackUnpublished,l),l.setTrack(void 0),u&&(yield this.engine.negotiate()),l})}unpublishTracks(e){return E(this,void 0,void 0,function*(){return(yield Promise.all(e.map(s=>this.unpublishTrack(s)))).filter(s=>!!s)})}republishAllTracks(e){return E(this,arguments,void 0,function(i){var s=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return(function*(){s.republishPromise&&(yield s.republishPromise),s.republishPromise=new Mt((l,d)=>E(s,void 0,void 0,function*(){try{const u=[];this.trackPublications.forEach(f=>{f.track&&(i&&(f.options=Object.assign(Object.assign({},f.options),i)),u.push(f))}),yield Promise.all(u.map(f=>E(this,void 0,void 0,function*(){const p=f.track;yield this.unpublishTrack(p,!1),o&&!p.isMuted&&p.source!==Q.Source.ScreenShare&&p.source!==Q.Source.ScreenShareAudio&&(ci(p)||Ki(p))&&!p.isUserProvided&&(this.log.debug("restarting existing track",Object.assign(Object.assign({},this.logContext),{track:f.trackSid})),yield p.restartTrack()),yield this.publishOrRepublishTrack(p,f.options,!0)}))),l()}catch(u){u instanceof Error?d(u):d(new Error(String(u)))}finally{this.republishPromise=void 0}})),yield s.republishPromise})()})}publishData(e){return E(this,arguments,void 0,function(i){var s=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return(function*(){const l=o.reliable?Ce.RELIABLE:Ce.LOSSY,d=o.destinationIdentities,u=o.topic;let f=new sf({participantIdentity:s.identity,payload:i,destinationIdentities:d,topic:u});const p=new Pt({kind:l,value:{case:"user",value:f}});yield s.engine.sendDataPacket(p,l)})()})}publishDtmf(e,i){return E(this,void 0,void 0,function*(){const s=new Pt({kind:Ce.RELIABLE,value:{case:"sipDtmf",value:new Yb({code:e,digit:i})}});yield this.engine.sendDataPacket(s,Ce.RELIABLE)})}sendChatMessage(e,i){return E(this,void 0,void 0,function*(){const s={id:crypto.randomUUID(),message:e,timestamp:Date.now(),attachedFiles:i?.attachments},o=new Pt({value:{case:"chatMessage",value:new Xl(Object.assign(Object.assign({},s),{timestamp:et.parse(s.timestamp)}))}});return yield this.engine.sendDataPacket(o,Ce.RELIABLE),this.emit(ae.ChatMessage,s),s})}editChatMessage(e,i){return E(this,void 0,void 0,function*(){const s=Object.assign(Object.assign({},i),{message:e,editTimestamp:Date.now()}),o=new Pt({value:{case:"chatMessage",value:new Xl(Object.assign(Object.assign({},s),{timestamp:et.parse(s.timestamp),editTimestamp:et.parse(s.editTimestamp)}))}});return yield this.engine.sendDataPacket(o,Ce.RELIABLE),this.emit(ae.ChatMessage,s),s})}sendText(e,i){return E(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.sendText(e,i)})}streamText(e){return E(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.streamText(e)})}sendFile(e,i){return E(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.sendFile(e,i)})}streamBytes(e){return E(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.streamBytes(e)})}performRpc(e){let{destinationIdentity:i,method:s,payload:o,responseTimeout:l=15e3}=e;const d=7e3,u=d+1e3;return new Mt((f,p)=>E(this,void 0,void 0,function*(){var v,y,S,C;if(wf(o)>oT){p(rt.builtIn("REQUEST_PAYLOAD_TOO_LARGE"));return}if(!((y=(v=this.engine.latestJoinResponse)===null||v===void 0?void 0:v.serverInfo)===null||y===void 0)&&y.version&&zn((C=(S=this.engine.latestJoinResponse)===null||S===void 0?void 0:S.serverInfo)===null||C===void 0?void 0:C.version,"1.8.0")<0){p(rt.builtIn("UNSUPPORTED_SERVER"));return}const _=Math.max(l,u),x=crypto.randomUUID();yield this.publishRpcRequest(i,x,s,o,_);const k=setTimeout(()=>{this.pendingAcks.delete(x),p(rt.builtIn("CONNECTION_TIMEOUT")),this.pendingResponses.delete(x),clearTimeout(R)},d);this.pendingAcks.set(x,{resolve:()=>{clearTimeout(k)},participantIdentity:i});const R=setTimeout(()=>{this.pendingResponses.delete(x),p(rt.builtIn("RESPONSE_TIMEOUT"))},l);this.pendingResponses.set(x,{resolve:(O,L)=>{clearTimeout(R),this.pendingAcks.has(x)&&(this.log.warn("RPC response received before ack",x),this.pendingAcks.delete(x),clearTimeout(k)),L?p(L):f(O??"")},participantIdentity:i})}))}registerRpcMethod(e,i){this.rpcHandlers.has(e)&&this.log.warn("you're overriding the RPC handler for method ".concat(e,", in the future this will throw an error")),this.rpcHandlers.set(e,i)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}setTrackSubscriptionPermissions(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.participantTrackPermissions=i,this.allParticipantsAllowedToSubscribe=e,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}handleIncomingRpcAck(e){const i=this.pendingAcks.get(e);i?(i.resolve(),this.pendingAcks.delete(e)):console.error("Ack received for unexpected RPC request",e)}handleIncomingRpcResponse(e,i,s){const o=this.pendingResponses.get(e);o?(o.resolve(i,s),this.pendingResponses.delete(e)):console.error("Response received for unexpected RPC request",e)}publishRpcRequest(e,i,s,o,l){return E(this,void 0,void 0,function*(){const d=new Pt({destinationIdentities:[e],kind:Ce.RELIABLE,value:{case:"rpcRequest",value:new rf({id:i,method:s,payload:o,responseTimeoutMs:l,version:1})}});yield this.engine.sendDataPacket(d,Ce.RELIABLE)})}handleParticipantDisconnected(e){for(const[i,{participantIdentity:s}]of this.pendingAcks)s===e&&this.pendingAcks.delete(i);for(const[i,{participantIdentity:s,resolve:o}]of this.pendingResponses)s===e&&(o(null,rt.builtIn("RECIPIENT_DISCONNECTED")),this.pendingResponses.delete(i))}setEnabledPublishCodecs(e){this.enabledPublishVideoCodecs=e.filter(i=>i.mime.split("/")[0].toLowerCase()==="video")}updateInfo(e){return super.updateInfo(e)?(e.tracks.forEach(i=>{var s,o;const l=this.trackPublications.get(i.sid);if(l){const d=l.isMuted||((o=(s=l.track)===null||s===void 0?void 0:s.isUpstreamPaused)!==null&&o!==void 0?o:!1);d!==i.muted&&(this.log.debug("updating server mute state after reconcile",Object.assign(Object.assign(Object.assign({},this.logContext),Ee(l)),{mutedOnServer:d})),this.engine.client.sendMuteTrack(i.sid,d))}}),!0):!1}setActiveAgent(e){var i,s,o,l;this.firstActiveAgent=e,e&&!this.firstActiveAgent&&(this.firstActiveAgent=e),e?(s=(i=this.activeAgentFuture)===null||i===void 0?void 0:i.resolve)===null||s===void 0||s.call(i,e):(l=(o=this.activeAgentFuture)===null||o===void 0?void 0:o.reject)===null||l===void 0||l.call(o,new Error("Agent disconnected")),this.activeAgentFuture=void 0}waitUntilActiveAgentPresent(){return this.firstActiveAgent?Promise.resolve(this.firstActiveAgent):(this.activeAgentFuture||(this.activeAgentFuture=new bn),this.activeAgentFuture.promise)}getPublicationForTrack(e){let i;return this.trackPublications.forEach(s=>{const o=s.track;o&&(e instanceof MediaStreamTrack?(ci(o)||Ki(o))&&o.mediaStreamTrack===e&&(i=s):e===o&&(i=s))}),i}waitForPendingPublicationOfSource(e){return E(this,void 0,void 0,function*(){const s=Date.now();for(;Date.now()<s+1e4;){const o=Array.from(this.pendingPublishPromises.entries()).find(l=>{let[d]=l;return d.source===e});if(o)return o[1];yield Nt(20)}})}}class SA extends ui{constructor(e,i,s,o){super(e,i.sid,i.name,o),this.track=void 0,this.allowed=!0,this.requestedDisabled=void 0,this.visible=!0,this.handleEnded=l=>{this.setTrack(void 0),this.emit($.Ended,l)},this.handleVisibilityChange=l=>{this.log.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(l),this.logContext),this.visible=l,this.emitTrackUpdate()},this.handleVideoDimensionsChange=l=>{this.log.debug("adaptivestream video dimensions ".concat(l.width,"x").concat(l.height),this.logContext),this.videoDimensionsAdaptiveStream=l,this.emitTrackUpdate()},this.subscribed=s,this.updateInfo(i)}setSubscribed(e){const i=this.subscriptionStatus,s=this.permissionStatus;this.subscribed=e,e&&(this.allowed=!0);const o=new pc({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new Qb({participantSid:"",trackSids:[this.trackSid]})]});this.emit($.UpdateSubscription,o),this.emitSubscriptionUpdateIfChanged(i),this.emitPermissionUpdateIfChanged(s)}get subscriptionStatus(){return this.subscribed===!1?ui.SubscriptionStatus.Unsubscribed:super.isSubscribed?ui.SubscriptionStatus.Subscribed:ui.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?ui.PermissionStatus.Allowed:ui.PermissionStatus.NotAllowed}get isSubscribed(){return this.subscribed===!1?!1:super.isSubscribed}get isDesired(){return this.subscribed!==!1}get isEnabled(){return this.requestedDisabled!==void 0?!this.requestedDisabled:this.isAdaptiveStream?this.visible:!0}get isLocal(){return!1}setEnabled(e){!this.isManualOperationAllowed()||this.requestedDisabled===!e||(this.requestedDisabled=!e,this.emitTrackUpdate())}setVideoQuality(e){!this.isManualOperationAllowed()||this.requestedMaxQuality===e||(this.requestedMaxQuality=e,this.requestedVideoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var i,s;this.isManualOperationAllowed()&&(((i=this.requestedVideoDimensions)===null||i===void 0?void 0:i.width)===e.width&&((s=this.requestedVideoDimensions)===null||s===void 0?void 0:s.height)===e.height||(sh(this.track)&&(this.requestedVideoDimensions=e),this.requestedMaxQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(e){this.isManualOperationAllowed()&&sh(this.track)&&this.fps!==e&&(this.fps=e,this.emitTrackUpdate())}get videoQuality(){var e;return(e=this.requestedMaxQuality)!==null&&e!==void 0?e:rn.HIGH}setTrack(e){const i=this.subscriptionStatus,s=this.permissionStatus,o=this.track;o!==e&&(o&&(o.off($.VideoDimensionsChanged,this.handleVideoDimensionsChange),o.off($.VisibilityChanged,this.handleVisibilityChange),o.off($.Ended,this.handleEnded),o.detach(),o.stopMonitor(),this.emit($.Unsubscribed,o)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on($.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on($.VisibilityChanged,this.handleVisibilityChange),e.on($.Ended,this.handleEnded),this.emit($.Subscribed,e)),this.emitPermissionUpdateIfChanged(s),this.emitSubscriptionUpdateIfChanged(i))}setAllowed(e){const i=this.subscriptionStatus,s=this.permissionStatus;this.allowed=e,this.emitPermissionUpdateIfChanged(s),this.emitSubscriptionUpdateIfChanged(i)}setSubscriptionError(e){this.emit($.SubscriptionFailed,e)}updateInfo(e){super.updateInfo(e);const i=this.metadataMuted;this.metadataMuted=e.muted,this.track?this.track.setMuted(e.muted):i!==e.muted&&this.emit(e.muted?$.Muted:$.Unmuted)}emitSubscriptionUpdateIfChanged(e){const i=this.subscriptionStatus;e!==i&&this.emit($.SubscriptionStatusChanged,i,e)}emitPermissionUpdateIfChanged(e){this.permissionStatus!==e&&this.emit($.SubscriptionPermissionChanged,this.permissionStatus,e)}isManualOperationAllowed(){return this.isDesired?!0:(this.log.warn("cannot update track settings when not subscribed",this.logContext),!1)}get isAdaptiveStream(){return sh(this.track)&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=new oS({trackSids:[this.trackSid],disabled:!this.isEnabled,fps:this.fps});if(this.kind===Q.Kind.Video){let i=this.requestedVideoDimensions;if(this.videoDimensionsAdaptiveStream!==void 0)if(i)a0(this.videoDimensionsAdaptiveStream,i)&&(this.log.debug("using adaptive stream dimensions instead of requested",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),i=this.videoDimensionsAdaptiveStream);else if(this.requestedMaxQuality!==void 0&&this.trackInfo){const s=UR(this.trackInfo,this.requestedMaxQuality);s&&a0(this.videoDimensionsAdaptiveStream,s)&&(this.log.debug("using adaptive stream dimensions instead of max quality layer",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),i=this.videoDimensionsAdaptiveStream)}else this.log.debug("using adaptive stream dimensions",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),i=this.videoDimensionsAdaptiveStream;i?(e.width=Math.ceil(i.width),e.height=Math.ceil(i.height)):this.requestedMaxQuality!==void 0?(this.log.debug("using requested max quality",Object.assign(Object.assign({},this.logContext),{quality:this.requestedMaxQuality})),e.quality=this.requestedMaxQuality):(this.log.debug("using default quality",Object.assign(Object.assign({},this.logContext),{quality:rn.HIGH})),e.quality=rn.HIGH)}this.emit($.UpdateSettings,e)}}class ac extends pT{static fromParticipantInfo(e,i,s){return new ac(e,i.sid,i.identity,i.name,i.metadata,i.attributes,s,i.kind)}get logContext(){return Object.assign(Object.assign({},super.logContext),{rpID:this.sid,remoteParticipant:this.identity})}constructor(e,i,s,o,l,d,u){let f=arguments.length>7&&arguments[7]!==void 0?arguments[7]:Qr.STANDARD;super(i,s||"",o,l,d,u,f),this.signalClient=e,this.trackPublications=new Map,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.volumeMap=new Map}addTrackPublication(e){super.addTrackPublication(e),e.on($.UpdateSettings,i=>{this.log.debug("send update settings",Object.assign(Object.assign(Object.assign({},this.logContext),Ee(e)),{settings:i})),this.signalClient.sendUpdateTrackSettings(i)}),e.on($.UpdateSubscription,i=>{i.participantTracks.forEach(s=>{s.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(i)}),e.on($.SubscriptionPermissionChanged,i=>{this.emit(ae.TrackSubscriptionPermissionChanged,e,i)}),e.on($.SubscriptionStatusChanged,i=>{this.emit(ae.TrackSubscriptionStatusChanged,e,i)}),e.on($.Subscribed,i=>{this.emit(ae.TrackSubscribed,i,e)}),e.on($.Unsubscribed,i=>{this.emit(ae.TrackUnsubscribed,i,e)}),e.on($.SubscriptionFailed,i=>{this.emit(ae.TrackSubscriptionFailed,e.trackSid,i)})}getTrackPublication(e){const i=super.getTrackPublication(e);if(i)return i}getTrackPublicationByName(e){const i=super.getTrackPublicationByName(e);if(i)return i}setVolume(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Q.Source.Microphone;this.volumeMap.set(i,e);const s=this.getTrackPublication(i);s&&s.track&&s.track.setVolume(e)}getVolume(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Q.Source.Microphone;const i=this.getTrackPublication(e);return i&&i.track?i.track.getVolume():this.volumeMap.get(e)}addSubscribedMediaTrack(e,i,s,o,l,d){let u=this.getTrackPublicationBySid(i);if(u||i.startsWith("TR")||this.trackPublications.forEach(v=>{!u&&e.kind===v.kind.toString()&&(u=v)}),!u){if(d===0){this.log.error("could not find published track",Object.assign(Object.assign({},this.logContext),{trackSid:i})),this.emit(ae.TrackSubscriptionFailed,i);return}d===void 0&&(d=20),setTimeout(()=>{this.addSubscribedMediaTrack(e,i,s,o,l,d-1)},150);return}if(e.readyState==="ended"){this.log.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",Object.assign(Object.assign({},this.logContext),Ee(u))),this.emit(ae.TrackSubscriptionFailed,i);return}const f=e.kind==="video";let p;return f?p=new mA(e,i,o,l):p=new fA(e,i,o,this.audioContext,this.audioOutput),p.source=u.source,p.isMuted=u.isMuted,p.setMediaStream(s),p.start(),u.setTrack(p),this.volumeMap.has(u.source)&&Lh(p)&&Bn(p)&&p.setVolume(this.volumeMap.get(u.source)),u}get hasMetadata(){return!!this.participantInfo}getTrackPublicationBySid(e){return this.trackPublications.get(e)}updateInfo(e){if(!super.updateInfo(e))return!1;const i=new Map,s=new Map;return e.tracks.forEach(o=>{var l,d;let u=this.getTrackPublicationBySid(o.sid);if(u)u.updateInfo(o);else{const f=Q.kindFromProto(o.type);if(!f)return;u=new SA(f,o,(l=this.signalClient.connectOptions)===null||l===void 0?void 0:l.autoSubscribe,{loggerContextCb:()=>this.logContext,loggerName:(d=this.loggerOptions)===null||d===void 0?void 0:d.loggerName}),u.updateInfo(o),s.set(o.sid,u);const p=Array.from(this.trackPublications.values()).find(v=>v.source===u?.source);p&&u.source!==Q.Source.Unknown&&this.log.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(u.source),Object.assign(Object.assign({},this.logContext),{oldTrack:Ee(p),newTrack:Ee(u)})),this.addTrackPublication(u)}i.set(o.sid,u)}),this.trackPublications.forEach(o=>{i.has(o.trackSid)||(this.log.trace("detected removed track on remote participant, unpublishing",Object.assign(Object.assign({},this.logContext),Ee(o))),this.unpublishTrack(o.trackSid,!0))}),s.forEach(o=>{this.emit(ae.TrackPublished,o)}),!0}unpublishTrack(e,i){const s=this.trackPublications.get(e);if(!s)return;const{track:o}=s;switch(o&&(o.stop(),s.setTrack(void 0)),this.trackPublications.delete(e),s.kind){case Q.Kind.Audio:this.audioTrackPublications.delete(e);break;case Q.Kind.Video:this.videoTrackPublications.delete(e);break}i&&this.emit(ae.TrackUnpublished,s)}setAudioOutput(e){return E(this,void 0,void 0,function*(){this.audioOutput=e;const i=[];this.audioTrackPublications.forEach(s=>{var o;Bn(s.track)&&Lh(s.track)&&i.push(s.track.setSinkId((o=e.deviceId)!==null&&o!==void 0?o:"default"))}),yield Promise.all(i)})}emit(e){for(var i=arguments.length,s=new Array(i>1?i-1:0),o=1;o<i;o++)s[o-1]=arguments[o];return this.log.trace("participant event",Object.assign(Object.assign({},this.logContext),{event:e,args:s})),super.emit(e,...s)}}var Ie;(function(a){a.Disconnected="disconnected",a.Connecting="connecting",a.Connected="connected",a.Reconnecting="reconnecting",a.SignalReconnecting="signalReconnecting"})(Ie||(Ie={}));const TA=4*1e3;class Os extends Vn.EventEmitter{get hasE2EESetup(){return this.e2eeManager!==void 0}constructor(e){var i,s,o,l,d;if(super(),i=this,this.state=Ie.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.log=Se,this.bufferedEvents=[],this.isResuming=!1,this.rpcHandlers=new Map,this.connect=(u,f,p)=>E(this,void 0,void 0,function*(){var v;if(!VR())throw Fn()?Error("WebRTC isn't detected, have you called registerGlobals?"):Error("LiveKit doesn't seem to be supported on this browser. Try to update your browser and make sure no browser extensions are disabling webRTC.");const y=yield this.disconnectLock.lock();if(this.state===Ie.Connected)return this.log.info("already connected to room ".concat(this.name),this.logContext),y(),Promise.resolve();if(this.connectFuture)return y(),this.connectFuture.promise;this.setAndEmitConnectionState(Ie.Connecting),((v=this.regionUrlProvider)===null||v===void 0?void 0:v.getServerUrl().toString())!==iT(u)&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),Ds(new URL(u))&&(this.regionUrlProvider===void 0?this.regionUrlProvider=new De(u,f):this.regionUrlProvider.updateToken(f),this.regionUrlProvider.fetchRegionSettings().then(_=>{var x;(x=this.regionUrlProvider)===null||x===void 0||x.setServerReportedRegions(_)}).catch(_=>{this.log.warn("could not fetch region settings",Object.assign(Object.assign({},this.logContext),{error:_}))}));const S=(_,x,k)=>E(this,void 0,void 0,function*(){var R,O;this.abortController&&this.abortController.abort();const L=new AbortController;this.abortController=L,y?.();try{if(yield Ns.getInstance().getBackOffPromise(u),L.signal.aborted)throw me.cancelled("Connection attempt aborted");yield this.attemptConnection(k??u,f,p,L),this.abortController=void 0,_()}catch(D){if(this.regionUrlProvider&&D instanceof me&&D.reason!==Qe.Cancelled&&D.reason!==Qe.NotAllowed){let I=null;try{this.log.debug("Fetching next region"),I=yield this.regionUrlProvider.getNextBestRegionUrl((R=this.abortController)===null||R===void 0?void 0:R.signal)}catch(j){if(j instanceof me&&(j.status===401||j.reason===Qe.Cancelled)){this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),x(j);return}}[Qe.InternalError,Qe.ServerUnreachable,Qe.Timeout].includes(D.reason)&&(this.log.debug("Adding failed connection attempt to back off"),Ns.getInstance().addFailedConnectionAttempt(u)),I&&!(!((O=this.abortController)===null||O===void 0)&&O.signal.aborted)?(this.log.info("Initial connection failed with ConnectionError: ".concat(D.message,". Retrying with another region: ").concat(I),this.logContext),this.recreateEngine(),yield S(_,x,I)):(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,d0(D)),x(D))}else{let I=An.UNKNOWN_REASON;D instanceof me&&(I=d0(D)),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,I),x(D)}}}),C=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new bn((_,x)=>{S(_,x,C)},()=>{this.clearConnectionFutures()}),this.connectFuture.promise}),this.connectSignal=(u,f,p,v,y,S)=>E(this,void 0,void 0,function*(){var C,_,x;const k=yield p.join(u,f,{autoSubscribe:v.autoSubscribe,adaptiveStream:typeof y.adaptiveStream=="object"?!0:y.adaptiveStream,maxRetries:v.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:v.websocketTimeout},S.signal,!y.singlePeerConnection);let R=k.serverInfo;if(R||(R={version:k.serverVersion,region:k.serverRegion}),this.serverInfo=R,this.log.debug("connected to Livekit Server ".concat(Object.entries(R).map(O=>{let[L,D]=O;return"".concat(L,": ").concat(D)}).join(", ")),{room:(C=k.room)===null||C===void 0?void 0:C.name,roomSid:(_=k.room)===null||_===void 0?void 0:_.sid,identity:(x=k.participant)===null||x===void 0?void 0:x.identity}),!R.version)throw new wR("unknown server version");return R.version==="0.15.1"&&this.options.dynacast&&(this.log.debug("disabling dynacast due to server version",this.logContext),y.dynacast=!1),k}),this.applyJoinResponse=u=>{const f=u.participant;if(this.localParticipant.sid=f.sid,this.localParticipant.identity=f.identity,this.localParticipant.setEnabledPublishCodecs(u.enabledPublishCodecs),this.e2eeManager)try{this.e2eeManager.setSifTrailer(u.sifTrailer)}catch(p){this.log.error(p instanceof Error?p.message:"Could not set SifTrailer",Object.assign(Object.assign({},this.logContext),{error:p}))}this.handleParticipantUpdates([f,...u.otherParticipants]),u.room&&this.handleRoomUpdate(u.room)},this.attemptConnection=(u,f,p,v)=>E(this,void 0,void 0,function*(){var y,S;this.state===Ie.Reconnecting||this.isResuming||!((y=this.engine)===null||y===void 0)&&y.pendingReconnect?(this.log.info("Reconnection attempt replaced by new connection attempt",this.logContext),this.recreateEngine()):this.maybeCreateEngine(),!((S=this.regionUrlProvider)===null||S===void 0)&&S.isCloud()&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},Ef),p),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const C=yield this.connectSignal(u,f,this.engine,this.connOptions,this.options,v);this.applyJoinResponse(C),this.setupLocalParticipantEvents(),this.emit(X.SignalConnected)}catch(C){yield this.engine.close(),this.recreateEngine();const _=v.signal.aborted?me.cancelled("Signal connection aborted"):me.serverUnreachable("could not establish signal connection");throw C instanceof Error&&(_.message="".concat(_.message,": ").concat(C.message)),C instanceof me&&(_.reason=C.reason,_.status=C.status),this.log.debug("error trying to establish signal connection",Object.assign(Object.assign({},this.logContext),{error:C})),_}if(v.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),me.cancelled("Connection attempt aborted");try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,v)}catch(C){throw yield this.engine.close(),this.recreateEngine(),C}Kt()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),Kt()&&window.addEventListener("freeze",this.onPageLeave),this.setAndEmitConnectionState(Ie.Connected),this.emit(X.Connected),Ns.getInstance().resetFailedConnectionAttempts(u),this.registerConnectionReconcile(),this.regionUrlProvider&&this.regionUrlProvider.notifyConnected()}),this.disconnect=function(){for(var u=arguments.length,f=new Array(u),p=0;p<u;p++)f[p]=arguments[p];return E(i,[...f],void 0,function(){var v=this;let y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return(function*(){var S,C,_;const x=yield v.disconnectLock.lock();try{if(v.state===Ie.Disconnected){v.log.debug("already disconnected",v.logContext);return}if(v.log.info("disconnect from room",Object.assign({},v.logContext)),v.state===Ie.Connecting||v.state===Ie.Reconnecting||v.isResuming){const k="Abort connection attempt due to user initiated disconnect";v.log.warn(k,v.logContext),(S=v.abortController)===null||S===void 0||S.abort(k),(_=(C=v.connectFuture)===null||C===void 0?void 0:C.reject)===null||_===void 0||_.call(C,me.cancelled("Client initiated disconnect")),v.connectFuture=void 0}v.engine&&(v.engine.client.isDisconnected||(yield v.engine.client.sendLeave()),yield v.engine.close()),v.handleDisconnect(y,An.CLIENT_INITIATED),v.engine=void 0}finally{x()}})()})},this.onPageLeave=()=>E(this,void 0,void 0,function*(){this.log.info("Page leave detected, disconnecting",this.logContext),yield this.disconnect()}),this.startAudio=()=>E(this,void 0,void 0,function*(){const u=[],f=Yt();if(f&&f.os==="iOS"){const p="livekit-dummy-audio-el";let v=document.getElementById(p);if(!v){v=document.createElement("audio"),v.id=p,v.autoplay=!0,v.hidden=!0;const y=ah();y.enabled=!0;const S=new MediaStream([y]);v.srcObject=S,document.addEventListener("visibilitychange",()=>{v&&(v.srcObject=document.hidden?null:S,document.hidden||(this.log.debug("page visible again, triggering startAudio to resume playback and update playback status",this.logContext),this.startAudio()))}),document.body.append(v),this.once(X.Disconnected,()=>{v?.remove(),v=null})}u.push(v)}this.remoteParticipants.forEach(p=>{p.audioTrackPublications.forEach(v=>{v.track&&v.track.attachedElements.forEach(y=>{u.push(y)})})});try{yield Promise.all([this.acquireAudioContext(),...u.map(p=>(p.muted=!1,p.play()))]),this.handleAudioPlaybackStarted()}catch(p){throw this.handleAudioPlaybackFailed(p),p}}),this.startVideo=()=>E(this,void 0,void 0,function*(){const u=[];for(const f of this.remoteParticipants.values())f.videoTrackPublications.forEach(p=>{var v;(v=p.track)===null||v===void 0||v.attachedElements.forEach(y=>{u.includes(y)||u.push(y)})});yield Promise.all(u.map(f=>f.play())).then(()=>{this.handleVideoPlaybackStarted()}).catch(f=>{f.name==="NotAllowedError"?this.handleVideoPlaybackFailed():this.log.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler",this.logContext)})}),this.handleRestarting=()=>{this.clearConnectionReconcile(),this.isResuming=!1;for(const u of this.remoteParticipants.values())this.handleParticipantDisconnected(u.identity,u);this.setAndEmitConnectionState(Ie.Reconnecting)&&this.emit(X.Reconnecting)},this.handleSignalRestarted=u=>E(this,void 0,void 0,function*(){this.log.debug("signal reconnected to server, region ".concat(u.serverRegion),Object.assign(Object.assign({},this.logContext),{region:u.serverRegion})),this.bufferedEvents=[],this.applyJoinResponse(u);try{yield this.localParticipant.republishAllTracks(void 0,!0)}catch(f){this.log.error("error trying to re-publish tracks after reconnection",Object.assign(Object.assign({},this.logContext),{error:f}))}try{yield this.engine.waitForRestarted(),this.log.debug("fully reconnected to server",Object.assign(Object.assign({},this.logContext),{region:u.serverRegion}))}catch{return}this.setAndEmitConnectionState(Ie.Connected),this.emit(X.Reconnected),this.registerConnectionReconcile(),this.emitBufferedEvents()}),this.handleParticipantUpdates=u=>{u.forEach(f=>{var p;if(f.identity===this.localParticipant.identity){this.localParticipant.updateInfo(f);return}f.identity===""&&(f.identity=(p=this.sidToIdentity.get(f.sid))!==null&&p!==void 0?p:"");let v=this.remoteParticipants.get(f.identity);f.state===xs.DISCONNECTED?this.handleParticipantDisconnected(f.identity,v):v=this.getOrCreateParticipant(f.identity,f)})},this.handleActiveSpeakersUpdate=u=>{const f=[],p={};u.forEach(v=>{if(p[v.sid]=!0,v.sid===this.localParticipant.sid)this.localParticipant.audioLevel=v.level,this.localParticipant.setIsSpeaking(!0),f.push(this.localParticipant);else{const y=this.getRemoteParticipantBySid(v.sid);y&&(y.audioLevel=v.level,y.setIsSpeaking(!0),f.push(y))}}),p[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.remoteParticipants.forEach(v=>{p[v.sid]||(v.audioLevel=0,v.setIsSpeaking(!1))}),this.activeSpeakers=f,this.emitWhenConnected(X.ActiveSpeakersChanged,f)},this.handleSpeakersChanged=u=>{const f=new Map;this.activeSpeakers.forEach(v=>{const y=this.remoteParticipants.get(v.identity);y&&y.sid!==v.sid||f.set(v.sid,v)}),u.forEach(v=>{let y=this.getRemoteParticipantBySid(v.sid);v.sid===this.localParticipant.sid&&(y=this.localParticipant),y&&(y.audioLevel=v.level,y.setIsSpeaking(v.active),v.active?f.set(v.sid,y):f.delete(v.sid))});const p=Array.from(f.values());p.sort((v,y)=>y.audioLevel-v.audioLevel),this.activeSpeakers=p,this.emitWhenConnected(X.ActiveSpeakersChanged,p)},this.handleStreamStateUpdate=u=>{u.streamStates.forEach(f=>{const p=this.getRemoteParticipantBySid(f.participantSid);if(!p)return;const v=p.getTrackPublicationBySid(f.trackSid);if(!v||!v.track)return;const y=Q.streamStateFromProto(f.state);v.track.setStreamState(y),y!==v.track.streamState&&(p.emit(ae.TrackStreamStateChanged,v,v.track.streamState),this.emitWhenConnected(X.TrackStreamStateChanged,v,v.track.streamState,p))})},this.handleSubscriptionPermissionUpdate=u=>{const f=this.getRemoteParticipantBySid(u.participantSid);if(!f)return;const p=f.getTrackPublicationBySid(u.trackSid);p&&p.setAllowed(u.allowed)},this.handleSubscriptionError=u=>{const f=Array.from(this.remoteParticipants.values()).find(v=>v.trackPublications.has(u.trackSid));if(!f)return;const p=f.getTrackPublicationBySid(u.trackSid);p&&p.setSubscriptionError(u.err)},this.handleDataPacket=(u,f)=>{const p=this.remoteParticipants.get(u.participantIdentity);if(u.value.case==="user")this.handleUserPacket(p,u.value.value,u.kind,f);else if(u.value.case==="transcription")this.handleTranscription(p,u.value.value);else if(u.value.case==="sipDtmf")this.handleSipDtmf(p,u.value.value);else if(u.value.case==="chatMessage")this.handleChatMessage(p,u.value.value);else if(u.value.case==="metrics")this.handleMetrics(u.value.value,p);else if(u.value.case==="streamHeader"||u.value.case==="streamChunk"||u.value.case==="streamTrailer")this.handleDataStream(u,f);else if(u.value.case==="rpcRequest"){const v=u.value.value;this.handleIncomingRpcRequest(u.participantIdentity,v.id,v.method,v.payload,v.responseTimeoutMs,v.version)}},this.handleUserPacket=(u,f,p,v)=>{this.emit(X.DataReceived,f.payload,u,p,f.topic,v),u?.emit(ae.DataReceived,f.payload,p,v)},this.handleSipDtmf=(u,f)=>{this.emit(X.SipDTMFReceived,f,u),u?.emit(ae.SipDTMFReceived,f)},this.handleTranscription=(u,f)=>{const p=f.transcribedParticipantIdentity===this.localParticipant.identity?this.localParticipant:this.getParticipantByIdentity(f.transcribedParticipantIdentity),v=p?.trackPublications.get(f.trackId),y=$R(f,this.transcriptionReceivedTimes);v?.emit($.TranscriptionReceived,y),p?.emit(ae.TranscriptionReceived,y,v),this.emit(X.TranscriptionReceived,y,p,v)},this.handleChatMessage=(u,f)=>{const p=eN(f);this.emit(X.ChatMessage,p,u)},this.handleMetrics=(u,f)=>{this.emit(X.MetricsReceived,u,f)},this.handleDataStream=(u,f)=>{this.incomingDataStreamManager.handleDataStreamPacket(u,f)},this.bufferedSegments=new Map,this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(X.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=u=>{this.log.warn("could not playback audio",Object.assign(Object.assign({},this.logContext),{error:u})),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(X.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit(X.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit(X.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>E(this,void 0,void 0,function*(){var u;((u=Yt())===null||u===void 0?void 0:u.os)!=="iOS"&&(yield this.selectDefaultDevices()),this.emit(X.MediaDevicesChanged)}),this.handleRoomUpdate=u=>{const f=this.roomInfo;this.roomInfo=u,f&&f.metadata!==u.metadata&&this.emitWhenConnected(X.RoomMetadataChanged,u.metadata),f?.activeRecording!==u.activeRecording&&this.emitWhenConnected(X.RecordingStatusChanged,u.activeRecording)},this.handleConnectionQualityUpdate=u=>{u.updates.forEach(f=>{if(f.participantSid===this.localParticipant.sid){this.localParticipant.setConnectionQuality(f.quality);return}const p=this.getRemoteParticipantBySid(f.participantSid);p&&p.setConnectionQuality(f.quality)})},this.onLocalParticipantMetadataChanged=u=>{this.emit(X.ParticipantMetadataChanged,u,this.localParticipant)},this.onLocalParticipantNameChanged=u=>{this.emit(X.ParticipantNameChanged,u,this.localParticipant)},this.onLocalAttributesChanged=u=>{this.emit(X.ParticipantAttributesChanged,u,this.localParticipant)},this.onLocalTrackMuted=u=>{this.emit(X.TrackMuted,u,this.localParticipant)},this.onLocalTrackUnmuted=u=>{this.emit(X.TrackUnmuted,u,this.localParticipant)},this.onTrackProcessorUpdate=u=>{var f;(f=u?.onPublish)===null||f===void 0||f.call(u,this)},this.onLocalTrackPublished=u=>E(this,void 0,void 0,function*(){var f,p,v,y,S,C;(f=u.track)===null||f===void 0||f.on($.TrackProcessorUpdate,this.onTrackProcessorUpdate),(p=u.track)===null||p===void 0||p.on($.Restarted,this.onLocalTrackRestarted),(S=(y=(v=u.track)===null||v===void 0?void 0:v.getProcessor())===null||y===void 0?void 0:y.onPublish)===null||S===void 0||S.call(y,this),this.emit(X.LocalTrackPublished,u,this.localParticipant),ci(u.track)&&(yield u.track.checkForSilence())&&this.emit(X.LocalAudioSilenceDetected,u);const _=yield(C=u.track)===null||C===void 0?void 0:C.getDeviceId(!1),x=Oh(u.source);x&&_&&_!==this.localParticipant.activeDeviceMap.get(x)&&(this.localParticipant.activeDeviceMap.set(x,_),this.emit(X.ActiveDeviceChanged,x,_))}),this.onLocalTrackUnpublished=u=>{var f,p;(f=u.track)===null||f===void 0||f.off($.TrackProcessorUpdate,this.onTrackProcessorUpdate),(p=u.track)===null||p===void 0||p.off($.Restarted,this.onLocalTrackRestarted),this.emit(X.LocalTrackUnpublished,u,this.localParticipant)},this.onLocalTrackRestarted=u=>E(this,void 0,void 0,function*(){const f=yield u.getDeviceId(!1),p=Oh(u.source);p&&f&&f!==this.localParticipant.activeDeviceMap.get(p)&&(this.log.debug("local track restarted, setting ".concat(p," ").concat(f," active"),this.logContext),this.localParticipant.activeDeviceMap.set(p,f),this.emit(X.ActiveDeviceChanged,p,f))}),this.onLocalConnectionQualityChanged=u=>{this.emit(X.ConnectionQualityChanged,u,this.localParticipant)},this.onMediaDevicesError=(u,f)=>{this.emit(X.MediaDevicesError,u,f)},this.onLocalParticipantPermissionsChanged=u=>{this.emit(X.ParticipantPermissionsChanged,u,this.localParticipant)},this.onLocalChatMessageSent=u=>{this.emit(X.ChatMessage,u,this.localParticipant)},this.setMaxListeners(100),this.remoteParticipants=new Map,this.sidToIdentity=new Map,this.options=Object.assign(Object.assign({},ON),e),this.log=qn((s=this.options.loggerName)!==null&&s!==void 0?s:Sn.Room),this.transcriptionReceivedTimes=new Map,this.options.audioCaptureDefaults=Object.assign(Object.assign({},aT),e?.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},sT),e?.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},DN),e?.publishDefaults),this.maybeCreateEngine(),this.incomingDataStreamManager=new cA,this.outgoingDataStreamManager=new hA(this.engine,this.log),this.disconnectLock=new It,this.localParticipant=new bA("","",this.engine,this.options,this.rpcHandlers,this.outgoingDataStreamManager),(this.options.e2ee||this.options.encryption)&&this.setupE2EE(),this.engine.e2eeManager=this.e2eeManager,this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",wa(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",wa(this.options.audioCaptureDefaults.deviceId)),!((o=this.options.audioOutput)===null||o===void 0)&&o.deviceId&&this.switchActiveDevice("audiooutput",wa(this.options.audioOutput.deviceId)).catch(u=>this.log.warn("Could not set audio output: ".concat(u.message),this.logContext)),Kt()){const u=new AbortController;(d=(l=navigator.mediaDevices)===null||l===void 0?void 0:l.addEventListener)===null||d===void 0||d.call(l,"devicechange",this.handleDeviceChange,{signal:u.signal}),Os.cleanupRegistry&&Os.cleanupRegistry.register(this,()=>{u.abort()})}}registerTextStreamHandler(e,i){return this.incomingDataStreamManager.registerTextStreamHandler(e,i)}unregisterTextStreamHandler(e){return this.incomingDataStreamManager.unregisterTextStreamHandler(e)}registerByteStreamHandler(e,i){return this.incomingDataStreamManager.registerByteStreamHandler(e,i)}unregisterByteStreamHandler(e){return this.incomingDataStreamManager.unregisterByteStreamHandler(e)}registerRpcMethod(e,i){if(this.rpcHandlers.has(e))throw Error("RPC handler already registered for method ".concat(e,", unregisterRpcMethod before trying to register again"));this.rpcHandlers.set(e,i)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}setE2EEEnabled(e){return E(this,void 0,void 0,function*(){if(this.e2eeManager)yield Promise.all([this.localParticipant.setE2EEEnabled(e)]),this.localParticipant.identity!==""&&this.e2eeManager.setParticipantCryptorEnabled(e,this.localParticipant.identity);else throw Error("e2ee not configured, please set e2ee settings within the room options")})}setupE2EE(){var e;const i=!!this.options.encryption,s=this.options.encryption||this.options.e2ee;s&&("e2eeManager"in s?(this.e2eeManager=s.e2eeManager,this.e2eeManager.isDataChannelEncryptionEnabled=i):this.e2eeManager=new pN(s,i),this.e2eeManager.on(Qi.ParticipantEncryptionStatusChanged,(o,l)=>{nN(l)&&(this.isE2EEEnabled=o),this.emit(X.ParticipantEncryptionStatusChanged,o,l)}),this.e2eeManager.on(Qi.EncryptionError,(o,l)=>{const d=l?this.getParticipantByIdentity(l):void 0;this.emit(X.EncryptionError,o,d)}),(e=this.e2eeManager)===null||e===void 0||e.setup(this))}get logContext(){var e;return{room:this.name,roomID:(e=this.roomInfo)===null||e===void 0?void 0:e.sid,participant:this.localParticipant.identity,pID:this.localParticipant.sid}}get isRecording(){var e,i;return(i=(e=this.roomInfo)===null||e===void 0?void 0:e.activeRecording)!==null&&i!==void 0?i:!1}getSid(){return this.state===Ie.Disconnected?Mt.resolve(""):this.roomInfo&&this.roomInfo.sid!==""?Mt.resolve(this.roomInfo.sid):new Mt((e,i)=>{const s=o=>{o.sid!==""&&(this.engine.off(ie.RoomUpdate,s),e(o.sid))};this.engine.on(ie.RoomUpdate,s),this.once(X.Disconnected,()=>{this.engine.off(ie.RoomUpdate,s),i(new ut("Room disconnected before room server id was available"))})})}get name(){var e,i;return(i=(e=this.roomInfo)===null||e===void 0?void 0:e.name)!==null&&i!==void 0?i:""}get metadata(){var e;return(e=this.roomInfo)===null||e===void 0?void 0:e.metadata}get numParticipants(){var e,i;return(i=(e=this.roomInfo)===null||e===void 0?void 0:e.numParticipants)!==null&&i!==void 0?i:0}get numPublishers(){var e,i;return(i=(e=this.roomInfo)===null||e===void 0?void 0:e.numPublishers)!==null&&i!==void 0?i:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new sA(this.options),this.engine.e2eeManager=this.e2eeManager,this.engine.on(ie.ParticipantUpdate,this.handleParticipantUpdates).on(ie.RoomUpdate,this.handleRoomUpdate).on(ie.SpeakersChanged,this.handleSpeakersChanged).on(ie.StreamStateChanged,this.handleStreamStateUpdate).on(ie.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(ie.SubscriptionError,this.handleSubscriptionError).on(ie.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(ie.MediaTrackAdded,(e,i,s)=>{this.onTrackAdded(e,i,s)}).on(ie.Disconnected,e=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,e)}).on(ie.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(ie.DataPacketReceived,this.handleDataPacket).on(ie.Resuming,()=>{this.clearConnectionReconcile(),this.isResuming=!0,this.log.info("Resuming signal connection",this.logContext),this.setAndEmitConnectionState(Ie.SignalReconnecting)&&this.emit(X.SignalReconnecting)}).on(ie.Resumed,()=>{this.registerConnectionReconcile(),this.isResuming=!1,this.log.info("Resumed signal connection",this.logContext),this.updateSubscriptions(),this.emitBufferedEvents(),this.setAndEmitConnectionState(Ie.Connected)&&this.emit(X.Reconnected)}).on(ie.SignalResumed,()=>{this.bufferedEvents=[],(this.state===Ie.Reconnecting||this.isResuming)&&this.sendSyncState()}).on(ie.Restarting,this.handleRestarting).on(ie.SignalRestarted,this.handleSignalRestarted).on(ie.Offline,()=>{this.setAndEmitConnectionState(Ie.Reconnecting)&&this.emit(X.Reconnecting)}).on(ie.DCBufferStatusChanged,(e,i)=>{this.emit(X.DCBufferStatusChanged,e,i)}).on(ie.LocalTrackSubscribed,e=>{const i=this.localParticipant.getTrackPublications().find(s=>{let{trackSid:o}=s;return o===e});if(!i){this.log.warn("could not find local track subscription for subscribed event",this.logContext);return}this.localParticipant.emit(ae.LocalTrackSubscribed,i),this.emitWhenConnected(X.LocalTrackSubscribed,i,this.localParticipant)}).on(ie.RoomMoved,e=>{this.log.debug("room moved",e),e.room&&this.handleRoomUpdate(e.room),this.remoteParticipants.forEach((i,s)=>{this.handleParticipantDisconnected(s,i)}),this.emit(X.Moved,e.room.name),e.participant?this.handleParticipantUpdates([e.participant,...e.otherParticipants]):this.handleParticipantUpdates(e.otherParticipants)}),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine),this.outgoingDataStreamManager&&this.outgoingDataStreamManager.setupEngine(this.engine))}static getLocalDevices(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return Ct.getInstance().getDevices(e,i)}prepareConnection(e,i){return E(this,void 0,void 0,function*(){if(this.state===Ie.Disconnected){this.log.debug("prepareConnection to ".concat(e),this.logContext);try{if(Ds(new URL(e))&&i){this.regionUrlProvider=new De(e,i);const s=yield this.regionUrlProvider.getNextBestRegionUrl();s&&this.state===Ie.Disconnected&&(this.regionUrl=s,yield fetch($r(s),{method:"HEAD"}),this.log.debug("prepared connection to ".concat(s),this.logContext))}else yield fetch($r(e),{method:"HEAD"})}catch(s){this.log.warn("could not prepare connection",Object.assign(Object.assign({},this.logContext),{error:s}))}}})}getParticipantByIdentity(e){return this.localParticipant.identity===e?this.localParticipant:this.remoteParticipants.get(e)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(e,i){return E(this,void 0,void 0,function*(){let s=()=>E(this,void 0,void 0,function*(){}),o;switch(e){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":o=new Ln({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":o=new Ln({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":o=new Ln({scenario:{case:"serverLeave",value:!0}});break;case"migration":o=new Ln({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"disconnect-signal-on-resume":s=()=>E(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),o=new Ln({scenario:{case:"disconnectSignalOnResume",value:!0}});break;case"disconnect-signal-on-resume-no-messages":s=()=>E(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),o=new Ln({scenario:{case:"disconnectSignalOnResumeNoMessages",value:!0}});break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":o=new Ln({scenario:{case:"switchCandidateProtocol",value:e==="force-tls"?2:1}}),s=()=>E(this,void 0,void 0,function*(){const l=this.engine.client.onLeave;l&&l(new gc({reason:An.CLIENT_INITIATED,action:Es.RECONNECT}))});break;case"subscriber-bandwidth":if(i===void 0||typeof i!="number")throw new Error("subscriber-bandwidth requires a number as argument");o=new Ln({scenario:{case:"subscriberBandwidth",value:xa(i)}});break;case"leave-full-reconnect":o=new Ln({scenario:{case:"leaveRequestFullReconnect",value:!0}})}o&&(yield this.engine.client.sendSimulateScenario(o),yield s())})}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveDevice(e){return this.localParticipant.activeDeviceMap.get(e)}switchActiveDevice(e,i){return E(this,arguments,void 0,function(s,o){var l=this;let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return(function*(){var u,f,p,v,y,S,C;let _=!0,x=!1;const k=d?{exact:o}:o;if(s==="audioinput"){x=l.localParticipant.audioTrackPublications.size===0;const R=(u=l.getActiveDevice(s))!==null&&u!==void 0?u:l.options.audioCaptureDefaults.deviceId;l.options.audioCaptureDefaults.deviceId=k;const O=Array.from(l.localParticipant.audioTrackPublications.values()).filter(D=>D.source===Q.Source.Microphone);try{_=(yield Promise.all(O.map(D=>{var I;return(I=D.audioTrack)===null||I===void 0?void 0:I.setDeviceId(k)}))).every(D=>D===!0)}catch(D){throw l.options.audioCaptureDefaults.deviceId=R,D}const L=O.some(D=>{var I,j;return(j=(I=D.track)===null||I===void 0?void 0:I.isMuted)!==null&&j!==void 0?j:!1});_&&L&&(x=!0)}else if(s==="videoinput"){x=l.localParticipant.videoTrackPublications.size===0;const R=(f=l.getActiveDevice(s))!==null&&f!==void 0?f:l.options.videoCaptureDefaults.deviceId;l.options.videoCaptureDefaults.deviceId=k;const O=Array.from(l.localParticipant.videoTrackPublications.values()).filter(D=>D.source===Q.Source.Camera);try{_=(yield Promise.all(O.map(D=>{var I;return(I=D.videoTrack)===null||I===void 0?void 0:I.setDeviceId(k)}))).every(D=>D===!0)}catch(D){throw l.options.videoCaptureDefaults.deviceId=R,D}const L=O.some(D=>{var I,j;return(j=(I=D.track)===null||I===void 0?void 0:I.isMuted)!==null&&j!==void 0?j:!1});_&&L&&(x=!0)}else if(s==="audiooutput"){if(x=!0,!Ih()&&!l.options.webAudioMix||l.options.webAudioMix&&l.audioContext&&!("setSinkId"in l.audioContext))throw new Error("cannot switch audio output, the current browser does not support it");l.options.webAudioMix&&(o=(p=yield Ct.getInstance().normalizeDeviceId("audiooutput",o))!==null&&p!==void 0?p:""),(v=(C=l.options).audioOutput)!==null&&v!==void 0||(C.audioOutput={});const R=(y=l.getActiveDevice(s))!==null&&y!==void 0?y:l.options.audioOutput.deviceId;l.options.audioOutput.deviceId=o;try{l.options.webAudioMix&&((S=l.audioContext)===null||S===void 0||S.setSinkId(o)),yield Promise.all(Array.from(l.remoteParticipants.values()).map(O=>O.setAudioOutput({deviceId:o})))}catch(O){throw l.options.audioOutput.deviceId=R,O}}return x&&(l.localParticipant.activeDeviceMap.set(s,o),l.emit(X.ActiveDeviceChanged,s,o)),_})()})}setupLocalParticipantEvents(){this.localParticipant.on(ae.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(ae.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(ae.AttributesChanged,this.onLocalAttributesChanged).on(ae.TrackMuted,this.onLocalTrackMuted).on(ae.TrackUnmuted,this.onLocalTrackUnmuted).on(ae.LocalTrackPublished,this.onLocalTrackPublished).on(ae.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(ae.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(ae.MediaDevicesError,this.onMediaDevicesError).on(ae.AudioStreamAcquired,this.startAudio).on(ae.ChatMessage,this.onLocalChatMessageSent).on(ae.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var e;(e=this.engine)===null||e===void 0||e.close(),this.engine=void 0,this.isResuming=!1,this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.bufferedEvents=[],this.maybeCreateEngine()}onTrackAdded(e,i,s){if(this.state===Ie.Connecting||this.state===Ie.Reconnecting){const y=()=>{this.log.debug("deferring on track for later",{mediaTrackId:e.id,mediaStreamId:i.id,tracksInStream:i.getTracks().map(C=>C.id)}),this.onTrackAdded(e,i,s),S()},S=()=>{this.off(X.Reconnected,y),this.off(X.Connected,y),this.off(X.Disconnected,S)};this.once(X.Reconnected,y),this.once(X.Connected,y),this.once(X.Disconnected,S);return}if(this.state===Ie.Disconnected){this.log.warn("skipping incoming track after Room disconnected",this.logContext);return}if(e.readyState==="ended"){this.log.info("skipping incoming track as it already ended",this.logContext);return}const o=FR(i.id),l=o[0];let d=o[1],u=e.id;if(d&&d.startsWith("TR")&&(u=d),l===this.localParticipant.sid){this.log.warn("tried to create RemoteParticipant for local participant",this.logContext);return}const f=Array.from(this.remoteParticipants.values()).find(y=>y.sid===l);if(!f){this.log.error("Tried to add a track for a participant, that's not present. Sid: ".concat(l),this.logContext);return}if(!u.startsWith("TR")){const y=this.engine.getTrackIdForReceiver(s);if(!y){this.log.error("Tried to add a track whose 'sid' could not be found for a participant, that's not present. Sid: ".concat(l),this.logContext);return}u=y}u.startsWith("TR")||this.log.warn("Tried to add a track whose 'sid' could not be determined for a participant, that's not present. Sid: ".concat(l,", streamId: ").concat(d,", trackId: ").concat(u),Object.assign(Object.assign({},this.logContext),{rpID:l,streamId:d,trackId:u}));let p;this.options.adaptiveStream&&(typeof this.options.adaptiveStream=="object"?p=this.options.adaptiveStream:p={});const v=f.addSubscribedMediaTrack(e,u,i,s,p);v?.isEncrypted&&!this.e2eeManager&&this.emit(X.EncryptionError,new Error("Encrypted ".concat(v.source," track received from participant ").concat(f.sid,", but room does not have encryption enabled!")))}handleDisconnect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,i=arguments.length>1?arguments[1]:void 0;var s,o;if(this.clearConnectionReconcile(),this.isResuming=!1,this.bufferedEvents=[],this.transcriptionReceivedTimes.clear(),this.incomingDataStreamManager.clearControllers(),this.state!==Ie.Disconnected){this.regionUrl=void 0,this.regionUrlProvider&&this.regionUrlProvider.notifyDisconnected();try{this.remoteParticipants.forEach(l=>{l.trackPublications.forEach(d=>{l.unpublishTrack(d.trackSid)})}),this.localParticipant.trackPublications.forEach(l=>{var d,u,f;l.track&&this.localParticipant.unpublishTrack(l.track,e),e?((d=l.track)===null||d===void 0||d.detach(),(u=l.track)===null||u===void 0||u.stop()):(f=l.track)===null||f===void 0||f.stopMonitor()}),this.localParticipant.off(ae.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(ae.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(ae.AttributesChanged,this.onLocalAttributesChanged).off(ae.TrackMuted,this.onLocalTrackMuted).off(ae.TrackUnmuted,this.onLocalTrackUnmuted).off(ae.LocalTrackPublished,this.onLocalTrackPublished).off(ae.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(ae.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(ae.MediaDevicesError,this.onMediaDevicesError).off(ae.AudioStreamAcquired,this.startAudio).off(ae.ChatMessage,this.onLocalChatMessageSent).off(ae.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.trackPublications.clear(),this.localParticipant.videoTrackPublications.clear(),this.localParticipant.audioTrackPublications.clear(),this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.activeSpeakers=[],this.audioContext&&typeof this.options.webAudioMix=="boolean"&&(this.audioContext.close(),this.audioContext=void 0),Kt()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),(o=(s=navigator.mediaDevices)===null||s===void 0?void 0:s.removeEventListener)===null||o===void 0||o.call(s,"devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(Ie.Disconnected),this.emit(X.Disconnected,i)}}}handleParticipantDisconnected(e,i){var s;this.remoteParticipants.delete(e),i&&(this.incomingDataStreamManager.validateParticipantHasNoActiveDataStreams(e),i.trackPublications.forEach(o=>{i.unpublishTrack(o.trackSid,!0)}),this.emit(X.ParticipantDisconnected,i),i.setDisconnected(),(s=this.localParticipant)===null||s===void 0||s.handleParticipantDisconnected(i.identity))}handleIncomingRpcRequest(e,i,s,o,l,d){return E(this,void 0,void 0,function*(){if(yield this.engine.publishRpcAck(e,i),d!==1){yield this.engine.publishRpcResponse(e,i,null,rt.builtIn("UNSUPPORTED_VERSION"));return}const u=this.rpcHandlers.get(s);if(!u){yield this.engine.publishRpcResponse(e,i,null,rt.builtIn("UNSUPPORTED_METHOD"));return}let f=null,p=null;try{const v=yield u({requestId:i,callerIdentity:e,payload:o,responseTimeout:l});wf(v)>oT?(f=rt.builtIn("RESPONSE_PAYLOAD_TOO_LARGE"),this.log.warn("RPC Response payload too large for ".concat(s))):p=v}catch(v){v instanceof rt?f=v:(this.log.warn("Uncaught error returned by RPC handler for ".concat(s,". Returning APPLICATION_ERROR instead."),v),f=rt.builtIn("APPLICATION_ERROR"))}yield this.engine.publishRpcResponse(e,i,p,f)})}selectDefaultDevices(){return E(this,void 0,void 0,function*(){var e,i,s;const o=Ct.getInstance().previousDevices,l=yield Ct.getInstance().getDevices(void 0,!1),d=Yt();if(d?.name==="Chrome"&&d.os!=="iOS")for(let f of l){const p=o.find(v=>v.deviceId===f.deviceId);p&&p.label!==""&&p.kind===f.kind&&p.label!==f.label&&this.getActiveDevice(f.kind)==="default"&&this.emit(X.ActiveDeviceChanged,f.kind,f.deviceId)}const u=["audiooutput","audioinput","videoinput"];for(let f of u){const p=DR(f),v=this.localParticipant.getTrackPublication(p);if(v&&(!((e=v.track)===null||e===void 0)&&e.isUserProvided))continue;const y=l.filter(C=>C.kind===f),S=this.getActiveDevice(f);if(S===((i=o.filter(C=>C.kind===f)[0])===null||i===void 0?void 0:i.deviceId)&&y.length>0&&((s=y[0])===null||s===void 0?void 0:s.deviceId)!==S){yield this.switchActiveDevice(f,y[0].deviceId);continue}f==="audioinput"&&!Zr()||f==="videoinput"||y.length>0&&!y.find(C=>C.deviceId===this.getActiveDevice(f))&&(f!=="audiooutput"||!Zr())&&(yield this.switchActiveDevice(f,y[0].deviceId))}})}acquireAudioContext(){return E(this,void 0,void 0,function*(){var e,i;if(typeof this.options.webAudioMix!="boolean"&&this.options.webAudioMix.audioContext?this.audioContext=this.options.webAudioMix.audioContext:(!this.audioContext||this.audioContext.state==="closed")&&(this.audioContext=(e=ZS())!==null&&e!==void 0?e:void 0),this.options.webAudioMix&&this.remoteParticipants.forEach(o=>o.setAudioContext(this.audioContext)),this.localParticipant.setAudioContext(this.audioContext),this.audioContext&&this.audioContext.state==="suspended")try{yield Promise.race([this.audioContext.resume(),Nt(200)])}catch(o){this.log.warn("Could not resume audio context",Object.assign(Object.assign({},this.logContext),{error:o}))}const s=((i=this.audioContext)===null||i===void 0?void 0:i.state)==="running";s!==this.canPlaybackAudio&&(this.audioEnabled=s,this.emit(X.AudioPlaybackStatusChanged,s))})}createParticipant(e,i){var s;let o;return i?o=ac.fromParticipantInfo(this.engine.client,i,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}):o=new ac(this.engine.client,"",e,void 0,void 0,void 0,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}),this.options.webAudioMix&&o.setAudioContext(this.audioContext),!((s=this.options.audioOutput)===null||s===void 0)&&s.deviceId&&o.setAudioOutput(this.options.audioOutput).catch(l=>this.log.warn("Could not set audio output: ".concat(l.message),this.logContext)),o}getOrCreateParticipant(e,i){if(this.remoteParticipants.has(e)){const o=this.remoteParticipants.get(e);return i&&o.updateInfo(i)&&this.sidToIdentity.set(i.sid,i.identity),o}const s=this.createParticipant(e,i);return this.remoteParticipants.set(e,s),this.sidToIdentity.set(i.sid,i.identity),this.emitWhenConnected(X.ParticipantConnected,s),s.on(ae.TrackPublished,o=>{this.emitWhenConnected(X.TrackPublished,o,s)}).on(ae.TrackSubscribed,(o,l)=>{o.kind===Q.Kind.Audio?(o.on($.AudioPlaybackStarted,this.handleAudioPlaybackStarted),o.on($.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):o.kind===Q.Kind.Video&&(o.on($.VideoPlaybackFailed,this.handleVideoPlaybackFailed),o.on($.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit(X.TrackSubscribed,o,l,s)}).on(ae.TrackUnpublished,o=>{this.emit(X.TrackUnpublished,o,s)}).on(ae.TrackUnsubscribed,(o,l)=>{this.emit(X.TrackUnsubscribed,o,l,s)}).on(ae.TrackMuted,o=>{this.emitWhenConnected(X.TrackMuted,o,s)}).on(ae.TrackUnmuted,o=>{this.emitWhenConnected(X.TrackUnmuted,o,s)}).on(ae.ParticipantMetadataChanged,o=>{this.emitWhenConnected(X.ParticipantMetadataChanged,o,s)}).on(ae.ParticipantNameChanged,o=>{this.emitWhenConnected(X.ParticipantNameChanged,o,s)}).on(ae.AttributesChanged,o=>{this.emitWhenConnected(X.ParticipantAttributesChanged,o,s)}).on(ae.ConnectionQualityChanged,o=>{this.emitWhenConnected(X.ConnectionQualityChanged,o,s)}).on(ae.ParticipantPermissionsChanged,o=>{this.emitWhenConnected(X.ParticipantPermissionsChanged,o,s)}).on(ae.TrackSubscriptionStatusChanged,(o,l)=>{this.emitWhenConnected(X.TrackSubscriptionStatusChanged,o,l,s)}).on(ae.TrackSubscriptionFailed,(o,l)=>{this.emit(X.TrackSubscriptionFailed,o,s,l)}).on(ae.TrackSubscriptionPermissionChanged,(o,l)=>{this.emitWhenConnected(X.TrackSubscriptionPermissionChanged,o,l,s)}).on(ae.Active,()=>{this.emitWhenConnected(X.ParticipantActive,s),s.kind===Qr.AGENT&&this.localParticipant.setActiveAgent(s)}),i&&s.updateInfo(i),s}sendSyncState(){const e=Array.from(this.remoteParticipants.values()).reduce((s,o)=>(s.push(...o.getTrackPublications()),s),[]),i=this.localParticipant.getTrackPublications();this.engine.sendSyncState(e,i)}updateSubscriptions(){for(const e of this.remoteParticipants.values())for(const i of e.videoTrackPublications.values())i.isSubscribed&&tN(i)&&i.emitTrackUpdate()}getRemoteParticipantBySid(e){const i=this.sidToIdentity.get(e);if(i)return this.remoteParticipants.get(i)}registerConnectionReconcile(){this.clearConnectionReconcile();let e=0;this.connectionReconcileInterval=Rt.setInterval(()=>{!this.engine||this.engine.isClosed||!this.engine.verifyTransport()?(e++,this.log.warn("detected connection state mismatch",Object.assign(Object.assign({},this.logContext),{numFailures:e,engine:this.engine?{closed:this.engine.isClosed,transportsConnectedOrConnecting:this.engine.verifyTransport()}:void 0})),e>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,An.STATE_MISMATCH))):e=0},TA)}clearConnectionReconcile(){this.connectionReconcileInterval&&Rt.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(e){return e===this.state?!1:(this.state=e,this.emit(X.ConnectionStateChanged,this.state),!0)}emitBufferedEvents(){this.bufferedEvents.forEach(e=>{let[i,s]=e;this.emit(i,...s)}),this.bufferedEvents=[]}emitWhenConnected(e){for(var i=arguments.length,s=new Array(i>1?i-1:0),o=1;o<i;o++)s[o-1]=arguments[o];if(this.state===Ie.Reconnecting||this.isResuming||!this.engine||this.engine.pendingReconnect)this.bufferedEvents.push([e,s]);else if(this.state===Ie.Connected)return this.emit(e,...s);return!1}simulateParticipants(e){return E(this,void 0,void 0,function*(){var i,s,o,l;const d=Object.assign({audio:!0,video:!0,useRealTracks:!1},e.publish),u=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},e.participants);if(this.handleDisconnect(),this.roomInfo=new hc({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:et.parse(new Date().getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new Ra({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(X.SignalConnected),this.emit(X.Connected),this.setAndEmitConnectionState(Ie.Connected),d.video){const f=new Hh(Q.Kind.Video,new Ts({source:vt.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:_n.AUDIO,name:"video-dummy"}),new ic(d.useRealTracks&&(!((i=window.navigator.mediaDevices)===null||i===void 0)&&i.getUserMedia)?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:u0(160*((s=u.aspectRatios[0])!==null&&s!==void 0?s:1),160,!0,!0),void 0,!1,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(f),this.localParticipant.emit(ae.LocalTrackPublished,f)}if(d.audio){const f=new Hh(Q.Kind.Audio,new Ts({source:vt.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:_n.AUDIO}),new nc(d.useRealTracks&&(!((o=navigator.mediaDevices)===null||o===void 0)&&o.getUserMedia)?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:ah(),void 0,!1,this.audioContext,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(f),this.localParticipant.emit(ae.LocalTrackPublished,f)}for(let f=0;f<u.count-1;f+=1){let p=new Ra({sid:Math.floor(Math.random()*1e4).toString(),identity:"simulated-".concat(f),state:xs.ACTIVE,tracks:[],joinedAt:et.parse(Date.now())});const v=this.getOrCreateParticipant(p.identity,p);if(u.video){const y=u0(160*((l=u.aspectRatios[f%u.aspectRatios.length])!==null&&l!==void 0?l:1),160,!1,!0),S=new Ts({source:vt.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:_n.AUDIO});v.addSubscribedMediaTrack(y,S.sid,new MediaStream([y]),new RTCRtpReceiver),p.tracks=[...p.tracks,S]}if(u.audio){const y=ah(),S=new Ts({source:vt.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:_n.AUDIO});v.addSubscribedMediaTrack(y,S.sid,new MediaStream([y]),new RTCRtpReceiver),p.tracks=[...p.tracks,S]}v.updateInfo(p)}})}emit(e){for(var i=arguments.length,s=new Array(i>1?i-1:0),o=1;o<i;o++)s[o-1]=arguments[o];if(e!==X.ActiveSpeakersChanged&&e!==X.TranscriptionReceived){const l=gT(s).filter(d=>d!==void 0);(e===X.TrackSubscribed||e===X.TrackUnsubscribed)&&this.log.trace("subscribe trace: ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:l})),this.log.debug("room event ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:l}))}return super.emit(e,...s)}}Os.cleanupRegistry=typeof FinalizationRegistry<"u"&&new FinalizationRegistry(a=>{a()});function gT(a){return a.map(e=>{if(e)return Array.isArray(e)?gT(e):typeof e=="object"?"logContext"in e?e.logContext:void 0:e})}var j0;(function(a){a[a.TooShort=0]="TooShort",a[a.HeaderOverrun=1]="HeaderOverrun",a[a.MissingExtWords=2]="MissingExtWords",a[a.UnsupportedVersion=3]="UnsupportedVersion",a[a.InvalidHandle=4]="InvalidHandle",a[a.MalformedExt=5]="MalformedExt"})(j0||(j0={}));var P0;(function(a){a[a.TooSmallForHeader=0]="TooSmallForHeader",a[a.TooSmallForPayload=1]="TooSmallForPayload"})(P0||(P0={}));var sc;(function(a){a[a.UserTimestamp=2]="UserTimestamp",a[a.E2ee=1]="E2ee"})(sc||(sc={}));sc.UserTimestamp;sc.E2ee;var I0;(function(a){a[a.Reserved=0]="Reserved",a[a.TooLarge=1]="TooLarge"})(I0||(I0={}));var L0;(function(a){a[a.Start=0]="Start",a[a.Inter=1]="Inter",a[a.Final=2]="Final",a[a.Single=3]="Single"})(L0||(L0={}));var U0;(function(a){a[a.MtuTooShort=0]="MtuTooShort"})(U0||(U0={}));qn(Sn.DataTracks);var B0;(function(a){a[a.Interrupted=0]="Interrupted",a[a.UnknownFrame=1]="UnknownFrame",a[a.BufferFull=2]="BufferFull",a[a.Incomplete=3]="Incomplete"})(B0||(B0={}));var wn;(function(a){a[a.IDLE=0]="IDLE",a[a.RUNNING=1]="RUNNING",a[a.SKIPPED=2]="SKIPPED",a[a.SUCCESS=3]="SUCCESS",a[a.FAILED=4]="FAILED"})(wn||(wn={}));class ia extends Vn.EventEmitter{constructor(e,i){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.status=wn.IDLE,this.logs=[],this.options={},this.url=e,this.token=i,this.name=this.constructor.name,this.room=new Os(s.roomOptions),this.connectOptions=s.connectOptions,this.options=s}run(e){return E(this,void 0,void 0,function*(){if(this.status!==wn.IDLE)throw Error("check is running already");this.setStatus(wn.RUNNING);try{yield this.perform()}catch(i){i instanceof Error&&(this.options.errorsAsWarnings?this.appendWarning(i.message):this.appendError(i.message))}return yield this.disconnect(),yield new Promise(i=>setTimeout(i,500)),this.status!==wn.SKIPPED&&this.setStatus(this.isSuccess()?wn.SUCCESS:wn.FAILED),e&&e(),this.getInfo()})}isSuccess(){return!this.logs.some(e=>e.level==="error")}connect(e){return E(this,void 0,void 0,function*(){return this.room.state===Ie.Connected?this.room:(e||(e=this.url),yield this.room.connect(e,this.token,this.connectOptions),this.room)})}disconnect(){return E(this,void 0,void 0,function*(){this.room&&this.room.state!==Ie.Disconnected&&(yield this.room.disconnect(),yield new Promise(e=>setTimeout(e,500)))})}skip(){this.setStatus(wn.SKIPPED)}switchProtocol(e){return E(this,void 0,void 0,function*(){let i=!1,s=!1;if(this.room.on(X.Reconnecting,()=>{i=!0}),this.room.once(X.Reconnected,()=>{s=!0}),this.room.simulateScenario("force-".concat(e)),yield new Promise(l=>setTimeout(l,1e3)),!i)return;const o=Date.now()+1e4;for(;Date.now()<o;){if(s)return;yield Nt(100)}throw new Error("Could not reconnect using ".concat(e," protocol after 10 seconds"))})}appendMessage(e){this.logs.push({level:"info",message:e}),this.emit("update",this.getInfo())}appendWarning(e){this.logs.push({level:"warning",message:e}),this.emit("update",this.getInfo())}appendError(e){this.logs.push({level:"error",message:e}),this.emit("update",this.getInfo())}setStatus(e){this.status=e,this.emit("update",this.getInfo())}get engine(){var e;return(e=this.room)===null||e===void 0?void 0:e.engine}getInfo(){return{logs:this.logs,name:this.name,status:this.status,description:this.description}}}class CA extends ia{get description(){return"Cloud regions"}perform(){return E(this,void 0,void 0,function*(){const e=new De(this.url,this.token);if(!e.isCloud()){this.skip();return}const i=[],s=new Set;for(let l=0;l<3;l++){const d=yield e.getNextBestRegionUrl();if(!d)break;if(s.has(d))continue;s.add(d);const u=yield this.checkCloudRegion(d);this.appendMessage("".concat(u.region," RTT: ").concat(u.rtt,"ms, duration: ").concat(u.duration,"ms")),i.push(u)}i.sort((l,d)=>(l.duration-d.duration)*.5+(l.rtt-d.rtt)*.5);const o=i[0];this.bestStats=o,this.appendMessage("best Cloud region: ".concat(o.region))})}getInfo(){const e=super.getInfo();return e.data=this.bestStats,e}checkCloudRegion(e){return E(this,void 0,void 0,function*(){var i,s;yield this.connect(e),this.options.protocol==="tcp"&&(yield this.switchProtocol("tcp"));const o=(i=this.room.serverInfo)===null||i===void 0?void 0:i.region;if(!o)throw new Error("Region not found");const l=yield this.room.localParticipant.streamText({topic:"test"}),d=1e3,f=1e6/d,p="A".repeat(d),v=Date.now();for(let _=0;_<f;_++)yield l.write(p);yield l.close();const y=Date.now(),S=yield(s=this.room.engine.pcManager)===null||s===void 0?void 0:s.publisher.getStats(),C={region:o,rtt:1e4,duration:y-v};return S?.forEach(_=>{_.type==="candidate-pair"&&_.nominated&&(C.rtt=_.currentRoundTripTime*1e3)}),yield this.disconnect(),C})}}const fh=1e4;class kA extends ia{get description(){return"Connection via UDP vs TCP"}perform(){return E(this,void 0,void 0,function*(){const e=yield this.checkConnectionProtocol("udp"),i=yield this.checkConnectionProtocol("tcp");this.bestStats=e,e.qualityLimitationDurations.bandwidth-i.qualityLimitationDurations.bandwidth>.5||(e.packetsLost-i.packetsLost)/e.packetsSent>.01?(this.appendMessage("best connection quality via tcp"),this.bestStats=i):this.appendMessage("best connection quality via udp");const s=this.bestStats;this.appendMessage("upstream bitrate: ".concat((s.bitrateTotal/s.count/1e3/1e3).toFixed(2)," mbps")),this.appendMessage("RTT: ".concat((s.rttTotal/s.count*1e3).toFixed(2)," ms")),this.appendMessage("jitter: ".concat((s.jitterTotal/s.count*1e3).toFixed(2)," ms")),s.packetsLost>0&&this.appendWarning("packets lost: ".concat((s.packetsLost/s.packetsSent*100).toFixed(2),"%")),s.qualityLimitationDurations.bandwidth>1&&this.appendWarning("bandwidth limited ".concat((s.qualityLimitationDurations.bandwidth/(fh/1e3)*100).toFixed(2),"%")),s.qualityLimitationDurations.cpu>0&&this.appendWarning("cpu limited ".concat((s.qualityLimitationDurations.cpu/(fh/1e3)*100).toFixed(2),"%"))})}getInfo(){const e=super.getInfo();return e.data=this.bestStats,e}checkConnectionProtocol(e){return E(this,void 0,void 0,function*(){yield this.connect(),e==="tcp"?yield this.switchProtocol("tcp"):yield this.switchProtocol("udp");const i=document.createElement("canvas");i.width=1280,i.height=720;const s=i.getContext("2d");if(!s)throw new Error("Could not get canvas context");let o=0;const l=()=>{o=(o+1)%360,s.fillStyle="hsl(".concat(o,", 100%, 50%)"),s.fillRect(0,0,i.width,i.height),requestAnimationFrame(l)};l();const u=i.captureStream(30).getVideoTracks()[0],p=(yield this.room.localParticipant.publishTrack(u,{simulcast:!1,degradationPreference:"maintain-resolution",videoEncoding:{maxBitrate:2e6}})).track,v={protocol:e,packetsLost:0,packetsSent:0,qualityLimitationDurations:{},rttTotal:0,jitterTotal:0,bitrateTotal:0,count:0},y=setInterval(()=>E(this,void 0,void 0,function*(){const S=yield p.getRTCStatsReport();S?.forEach(C=>{C.type==="outbound-rtp"?(v.packetsSent=C.packetsSent,v.qualityLimitationDurations=C.qualityLimitationDurations,v.bitrateTotal+=C.targetBitrate,v.count++):C.type==="remote-inbound-rtp"&&(v.packetsLost=C.packetsLost,v.rttTotal+=C.roundTripTime,v.jitterTotal+=C.jitter)})}),1e3);return yield new Promise(S=>setTimeout(S,fh)),clearInterval(y),u.stop(),i.remove(),yield this.disconnect(),v})}}class xA extends ia{get description(){return"Can publish audio"}perform(){return E(this,void 0,void 0,function*(){var e;const i=yield this.connect(),s=yield mT();if(yield XS(s,1e3))throw new Error("unable to detect audio from microphone");this.appendMessage("detected audio from microphone"),i.localParticipant.publishTrack(s),yield new Promise(u=>setTimeout(u,3e3));const l=yield(e=s.sender)===null||e===void 0?void 0:e.getStats();if(!l)throw new Error("Could not get RTCStats");let d=0;if(l.forEach(u=>{u.type==="outbound-rtp"&&(u.kind==="audio"||!u.kind&&u.mediaType==="audio")&&(d=u.packetsSent)}),d===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(d," audio packets"))})}}class EA extends ia{get description(){return"Can publish video"}perform(){return E(this,void 0,void 0,function*(){var e;const i=yield this.connect(),s=yield gA();yield this.checkForVideo(s.mediaStreamTrack),i.localParticipant.publishTrack(s),yield new Promise(d=>setTimeout(d,5e3));const o=yield(e=s.sender)===null||e===void 0?void 0:e.getStats();if(!o)throw new Error("Could not get RTCStats");let l=0;if(o.forEach(d=>{d.type==="outbound-rtp"&&(d.kind==="video"||!d.kind&&d.mediaType==="video")&&(l+=d.packetsSent)}),l===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(l," video packets"))})}checkForVideo(e){return E(this,void 0,void 0,function*(){const i=new MediaStream;i.addTrack(e.clone());const s=document.createElement("video");s.srcObject=i,s.muted=!0,s.autoplay=!0,s.playsInline=!0,s.setAttribute("playsinline","true"),document.body.appendChild(s),yield new Promise(o=>{s.onplay=()=>{setTimeout(()=>{var l,d,u,f;const p=document.createElement("canvas"),v=e.getSettings(),y=(d=(l=v.width)!==null&&l!==void 0?l:s.videoWidth)!==null&&d!==void 0?d:1280,S=(f=(u=v.height)!==null&&u!==void 0?u:s.videoHeight)!==null&&f!==void 0?f:720;p.width=y,p.height=S;const C=p.getContext("2d");C.drawImage(s,0,0);const x=C.getImageData(0,0,p.width,p.height).data;let k=!0;for(let R=0;R<x.length;R+=4)if(x[R]!==0||x[R+1]!==0||x[R+2]!==0){k=!1;break}k?this.appendError("camera appears to be producing only black frames"):this.appendMessage("received video frames"),o()},1e3)},s.play()}),i.getTracks().forEach(o=>o.stop()),s.remove()})}}class wA extends ia{get description(){return"Resuming connection after interruption"}perform(){return E(this,void 0,void 0,function*(){var e;const i=yield this.connect();let s=!1,o=!1,l;const d=new Promise(p=>{setTimeout(p,5e3),l=p}),u=()=>{s=!0};i.on(X.SignalReconnecting,u).on(X.Reconnecting,u).on(X.Reconnected,()=>{o=!0,l(!0)}),(e=i.engine.client.ws)===null||e===void 0||e.close();const f=i.engine.client.onClose;if(f&&f(""),yield d,s){if(!o||i.state!==Ie.Connected)throw this.appendWarning("reconnection is only possible in Redis-based configurations"),new Error("Not able to reconnect")}else throw new Error("Did not attempt to reconnect")})}}class _A extends ia{get description(){return"Can connect via TURN"}perform(){return E(this,void 0,void 0,function*(){var e,i,s;Ds(new URL(this.url))&&(this.appendMessage("Using region specific url"),this.url=(e=yield new De(this.url,this.token).getNextBestRegionUrl())!==null&&e!==void 0?e:this.url);const o=new Tf,l=yield o.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3},void 0,!0);let d=!1,u=!1,f=!1;for(let p of l.iceServers)for(let v of p.urls)v.startsWith("turn:")?(u=!0,f=!0):v.startsWith("turns:")&&(u=!0,f=!0,d=!0),v.startsWith("stun:")&&(f=!0);f?u&&!d&&this.appendWarning("TURN is configured server side, but TURN/TLS is unavailable."):this.appendWarning("No STUN servers configured on server side."),yield o.close(),!((s=(i=this.connectOptions)===null||i===void 0?void 0:i.rtcConfig)===null||s===void 0)&&s.iceServers||u?yield this.room.connect(this.url,this.token,{rtcConfig:{iceTransportPolicy:"relay"}}):(this.appendWarning("No TURN servers configured."),this.skip(),yield new Promise(p=>setTimeout(p,0)))})}}class RA extends ia{get description(){return"Establishing WebRTC connection"}perform(){return E(this,void 0,void 0,function*(){let e=!1,i=!1;this.room.on(X.SignalConnected,()=>{var s;const o=this.room.engine.client.onTrickle;this.room.engine.client.onTrickle=(l,d)=>{if(l.candidate){const u=new RTCIceCandidate(l);let f="".concat(u.protocol," ").concat(u.address,":").concat(u.port," ").concat(u.type);u.address&&(NA(u.address)?f+=" (private)":u.protocol==="tcp"&&u.tcpType==="passive"?(e=!0,f+=" (passive)"):u.protocol==="udp"&&(i=!0)),this.appendMessage(f)}o&&o(l,d)},!((s=this.room.engine.pcManager)===null||s===void 0)&&s.subscriber&&(this.room.engine.pcManager.subscriber.onIceCandidateError=l=>{l instanceof RTCPeerConnectionIceErrorEvent&&this.appendWarning("error with ICE candidate: ".concat(l.errorCode," ").concat(l.errorText," ").concat(l.url))})});try{yield this.connect(),Se.info("now the room is connected")}catch(s){throw this.appendWarning("ports need to be open on firewall in order to connect."),s}e||this.appendWarning("Server is not configured for ICE/TCP"),i||this.appendWarning("No public IPv4 UDP candidates were found. Your server is likely not configured correctly")})}}function NA(a){const e=a.split(".");if(e.length===4){if(e[0]==="10")return!0;if(e[0]==="192"&&e[1]==="168")return!0;if(e[0]==="172"){const i=parseInt(e[1],10);if(i>=16&&i<=31)return!0}}return!1}class AA extends ia{get description(){return"Connecting to signal connection via WebSocket"}perform(){return E(this,void 0,void 0,function*(){var e,i,s;(this.url.startsWith("ws:")||this.url.startsWith("http:"))&&this.appendWarning("Server is insecure, clients may block connections to it");let o=new Tf,l;try{l=yield o.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3},void 0,!0)}catch(d){if(Ds(new URL(this.url))){this.appendMessage("Initial connection failed with error ".concat(d.message,". Retrying with region fallback"));const f=yield new De(this.url,this.token).getNextBestRegionUrl();f&&(l=yield o.join(f,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3},void 0,!0),this.appendMessage("Fallback to region worked. To avoid initial connections failing, ensure you're calling room.prepareConnection() ahead of time"))}}l?(this.appendMessage("Connected to server, version ".concat(l.serverVersion,".")),((e=l.serverInfo)===null||e===void 0?void 0:e.edition)===Xb.Cloud&&(!((i=l.serverInfo)===null||i===void 0)&&i.region)&&this.appendMessage("LiveKit Cloud: ".concat((s=l.serverInfo)===null||s===void 0?void 0:s.region))):this.appendError("Websocket connection could not be established"),yield o.close()})}}class cM extends Vn.EventEmitter{constructor(e,i){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.options={},this.checkResults=new Map,this.url=e,this.token=i,this.options=s}getNextCheckId(){const e=this.checkResults.size;return this.checkResults.set(e,{logs:[],status:wn.IDLE,name:"",description:""}),e}updateCheck(e,i){this.checkResults.set(e,i),this.emit("checkUpdate",e,i)}isSuccess(){return Array.from(this.checkResults.values()).every(e=>e.status!==wn.FAILED)}getResults(){return Array.from(this.checkResults.values())}createAndRunCheck(e){return E(this,void 0,void 0,function*(){const i=this.getNextCheckId(),s=new e(this.url,this.token,this.options),o=d=>{this.updateCheck(i,d)};s.on("update",o);const l=yield s.run();return s.off("update",o),l})}checkWebsocket(){return E(this,void 0,void 0,function*(){return this.createAndRunCheck(AA)})}checkWebRTC(){return E(this,void 0,void 0,function*(){return this.createAndRunCheck(RA)})}checkTURN(){return E(this,void 0,void 0,function*(){return this.createAndRunCheck(_A)})}checkReconnect(){return E(this,void 0,void 0,function*(){return this.createAndRunCheck(wA)})}checkPublishAudio(){return E(this,void 0,void 0,function*(){return this.createAndRunCheck(xA)})}checkPublishVideo(){return E(this,void 0,void 0,function*(){return this.createAndRunCheck(EA)})}checkConnectionProtocol(){return E(this,void 0,void 0,function*(){const e=yield this.createAndRunCheck(kA);if(e.data&&"protocol"in e.data){const i=e.data;this.options.protocol=i.protocol}return e})}checkCloudRegion(){return E(this,void 0,void 0,function*(){return this.createAndRunCheck(CA)})}}function we(a,e,i){return(e=DA(e))in a?Object.defineProperty(a,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):a[e]=i,a}function MA(a,e){if(typeof a!="object"||!a)return a;var i=a[Symbol.toPrimitive];if(i!==void 0){var s=i.call(a,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(a)}function DA(a){var e=MA(a,"string");return typeof e=="symbol"?e:e+""}new TextEncoder;new TextDecoder;class Lt extends Error{constructor(e,i){var s;super(e,i),we(this,"code","ERR_JOSE_GENERIC"),this.name=this.constructor.name,(s=Error.captureStackTrace)===null||s===void 0||s.call(Error,this,this.constructor)}}we(Lt,"code","ERR_JOSE_GENERIC");class OA extends Lt{constructor(e,i){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"unspecified",o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unspecified";super(e,{cause:{claim:s,reason:o,payload:i}}),we(this,"code","ERR_JWT_CLAIM_VALIDATION_FAILED"),we(this,"claim",void 0),we(this,"reason",void 0),we(this,"payload",void 0),this.claim=s,this.reason=o,this.payload=i}}we(OA,"code","ERR_JWT_CLAIM_VALIDATION_FAILED");class jA extends Lt{constructor(e,i){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"unspecified",o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unspecified";super(e,{cause:{claim:s,reason:o,payload:i}}),we(this,"code","ERR_JWT_EXPIRED"),we(this,"claim",void 0),we(this,"reason",void 0),we(this,"payload",void 0),this.claim=s,this.reason=o,this.payload=i}}we(jA,"code","ERR_JWT_EXPIRED");class PA extends Lt{constructor(){super(...arguments),we(this,"code","ERR_JOSE_ALG_NOT_ALLOWED")}}we(PA,"code","ERR_JOSE_ALG_NOT_ALLOWED");class IA extends Lt{constructor(){super(...arguments),we(this,"code","ERR_JOSE_NOT_SUPPORTED")}}we(IA,"code","ERR_JOSE_NOT_SUPPORTED");class LA extends Lt{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"decryption operation failed",i=arguments.length>1?arguments[1]:void 0;super(e,i),we(this,"code","ERR_JWE_DECRYPTION_FAILED")}}we(LA,"code","ERR_JWE_DECRYPTION_FAILED");class UA extends Lt{constructor(){super(...arguments),we(this,"code","ERR_JWE_INVALID")}}we(UA,"code","ERR_JWE_INVALID");class BA extends Lt{constructor(){super(...arguments),we(this,"code","ERR_JWS_INVALID")}}we(BA,"code","ERR_JWS_INVALID");class qA extends Lt{constructor(){super(...arguments),we(this,"code","ERR_JWT_INVALID")}}we(qA,"code","ERR_JWT_INVALID");class FA extends Lt{constructor(){super(...arguments),we(this,"code","ERR_JWK_INVALID")}}we(FA,"code","ERR_JWK_INVALID");class zA extends Lt{constructor(){super(...arguments),we(this,"code","ERR_JWKS_INVALID")}}we(zA,"code","ERR_JWKS_INVALID");class HA extends Lt{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"no applicable key found in the JSON Web Key Set",i=arguments.length>1?arguments[1]:void 0;super(e,i),we(this,"code","ERR_JWKS_NO_MATCHING_KEY")}}we(HA,"code","ERR_JWKS_NO_MATCHING_KEY");class VA extends Lt{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"multiple matching keys found in the JSON Web Key Set",i=arguments.length>1?arguments[1]:void 0;super(e,i),we(this,Symbol.asyncIterator,void 0),we(this,"code","ERR_JWKS_MULTIPLE_MATCHING_KEYS")}}we(VA,"code","ERR_JWKS_MULTIPLE_MATCHING_KEYS");class GA extends Lt{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"request timed out",i=arguments.length>1?arguments[1]:void 0;super(e,i),we(this,"code","ERR_JWKS_TIMEOUT")}}we(GA,"code","ERR_JWKS_TIMEOUT");class KA extends Lt{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"signature verification failed",i=arguments.length>1?arguments[1]:void 0;super(e,i),we(this,"code","ERR_JWS_SIGNATURE_VERIFICATION_FAILED")}}we(KA,"code","ERR_JWS_SIGNATURE_VERIFICATION_FAILED");function Mn(){return Mn=Object.assign?Object.assign.bind():function(a){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)({}).hasOwnProperty.call(i,s)&&(a[s]=i[s])}return a},Mn.apply(null,arguments)}const q0=new Uint8Array(0);class eo{static getFullOptions(e){var i;const s=(function(o){var l,d;const{textOnly:u}=(l=(d=o.overrides)==null?void 0:d.conversation)!=null?l:{},{textOnly:f}=o;return typeof f=="boolean"?(typeof u=="boolean"&&f!==u&&console.warn(`Conflicting textOnly options provided: ${f} via options.textOnly (will be used) and ${u} via options.overrides.conversation.textOnly (will be ignored)`),f):typeof u=="boolean"?u:void 0})(e);return Mn({clientTools:{},onConnect:()=>{},onDebug:()=>{},onDisconnect:()=>{},onError:()=>{},onMessage:()=>{},onAudio:()=>{},onModeChange:()=>{},onStatusChange:()=>{},onCanSendFeedbackChange:()=>{},onInterruption:()=>{}},e,{textOnly:s,overrides:Mn({},e.overrides,{conversation:Mn({},(i=e.overrides)==null?void 0:i.conversation,{textOnly:s})})})}constructor(e,i){var s=this;this.options=void 0,this.connection=void 0,this.lastInterruptTimestamp=0,this.mode="listening",this.status="connecting",this.volume=1,this.currentEventId=1,this.lastFeedbackEventId=0,this.canSendFeedback=!1,this.endSessionWithDetails=async function(o){s.status!=="connected"&&s.status!=="connecting"||(s.updateStatus("disconnecting"),await s.handleEndSession(),s.updateStatus("disconnected"),s.options.onDisconnect&&s.options.onDisconnect(o))},this.onMessage=async function(o){switch(o.type){case"interruption":return void s.handleInterruption(o);case"agent_response":return void s.handleAgentResponse(o);case"user_transcript":return void s.handleUserTranscript(o);case"internal_tentative_agent_response":return void s.handleTentativeAgentResponse(o);case"client_tool_call":try{await s.handleClientToolCall(o)}catch(l){s.onError(`Unexpected error in client tool call handling: ${l instanceof Error?l.message:String(l)}`,{clientToolName:o.client_tool_call.tool_name,toolCallId:o.client_tool_call.tool_call_id})}return;case"audio":return void s.handleAudio(o);case"vad_score":return void s.handleVadScore(o);case"ping":return void s.connection.sendMessage({type:"pong",event_id:o.ping_event.event_id});case"mcp_tool_call":return void s.handleMCPToolCall(o);case"mcp_connection_status":return void s.handleMCPConnectionStatus(o);case"agent_tool_request":return void s.handleAgentToolRequest(o);case"agent_tool_response":return void s.handleAgentToolResponse(o);case"conversation_initiation_metadata":return void s.handleConversationMetadata(o);case"asr_initiation_metadata":return void s.handleAsrInitiationMetadata(o);case"agent_chat_response_part":return void s.handleAgentChatResponsePart(o);case"error":return void s.handleErrorEvent(o);default:return void(s.options.onDebug&&s.options.onDebug(o))}},this.setVolume=({volume:o})=>{this.volume=o},this.options=e,this.connection=i,this.options.onConnect&&this.options.onConnect({conversationId:i.conversationId}),this.connection.onMessage(this.onMessage),this.connection.onDisconnect(this.endSessionWithDetails),this.connection.onModeChange(o=>this.updateMode(o)),this.updateStatus("connected")}endSession(){return this.endSessionWithDetails({reason:"user"})}async handleEndSession(){this.connection.close()}updateMode(e){e!==this.mode&&(this.mode=e,this.options.onModeChange&&this.options.onModeChange({mode:e}))}updateStatus(e){e!==this.status&&(this.status=e,this.options.onStatusChange&&this.options.onStatusChange({status:e}))}updateCanSendFeedback(){const e=this.currentEventId!==this.lastFeedbackEventId;this.canSendFeedback!==e&&(this.canSendFeedback=e,this.options.onCanSendFeedbackChange&&this.options.onCanSendFeedbackChange({canSendFeedback:e}))}handleInterruption(e){e.interruption_event&&(this.lastInterruptTimestamp=e.interruption_event.event_id,this.options.onInterruption&&this.options.onInterruption({event_id:e.interruption_event.event_id}))}handleAgentResponse(e){this.options.onMessage&&this.options.onMessage({source:"ai",role:"agent",message:e.agent_response_event.agent_response})}handleUserTranscript(e){this.options.onMessage&&this.options.onMessage({source:"user",role:"user",message:e.user_transcription_event.user_transcript})}handleTentativeAgentResponse(e){this.options.onDebug&&this.options.onDebug({type:"tentative_agent_response",response:e.tentative_agent_response_internal_event.tentative_agent_response})}handleVadScore(e){this.options.onVadScore&&this.options.onVadScore({vadScore:e.vad_score_event.vad_score})}async handleClientToolCall(e){if(Object.prototype.hasOwnProperty.call(this.options.clientTools,e.client_tool_call.tool_name))try{var i;const s=(i=await this.options.clientTools[e.client_tool_call.tool_name](e.client_tool_call.parameters))!=null?i:"Client tool execution successful.",o=typeof s=="object"?JSON.stringify(s):String(s);this.connection.sendMessage({type:"client_tool_result",tool_call_id:e.client_tool_call.tool_call_id,result:o,is_error:!1})}catch(s){this.onError(`Client tool execution failed with following error: ${s?.message}`,{clientToolName:e.client_tool_call.tool_name}),this.connection.sendMessage({type:"client_tool_result",tool_call_id:e.client_tool_call.tool_call_id,result:`Client tool execution failed: ${s?.message}`,is_error:!0})}else{if(this.options.onUnhandledClientToolCall)return void this.options.onUnhandledClientToolCall(e.client_tool_call);this.onError(`Client tool with name ${e.client_tool_call.tool_name} is not defined on client`,{clientToolName:e.client_tool_call.tool_name}),this.connection.sendMessage({type:"client_tool_result",tool_call_id:e.client_tool_call.tool_call_id,result:`Client tool with name ${e.client_tool_call.tool_name} is not defined on client`,is_error:!0})}}handleAudio(e){}handleMCPToolCall(e){this.options.onMCPToolCall&&this.options.onMCPToolCall(e.mcp_tool_call)}handleMCPConnectionStatus(e){this.options.onMCPConnectionStatus&&this.options.onMCPConnectionStatus(e.mcp_connection_status)}handleAgentToolRequest(e){this.options.onAgentToolRequest&&this.options.onAgentToolRequest(e.agent_tool_request)}handleAgentToolResponse(e){e.agent_tool_response.tool_name==="end_call"&&this.endSessionWithDetails({reason:"agent",context:new CloseEvent("end_call",{reason:"Agent ended the call"})}),this.options.onAgentToolResponse&&this.options.onAgentToolResponse(e.agent_tool_response)}handleConversationMetadata(e){this.options.onConversationMetadata&&this.options.onConversationMetadata(e.conversation_initiation_metadata_event)}handleAsrInitiationMetadata(e){this.options.onAsrInitiationMetadata&&this.options.onAsrInitiationMetadata(e.asr_initiation_metadata_event)}handleAgentChatResponsePart(e){this.options.onAgentChatResponsePart&&this.options.onAgentChatResponsePart(e.text_response_part)}handleErrorEvent(e){const i=e.error_event.error_type,s=e.error_event.message||e.error_event.reason||"Unknown error";i!=="max_duration_exceeded"?this.onError(`Server error: ${s}`,{errorType:i,code:e.error_event.code,debugMessage:e.error_event.debug_message,details:e.error_event.details}):this.endSessionWithDetails({reason:"error",message:s,context:new Event("max_duration_exceeded")})}onError(e,i){console.error(e,i),this.options.onError&&this.options.onError(e,i)}getId(){return this.connection.conversationId}isOpen(){return this.status==="connected"}setMicMuted(e){this.connection.setMicMuted(e)}getInputByteFrequencyData(){return q0}getOutputByteFrequencyData(){return q0}getInputVolume(){return 0}getOutputVolume(){return 0}sendFeedback(e){this.canSendFeedback?(this.connection.sendMessage({type:"feedback",score:e?"like":"dislike",event_id:this.currentEventId}),this.lastFeedbackEventId=this.currentEventId,this.updateCanSendFeedback()):console.warn(this.lastFeedbackEventId===0?"Cannot send feedback: the conversation has not started yet.":"Cannot send feedback: feedback has already been sent for the current response.")}sendContextualUpdate(e){this.connection.sendMessage({type:"contextual_update",text:e})}sendUserMessage(e){this.connection.sendMessage({type:"user_message",text:e})}sendUserActivity(){this.connection.sendMessage({type:"user_activity"})}sendMCPToolApprovalResult(e,i){this.connection.sendMessage({type:"mcp_tool_approval_result",tool_call_id:e,is_approved:i})}}let vT=class{constructor(e={}){this.queue=[],this.disconnectionDetails=null,this.onDisconnectCallback=null,this.onMessageCallback=null,this.onModeChangeCallback=null,this.onDebug=void 0,this.onDebug=e.onDebug}debug(e){this.onDebug&&this.onDebug(e)}onMessage(e){this.onMessageCallback=e;const i=this.queue;this.queue=[],i.length>0&&queueMicrotask(()=>{i.forEach(e)})}onDisconnect(e){this.onDisconnectCallback=e;const i=this.disconnectionDetails;i&&queueMicrotask(()=>{e(i)})}onModeChange(e){this.onModeChangeCallback=e}updateMode(e){var i;(i=this.onModeChangeCallback)==null||i.call(this,e)}disconnect(e){var i;this.disconnectionDetails||(this.disconnectionDetails=e,(i=this.onDisconnectCallback)==null||i.call(this,e))}handleMessage(e){this.onMessageCallback?this.onMessageCallback(e):this.queue.push(e)}};function rc(a){const[e,i]=a.split("_");if(!["pcm","ulaw"].includes(e))throw new Error(`Invalid format: ${a}`);const s=Number.parseInt(i);if(Number.isNaN(s))throw new Error(`Invalid sample rate: ${i}`);return{format:e,sampleRate:s}}const yT="0.14.0";function Vh(a){return!!a.type}const bT="conversation_initiation_client_data";function ST(a){var e;const i={type:bT};var s,o,l,d,u,f,p,v;return a.overrides&&(i.conversation_config_override={agent:{prompt:(s=a.overrides.agent)==null?void 0:s.prompt,first_message:(o=a.overrides.agent)==null?void 0:o.firstMessage,language:(l=a.overrides.agent)==null?void 0:l.language},tts:{voice_id:(d=a.overrides.tts)==null?void 0:d.voiceId,speed:(u=a.overrides.tts)==null?void 0:u.speed,stability:(f=a.overrides.tts)==null?void 0:f.stability,similarity_boost:(p=a.overrides.tts)==null?void 0:p.similarityBoost},conversation:{text_only:(v=a.overrides.conversation)==null?void 0:v.textOnly}}),a.customLlmExtraBody&&(i.custom_llm_extra_body=a.customLlmExtraBody),a.dynamicVariables&&(i.dynamic_variables=a.dynamicVariables),a.userId&&(i.user_id=a.userId),(e=a.overrides)!=null&&e.client&&(i.source_info={source:a.overrides.client.source,version:a.overrides.client.version}),i}let F0=class extends Error{constructor(e,i){super(e),this.closeCode=void 0,this.closeReason=void 0,this.name="SessionConnectionError",this.closeCode=i?.closeCode,this.closeReason=i?.closeReason}},Gh=class TT extends vT{constructor(e,i,s,o){super(),this.socket=void 0,this.conversationId=void 0,this.inputFormat=void 0,this.outputFormat=void 0,this.socket=e,this.conversationId=i,this.inputFormat=s,this.outputFormat=o,this.socket.addEventListener("error",l=>{setTimeout(()=>this.disconnect({reason:"error",message:"The connection was closed due to a socket error.",context:l}),0)}),this.socket.addEventListener("close",l=>{this.disconnect(l.code===1e3?{reason:"agent",context:l,closeCode:l.code,closeReason:l.reason||void 0}:{reason:"error",message:l.reason||"The connection was closed by the server.",context:l,closeCode:l.code,closeReason:l.reason||void 0})}),this.socket.addEventListener("message",l=>{try{const d=JSON.parse(l.data);if(!Vh(d))return void this.debug({type:"invalid_event",message:"Received invalid socket event",data:l.data});this.handleMessage(d)}catch(d){this.debug({type:"parsing_error",message:"Failed to parse socket message",error:d instanceof Error?d.message:String(d),data:l.data})}})}static async create(e){let i=null;try{var s,o,l;const u=(s=e.origin)!=null?s:"wss://api.elevenlabs.io";let f;const p=((o=e.overrides)==null||(o=o.client)==null?void 0:o.version)||yT,v=((l=e.overrides)==null||(l=l.client)==null?void 0:l.source)||"js_sdk";if(e.signedUrl){const O=e.signedUrl.includes("?")?"&":"?";f=`${e.signedUrl}${O}source=${v}&version=${p}`}else f=`${u}/v1/convai/conversation?agent_id=${e.agentId}&source=${v}&version=${p}`;const y=["convai"];e.authorization&&y.push(`bearer.${e.authorization}`),i=new WebSocket(f,y);const S=await new Promise((O,L)=>{i.addEventListener("open",()=>{var D;const I=ST(e);(D=i)==null||D.send(JSON.stringify(I))},{once:!0}),i.addEventListener("error",D=>{setTimeout(()=>L(new F0("The connection was closed due to a socket error.")),0)}),i.addEventListener("close",D=>{L(new F0(D.reason||(D.code===1e3?"Connection closed normally before session could be established.":"Connection closed unexpectedly before session could be established."),{closeCode:D.code,closeReason:D.reason||void 0}))}),i.addEventListener("message",D=>{const I=JSON.parse(D.data);Vh(I)&&(I.type==="conversation_initiation_metadata"?O(I.conversation_initiation_metadata_event):console.warn("First received message is not conversation metadata."))},{once:!0})}),{conversation_id:C,agent_output_audio_format:_,user_input_audio_format:x}=S,k=rc(x??"pcm_16000"),R=rc(_);return new TT(i,C,k,R)}catch(u){var d;throw(d=i)==null||d.close(),u}}close(){this.socket.close(1e3,"User ended conversation")}sendMessage(e){this.socket.send(JSON.stringify(e))}async setMicMuted(e){console.warn(`WebSocket connection setMicMuted called with ${e}, but this is handled by VoiceConversation`)}};function CT(a){const e=new Uint8Array(a);return window.btoa(String.fromCharCode(...e))}function YA(a){const e=window.atob(a),i=e.length,s=new Uint8Array(i);for(let o=0;o<i;o++)s[o]=e.charCodeAt(o);return s.buffer}const wl=new Map;function kT(a,e){return async(i,s)=>{const o=wl.get(a);if(o)return i.addModule(o);if(s)try{return await i.addModule(s),void wl.set(a,s)}catch(u){throw new Error(`Failed to load the ${a} worklet module from path: ${s}. Error: ${u}`)}const l=new Blob([e],{type:"application/javascript"}),d=URL.createObjectURL(l);try{return await i.addModule(d),void wl.set(a,d)}catch{URL.revokeObjectURL(d)}try{const u=`data:application/javascript;base64,${btoa(e)}`;await i.addModule(u),wl.set(a,u)}catch{throw new Error(`Failed to load the ${a} worklet module. Make sure the browser supports AudioWorklets. If you are using a strict CSP, you may need to self-host the worklet files.`)}}}const xT=kT("rawAudioProcessor",`/*
 * ulaw encoding logic taken from the wavefile library
 * https://github.com/rochars/wavefile/blob/master/lib/codecs/mulaw.js
 * USED BY @elevenlabs/client
 */

const BIAS = 0x84;
const CLIP = 32635;
const encodeTable = [
  0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,
  4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,
  5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,
  5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,
  6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,
  6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,
  6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,
  6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,
  7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
  7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
  7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
  7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
  7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
  7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
  7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
  7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7
];

function encodeSample(sample) {
  let sign;
  let exponent;
  let mantissa;
  let muLawSample;
  sign = (sample >> 8) & 0x80;
  if (sign !== 0) sample = -sample;
  sample = sample + BIAS;
  if (sample > CLIP) sample = CLIP;
  exponent = encodeTable[(sample>>7) & 0xFF];
  mantissa = (sample >> (exponent+3)) & 0x0F;
  muLawSample = ~(sign | (exponent << 4) | mantissa);
  
  return muLawSample;
}

class RawAudioProcessor extends AudioWorkletProcessor {
  constructor() {
    super();
              
    this.port.onmessage = ({ data }) => {
      switch (data.type) {
        case "setFormat":
          this.isMuted = false;
          this.buffer = []; // Initialize an empty buffer
          this.bufferSize = data.sampleRate / 10;
          this.format = data.format;

          if (globalThis.LibSampleRate && sampleRate !== data.sampleRate) {
            globalThis.LibSampleRate.create(1, sampleRate, data.sampleRate).then(resampler => {
              this.resampler = resampler;
            });
          }
          break;
        case "setMuted":
          this.isMuted = data.isMuted;
          break;
      }
    };
  }
  process(inputs) {
    if (!this.buffer) {
      return true;
    }
    
    const input = inputs[0]; // Get the first input node
    if (input.length > 0) {
      let channelData = input[0]; // Get the first channel's data

      // Resample the audio if necessary
      if (this.resampler) {
        channelData = this.resampler.full(channelData);
      }

      // Add channel data to the buffer
      this.buffer.push(...channelData);
      // Get max volume 
      let sum = 0.0;
      for (let i = 0; i < channelData.length; i++) {
        sum += channelData[i] * channelData[i];
      }
      const maxVolume = Math.sqrt(sum / channelData.length);
      // Check if buffer size has reached or exceeded the threshold
      if (this.buffer.length >= this.bufferSize) {
        const float32Array = this.isMuted 
          ? new Float32Array(this.buffer.length)
          : new Float32Array(this.buffer);

        let encodedArray = this.format === "ulaw"
          ? new Uint8Array(float32Array.length)
          : new Int16Array(float32Array.length);

        // Iterate through the Float32Array and convert each sample to PCM16
        for (let i = 0; i < float32Array.length; i++) {
          // Clamp the value to the range [-1, 1]
          let sample = Math.max(-1, Math.min(1, float32Array[i]));

          // Scale the sample to the range [-32768, 32767]
          let value = sample < 0 ? sample * 32768 : sample * 32767;
          if (this.format === "ulaw") {
            value = encodeSample(Math.round(value));
          }

          encodedArray[i] = value;
        }

        // Send the buffered data to the main script
        this.port.postMessage([encodedArray, maxVolume]);

        // Clear the buffer after sending
        this.buffer = [];
      }
    }
    return true; // Continue processing
  }
}
registerProcessor("rawAudioProcessor", RawAudioProcessor);
`);class di extends vT{constructor(e,i,s,o,l={}){super(l),this.conversationId=void 0,this.inputFormat=void 0,this.outputFormat=void 0,this.room=void 0,this.isConnected=!1,this.audioEventId=1,this.audioCaptureContext=null,this.audioElements=[],this.outputDeviceId=null,this.outputAnalyser=null,this.outputFrequencyData=null,this.room=e,this.conversationId=i,this.inputFormat=s,this.outputFormat=o,this.setupRoomEventListeners()}static async create(e){let i;if("conversationToken"in e&&e.conversationToken)i=e.conversationToken;else{if(!("agentId"in e)||!e.agentId)throw new Error("Either conversationToken or agentId is required for WebRTC connection");try{var s,o,l;const p=((s=e.overrides)==null||(s=s.client)==null?void 0:s.version)||yT,v=((o=e.overrides)==null||(o=o.client)==null?void 0:o.source)||"js_sdk",y=`${d=(l=e.origin)!=null?l:"https://api.elevenlabs.io",d.replace(/^wss:\/\//,"https://")}/v1/convai/conversation/token?agent_id=${e.agentId}&source=${v}&version=${p}`,S=await fetch(y);if(!S.ok)throw new Error(`ElevenLabs API returned ${S.status} ${S.statusText}`);if(i=(await S.json()).token,!i)throw new Error("No conversation token received from API")}catch(p){let v=p instanceof Error?p.message:String(p);throw p instanceof Error&&p.message.includes("401")&&(v="Your agent has authentication enabled, but no signed URL or conversation token was provided."),new Error(`Failed to fetch conversation token for agent ${e.agentId}: ${v}`)}}var d;const u=new Os;try{const p=`room_${Date.now()}`,v=rc("pcm_48000"),y=rc("pcm_48000"),S=new di(u,p,v,y,e),C=e.livekitUrl||"wss://livekit.rtc.elevenlabs.io";var f;await u.connect(C,i),await new Promise(x=>{if(S.isConnected)x();else{const k=()=>{u.off(X.Connected,k),x()};u.on(X.Connected,k)}}),u.name&&(S.conversationId=((f=u.name.match(/(conv_[a-zA-Z0-9]+)/))==null?void 0:f[0])||u.name),e.textOnly||await u.localParticipant.setMicrophoneEnabled(!0);const _=ST(e);return S.debug({type:bT,message:_}),await S.sendMessage(_),S}catch(p){throw await u.disconnect(),p}}setupRoomEventListeners(){var e=this;this.room.on(X.Connected,async function(){e.isConnected=!0,console.info("WebRTC room connected")}),this.room.on(X.Disconnected,i=>{this.isConnected=!1,this.disconnect({reason:"agent",context:new CloseEvent("close",{reason:i?.toString()})})}),this.room.on(X.ConnectionStateChanged,i=>{i===Ie.Disconnected&&(this.isConnected=!1,this.disconnect({reason:"error",message:`LiveKit connection state changed to ${i}`,context:new Event("connection_state_changed")}))}),this.room.on(X.DataReceived,(i,s)=>{try{const o=JSON.parse(new TextDecoder().decode(i));if(o.type==="audio")return;Vh(o)?this.handleMessage(o):console.warn("Invalid socket event received:",o)}catch(o){console.warn("Failed to parse incoming data message:",o),console.warn("Raw payload:",new TextDecoder().decode(i))}}),this.room.on(X.TrackSubscribed,async function(i,s,o){if(i.kind===Q.Kind.Audio&&o.identity.includes("agent")){const l=i,d=l.attach();if(d.autoplay=!0,d.controls=!1,e.outputDeviceId&&d.setSinkId)try{await d.setSinkId(e.outputDeviceId)}catch(u){console.warn("Failed to set output device for new audio element:",u)}d.style.display="none",document.body.appendChild(d),e.audioElements.push(d),e.audioElements.length===1&&(e.onDebug==null||e.onDebug({type:"audio_element_ready"})),await e.setupAudioCapture(l)}}),this.room.on(X.ActiveSpeakersChanged,async function(i){e.updateMode(i.length>0&&i[0].identity.startsWith("agent")?"speaking":"listening")}),this.room.on(X.ParticipantDisconnected,i=>{var s;(s=i.identity)!=null&&s.startsWith("agent")&&this.disconnect({reason:"agent",context:new CloseEvent("close",{reason:"agent disconnected"})})})}close(){if(this.isConnected){try{this.room.localParticipant.audioTrackPublications.forEach(e=>{e.track&&e.track.stop()})}catch(e){console.warn("Error stopping local tracks:",e)}this.audioCaptureContext&&(this.audioCaptureContext.close().catch(e=>{console.warn("Error closing audio capture context:",e)}),this.audioCaptureContext=null),this.audioElements.forEach(e=>{e.parentNode&&e.parentNode.removeChild(e)}),this.audioElements=[],this.room.disconnect()}}async sendMessage(e){if(this.isConnected&&this.room.localParticipant){if(!("user_audio_chunk"in e))try{const i=new TextEncoder().encode(JSON.stringify(e));await this.room.localParticipant.publishData(i,{reliable:!0})}catch(i){this.debug({type:"send_message_error",message:{message:e,error:i}}),console.error("Failed to send message via WebRTC:",i)}}else console.warn("Cannot send message: room not connected or no local participant")}getRoom(){return this.room}async setMicMuted(e){if(!this.isConnected||!this.room.localParticipant)return void console.warn("Cannot set microphone muted: room not connected or no local participant");const i=this.room.localParticipant.getTrackPublication(Q.Source.Microphone);if(i!=null&&i.track)try{e?await i.track.mute():await i.track.unmute()}catch{await this.room.localParticipant.setMicrophoneEnabled(!e)}else await this.room.localParticipant.setMicrophoneEnabled(!e)}async setupAudioCapture(e){try{const i=new AudioContext;this.audioCaptureContext=i,this.outputAnalyser=i.createAnalyser(),this.outputAnalyser.fftSize=2048,this.outputAnalyser.smoothingTimeConstant=.8;const s=new MediaStream([e.mediaStreamTrack]),o=i.createMediaStreamSource(s);o.connect(this.outputAnalyser),await xT(i.audioWorklet);const l=new AudioWorkletNode(i,"rawAudioProcessor");this.outputAnalyser.connect(l),l.port.postMessage({type:"setFormat",format:this.outputFormat.format,sampleRate:this.outputFormat.sampleRate}),l.port.onmessage=d=>{const[u,f]=d.data;if(f>.01){const p=CT(u.buffer),v=this.audioEventId++;this.handleMessage({type:"audio",audio_event:{audio_base_64:p,event_id:v}})}},o.connect(l)}catch(i){console.warn("Failed to set up audio capture:",i)}}setAudioVolume(e){this.audioElements.forEach(i=>{i.volume=e})}async setAudioOutputDevice(e){if(!("setSinkId"in HTMLAudioElement.prototype))throw new Error("setSinkId is not supported in this browser");const i=this.audioElements.map(async function(s){try{await s.setSinkId(e)}catch(o){throw console.error("Failed to set sink ID for audio element:",o),o}});await Promise.all(i),this.outputDeviceId=e}async setAudioInputDevice(e){if(!this.isConnected||!this.room.localParticipant)throw new Error("Cannot change input device: room not connected or no local participant");try{const i=this.room.localParticipant.getTrackPublication(Q.Source.Microphone);i!=null&&i.track&&(await i.track.stop(),await this.room.localParticipant.unpublishTrack(i.track));const s={deviceId:{exact:e},echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0,channelCount:{ideal:1}},o=await mT(s);await this.room.localParticipant.publishTrack(o,{name:"microphone",source:Q.Source.Microphone})}catch(i){console.error("Failed to change input device:",i);try{await this.room.localParticipant.setMicrophoneEnabled(!0)}catch(s){console.error("Failed to recover microphone after device switch error:",s)}throw i}}getOutputByteFrequencyData(){return this.outputAnalyser?(this.outputFrequencyData!=null||(this.outputFrequencyData=new Uint8Array(this.outputAnalyser.frequencyBinCount)),this.outputAnalyser.getByteFrequencyData(this.outputFrequencyData),this.outputFrequencyData):null}}async function ET(a){const e=(function(i){return i.connectionType?i.connectionType:"conversationToken"in i&&i.conversationToken?"webrtc":"websocket"})(a);switch(e){case"websocket":return Gh.create(a);case"webrtc":return di.create(a);default:throw new Error(`Unknown connection type: ${e}`)}}function Kh(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}async function wT(a={default:0,android:3e3}){let e=a.default;var i;if(/android/i.test(navigator.userAgent))e=(i=a.android)!=null?i:e;else if(Kh()){var s;e=(s=a.ios)!=null?s:e}e>0&&await new Promise(o=>setTimeout(o,e))}class Nf extends eo{static async startSession(e){const i=eo.getFullOptions(e);i.onStatusChange&&i.onStatusChange({status:"connecting"}),i.onCanSendFeedbackChange&&i.onCanSendFeedbackChange({canSendFeedback:!1}),i.onModeChange&&i.onModeChange({mode:"listening"}),i.onCanSendFeedbackChange&&i.onCanSendFeedbackChange({canSendFeedback:!1});let s=null;try{return await wT(i.connectionDelay),s=await ET(e),new Nf(i,s)}catch(l){var o;throw i.onStatusChange&&i.onStatusChange({status:"disconnected"}),(o=s)==null||o.close(),l}}}const z0={echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0,channelCount:{ideal:1}};class As{static async create({sampleRate:e,format:i,preferHeadphonesForIosDevices:s,inputDeviceId:o,workletPaths:l,libsampleratePath:d,onError:u}){let f=null,p=null;try{const S=Mn({sampleRate:{ideal:e}},z0);if(Kh()&&s){const L=(await window.navigator.mediaDevices.enumerateDevices()).find(D=>D.kind==="audioinput"&&["airpod","headphone","earphone"].find(I=>D.label.toLowerCase().includes(I)));L&&(S.deviceId={ideal:L.deviceId})}o&&(S.deviceId=As.getDeviceIdConstraint(o));const C=navigator.mediaDevices.getSupportedConstraints().sampleRate;f=new window.AudioContext(C?{sampleRate:e}:{});const _=f.createAnalyser();if(!C){const L=d||"https://cdn.jsdelivr.net/npm/@alexanderolsen/libsamplerate-js@2.1.2/dist/libsamplerate.worklet.js";await f.audioWorklet.addModule(L)}await xT(f.audioWorklet,l?.rawAudioProcessor);const x=Mn({voiceIsolation:!0},S);p=await navigator.mediaDevices.getUserMedia({audio:x});const k=f.createMediaStreamSource(p),R=new AudioWorkletNode(f,"rawAudioProcessor");R.port.postMessage({type:"setFormat",format:i,sampleRate:e}),k.connect(_),_.connect(R),await f.resume();const O=await navigator.permissions.query({name:"microphone"});return new As(f,_,R,p,k,O,u)}catch(S){var v,y;throw(v=p)==null||v.getTracks().forEach(C=>{C.stop()}),(y=f)==null||y.close(),S}}static getDeviceIdConstraint(e){if(e)return Kh()?{ideal:e}:{exact:e}}constructor(e,i,s,o,l,d,u=console.error){this.context=void 0,this.analyser=void 0,this.worklet=void 0,this.inputStream=void 0,this.mediaStreamSource=void 0,this.permissions=void 0,this.onError=void 0,this.settingInput=!1,this.handlePermissionsChange=()=>{if(this.permissions.state==="denied")this.onError("Microphone permission denied");else if(!this.settingInput){var f;const[p]=this.inputStream.getAudioTracks(),{deviceId:v}=(f=p?.getSettings())!=null?f:{};this.setInputDevice(v).catch(y=>{this.onError("Failed to reset input device after permission change:",y)})}},this.context=e,this.analyser=i,this.worklet=s,this.inputStream=o,this.mediaStreamSource=l,this.permissions=d,this.onError=u,this.permissions.addEventListener("change",this.handlePermissionsChange)}forgetInputStreamAndSource(){for(const e of this.inputStream.getTracks())e.stop();this.mediaStreamSource.disconnect()}async close(){this.forgetInputStreamAndSource(),this.permissions.removeEventListener("change",this.handlePermissionsChange),await this.context.close()}setMuted(e){this.worklet.port.postMessage({type:"setMuted",isMuted:e})}async setInputDevice(e){try{if(this.settingInput)throw new Error("Input device is already being set");this.settingInput=!0;const i=Mn({},z0);e&&(i.deviceId=As.getDeviceIdConstraint(e));const s=Mn({voiceIsolation:!0},i),o=await navigator.mediaDevices.getUserMedia({audio:s});this.forgetInputStreamAndSource(),this.inputStream=o,this.mediaStreamSource=this.context.createMediaStreamSource(o),this.mediaStreamSource.connect(this.analyser)}catch(i){throw this.onError("Failed to switch input device:",i),i}finally{this.settingInput=!1}}}const JA=kT("audioConcatProcessor",`/*
 * ulaw decoding logic taken from the wavefile library
 * https://github.com/rochars/wavefile/blob/master/lib/codecs/mulaw.js
 * USED BY @elevenlabs/client
 */

const decodeTable = [0,132,396,924,1980,4092,8316,16764];

function decodeSample(muLawSample) {
  let sign;
  let exponent;
  let mantissa;
  let sample;
  muLawSample = ~muLawSample;
  sign = (muLawSample & 0x80);
  exponent = (muLawSample >> 4) & 0x07;
  mantissa = muLawSample & 0x0F;
  sample = decodeTable[exponent] + (mantissa << (exponent+3));
  if (sign !== 0) sample = -sample;

  return sample;
}

class AudioConcatProcessor extends AudioWorkletProcessor {
  constructor() {
    super();
    this.buffers = []; // Initialize an empty buffer
    this.cursor = 0;
    this.currentBuffer = null;
    this.wasInterrupted = false;
    this.finished = false;
    
    this.port.onmessage = ({ data }) => {
      switch (data.type) {
        case "setFormat":
          this.format = data.format;
          break;
        case "buffer":
          this.wasInterrupted = false;
          this.buffers.push(
            this.format === "ulaw"
              ? new Uint8Array(data.buffer)
              : new Int16Array(data.buffer)
          );
          break;
        case "interrupt":
          this.wasInterrupted = true;
          break;
        case "clearInterrupted":
          if (this.wasInterrupted) {
            this.wasInterrupted = false;
            this.buffers = [];
            this.currentBuffer = null;
          }
      }
    };
  }
  process(_, outputs) {
    let finished = false;
    const output = outputs[0][0];
    for (let i = 0; i < output.length; i++) {
      if (!this.currentBuffer) {
        if (this.buffers.length === 0) {
          finished = true;
          break;
        }
        this.currentBuffer = this.buffers.shift();
        this.cursor = 0;
      }

      let value = this.currentBuffer[this.cursor];
      if (this.format === "ulaw") {
        value = decodeSample(value);
      }
      output[i] = value / 32768;
      this.cursor++;

      if (this.cursor >= this.currentBuffer.length) {
        this.currentBuffer = null;
      }
    }

    if (this.finished !== finished) {
      this.finished = finished;
      this.port.postMessage({ type: "process", finished });
    }

    return true; // Continue processing
  }
}

registerProcessor("audioConcatProcessor", AudioConcatProcessor);
`);class oc{static async create({sampleRate:e,format:i,outputDeviceId:s,workletPaths:o}){let l=null,d=null;try{l=new AudioContext({sampleRate:e});const p=l.createAnalyser(),v=l.createGain();d=new Audio,d.src="",d.load(),d.autoplay=!0,d.style.display="none",document.body.appendChild(d);const y=l.createMediaStreamDestination();d.srcObject=y.stream,v.connect(p),p.connect(y),await JA(l.audioWorklet,o?.audioConcatProcessor);const S=new AudioWorkletNode(l,"audioConcatProcessor");return S.port.postMessage({type:"setFormat",format:i}),S.connect(v),await l.resume(),s&&d.setSinkId&&await d.setSinkId(s),new oc(l,p,v,S,d)}catch(p){var u,f;throw(u=d)!=null&&u.parentNode&&d.parentNode.removeChild(d),(f=d)==null||f.pause(),l&&l.state!=="closed"&&await l.close(),p}}constructor(e,i,s,o,l){this.context=void 0,this.analyser=void 0,this.gain=void 0,this.worklet=void 0,this.audioElement=void 0,this.context=e,this.analyser=i,this.gain=s,this.worklet=o,this.audioElement=l}async setOutputDevice(e){if(!("setSinkId"in HTMLAudioElement.prototype))throw new Error("setSinkId is not supported in this browser");await this.audioElement.setSinkId(e||"")}async close(){this.audioElement.parentNode&&this.audioElement.parentNode.removeChild(this.audioElement),this.audioElement.pause(),await this.context.close()}}class Vr extends eo{static async requestWakeLock(){if("wakeLock"in navigator)try{return await navigator.wakeLock.request("screen")}catch{}return null}static async startSession(e){var i;const s=eo.getFullOptions(e);s.onStatusChange&&s.onStatusChange({status:"connecting"}),s.onCanSendFeedbackChange&&s.onCanSendFeedbackChange({canSendFeedback:!1});let o=null,l=null,d=null,u=null,f=null;((i=e.useWakeLock)==null||i)&&(f=await Vr.requestWakeLock());try{var p;return u=await navigator.mediaDevices.getUserMedia({audio:!0}),await wT(s.connectionDelay),l=await ET(e),[o,d]=await Promise.all([As.create(Mn({},l.inputFormat,{preferHeadphonesForIosDevices:e.preferHeadphonesForIosDevices,inputDeviceId:e.inputDeviceId,workletPaths:e.workletPaths,libsampleratePath:e.libsampleratePath})),oc.create(Mn({},l.outputFormat,{outputDeviceId:e.outputDeviceId,workletPaths:e.workletPaths}))]),(p=u)==null||p.getTracks().forEach(x=>{x.stop()}),u=null,new Vr(s,l,o,d,f)}catch(x){var v,y,S,C;s.onStatusChange&&s.onStatusChange({status:"disconnected"}),(v=u)==null||v.getTracks().forEach(k=>{k.stop()}),(y=l)==null||y.close(),await((S=o)==null?void 0:S.close()),await((C=d)==null?void 0:C.close());try{var _;await((_=f)==null?void 0:_.release()),f=null}catch{}throw x}}constructor(e,i,s,o,l){super(e,i),this.input=void 0,this.output=void 0,this.wakeLock=void 0,this.inputFrequencyData=void 0,this.outputFrequencyData=void 0,this.visibilityChangeHandler=null,this.onInputWorkletMessage=d=>{this.status==="connected"&&this.connection.sendMessage({user_audio_chunk:CT(d.data[0].buffer)})},this.onOutputWorkletMessage=({data:d})=>{d.type==="process"&&this.updateMode(d.finished?"listening":"speaking")},this.addAudioBase64Chunk=d=>{this.output.gain.gain.cancelScheduledValues(this.output.context.currentTime),this.output.gain.gain.value=this.volume,this.output.worklet.port.postMessage({type:"clearInterrupted"}),this.output.worklet.port.postMessage({type:"buffer",buffer:YA(d)})},this.fadeOutAudio=()=>{this.updateMode("listening"),this.output.worklet.port.postMessage({type:"interrupt"}),this.output.gain.gain.exponentialRampToValueAtTime(1e-4,this.output.context.currentTime+2),setTimeout(()=>{this.output.gain.gain.value=this.volume,this.output.worklet.port.postMessage({type:"clearInterrupted"})},2e3)},this.calculateVolume=d=>{if(d.length===0)return 0;let u=0;for(let f=0;f<d.length;f++)u+=d[f]/255;return u/=d.length,u<0?0:u>1?1:u},this.setVolume=({volume:d})=>{const u=Number.isFinite(d)?Math.min(1,Math.max(0,d)):1;this.volume=u,this.connection instanceof di?this.connection.setAudioVolume(u):this.output.gain.gain.value=u},this.input=s,this.output=o,this.wakeLock=l,this.input.worklet.port.onmessage=this.onInputWorkletMessage,this.output.worklet.port.onmessage=this.onOutputWorkletMessage,l&&(this.visibilityChangeHandler=()=>{var d;document.visibilityState==="visible"&&(d=this.wakeLock)!=null&&d.released&&Vr.requestWakeLock().then(u=>{this.wakeLock=u})},document.addEventListener("visibilitychange",this.visibilityChangeHandler))}async handleEndSession(){await super.handleEndSession(),this.visibilityChangeHandler&&document.removeEventListener("visibilitychange",this.visibilityChangeHandler);try{var e;await((e=this.wakeLock)==null?void 0:e.release()),this.wakeLock=null}catch{}await this.input.close(),await this.output.close()}handleInterruption(e){super.handleInterruption(e),this.fadeOutAudio()}handleAudio(e){var i,s;super.handleAudio(e),e.audio_event.alignment&&this.options.onAudioAlignment&&this.options.onAudioAlignment(e.audio_event.alignment),this.lastInterruptTimestamp<=e.audio_event.event_id&&(e.audio_event.audio_base_64&&((i=(s=this.options).onAudio)==null||i.call(s,e.audio_event.audio_base_64),this.connection instanceof di||this.addAudioBase64Chunk(e.audio_event.audio_base_64)),this.currentEventId=e.audio_event.event_id,this.updateCanSendFeedback(),this.updateMode("speaking"))}setMicMuted(e){this.connection instanceof di?this.connection.setMicMuted(e):this.input.setMuted(e)}getInputByteFrequencyData(){return this.inputFrequencyData!=null||(this.inputFrequencyData=new Uint8Array(this.input.analyser.frequencyBinCount)),this.input.analyser.getByteFrequencyData(this.inputFrequencyData),this.inputFrequencyData}getOutputByteFrequencyData(){return this.connection instanceof di?this.connection.getOutputByteFrequencyData()||new Uint8Array(1024):(this.outputFrequencyData!=null||(this.outputFrequencyData=new Uint8Array(this.output.analyser.frequencyBinCount)),this.output.analyser.getByteFrequencyData(this.outputFrequencyData),this.outputFrequencyData)}getInputVolume(){return this.calculateVolume(this.getInputByteFrequencyData())}getOutputVolume(){return this.calculateVolume(this.getOutputByteFrequencyData())}async changeInputDevice({sampleRate:e,format:i,preferHeadphonesForIosDevices:s,inputDeviceId:o}){try{if(this.connection instanceof Gh)try{return await this.input.setInputDevice(o),this.input}catch(d){console.warn("Failed to change device on existing input, recreating:",d)}this.connection instanceof di&&await this.connection.setAudioInputDevice(o||""),await this.input.close();const l=await As.create({sampleRate:e??this.connection.inputFormat.sampleRate,format:i??this.connection.inputFormat.format,preferHeadphonesForIosDevices:s,inputDeviceId:o,workletPaths:this.options.workletPaths,libsampleratePath:this.options.libsampleratePath,onError:this.options.onError});return this.input=l,this.input.worklet.port.onmessage=this.onInputWorkletMessage,this.input}catch(l){throw console.error("Error changing input device",l),l}}async changeOutputDevice({sampleRate:e,format:i,outputDeviceId:s}){try{if(this.connection instanceof Gh)try{return await this.output.setOutputDevice(s),this.output}catch(l){console.warn("Failed to change device on existing output, recreating:",l)}this.connection instanceof di&&await this.connection.setAudioOutputDevice(s||""),await this.output.close();const o=await oc.create({sampleRate:e??this.connection.outputFormat.sampleRate,format:i??this.connection.outputFormat.format,outputDeviceId:s,workletPaths:this.options.workletPaths});return this.output=o,this.output}catch(o){throw console.error("Error changing output device",o),o}}}var H0;(function(a){a.SESSION_STARTED="session_started",a.PARTIAL_TRANSCRIPT="partial_transcript",a.COMMITTED_TRANSCRIPT="committed_transcript",a.COMMITTED_TRANSCRIPT_WITH_TIMESTAMPS="committed_transcript_with_timestamps",a.AUTH_ERROR="auth_error",a.ERROR="error",a.OPEN="open",a.CLOSE="close",a.QUOTA_EXCEEDED="quota_exceeded",a.COMMIT_THROTTLED="commit_throttled",a.TRANSCRIBER_ERROR="transcriber_error",a.UNACCEPTED_TERMS="unaccepted_terms",a.RATE_LIMITED="rate_limited",a.INPUT_ERROR="input_error",a.QUEUE_OVERFLOW="queue_overflow",a.RESOURCE_EXHAUSTED="resource_exhausted",a.SESSION_TIME_LIMIT_EXCEEDED="session_time_limit_exceeded",a.CHUNK_SIZE_EXCEEDED="chunk_size_exceeded",a.INSUFFICIENT_AUDIO_ACTIVITY="insufficient_audio_activity"})(H0||(H0={}));var V0,G0;(function(a){a.PCM_8000="pcm_8000",a.PCM_16000="pcm_16000",a.PCM_22050="pcm_22050",a.PCM_24000="pcm_24000",a.PCM_44100="pcm_44100",a.PCM_48000="pcm_48000",a.ULAW_8000="ulaw_8000"})(V0||(V0={})),(function(a){a.MANUAL="manual",a.VAD="vad"})(G0||(G0={}));class Af extends eo{static startSession(e){const i=Af.getFullOptions(e);return i.textOnly?Nf.startSession(i):Vr.startSession(i)}}function Gr(){return Gr=Object.assign?Object.assign.bind():function(a){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)({}).hasOwnProperty.call(i,s)&&(a[s]=i[s])}return a},Gr.apply(null,arguments)}const QA=["micMuted","volume","serverLocation"];function WA(a="us"){switch(a){case"eu-residency":case"in-residency":case"us":case"global":return a;default:return console.warn(`[ConversationalAI] Invalid server-location: ${a}. Defaulting to "us"`),"us"}}function XA(a){return{us:"wss://api.elevenlabs.io","eu-residency":"wss://api.eu.residency.elevenlabs.io","in-residency":"wss://api.in.residency.elevenlabs.io",global:"wss://api.elevenlabs.io"}[a]}function ZA(a){return{us:"wss://livekit.rtc.elevenlabs.io","eu-residency":"wss://livekit.rtc.eu.residency.elevenlabs.io","in-residency":"wss://livekit.rtc.in.residency.elevenlabs.io",global:"wss://livekit.rtc.elevenlabs.io"}[a]}function $A(a={}){const{micMuted:e,volume:i,serverLocation:s}=a,o=(function(k,R){if(k==null)return{};var O={};for(var L in k)if({}.hasOwnProperty.call(k,L)){if(R.indexOf(L)!==-1)continue;O[L]=k[L]}return O})(a,QA),l=M.useRef(null),d=M.useRef(null),u=M.useRef(!1),[f,p]=M.useState("disconnected"),[v,y]=M.useState(!1),[S,C]=M.useState("listening"),_=M.useRef(e),x=M.useRef(i);return _.current=e,x.current=i,M.useEffect(()=>{var k;e!==void 0&&(l==null||(k=l.current)==null||k.setMicMuted(e))},[e]),M.useEffect(()=>{var k;i!==void 0&&(l==null||(k=l.current)==null||k.setVolume({volume:i}))},[i]),M.useEffect(()=>()=>{var k;u.current=!0,d.current?d.current.then(R=>R.endSession()):(k=l.current)==null||k.endSession()},[]),{startSession:async k=>{var R;if((R=l.current)!=null&&R.isOpen())return l.current.getId();if(d.current)return(await d.current).getId();u.current=!1;try{var O,L,D,I,j,H,Z,ee,te,re;const ue=WA(k?.serverLocation||s),Me=XA(ue),We=ZA(ue);if(d.current=Af.startSession(Gr({},o??{},k??{},{origin:Me,livekitUrl:k?.livekitUrl||o?.livekitUrl||We,overrides:Gr({},(O=o?.overrides)!=null?O:{},(L=k?.overrides)!=null?L:{},{client:Gr({},(D=o==null||(I=o.overrides)==null?void 0:I.client)!=null?D:{},(j=k==null||(H=k.overrides)==null?void 0:H.client)!=null?j:{},{source:(k==null||(Z=k.overrides)==null||(Z=Z.client)==null?void 0:Z.source)||(o==null||(ee=o.overrides)==null||(ee=ee.client)==null?void 0:ee.source)||"react_sdk",version:(k==null||(te=k.overrides)==null||(te=te.client)==null?void 0:te.version)||(o==null||(re=o.overrides)==null||(re=re.client)==null?void 0:re.version)||"0.14.0"})}),onConnect:k?.onConnect||o?.onConnect,onDisconnect:k?.onDisconnect||o?.onDisconnect,onError:k?.onError||o?.onError,onMessage:k?.onMessage||o?.onMessage,onAudio:k?.onAudio||o?.onAudio,onDebug:k?.onDebug||o?.onDebug,onUnhandledClientToolCall:k?.onUnhandledClientToolCall||o?.onUnhandledClientToolCall,onVadScore:k?.onVadScore||o?.onVadScore,onInterruption:k?.onInterruption||o?.onInterruption,onAgentToolRequest:k?.onAgentToolRequest||o?.onAgentToolRequest,onAgentToolResponse:k?.onAgentToolResponse||o?.onAgentToolResponse,onConversationMetadata:k?.onConversationMetadata||o?.onConversationMetadata,onMCPToolCall:k?.onMCPToolCall||o?.onMCPToolCall,onMCPConnectionStatus:k?.onMCPConnectionStatus||o?.onMCPConnectionStatus,onAsrInitiationMetadata:k?.onAsrInitiationMetadata||o?.onAsrInitiationMetadata,onAgentChatResponsePart:k?.onAgentChatResponsePart||o?.onAgentChatResponsePart,onAudioAlignment:k?.onAudioAlignment||o?.onAudioAlignment,onModeChange:({mode:ze})=>{var z;C(ze),(z=k?.onModeChange||o?.onModeChange)==null||z({mode:ze})},onStatusChange:({status:ze})=>{var z;p(ze),(z=k?.onStatusChange||o?.onStatusChange)==null||z({status:ze})},onCanSendFeedbackChange:({canSendFeedback:ze})=>{var z;y(ze),(z=k?.onCanSendFeedbackChange||o?.onCanSendFeedbackChange)==null||z({canSendFeedback:ze})}})),l.current=await d.current,u.current)throw await l.current.endSession(),l.current=null,d.current=null,new Error("Session cancelled during connection");return _.current!==void 0&&l.current.setMicMuted(_.current),x.current!==void 0&&l.current.setVolume({volume:x.current}),l.current.getId()}finally{d.current=null}},endSession:async()=>{u.current=!0;const k=d.current,R=l.current;l.current=null,k?await(await k).endSession():await R?.endSession()},setVolume:({volume:k})=>{var R;(R=l.current)==null||R.setVolume({volume:k})},getInputByteFrequencyData:()=>{var k;return(k=l.current)==null?void 0:k.getInputByteFrequencyData()},getOutputByteFrequencyData:()=>{var k;return(k=l.current)==null?void 0:k.getOutputByteFrequencyData()},getInputVolume:()=>{var k,R;return(k=(R=l.current)==null?void 0:R.getInputVolume())!=null?k:0},getOutputVolume:()=>{var k,R;return(k=(R=l.current)==null?void 0:R.getOutputVolume())!=null?k:0},sendFeedback:k=>{var R;(R=l.current)==null||R.sendFeedback(k)},getId:()=>{var k;return(k=l.current)==null?void 0:k.getId()},sendContextualUpdate:k=>{var R;(R=l.current)==null||R.sendContextualUpdate(k)},sendUserMessage:k=>{var R;(R=l.current)==null||R.sendUserMessage(k)},sendUserActivity:()=>{var k;(k=l.current)==null||k.sendUserActivity()},sendMCPToolApprovalResult:(k,R)=>{var O;(O=l.current)==null||O.sendMCPToolApprovalResult(k,R)},changeInputDevice:async k=>{if(l.current&&"changeInputDevice"in l.current)return await l.current.changeInputDevice(k);throw new Error("Device switching is only available for voice conversations")},changeOutputDevice:async k=>{if(l.current&&"changeOutputDevice"in l.current)return await l.current.changeOutputDevice(k);throw new Error("Device switching is only available for voice conversations")},status:f,canSendFeedback:v,micMuted:e,isSpeaking:S==="speaking"}}const K0="/assets/AI_voicebot_image-lrpUZ6MZ.png",eM="agent_8001khx0a8vee5z8gcab88e1xhye",tM=()=>{const[a,e]=M.useState(!1),i=M.useRef(!1),s=$A({onConnect:()=>console.log("ElevenLabs: connected"),onDisconnect:()=>{console.log("ElevenLabs: disconnected"),i.current=!1},onError:v=>console.error("ElevenLabs error:",v)}),{status:o,isSpeaking:l}=s,d=o==="connected",u=M.useCallback(async()=>{if(!i.current){i.current=!0;try{await navigator.mediaDevices.getUserMedia({audio:!0}),await s.startSession({agentId:eM,connectionType:"webrtc"})}catch(v){console.error("Pre-warm failed:",v),i.current=!1}}},[s]),f=M.useCallback(()=>{e(!0),i.current||u()},[u]),p=M.useCallback(async()=>{await s.endSession(),i.current=!1,e(!1)},[s]);return M.useEffect(()=>(document.body.style.overflow=a?"hidden":"",()=>{document.body.style.overflow=""}),[a]),M.useEffect(()=>{const v=y=>{y.key==="Escape"&&p()};return window.addEventListener("keydown",v),()=>window.removeEventListener("keydown",v)},[p]),M.useEffect(()=>()=>{s.endSession()},[]),h.jsxs("main",{className:"maruthompal-page",children:[h.jsx("section",{className:"maruthompal-hero",children:h.jsx("div",{className:"maruthompal-hero-overlay",children:h.jsx("div",{className:"container",children:h.jsxs("div",{className:"maruthompal-hero-inner",children:[h.jsxs("div",{className:"maruthompal-hero-content",children:[h.jsxs("div",{className:"maruthompal-badge",children:[h.jsx(fE,{size:16}),h.jsx("span",{children:"Traditional Herbal Blends"})]}),h.jsx("h1",{className:"maruthompal-title",children:"Maruthompal"}),h.jsx("p",{className:"maruthompal-subtitle",children:"Authentic South Indian herbal idly podis, masalas & teas  crafted from nature's finest medicinal plants. Every product is a time-honoured recipe that nourishes both body and soul."}),h.jsxs("div",{className:"maruthompal-stats",children:[h.jsxs("div",{className:"stat-item",children:[h.jsx("span",{className:"stat-num",children:"27+"}),h.jsx("span",{className:"stat-label",children:"Herbal Products"})]}),h.jsx("div",{className:"stat-divider"}),h.jsxs("div",{className:"stat-item",children:[h.jsx("span",{className:"stat-num",children:"100%"}),h.jsx("span",{className:"stat-label",children:"Natural"})]}),h.jsx("div",{className:"stat-divider"}),h.jsxs("div",{className:"stat-item",children:[h.jsx("span",{className:"stat-num",children:"0"}),h.jsx("span",{className:"stat-label",children:"Preservatives"})]})]})]}),h.jsxs("div",{className:"maruthompal-hero-img-wrap",onMouseEnter:u,onClick:f,role:"button",tabIndex:0,"aria-label":"Talk to our Voice AI Assistant",onKeyDown:v=>v.key==="Enter"&&f(),children:[h.jsx("div",{className:"ai-img-pulse-ring"}),h.jsx("img",{src:K0,alt:"Voice AI Assistant",className:"maruthompal-hero-img"}),h.jsxs("div",{className:"ai-img-hint",children:[h.jsx(Wv,{size:13}),h.jsx("span",{children:"Click to talk"})]})]})]})})})}),a&&h.jsx("div",{className:"ai-modal-overlay",onClick:v=>{v.target===v.currentTarget&&p()},children:h.jsxs("div",{className:"ai-modal",children:[h.jsx("button",{className:"ai-modal-close",onClick:p,"aria-label":"Close",children:h.jsx(uc,{size:20})}),h.jsxs("div",{className:`ai-status-badge ${d?l?"speaking":"listening":"connecting"}`,children:[!d&&h.jsx("span",{children:"Connecting"}),d&&l&&h.jsxs(h.Fragment,{children:[h.jsx(VE,{size:13}),h.jsx("span",{children:"Agent is speaking"})]}),d&&!l&&h.jsxs(h.Fragment,{children:[h.jsx(Wv,{size:13}),h.jsx("span",{children:"Listening to you"})]})]}),h.jsxs("div",{className:"ai-modal-img-wrap",children:[h.jsx("div",{className:`ai-modal-pulse ${d&&l?"active":""}`}),h.jsx("img",{src:K0,alt:"Voice AI Agent",className:`ai-modal-img ${d&&l?"speaking-glow":""}`})]}),h.jsxs("div",{className:"ai-modal-controls",children:[h.jsx("p",{className:"ai-modal-hint",children:d?"Speak naturally  ask about any Maruthompal product!":"Connecting to your herbal assistant"}),h.jsxs("button",{className:"ai-end-btn",onClick:p,children:[h.jsx(TE,{size:18}),"End conversation"]})]})]})}),h.jsx("section",{className:"maruthompal-products-section",children:h.jsxs("div",{className:"container",children:[h.jsxs("div",{className:"section-header",children:[h.jsx("h2",{className:"section-title-main",children:"Our Herbal Collection"}),h.jsx("p",{className:"section-desc",children:"Explore our complete range of traditional South Indian herbal blends, each crafted with care from premium medicinal plants."})]}),h.jsx("div",{className:"maruthompal-grid",children:Cb.map(v=>h.jsx(Yr,{product:v},v.id))})]})})]})},nM=()=>h.jsx("div",{className:"policy-page",children:h.jsxs("div",{className:"policy-container",children:[h.jsxs("div",{className:"policy-header",children:[h.jsx(Te,{to:"/",className:"policy-back-link",children:" Back to Home"}),h.jsx("div",{className:"policy-tag",children:"Legal"}),h.jsx("h1",{children:"Privacy Policy"}),h.jsx("p",{className:"policy-date",children:"Last updated: January 1, 2026"})]}),h.jsx("p",{className:"policy-intro",children:"At AmmaFoods, your privacy is our priority. This Privacy Policy explains how we collect, use, store, and protect your personal information when you visit our website or make a purchase. By using our website, you agree to the practices described in this policy."}),h.jsxs("div",{className:"policy-section",children:[h.jsx("h2",{children:"1. Information We Collect"}),h.jsx("p",{children:"We collect the following types of information to process your orders and improve your experience:"}),h.jsxs("ul",{children:[h.jsxs("li",{children:[h.jsx("strong",{children:"Personal Information:"})," Name, email address, phone number, and delivery address when you place an order or create an account."]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Payment Information:"})," We do not store card details. Payments are processed securely through our payment gateway partners."]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Usage Data:"})," Pages visited, products viewed, and time spent on the website, collected via cookies and analytics tools."]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Device Information:"})," Browser type, IP address, and device type for security and performance purposes."]})]})]}),h.jsxs("div",{className:"policy-section",children:[h.jsx("h2",{children:"2. How We Use Your Information"}),h.jsx("p",{children:"The information we collect is used to:"}),h.jsxs("ul",{children:[h.jsx("li",{children:"Process and deliver your orders accurately and on time."}),h.jsx("li",{children:"Send order confirmations, shipping updates, and customer support communications."}),h.jsx("li",{children:"Personalise your shopping experience with relevant product recommendations."}),h.jsx("li",{children:"Improve website performance and fix any technical issues."}),h.jsx("li",{children:"Send promotional offers, discounts, and newsletters  only if you have opted in."}),h.jsx("li",{children:"Comply with legal obligations and prevent fraudulent activity."})]})]}),h.jsxs("div",{className:"policy-section",children:[h.jsx("h2",{children:"3. Sharing of Information"}),h.jsx("p",{children:"We do not sell, trade, or rent your personal information to third parties. We may share your data with:"}),h.jsxs("ul",{children:[h.jsxs("li",{children:[h.jsx("strong",{children:"Delivery Partners:"})," Your name, address, and phone number are shared with courier services solely for the purpose of delivering your order."]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Payment Processors:"})," Secure third-party payment gateways for processing transactions."]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Service Providers:"})," Trusted tools that help us run the website (e.g., analytics, email services), bound by strict confidentiality agreements."]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Legal Authorities:"})," When required by law or to protect the rights and safety of our customers and business."]})]})]}),h.jsxs("div",{className:"policy-section",children:[h.jsx("h2",{children:"4. Cookies"}),h.jsx("p",{children:"Our website uses cookies to enhance your browsing experience. Cookies are small files stored on your device that help us remember your preferences and understand how you use our site. You may disable cookies through your browser settings; however, some features of the website may not function properly without them."})]}),h.jsxs("div",{className:"policy-section",children:[h.jsx("h2",{children:"5. Data Security"}),h.jsx("p",{children:"We take the security of your personal information seriously. We use industry-standard encryption (SSL/TLS) to protect data transmitted between your browser and our servers. Access to your personal data is restricted to authorised personnel only."}),h.jsx("p",{children:"While we take all reasonable precautions, no method of online transmission is 100% secure. We encourage you to use strong passwords and keep your account credentials confidential."})]}),h.jsxs("div",{className:"policy-section",children:[h.jsx("h2",{children:"6. Data Retention"}),h.jsx("p",{children:"We retain your personal information for as long as necessary to fulfil the purposes outlined in this policy, unless a longer retention period is required by law. Order data is typically retained for 7 years for accounting and legal purposes."})]}),h.jsxs("div",{className:"policy-section",children:[h.jsx("h2",{children:"7. Your Rights"}),h.jsx("p",{children:"You have the right to:"}),h.jsxs("ul",{children:[h.jsx("li",{children:"Access the personal data we hold about you."}),h.jsx("li",{children:"Request correction of inaccurate or incomplete data."}),h.jsx("li",{children:"Request deletion of your personal data (subject to legal retention requirements)."}),h.jsx("li",{children:'Withdraw consent for marketing communications at any time by clicking "Unsubscribe" in our emails.'})]}),h.jsx("p",{children:"To exercise any of these rights, please contact us using the details below."})]}),h.jsxs("div",{className:"policy-section",children:[h.jsx("h2",{children:"8. Changes to This Policy"}),h.jsx("p",{children:'We may update this Privacy Policy from time to time. When we do, we will revise the "Last updated" date at the top of this page. We encourage you to review this policy periodically to stay informed about how we are protecting your information.'})]}),h.jsxs("div",{className:"policy-contact-box",children:[h.jsx("h3",{children:"Questions About Your Privacy?"}),h.jsx("p",{children:"If you have any questions or concerns about this Privacy Policy, please reach out to us:"}),h.jsxs("p",{children:[" Email: ",h.jsx("a",{href:"mailto:support@ammafoods.com",children:"support@ammafoods.com"})]}),h.jsxs("p",{children:[" Phone: ",h.jsx("a",{href:"tel:+919876543210",children:"+91 98765 43210"})]}),h.jsx("p",{children:" Address: AmmaFoods, Mumbai, Maharashtra, India"})]})]})}),iM=()=>h.jsx("div",{className:"policy-page",children:h.jsxs("div",{className:"policy-container",children:[h.jsxs("div",{className:"policy-header",children:[h.jsx(Te,{to:"/",className:"policy-back-link",children:" Back to Home"}),h.jsx("div",{className:"policy-tag",children:"Legal"}),h.jsx("h1",{children:"Terms & Conditions"}),h.jsx("p",{className:"policy-date",children:"Last updated: January 1, 2026"})]}),h.jsx("p",{className:"policy-intro",children:"Please read these Terms & Conditions carefully before using the AmmaFoods website or placing any order. By accessing our website or making a purchase, you agree to be bound by these terms. If you do not agree, please do not use our services."}),h.jsxs("div",{className:"policy-section",children:[h.jsx("h2",{children:"1. About AmmaFoods"}),h.jsx("p",{children:"AmmaFoods is an online retailer specialising in premium herbal supplements, organic foods, and natural wellness products. We are committed to delivering authentic, lab-tested, and FSSAI-certified products directly to your doorstep."})]}),h.jsxs("div",{className:"policy-section",children:[h.jsx("h2",{children:"2. Eligibility"}),h.jsx("p",{children:"By using our website, you confirm that you are at least 18 years of age, or accessing the site under the supervision of a parent or legal guardian. You agree to provide accurate and complete information when creating an account or placing an order."})]}),h.jsxs("div",{className:"policy-section",children:[h.jsx("h2",{children:"3. Products and Descriptions"}),h.jsx("p",{children:"We make every effort to display our products as accurately as possible, including images, descriptions, and ingredients. However:"}),h.jsxs("ul",{children:[h.jsx("li",{children:"Product colours may vary slightly due to screen display differences."}),h.jsx("li",{children:"All health claims on product pages are informational and not medical advice."}),h.jsx("li",{children:"We recommend consulting a qualified healthcare professional before using any herbal supplement, especially if you are pregnant, nursing, or on medication."}),h.jsx("li",{children:"AmmaFoods reserves the right to modify product descriptions and prices at any time without prior notice."})]})]}),h.jsxs("div",{className:"policy-section",children:[h.jsx("h2",{children:"4. Pricing and Payment"}),h.jsx("p",{children:"All prices listed on our website are in Indian Rupees () and are inclusive of applicable taxes unless stated otherwise. We reserve the right to update prices at any time. The price at the time of order confirmation will apply to your purchase."}),h.jsx("p",{children:"We accept payments via UPI, debit/credit cards, net banking, and other methods available at checkout. All transactions are processed securely through our payment partners."})]}),h.jsxs("div",{className:"policy-section",children:[h.jsx("h2",{children:"5. Order Confirmation and Cancellation"}),h.jsx("p",{children:"Once you place an order, you will receive an email confirmation. Your order is only confirmed after successful payment. We reserve the right to cancel any order due to product unavailability, pricing errors, or suspected fraudulent activity. In such cases, a full refund will be issued promptly."}),h.jsxs("p",{children:["If you wish to cancel your order, please contact us within ",h.jsx("strong",{children:"12 hours"})," of placing it. Once an order has been dispatched, it cannot be cancelled."]})]}),h.jsxs("div",{className:"policy-section",children:[h.jsx("h2",{children:"6. Intellectual Property"}),h.jsx("p",{children:"All content on this website  including text, images, logos, product descriptions, and graphics  is the property of AmmaFoods and is protected by applicable intellectual property laws. You may not reproduce, distribute, or use our content without prior written permission."})]}),h.jsxs("div",{className:"policy-section",children:[h.jsx("h2",{children:"7. Limitation of Liability"}),h.jsx("p",{children:"AmmaFoods shall not be liable for any indirect, incidental, or consequential damages arising from the use of our products or website. Our total liability to you shall not exceed the amount paid for the specific order in question."}),h.jsx("p",{children:"We are not responsible for delays caused by courier partners, natural disasters, strikes, or other circumstances beyond our control."})]}),h.jsxs("div",{className:"policy-section",children:[h.jsx("h2",{children:"8. Governing Law"}),h.jsx("p",{children:"These Terms & Conditions are governed by the laws of India. Any disputes arising from your use of our website or services shall be subject to the exclusive jurisdiction of the courts in Mumbai, Maharashtra."})]}),h.jsxs("div",{className:"policy-section",children:[h.jsx("h2",{children:"9. Changes to These Terms"}),h.jsx("p",{children:"We may revise these Terms & Conditions from time to time. Continued use of our website after any changes constitutes your acceptance of the updated terms. We recommend reviewing this page periodically."})]}),h.jsxs("div",{className:"policy-contact-box",children:[h.jsx("h3",{children:"Have a Question?"}),h.jsx("p",{children:"If you have questions about these Terms & Conditions, please contact us:"}),h.jsxs("p",{children:[" Email: ",h.jsx("a",{href:"mailto:support@ammafoods.com",children:"support@ammafoods.com"})]}),h.jsxs("p",{children:[" Phone: ",h.jsx("a",{href:"tel:+919876543210",children:"+91 98765 43210"})]}),h.jsx("p",{children:" Address: AmmaFoods, Mumbai, Maharashtra, India"})]})]})}),aM=()=>h.jsx("div",{className:"policy-page",children:h.jsxs("div",{className:"policy-container",children:[h.jsxs("div",{className:"policy-header",children:[h.jsx(Te,{to:"/",className:"policy-back-link",children:" Back to Home"}),h.jsx("div",{className:"policy-tag",children:"Customer Care"}),h.jsx("h1",{children:"Refund & Return Policy"}),h.jsx("p",{className:"policy-date",children:"Last updated: January 1, 2026"})]}),h.jsx("p",{className:"policy-intro",children:"At AmmaFoods, we stand behind every product we sell. If you are not completely satisfied with your purchase, we are here to help. Please read our refund and return policy carefully to understand your options."}),h.jsxs("div",{className:"policy-section",children:[h.jsx("h2",{children:"1. Eligibility for Returns"}),h.jsx("p",{children:"You may request a return or refund if:"}),h.jsxs("ul",{children:[h.jsxs("li",{children:["The product you received is ",h.jsx("strong",{children:"damaged"}),", ",h.jsx("strong",{children:"defective"}),", or ",h.jsx("strong",{children:"expired"}),"."]}),h.jsxs("li",{children:["You received the ",h.jsx("strong",{children:"wrong product"})," that does not match your order."]}),h.jsxs("li",{children:["The product ",h.jsx("strong",{children:"packaging is tampered"})," or the seal is broken upon delivery."]})]}),h.jsxs("p",{children:["Return requests must be raised within ",h.jsx("strong",{children:"7 days"})," of the delivery date. Requests raised after this period will not be eligible for a refund or replacement."]})]}),h.jsxs("div",{className:"policy-section",children:[h.jsx("h2",{children:"2. Non-Returnable Items"}),h.jsxs("p",{children:["For hygiene and safety reasons, the following items are ",h.jsx("strong",{children:"not eligible"})," for return:"]}),h.jsxs("ul",{children:[h.jsx("li",{children:"Opened or partially consumed products."}),h.jsx("li",{children:"Products purchased under special clearance or flash sale offers (unless defective)."}),h.jsx("li",{children:"Items that have been used or show signs of misuse."}),h.jsx("li",{children:"Products without original packaging or labels."})]})]}),h.jsxs("div",{className:"policy-section",children:[h.jsx("h2",{children:"3. How to Initiate a Return"}),h.jsx("p",{children:"To request a return, please follow these steps:"}),h.jsxs("ul",{children:[h.jsxs("li",{children:[h.jsx("strong",{children:"Step 1:"})," Email us at ",h.jsx("strong",{children:"support@ammafoods.com"})," within 7 days of delivery."]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Step 2:"})," Include your ",h.jsx("strong",{children:"order number"}),", the ",h.jsx("strong",{children:"reason for return"}),", and ",h.jsx("strong",{children:"clear photographs"})," of the product (and any damage)."]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Step 3:"})," Our customer support team will review your request within ",h.jsx("strong",{children:"2 business days"})," and guide you on the next steps."]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Step 4:"})," If approved, we will arrange a pickup or provide a return address. Please pack the product securely in its original packaging."]})]})]}),h.jsxs("div",{className:"policy-section",children:[h.jsx("h2",{children:"4. Refund Process"}),h.jsxs("p",{children:["Once we receive and inspect the returned product, we will notify you of the approval or rejection of your refund within ",h.jsx("strong",{children:"23 business days"}),"."]}),h.jsx("p",{children:"If approved, refunds will be processed as follows:"}),h.jsxs("ul",{children:[h.jsxs("li",{children:[h.jsx("strong",{children:"Original Payment Method:"})," The refund will be credited to the original payment source (credit/debit card, UPI, net banking) within ",h.jsx("strong",{children:"57 business days"}),", depending on your bank."]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Store Credit:"})," As an alternative, we can issue instant store credit (AmmaFoods wallet) which can be used on your next purchase."]})]}),h.jsx("p",{children:"Shipping charges are non-refundable unless the return is due to our error."})]}),h.jsxs("div",{className:"policy-section",children:[h.jsx("h2",{children:"5. Replacement Option"}),h.jsxs("p",{children:["Instead of a refund, you may opt for a ",h.jsx("strong",{children:"free replacement"})," of the same product (subject to availability). Replacement orders are dispatched within 35 business days after the return is approved."]})]}),h.jsxs("div",{className:"policy-section",children:[h.jsx("h2",{children:"6. Cancellations"}),h.jsxs("p",{children:["Orders can be cancelled before they are dispatched. To cancel, contact us within",h.jsx("strong",{children:" 12 hours"})," of placing the order. Once shipped, the order cannot be cancelled. In that case, please follow the return process after receiving the package."]})]}),h.jsxs("div",{className:"policy-section",children:[h.jsx("h2",{children:"7. Damaged in Transit"}),h.jsxs("p",{children:["If your package arrives damaged, please ",h.jsx("strong",{children:"do not accept the delivery"}),'and mark it as "Refused  Damaged" with the courier. Take photos and notify us immediately at support@ammafoods.com. We will dispatch a replacement at no cost.']})]}),h.jsxs("div",{className:"policy-contact-box",children:[h.jsx("h3",{children:"Need Help With a Return?"}),h.jsx("p",{children:"Our team is happy to assist you. Reach out to us anytime:"}),h.jsxs("p",{children:[" Email: ",h.jsx("a",{href:"mailto:support@ammafoods.com",children:"support@ammafoods.com"})]}),h.jsxs("p",{children:[" Phone: ",h.jsx("a",{href:"tel:+919876543210",children:"+91 98765 43210"})," (MonSat, 9 AM  6 PM)"]}),h.jsx("p",{children:" Address: AmmaFoods, Mumbai, Maharashtra, India"})]})]})}),sM=()=>h.jsx("div",{className:"policy-page",children:h.jsxs("div",{className:"policy-container",children:[h.jsxs("div",{className:"policy-header",children:[h.jsx(Te,{to:"/",className:"policy-back-link",children:" Back to Home"}),h.jsx("div",{className:"policy-tag",children:"Delivery"}),h.jsx("h1",{children:"Shipping Policy"}),h.jsx("p",{className:"policy-date",children:"Last updated: January 1, 2026"})]}),h.jsx("p",{className:"policy-intro",children:"We know you can't wait to receive your AmmaFoods products! We are committed to processing and shipping your orders as quickly as possible. Here is everything you need to know about our shipping process."}),h.jsxs("div",{className:"policy-section",children:[h.jsx("h2",{children:"1. Order Processing Time"}),h.jsxs("p",{children:["All orders placed on AmmaFoods are processed within ",h.jsx("strong",{children:"12 business days"}),"(Monday to Saturday, excluding public holidays). Orders placed after 3:00 PM IST or on Sundays/public holidays will be processed the next business day."]}),h.jsx("p",{children:"You will receive an order confirmation email immediately after placing your order, and a separate shipping confirmation email with a tracking number once your order is dispatched."})]}),h.jsxs("div",{className:"policy-section",children:[h.jsx("h2",{children:"2. Shipping Destinations"}),h.jsx("p",{children:"We currently ship to all major cities and towns across India, including:"}),h.jsxs("ul",{children:[h.jsx("li",{children:"Metro cities: Mumbai, Delhi, Bengaluru, Chennai, Hyderabad, Kolkata, Pune"}),h.jsx("li",{children:"Tier 2 and Tier 3 cities across all states"}),h.jsx("li",{children:"Remote pin codes may take additional 23 days for delivery"})]}),h.jsx("p",{children:"We do not currently offer international shipping. We hope to expand to more regions in the near future."})]}),h.jsxs("div",{className:"policy-section",children:[h.jsx("h2",{children:"3. Estimated Delivery Times"}),h.jsx("p",{children:"Delivery timelines vary by location:"}),h.jsxs("ul",{children:[h.jsxs("li",{children:[h.jsx("strong",{children:"Metro Cities:"})," 24 business days after dispatch"]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Tier 2 / Tier 3 Cities:"})," 46 business days after dispatch"]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Remote / Rural Areas:"})," 610 business days after dispatch"]})]}),h.jsx("p",{children:"These are estimated timelines and may vary due to peak seasons, festivals, bad weather, or other unforeseen circumstances. We appreciate your patience during such times."})]}),h.jsxs("div",{className:"policy-section",children:[h.jsx("h2",{children:"4. Shipping Charges"}),h.jsxs("ul",{children:[h.jsxs("li",{children:[h.jsx("strong",{children:"Free Shipping:"})," On all orders above 499."]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Standard Shipping:"})," 49 for orders below 499."]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Express Shipping:"})," Available at checkout for select pin codes at an additional charge."]})]}),h.jsx("p",{children:"Shipping charges (if applicable) are non-refundable unless the return is due to our error."})]}),h.jsxs("div",{className:"policy-section",children:[h.jsx("h2",{children:"5. Order Tracking"}),h.jsxs("p",{children:["Once your order is dispatched, you will receive an SMS and email containing your",h.jsx("strong",{children:" tracking number"})," and the name of the courier partner. You can use this to track your shipment on the courier's website in real time."]}),h.jsx("p",{children:"If you face any difficulty tracking your order, please contact our customer support with your order number and we will assist you."})]}),h.jsxs("div",{className:"policy-section",children:[h.jsx("h2",{children:"6. Delivery Attempts"}),h.jsxs("p",{children:["Our courier partners will attempt delivery up to ",h.jsx("strong",{children:"3 times"}),". If the package cannot be delivered after 3 attempts (due to incorrect address, no one available to receive, etc.), it will be returned to our warehouse."]}),h.jsx("p",{children:"In such cases, you may request a re-dispatch at an additional shipping charge, or we can issue a refund for the product cost (shipping charges excluded)."})]}),h.jsxs("div",{className:"policy-section",children:[h.jsx("h2",{children:"7. Incorrect Address"}),h.jsx("p",{children:"Please ensure your delivery address is complete and accurate at the time of placing the order. AmmaFoods is not responsible for non-delivery due to an incorrect or incomplete address provided by the customer. Address changes can only be made before the order is dispatched."})]}),h.jsxs("div",{className:"policy-section",children:[h.jsx("h2",{children:"8. Damaged or Lost Packages"}),h.jsx("p",{children:"If your package appears damaged upon delivery, please refuse to accept it and inform our support team immediately. If a package is confirmed lost in transit by the courier, we will arrange a full replacement or refund at no extra cost to you."})]}),h.jsxs("div",{className:"policy-section",children:[h.jsx("h2",{children:"9. Shipping During Festive Seasons"}),h.jsxs("p",{children:["During major festivals (Diwali, Pongal, Holi, etc.), courier services may experience higher-than-usual volumes, which can cause delays. We recommend placing your orders at least ",h.jsx("strong",{children:"10 days in advance"})," during the festive season to ensure timely delivery."]})]}),h.jsxs("div",{className:"policy-contact-box",children:[h.jsx("h3",{children:"Shipping Support"}),h.jsx("p",{children:"For any shipping-related queries, feel free to get in touch with us:"}),h.jsxs("p",{children:[" Email: ",h.jsx("a",{href:"mailto:support@ammafoods.com",children:"support@ammafoods.com"})]}),h.jsxs("p",{children:[" Phone: ",h.jsx("a",{href:"tel:+919876543210",children:"+91 98765 43210"})," (MonSat, 9 AM  6 PM IST)"]}),h.jsx("p",{children:" Address: AmmaFoods, Mumbai, Maharashtra, India"})]})]})}),rM=()=>h.jsx(Ax,{children:h.jsxs(Hx,{children:[h.jsx(Vx,{}),h.jsx(nw,{}),h.jsx(iw,{}),h.jsxs(sx,{children:[h.jsx(sn,{path:"/",element:h.jsx(cw,{})}),h.jsx(sn,{path:"/products",element:h.jsx(fw,{})}),h.jsx(sn,{path:"/product/:id",element:h.jsx(mw,{})}),h.jsx(sn,{path:"/checkout",element:h.jsx(vw,{})}),h.jsx(sn,{path:"/order-summary",element:h.jsx(yw,{})}),h.jsx(sn,{path:"/payment",element:h.jsx(bw,{})}),h.jsx(sn,{path:"/order-confirmed",element:h.jsx(Sw,{})}),h.jsx(sn,{path:"/maruthompal",element:h.jsx(tM,{})}),h.jsx(sn,{path:"/privacy-policy",element:h.jsx(nM,{})}),h.jsx(sn,{path:"/terms-conditions",element:h.jsx(iM,{})}),h.jsx(sn,{path:"/refund-policy",element:h.jsx(aM,{})}),h.jsx(sn,{path:"/shipping-policy",element:h.jsx(sM,{})})]}),h.jsx(aw,{})]})});o1.createRoot(document.getElementById("root")).render(h.jsx(M.StrictMode,{children:h.jsx(rM,{})}));
