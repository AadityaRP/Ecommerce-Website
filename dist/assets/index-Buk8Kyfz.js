(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const d of l.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function i(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(o){if(o.ep)return;o.ep=!0;const l=i(o);fetch(o.href,l)}})();function Xk(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var Ud={exports:{}},Mr={};var Dv;function Wk(){if(Dv)return Mr;Dv=1;var a=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function i(s,o,l){var d=null;if(l!==void 0&&(d=""+l),o.key!==void 0&&(d=""+o.key),"key"in o){l={};for(var u in o)u!=="key"&&(l[u]=o[u])}else l=o;return o=l.ref,{$$typeof:a,type:s,key:d,ref:o!==void 0?o:null,props:l}}return Mr.Fragment=e,Mr.jsx=i,Mr.jsxs=i,Mr}var Ov;function Zk(){return Ov||(Ov=1,Ud.exports=Wk()),Ud.exports}var v=Zk(),Bd={exports:{}},ge={};var Pv;function $k(){if(Pv)return ge;Pv=1;var a=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),d=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),y=Symbol.for("react.activity"),S=Symbol.iterator;function T(A){return A===null||typeof A!="object"?null:(A=S&&A[S]||A["@@iterator"],typeof A=="function"?A:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,k={};function R(A,Y,se){this.props=A,this.context=Y,this.refs=k,this.updater=se||x}R.prototype.isReactComponent={},R.prototype.setState=function(A,Y){if(typeof A!="object"&&typeof A!="function"&&A!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,A,Y,"setState")},R.prototype.forceUpdate=function(A){this.updater.enqueueForceUpdate(this,A,"forceUpdate")};function O(){}O.prototype=R.prototype;function L(A,Y,se){this.props=A,this.context=Y,this.refs=k,this.updater=se||x}var D=L.prototype=new O;D.constructor=L,E(D,R.prototype),D.isPureReactComponent=!0;var I=Array.isArray;function P(){}var H={H:null,A:null,T:null,S:null},Z=Object.prototype.hasOwnProperty;function ee(A,Y,se){var le=se.ref;return{$$typeof:a,type:A,key:Y,ref:le!==void 0?le:null,props:se}}function te(A,Y){return ee(A.type,Y,A.props)}function re(A){return typeof A=="object"&&A!==null&&A.$$typeof===a}function ue(A){var Y={"=":"=0",":":"=2"};return"$"+A.replace(/[=:]/g,function(se){return Y[se]})}var Ae=/\/+/g;function Xe(A,Y){return typeof A=="object"&&A!==null&&A.key!=null?ue(""+A.key):Y.toString(36)}function Fe(A){switch(A.status){case"fulfilled":return A.value;case"rejected":throw A.reason;default:switch(typeof A.status=="string"?A.then(P,P):(A.status="pending",A.then(function(Y){A.status==="pending"&&(A.status="fulfilled",A.value=Y)},function(Y){A.status==="pending"&&(A.status="rejected",A.reason=Y)})),A.status){case"fulfilled":return A.value;case"rejected":throw A.reason}}throw A}function F(A,Y,se,le,pe){var ye=typeof A;(ye==="undefined"||ye==="boolean")&&(A=null);var Be=!1;if(A===null)Be=!0;else switch(ye){case"bigint":case"string":case"number":Be=!0;break;case"object":switch(A.$$typeof){case a:case e:Be=!0;break;case g:return Be=A._init,F(Be(A._payload),Y,se,le,pe)}}if(Be)return pe=pe(A),Be=le===""?"."+Xe(A,0):le,I(pe)?(se="",Be!=null&&(se=Be.replace(Ae,"$&/")+"/"),F(pe,Y,se,"",function(Is){return Is})):pe!=null&&(re(pe)&&(pe=te(pe,se+(pe.key==null||A&&A.key===pe.key?"":(""+pe.key).replace(Ae,"$&/")+"/")+Be)),Y.push(pe)),1;Be=0;var Dt=le===""?".":le+":";if(I(A))for(var ot=0;ot<A.length;ot++)le=A[ot],ye=Dt+Xe(le,ot),Be+=F(le,Y,se,ye,pe);else if(ot=T(A),typeof ot=="function")for(A=ot.call(A),ot=0;!(le=A.next()).done;)le=le.value,ye=Dt+Xe(le,ot++),Be+=F(le,Y,se,ye,pe);else if(ye==="object"){if(typeof A.then=="function")return F(Fe(A),Y,se,le,pe);throw Y=String(A),Error("Objects are not valid as a React child (found: "+(Y==="[object Object]"?"object with keys {"+Object.keys(A).join(", ")+"}":Y)+"). If you meant to render a collection of children, use an array instead.")}return Be}function ne(A,Y,se){if(A==null)return A;var le=[],pe=0;return F(A,le,"","",function(ye){return Y.call(se,ye,pe++)}),le}function he(A){if(A._status===-1){var Y=A._result;Y=Y(),Y.then(function(se){(A._status===0||A._status===-1)&&(A._status=1,A._result=se)},function(se){(A._status===0||A._status===-1)&&(A._status=2,A._result=se)}),A._status===-1&&(A._status=0,A._result=Y)}if(A._status===1)return A._result.default;throw A._result}var Oe=typeof reportError=="function"?reportError:function(A){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Y=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof A=="object"&&A!==null&&typeof A.message=="string"?String(A.message):String(A),error:A});if(!window.dispatchEvent(Y))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",A);return}console.error(A)},Le={map:ne,forEach:function(A,Y,se){ne(A,function(){Y.apply(this,arguments)},se)},count:function(A){var Y=0;return ne(A,function(){Y++}),Y},toArray:function(A){return ne(A,function(Y){return Y})||[]},only:function(A){if(!re(A))throw Error("React.Children.only expected to receive a single React element child.");return A}};return ge.Activity=y,ge.Children=Le,ge.Component=R,ge.Fragment=i,ge.Profiler=o,ge.PureComponent=L,ge.StrictMode=s,ge.Suspense=h,ge.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=H,ge.__COMPILER_RUNTIME={__proto__:null,c:function(A){return H.H.useMemoCache(A)}},ge.cache=function(A){return function(){return A.apply(null,arguments)}},ge.cacheSignal=function(){return null},ge.cloneElement=function(A,Y,se){if(A==null)throw Error("The argument must be a React element, but you passed "+A+".");var le=E({},A.props),pe=A.key;if(Y!=null)for(ye in Y.key!==void 0&&(pe=""+Y.key),Y)!Z.call(Y,ye)||ye==="key"||ye==="__self"||ye==="__source"||ye==="ref"&&Y.ref===void 0||(le[ye]=Y[ye]);var ye=arguments.length-2;if(ye===1)le.children=se;else if(1<ye){for(var Be=Array(ye),Dt=0;Dt<ye;Dt++)Be[Dt]=arguments[Dt+2];le.children=Be}return ee(A.type,pe,le)},ge.createContext=function(A){return A={$$typeof:d,_currentValue:A,_currentValue2:A,_threadCount:0,Provider:null,Consumer:null},A.Provider=A,A.Consumer={$$typeof:l,_context:A},A},ge.createElement=function(A,Y,se){var le,pe={},ye=null;if(Y!=null)for(le in Y.key!==void 0&&(ye=""+Y.key),Y)Z.call(Y,le)&&le!=="key"&&le!=="__self"&&le!=="__source"&&(pe[le]=Y[le]);var Be=arguments.length-2;if(Be===1)pe.children=se;else if(1<Be){for(var Dt=Array(Be),ot=0;ot<Be;ot++)Dt[ot]=arguments[ot+2];pe.children=Dt}if(A&&A.defaultProps)for(le in Be=A.defaultProps,Be)pe[le]===void 0&&(pe[le]=Be[le]);return ee(A,ye,pe)},ge.createRef=function(){return{current:null}},ge.forwardRef=function(A){return{$$typeof:u,render:A}},ge.isValidElement=re,ge.lazy=function(A){return{$$typeof:g,_payload:{_status:-1,_result:A},_init:he}},ge.memo=function(A,Y){return{$$typeof:m,type:A,compare:Y===void 0?null:Y}},ge.startTransition=function(A){var Y=H.T,se={};H.T=se;try{var le=A(),pe=H.S;pe!==null&&pe(se,le),typeof le=="object"&&le!==null&&typeof le.then=="function"&&le.then(P,Oe)}catch(ye){Oe(ye)}finally{Y!==null&&se.types!==null&&(Y.types=se.types),H.T=Y}},ge.unstable_useCacheRefresh=function(){return H.H.useCacheRefresh()},ge.use=function(A){return H.H.use(A)},ge.useActionState=function(A,Y,se){return H.H.useActionState(A,Y,se)},ge.useCallback=function(A,Y){return H.H.useCallback(A,Y)},ge.useContext=function(A){return H.H.useContext(A)},ge.useDebugValue=function(){},ge.useDeferredValue=function(A,Y){return H.H.useDeferredValue(A,Y)},ge.useEffect=function(A,Y){return H.H.useEffect(A,Y)},ge.useEffectEvent=function(A){return H.H.useEffectEvent(A)},ge.useId=function(){return H.H.useId()},ge.useImperativeHandle=function(A,Y,se){return H.H.useImperativeHandle(A,Y,se)},ge.useInsertionEffect=function(A,Y){return H.H.useInsertionEffect(A,Y)},ge.useLayoutEffect=function(A,Y){return H.H.useLayoutEffect(A,Y)},ge.useMemo=function(A,Y){return H.H.useMemo(A,Y)},ge.useOptimistic=function(A,Y){return H.H.useOptimistic(A,Y)},ge.useReducer=function(A,Y,se){return H.H.useReducer(A,Y,se)},ge.useRef=function(A){return H.H.useRef(A)},ge.useState=function(A){return H.H.useState(A)},ge.useSyncExternalStore=function(A,Y,se){return H.H.useSyncExternalStore(A,Y,se)},ge.useTransition=function(){return H.H.useTransition()},ge.version="19.2.4",ge}var jv;function Yh(){return jv||(jv=1,Bd.exports=$k()),Bd.exports}var N=Yh();const e1=Xk(N);var qd={exports:{}},Ar={},zd={exports:{}},Fd={};var Iv;function t1(){return Iv||(Iv=1,(function(a){function e(F,ne){var he=F.length;F.push(ne);e:for(;0<he;){var Oe=he-1>>>1,Le=F[Oe];if(0<o(Le,ne))F[Oe]=ne,F[he]=Le,he=Oe;else break e}}function i(F){return F.length===0?null:F[0]}function s(F){if(F.length===0)return null;var ne=F[0],he=F.pop();if(he!==ne){F[0]=he;e:for(var Oe=0,Le=F.length,A=Le>>>1;Oe<A;){var Y=2*(Oe+1)-1,se=F[Y],le=Y+1,pe=F[le];if(0>o(se,he))le<Le&&0>o(pe,se)?(F[Oe]=pe,F[le]=he,Oe=le):(F[Oe]=se,F[Y]=he,Oe=Y);else if(le<Le&&0>o(pe,he))F[Oe]=pe,F[le]=he,Oe=le;else break e}}return ne}function o(F,ne){var he=F.sortIndex-ne.sortIndex;return he!==0?he:F.id-ne.id}if(a.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;a.unstable_now=function(){return l.now()}}else{var d=Date,u=d.now();a.unstable_now=function(){return d.now()-u}}var h=[],m=[],g=1,y=null,S=3,T=!1,x=!1,E=!1,k=!1,R=typeof setTimeout=="function"?setTimeout:null,O=typeof clearTimeout=="function"?clearTimeout:null,L=typeof setImmediate<"u"?setImmediate:null;function D(F){for(var ne=i(m);ne!==null;){if(ne.callback===null)s(m);else if(ne.startTime<=F)s(m),ne.sortIndex=ne.expirationTime,e(h,ne);else break;ne=i(m)}}function I(F){if(E=!1,D(F),!x)if(i(h)!==null)x=!0,P||(P=!0,ue());else{var ne=i(m);ne!==null&&Fe(I,ne.startTime-F)}}var P=!1,H=-1,Z=5,ee=-1;function te(){return k?!0:!(a.unstable_now()-ee<Z)}function re(){if(k=!1,P){var F=a.unstable_now();ee=F;var ne=!0;try{e:{x=!1,E&&(E=!1,O(H),H=-1),T=!0;var he=S;try{t:{for(D(F),y=i(h);y!==null&&!(y.expirationTime>F&&te());){var Oe=y.callback;if(typeof Oe=="function"){y.callback=null,S=y.priorityLevel;var Le=Oe(y.expirationTime<=F);if(F=a.unstable_now(),typeof Le=="function"){y.callback=Le,D(F),ne=!0;break t}y===i(h)&&s(h),D(F)}else s(h);y=i(h)}if(y!==null)ne=!0;else{var A=i(m);A!==null&&Fe(I,A.startTime-F),ne=!1}}break e}finally{y=null,S=he,T=!1}ne=void 0}}finally{ne?ue():P=!1}}}var ue;if(typeof L=="function")ue=function(){L(re)};else if(typeof MessageChannel<"u"){var Ae=new MessageChannel,Xe=Ae.port2;Ae.port1.onmessage=re,ue=function(){Xe.postMessage(null)}}else ue=function(){R(re,0)};function Fe(F,ne){H=R(function(){F(a.unstable_now())},ne)}a.unstable_IdlePriority=5,a.unstable_ImmediatePriority=1,a.unstable_LowPriority=4,a.unstable_NormalPriority=3,a.unstable_Profiling=null,a.unstable_UserBlockingPriority=2,a.unstable_cancelCallback=function(F){F.callback=null},a.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Z=0<F?Math.floor(1e3/F):5},a.unstable_getCurrentPriorityLevel=function(){return S},a.unstable_next=function(F){switch(S){case 1:case 2:case 3:var ne=3;break;default:ne=S}var he=S;S=ne;try{return F()}finally{S=he}},a.unstable_requestPaint=function(){k=!0},a.unstable_runWithPriority=function(F,ne){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var he=S;S=F;try{return ne()}finally{S=he}},a.unstable_scheduleCallback=function(F,ne,he){var Oe=a.unstable_now();switch(typeof he=="object"&&he!==null?(he=he.delay,he=typeof he=="number"&&0<he?Oe+he:Oe):he=Oe,F){case 1:var Le=-1;break;case 2:Le=250;break;case 5:Le=1073741823;break;case 4:Le=1e4;break;default:Le=5e3}return Le=he+Le,F={id:g++,callback:ne,priorityLevel:F,startTime:he,expirationTime:Le,sortIndex:-1},he>Oe?(F.sortIndex=he,e(m,F),i(h)===null&&F===i(m)&&(E?(O(H),H=-1):E=!0,Fe(I,he-Oe))):(F.sortIndex=Le,e(h,F),x||T||(x=!0,P||(P=!0,ue()))),F},a.unstable_shouldYield=te,a.unstable_wrapCallback=function(F){var ne=S;return function(){var he=S;S=ne;try{return F.apply(this,arguments)}finally{S=he}}}})(Fd)),Fd}var Lv;function n1(){return Lv||(Lv=1,zd.exports=t1()),zd.exports}var Hd={exports:{}},At={};var Uv;function i1(){if(Uv)return At;Uv=1;var a=Yh();function e(h){var m="https://react.dev/errors/"+h;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)m+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+h+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(){}var s={d:{f:i,r:function(){throw Error(e(522))},D:i,C:i,L:i,m:i,X:i,S:i,M:i},p:0,findDOMNode:null},o=Symbol.for("react.portal");function l(h,m,g){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:y==null?null:""+y,children:h,containerInfo:m,implementation:g}}var d=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,m){if(h==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return At.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,At.createPortal=function(h,m){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(e(299));return l(h,m,null,g)},At.flushSync=function(h){var m=d.T,g=s.p;try{if(d.T=null,s.p=2,h)return h()}finally{d.T=m,s.p=g,s.d.f()}},At.preconnect=function(h,m){typeof h=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,s.d.C(h,m))},At.prefetchDNS=function(h){typeof h=="string"&&s.d.D(h)},At.preinit=function(h,m){if(typeof h=="string"&&m&&typeof m.as=="string"){var g=m.as,y=u(g,m.crossOrigin),S=typeof m.integrity=="string"?m.integrity:void 0,T=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;g==="style"?s.d.S(h,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:y,integrity:S,fetchPriority:T}):g==="script"&&s.d.X(h,{crossOrigin:y,integrity:S,fetchPriority:T,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},At.preinitModule=function(h,m){if(typeof h=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var g=u(m.as,m.crossOrigin);s.d.M(h,{crossOrigin:g,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&s.d.M(h)},At.preload=function(h,m){if(typeof h=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var g=m.as,y=u(g,m.crossOrigin);s.d.L(h,g,{crossOrigin:y,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},At.preloadModule=function(h,m){if(typeof h=="string")if(m){var g=u(m.as,m.crossOrigin);s.d.m(h,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:g,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else s.d.m(h)},At.requestFormReset=function(h){s.d.r(h)},At.unstable_batchedUpdates=function(h,m){return h(m)},At.useFormState=function(h,m,g){return d.H.useFormState(h,m,g)},At.useFormStatus=function(){return d.H.useHostTransitionStatus()},At.version="19.2.4",At}var Bv;function a1(){if(Bv)return Hd.exports;Bv=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(e){console.error(e)}}return a(),Hd.exports=i1(),Hd.exports}var qv;function s1(){if(qv)return Ar;qv=1;var a=n1(),e=Yh(),i=a1();function s(t){var n="https://react.dev/errors/"+t;if(1<arguments.length){n+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)n+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+t+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function l(t){var n=t,r=t;if(t.alternate)for(;n.return;)n=n.return;else{t=n;do n=t,(n.flags&4098)!==0&&(r=n.return),t=n.return;while(t)}return n.tag===3?r:null}function d(t){if(t.tag===13){var n=t.memoizedState;if(n===null&&(t=t.alternate,t!==null&&(n=t.memoizedState)),n!==null)return n.dehydrated}return null}function u(t){if(t.tag===31){var n=t.memoizedState;if(n===null&&(t=t.alternate,t!==null&&(n=t.memoizedState)),n!==null)return n.dehydrated}return null}function h(t){if(l(t)!==t)throw Error(s(188))}function m(t){var n=t.alternate;if(!n){if(n=l(t),n===null)throw Error(s(188));return n!==t?null:t}for(var r=t,c=n;;){var f=r.return;if(f===null)break;var p=f.alternate;if(p===null){if(c=f.return,c!==null){r=c;continue}break}if(f.child===p.child){for(p=f.child;p;){if(p===r)return h(f),t;if(p===c)return h(f),n;p=p.sibling}throw Error(s(188))}if(r.return!==c.return)r=f,c=p;else{for(var b=!1,C=f.child;C;){if(C===r){b=!0,r=f,c=p;break}if(C===c){b=!0,c=f,r=p;break}C=C.sibling}if(!b){for(C=p.child;C;){if(C===r){b=!0,r=p,c=f;break}if(C===c){b=!0,c=p,r=f;break}C=C.sibling}if(!b)throw Error(s(189))}}if(r.alternate!==c)throw Error(s(190))}if(r.tag!==3)throw Error(s(188));return r.stateNode.current===r?t:n}function g(t){var n=t.tag;if(n===5||n===26||n===27||n===6)return t;for(t=t.child;t!==null;){if(n=g(t),n!==null)return n;t=t.sibling}return null}var y=Object.assign,S=Symbol.for("react.element"),T=Symbol.for("react.transitional.element"),x=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),O=Symbol.for("react.consumer"),L=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),P=Symbol.for("react.suspense_list"),H=Symbol.for("react.memo"),Z=Symbol.for("react.lazy"),ee=Symbol.for("react.activity"),te=Symbol.for("react.memo_cache_sentinel"),re=Symbol.iterator;function ue(t){return t===null||typeof t!="object"?null:(t=re&&t[re]||t["@@iterator"],typeof t=="function"?t:null)}var Ae=Symbol.for("react.client.reference");function Xe(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===Ae?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case E:return"Fragment";case R:return"Profiler";case k:return"StrictMode";case I:return"Suspense";case P:return"SuspenseList";case ee:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case x:return"Portal";case L:return t.displayName||"Context";case O:return(t._context.displayName||"Context")+".Consumer";case D:var n=t.render;return t=t.displayName,t||(t=n.displayName||n.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case H:return n=t.displayName||null,n!==null?n:Xe(t.type)||"Memo";case Z:n=t._payload,t=t._init;try{return Xe(t(n))}catch{}}return null}var Fe=Array.isArray,F=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ne=i.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,he={pending:!1,data:null,method:null,action:null},Oe=[],Le=-1;function A(t){return{current:t}}function Y(t){0>Le||(t.current=Oe[Le],Oe[Le]=null,Le--)}function se(t,n){Le++,Oe[Le]=t.current,t.current=n}var le=A(null),pe=A(null),ye=A(null),Be=A(null);function Dt(t,n){switch(se(ye,n),se(pe,t),se(le,null),n.nodeType){case 9:case 11:t=(t=n.documentElement)&&(t=t.namespaceURI)?tv(t):0;break;default:if(t=n.tagName,n=n.namespaceURI)n=tv(n),t=nv(n,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}Y(le),se(le,t)}function ot(){Y(le),Y(pe),Y(ye)}function Is(t){t.memoizedState!==null&&se(Be,t);var n=le.current,r=nv(n,t.type);n!==r&&(se(pe,t),se(le,r))}function ao(t){pe.current===t&&(Y(le),Y(pe)),Be.current===t&&(Y(Be),_r._currentValue=he)}var Sc,Nf;function aa(t){if(Sc===void 0)try{throw Error()}catch(r){var n=r.stack.trim().match(/\n( *(at )?)/);Sc=n&&n[1]||"",Nf=-1<r.stack.indexOf(`
    at`)?" (<anonymous>)":-1<r.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Sc+t+Nf}var Cc=!1;function Tc(t,n){if(!t||Cc)return"";Cc=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(n){var J=function(){throw Error()};if(Object.defineProperty(J.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(J,[])}catch(V){var z=V}Reflect.construct(t,[],J)}else{try{J.call()}catch(V){z=V}t.call(J.prototype)}}else{try{throw Error()}catch(V){z=V}(J=t())&&typeof J.catch=="function"&&J.catch(function(){})}}catch(V){if(V&&z&&typeof V.stack=="string")return[V.stack,z.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var p=c.DetermineComponentFrameRoot(),b=p[0],C=p[1];if(b&&C){var w=b.split(`
`),q=C.split(`
`);for(f=c=0;c<w.length&&!w[c].includes("DetermineComponentFrameRoot");)c++;for(;f<q.length&&!q[f].includes("DetermineComponentFrameRoot");)f++;if(c===w.length||f===q.length)for(c=w.length-1,f=q.length-1;1<=c&&0<=f&&w[c]!==q[f];)f--;for(;1<=c&&0<=f;c--,f--)if(w[c]!==q[f]){if(c!==1||f!==1)do if(c--,f--,0>f||w[c]!==q[f]){var G=`
`+w[c].replace(" at new "," at ");return t.displayName&&G.includes("<anonymous>")&&(G=G.replace("<anonymous>",t.displayName)),G}while(1<=c&&0<=f);break}}}finally{Cc=!1,Error.prepareStackTrace=r}return(r=t?t.displayName||t.name:"")?aa(r):""}function xC(t,n){switch(t.tag){case 26:case 27:case 5:return aa(t.type);case 16:return aa("Lazy");case 13:return t.child!==n&&n!==null?aa("Suspense Fallback"):aa("Suspense");case 19:return aa("SuspenseList");case 0:case 15:return Tc(t.type,!1);case 11:return Tc(t.type.render,!1);case 1:return Tc(t.type,!0);case 31:return aa("Activity");default:return""}}function Df(t){try{var n="",r=null;do n+=xC(t,r),r=t,t=t.return;while(t);return n}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var kc=Object.prototype.hasOwnProperty,Ec=a.unstable_scheduleCallback,_c=a.unstable_cancelCallback,RC=a.unstable_shouldYield,MC=a.unstable_requestPaint,Jt=a.unstable_now,AC=a.unstable_getCurrentPriorityLevel,Of=a.unstable_ImmediatePriority,Pf=a.unstable_UserBlockingPriority,so=a.unstable_NormalPriority,NC=a.unstable_LowPriority,jf=a.unstable_IdlePriority,DC=a.log,OC=a.unstable_setDisableYieldValue,Ls=null,Qt=null;function bi(t){if(typeof DC=="function"&&OC(t),Qt&&typeof Qt.setStrictMode=="function")try{Qt.setStrictMode(Ls,t)}catch{}}var Xt=Math.clz32?Math.clz32:IC,PC=Math.log,jC=Math.LN2;function IC(t){return t>>>=0,t===0?32:31-(PC(t)/jC|0)|0}var ro=256,oo=262144,lo=4194304;function sa(t){var n=t&42;if(n!==0)return n;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return t&261888;case 262144:case 524288:case 1048576:case 2097152:return t&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function co(t,n,r){var c=t.pendingLanes;if(c===0)return 0;var f=0,p=t.suspendedLanes,b=t.pingedLanes;t=t.warmLanes;var C=c&134217727;return C!==0?(c=C&~p,c!==0?f=sa(c):(b&=C,b!==0?f=sa(b):r||(r=C&~t,r!==0&&(f=sa(r))))):(C=c&~p,C!==0?f=sa(C):b!==0?f=sa(b):r||(r=c&~t,r!==0&&(f=sa(r)))),f===0?0:n!==0&&n!==f&&(n&p)===0&&(p=f&-f,r=n&-n,p>=r||p===32&&(r&4194048)!==0)?n:f}function Us(t,n){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&n)===0}function LC(t,n){switch(t){case 1:case 2:case 4:case 8:case 64:return n+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function If(){var t=lo;return lo<<=1,(lo&62914560)===0&&(lo=4194304),t}function wc(t){for(var n=[],r=0;31>r;r++)n.push(t);return n}function Bs(t,n){t.pendingLanes|=n,n!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function UC(t,n,r,c,f,p){var b=t.pendingLanes;t.pendingLanes=r,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=r,t.entangledLanes&=r,t.errorRecoveryDisabledLanes&=r,t.shellSuspendCounter=0;var C=t.entanglements,w=t.expirationTimes,q=t.hiddenUpdates;for(r=b&~r;0<r;){var G=31-Xt(r),J=1<<G;C[G]=0,w[G]=-1;var z=q[G];if(z!==null)for(q[G]=null,G=0;G<z.length;G++){var V=z[G];V!==null&&(V.lane&=-536870913)}r&=~J}c!==0&&Lf(t,c,0),p!==0&&f===0&&t.tag!==0&&(t.suspendedLanes|=p&~(b&~n))}function Lf(t,n,r){t.pendingLanes|=n,t.suspendedLanes&=~n;var c=31-Xt(n);t.entangledLanes|=n,t.entanglements[c]=t.entanglements[c]|1073741824|r&261930}function Uf(t,n){var r=t.entangledLanes|=n;for(t=t.entanglements;r;){var c=31-Xt(r),f=1<<c;f&n|t[c]&n&&(t[c]|=n),r&=~f}}function Bf(t,n){var r=n&-n;return r=(r&42)!==0?1:xc(r),(r&(t.suspendedLanes|n))!==0?0:r}function xc(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function Rc(t){return t&=-t,2<t?8<t?(t&134217727)!==0?32:268435456:8:2}function qf(){var t=ne.p;return t!==0?t:(t=window.event,t===void 0?32:_v(t.type))}function zf(t,n){var r=ne.p;try{return ne.p=t,n()}finally{ne.p=r}}var Si=Math.random().toString(36).slice(2),kt="__reactFiber$"+Si,Ut="__reactProps$"+Si,Pa="__reactContainer$"+Si,Mc="__reactEvents$"+Si,BC="__reactListeners$"+Si,qC="__reactHandles$"+Si,Ff="__reactResources$"+Si,qs="__reactMarker$"+Si;function Ac(t){delete t[kt],delete t[Ut],delete t[Mc],delete t[BC],delete t[qC]}function ja(t){var n=t[kt];if(n)return n;for(var r=t.parentNode;r;){if(n=r[Pa]||r[kt]){if(r=n.alternate,n.child!==null||r!==null&&r.child!==null)for(t=cv(t);t!==null;){if(r=t[kt])return r;t=cv(t)}return n}t=r,r=t.parentNode}return null}function Ia(t){if(t=t[kt]||t[Pa]){var n=t.tag;if(n===5||n===6||n===13||n===31||n===26||n===27||n===3)return t}return null}function zs(t){var n=t.tag;if(n===5||n===26||n===27||n===6)return t.stateNode;throw Error(s(33))}function La(t){var n=t[Ff];return n||(n=t[Ff]={hoistableStyles:new Map,hoistableScripts:new Map}),n}function bt(t){t[qs]=!0}var Hf=new Set,Vf={};function ra(t,n){Ua(t,n),Ua(t+"Capture",n)}function Ua(t,n){for(Vf[t]=n,t=0;t<n.length;t++)Hf.add(n[t])}var zC=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Gf={},Kf={};function FC(t){return kc.call(Kf,t)?!0:kc.call(Gf,t)?!1:zC.test(t)?Kf[t]=!0:(Gf[t]=!0,!1)}function uo(t,n,r){if(FC(n))if(r===null)t.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":t.removeAttribute(n);return;case"boolean":var c=n.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){t.removeAttribute(n);return}}t.setAttribute(n,""+r)}}function ho(t,n,r){if(r===null)t.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(n);return}t.setAttribute(n,""+r)}}function Vn(t,n,r,c){if(c===null)t.removeAttribute(r);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(r);return}t.setAttributeNS(n,r,""+c)}}function rn(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Yf(t){var n=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function HC(t,n,r){var c=Object.getOwnPropertyDescriptor(t.constructor.prototype,n);if(!t.hasOwnProperty(n)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var f=c.get,p=c.set;return Object.defineProperty(t,n,{configurable:!0,get:function(){return f.call(this)},set:function(b){r=""+b,p.call(this,b)}}),Object.defineProperty(t,n,{enumerable:c.enumerable}),{getValue:function(){return r},setValue:function(b){r=""+b},stopTracking:function(){t._valueTracker=null,delete t[n]}}}}function Nc(t){if(!t._valueTracker){var n=Yf(t)?"checked":"value";t._valueTracker=HC(t,n,""+t[n])}}function Jf(t){if(!t)return!1;var n=t._valueTracker;if(!n)return!0;var r=n.getValue(),c="";return t&&(c=Yf(t)?t.checked?"true":"false":t.value),t=c,t!==r?(n.setValue(t),!0):!1}function fo(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var VC=/[\n"\\]/g;function on(t){return t.replace(VC,function(n){return"\\"+n.charCodeAt(0).toString(16)+" "})}function Dc(t,n,r,c,f,p,b,C){t.name="",b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"?t.type=b:t.removeAttribute("type"),n!=null?b==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+rn(n)):t.value!==""+rn(n)&&(t.value=""+rn(n)):b!=="submit"&&b!=="reset"||t.removeAttribute("value"),n!=null?Oc(t,b,rn(n)):r!=null?Oc(t,b,rn(r)):c!=null&&t.removeAttribute("value"),f==null&&p!=null&&(t.defaultChecked=!!p),f!=null&&(t.checked=f&&typeof f!="function"&&typeof f!="symbol"),C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"?t.name=""+rn(C):t.removeAttribute("name")}function Qf(t,n,r,c,f,p,b,C){if(p!=null&&typeof p!="function"&&typeof p!="symbol"&&typeof p!="boolean"&&(t.type=p),n!=null||r!=null){if(!(p!=="submit"&&p!=="reset"||n!=null)){Nc(t);return}r=r!=null?""+rn(r):"",n=n!=null?""+rn(n):r,C||n===t.value||(t.value=n),t.defaultValue=n}c=c??f,c=typeof c!="function"&&typeof c!="symbol"&&!!c,t.checked=C?t.checked:!!c,t.defaultChecked=!!c,b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(t.name=b),Nc(t)}function Oc(t,n,r){n==="number"&&fo(t.ownerDocument)===t||t.defaultValue===""+r||(t.defaultValue=""+r)}function Ba(t,n,r,c){if(t=t.options,n){n={};for(var f=0;f<r.length;f++)n["$"+r[f]]=!0;for(r=0;r<t.length;r++)f=n.hasOwnProperty("$"+t[r].value),t[r].selected!==f&&(t[r].selected=f),f&&c&&(t[r].defaultSelected=!0)}else{for(r=""+rn(r),n=null,f=0;f<t.length;f++){if(t[f].value===r){t[f].selected=!0,c&&(t[f].defaultSelected=!0);return}n!==null||t[f].disabled||(n=t[f])}n!==null&&(n.selected=!0)}}function Xf(t,n,r){if(n!=null&&(n=""+rn(n),n!==t.value&&(t.value=n),r==null)){t.defaultValue!==n&&(t.defaultValue=n);return}t.defaultValue=r!=null?""+rn(r):""}function Wf(t,n,r,c){if(n==null){if(c!=null){if(r!=null)throw Error(s(92));if(Fe(c)){if(1<c.length)throw Error(s(93));c=c[0]}r=c}r==null&&(r=""),n=r}r=rn(n),t.defaultValue=r,c=t.textContent,c===r&&c!==""&&c!==null&&(t.value=c),Nc(t)}function qa(t,n){if(n){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=n;return}}t.textContent=n}var GC=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Zf(t,n,r){var c=n.indexOf("--")===0;r==null||typeof r=="boolean"||r===""?c?t.setProperty(n,""):n==="float"?t.cssFloat="":t[n]="":c?t.setProperty(n,r):typeof r!="number"||r===0||GC.has(n)?n==="float"?t.cssFloat=r:t[n]=(""+r).trim():t[n]=r+"px"}function $f(t,n,r){if(n!=null&&typeof n!="object")throw Error(s(62));if(t=t.style,r!=null){for(var c in r)!r.hasOwnProperty(c)||n!=null&&n.hasOwnProperty(c)||(c.indexOf("--")===0?t.setProperty(c,""):c==="float"?t.cssFloat="":t[c]="");for(var f in n)c=n[f],n.hasOwnProperty(f)&&r[f]!==c&&Zf(t,f,c)}else for(var p in n)n.hasOwnProperty(p)&&Zf(t,p,n[p])}function Pc(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var KC=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),YC=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function mo(t){return YC.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}function Gn(){}var jc=null;function Ic(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var za=null,Fa=null;function em(t){var n=Ia(t);if(n&&(t=n.stateNode)){var r=t[Ut]||null;e:switch(t=n.stateNode,n.type){case"input":if(Dc(t,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name),n=r.name,r.type==="radio"&&n!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll('input[name="'+on(""+n)+'"][type="radio"]'),n=0;n<r.length;n++){var c=r[n];if(c!==t&&c.form===t.form){var f=c[Ut]||null;if(!f)throw Error(s(90));Dc(c,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(n=0;n<r.length;n++)c=r[n],c.form===t.form&&Jf(c)}break e;case"textarea":Xf(t,r.value,r.defaultValue);break e;case"select":n=r.value,n!=null&&Ba(t,!!r.multiple,n,!1)}}}var Lc=!1;function tm(t,n,r){if(Lc)return t(n,r);Lc=!0;try{var c=t(n);return c}finally{if(Lc=!1,(za!==null||Fa!==null)&&(tl(),za&&(n=za,t=Fa,Fa=za=null,em(n),t)))for(n=0;n<t.length;n++)em(t[n])}}function Fs(t,n){var r=t.stateNode;if(r===null)return null;var c=r[Ut]||null;if(c===null)return null;r=c[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(t=t.type,c=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!c;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(s(231,n,typeof r));return r}var Kn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Uc=!1;if(Kn)try{var Hs={};Object.defineProperty(Hs,"passive",{get:function(){Uc=!0}}),window.addEventListener("test",Hs,Hs),window.removeEventListener("test",Hs,Hs)}catch{Uc=!1}var Ci=null,Bc=null,po=null;function nm(){if(po)return po;var t,n=Bc,r=n.length,c,f="value"in Ci?Ci.value:Ci.textContent,p=f.length;for(t=0;t<r&&n[t]===f[t];t++);var b=r-t;for(c=1;c<=b&&n[r-c]===f[p-c];c++);return po=f.slice(t,1<c?1-c:void 0)}function go(t){var n=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&n===13&&(t=13)):t=n,t===10&&(t=13),32<=t||t===13?t:0}function vo(){return!0}function im(){return!1}function Bt(t){function n(r,c,f,p,b){this._reactName=r,this._targetInst=f,this.type=c,this.nativeEvent=p,this.target=b,this.currentTarget=null;for(var C in t)t.hasOwnProperty(C)&&(r=t[C],this[C]=r?r(p):p[C]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?vo:im,this.isPropagationStopped=im,this}return y(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=vo)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=vo)},persist:function(){},isPersistent:vo}),n}var oa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},yo=Bt(oa),Vs=y({},oa,{view:0,detail:0}),JC=Bt(Vs),qc,zc,Gs,bo=y({},Vs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Hc,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Gs&&(Gs&&t.type==="mousemove"?(qc=t.screenX-Gs.screenX,zc=t.screenY-Gs.screenY):zc=qc=0,Gs=t),qc)},movementY:function(t){return"movementY"in t?t.movementY:zc}}),am=Bt(bo),QC=y({},bo,{dataTransfer:0}),XC=Bt(QC),WC=y({},Vs,{relatedTarget:0}),Fc=Bt(WC),ZC=y({},oa,{animationName:0,elapsedTime:0,pseudoElement:0}),$C=Bt(ZC),eT=y({},oa,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),tT=Bt(eT),nT=y({},oa,{data:0}),sm=Bt(nT),iT={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},aT={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},sT={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function rT(t){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(t):(t=sT[t])?!!n[t]:!1}function Hc(){return rT}var oT=y({},Vs,{key:function(t){if(t.key){var n=iT[t.key]||t.key;if(n!=="Unidentified")return n}return t.type==="keypress"?(t=go(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?aT[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Hc,charCode:function(t){return t.type==="keypress"?go(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?go(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),lT=Bt(oT),cT=y({},bo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),rm=Bt(cT),uT=y({},Vs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Hc}),dT=Bt(uT),hT=y({},oa,{propertyName:0,elapsedTime:0,pseudoElement:0}),fT=Bt(hT),mT=y({},bo,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),pT=Bt(mT),gT=y({},oa,{newState:0,oldState:0}),vT=Bt(gT),yT=[9,13,27,32],Vc=Kn&&"CompositionEvent"in window,Ks=null;Kn&&"documentMode"in document&&(Ks=document.documentMode);var bT=Kn&&"TextEvent"in window&&!Ks,om=Kn&&(!Vc||Ks&&8<Ks&&11>=Ks),lm=" ",cm=!1;function um(t,n){switch(t){case"keyup":return yT.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function dm(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ha=!1;function ST(t,n){switch(t){case"compositionend":return dm(n);case"keypress":return n.which!==32?null:(cm=!0,lm);case"textInput":return t=n.data,t===lm&&cm?null:t;default:return null}}function CT(t,n){if(Ha)return t==="compositionend"||!Vc&&um(t,n)?(t=nm(),po=Bc=Ci=null,Ha=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return om&&n.locale!=="ko"?null:n.data;default:return null}}var TT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function hm(t){var n=t&&t.nodeName&&t.nodeName.toLowerCase();return n==="input"?!!TT[t.type]:n==="textarea"}function fm(t,n,r,c){za?Fa?Fa.push(c):Fa=[c]:za=c,n=ll(n,"onChange"),0<n.length&&(r=new yo("onChange","change",null,r,c),t.push({event:r,listeners:n}))}var Ys=null,Js=null;function kT(t){Qg(t,0)}function So(t){var n=zs(t);if(Jf(n))return t}function mm(t,n){if(t==="change")return n}var pm=!1;if(Kn){var Gc;if(Kn){var Kc="oninput"in document;if(!Kc){var gm=document.createElement("div");gm.setAttribute("oninput","return;"),Kc=typeof gm.oninput=="function"}Gc=Kc}else Gc=!1;pm=Gc&&(!document.documentMode||9<document.documentMode)}function vm(){Ys&&(Ys.detachEvent("onpropertychange",ym),Js=Ys=null)}function ym(t){if(t.propertyName==="value"&&So(Js)){var n=[];fm(n,Js,t,Ic(t)),tm(kT,n)}}function ET(t,n,r){t==="focusin"?(vm(),Ys=n,Js=r,Ys.attachEvent("onpropertychange",ym)):t==="focusout"&&vm()}function _T(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return So(Js)}function wT(t,n){if(t==="click")return So(n)}function xT(t,n){if(t==="input"||t==="change")return So(n)}function RT(t,n){return t===n&&(t!==0||1/t===1/n)||t!==t&&n!==n}var Wt=typeof Object.is=="function"?Object.is:RT;function Qs(t,n){if(Wt(t,n))return!0;if(typeof t!="object"||t===null||typeof n!="object"||n===null)return!1;var r=Object.keys(t),c=Object.keys(n);if(r.length!==c.length)return!1;for(c=0;c<r.length;c++){var f=r[c];if(!kc.call(n,f)||!Wt(t[f],n[f]))return!1}return!0}function bm(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Sm(t,n){var r=bm(t);t=0;for(var c;r;){if(r.nodeType===3){if(c=t+r.textContent.length,t<=n&&c>=n)return{node:r,offset:n-t};t=c}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=bm(r)}}function Cm(t,n){return t&&n?t===n?!0:t&&t.nodeType===3?!1:n&&n.nodeType===3?Cm(t,n.parentNode):"contains"in t?t.contains(n):t.compareDocumentPosition?!!(t.compareDocumentPosition(n)&16):!1:!1}function Tm(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var n=fo(t.document);n instanceof t.HTMLIFrameElement;){try{var r=typeof n.contentWindow.location.href=="string"}catch{r=!1}if(r)t=n.contentWindow;else break;n=fo(t.document)}return n}function Yc(t){var n=t&&t.nodeName&&t.nodeName.toLowerCase();return n&&(n==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||n==="textarea"||t.contentEditable==="true")}var MT=Kn&&"documentMode"in document&&11>=document.documentMode,Va=null,Jc=null,Xs=null,Qc=!1;function km(t,n,r){var c=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Qc||Va==null||Va!==fo(c)||(c=Va,"selectionStart"in c&&Yc(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Xs&&Qs(Xs,c)||(Xs=c,c=ll(Jc,"onSelect"),0<c.length&&(n=new yo("onSelect","select",null,n,r),t.push({event:n,listeners:c}),n.target=Va)))}function la(t,n){var r={};return r[t.toLowerCase()]=n.toLowerCase(),r["Webkit"+t]="webkit"+n,r["Moz"+t]="moz"+n,r}var Ga={animationend:la("Animation","AnimationEnd"),animationiteration:la("Animation","AnimationIteration"),animationstart:la("Animation","AnimationStart"),transitionrun:la("Transition","TransitionRun"),transitionstart:la("Transition","TransitionStart"),transitioncancel:la("Transition","TransitionCancel"),transitionend:la("Transition","TransitionEnd")},Xc={},Em={};Kn&&(Em=document.createElement("div").style,"AnimationEvent"in window||(delete Ga.animationend.animation,delete Ga.animationiteration.animation,delete Ga.animationstart.animation),"TransitionEvent"in window||delete Ga.transitionend.transition);function ca(t){if(Xc[t])return Xc[t];if(!Ga[t])return t;var n=Ga[t],r;for(r in n)if(n.hasOwnProperty(r)&&r in Em)return Xc[t]=n[r];return t}var _m=ca("animationend"),wm=ca("animationiteration"),xm=ca("animationstart"),AT=ca("transitionrun"),NT=ca("transitionstart"),DT=ca("transitioncancel"),Rm=ca("transitionend"),Mm=new Map,Wc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Wc.push("scrollEnd");function Cn(t,n){Mm.set(t,n),ra(n,[t])}var Co=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var n=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(n))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)},ln=[],Ka=0,Zc=0;function To(){for(var t=Ka,n=Zc=Ka=0;n<t;){var r=ln[n];ln[n++]=null;var c=ln[n];ln[n++]=null;var f=ln[n];ln[n++]=null;var p=ln[n];if(ln[n++]=null,c!==null&&f!==null){var b=c.pending;b===null?f.next=f:(f.next=b.next,b.next=f),c.pending=f}p!==0&&Am(r,f,p)}}function ko(t,n,r,c){ln[Ka++]=t,ln[Ka++]=n,ln[Ka++]=r,ln[Ka++]=c,Zc|=c,t.lanes|=c,t=t.alternate,t!==null&&(t.lanes|=c)}function $c(t,n,r,c){return ko(t,n,r,c),Eo(t)}function ua(t,n){return ko(t,null,null,n),Eo(t)}function Am(t,n,r){t.lanes|=r;var c=t.alternate;c!==null&&(c.lanes|=r);for(var f=!1,p=t.return;p!==null;)p.childLanes|=r,c=p.alternate,c!==null&&(c.childLanes|=r),p.tag===22&&(t=p.stateNode,t===null||t._visibility&1||(f=!0)),t=p,p=p.return;return t.tag===3?(p=t.stateNode,f&&n!==null&&(f=31-Xt(r),t=p.hiddenUpdates,c=t[f],c===null?t[f]=[n]:c.push(n),n.lane=r|536870912),p):null}function Eo(t){if(50<yr)throw yr=0,ld=null,Error(s(185));for(var n=t.return;n!==null;)t=n,n=t.return;return t.tag===3?t.stateNode:null}var Ya={};function OT(t,n,r,c){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Zt(t,n,r,c){return new OT(t,n,r,c)}function eu(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Yn(t,n){var r=t.alternate;return r===null?(r=Zt(t.tag,n,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=n,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&65011712,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,n=t.dependencies,r.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r.refCleanup=t.refCleanup,r}function Nm(t,n){t.flags&=65011714;var r=t.alternate;return r===null?(t.childLanes=0,t.lanes=n,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=r.childLanes,t.lanes=r.lanes,t.child=r.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=r.memoizedProps,t.memoizedState=r.memoizedState,t.updateQueue=r.updateQueue,t.type=r.type,n=r.dependencies,t.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t}function _o(t,n,r,c,f,p){var b=0;if(c=t,typeof t=="function")eu(t)&&(b=1);else if(typeof t=="string")b=Uk(t,r,le.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case ee:return t=Zt(31,r,n,f),t.elementType=ee,t.lanes=p,t;case E:return da(r.children,f,p,n);case k:b=8,f|=24;break;case R:return t=Zt(12,r,n,f|2),t.elementType=R,t.lanes=p,t;case I:return t=Zt(13,r,n,f),t.elementType=I,t.lanes=p,t;case P:return t=Zt(19,r,n,f),t.elementType=P,t.lanes=p,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case L:b=10;break e;case O:b=9;break e;case D:b=11;break e;case H:b=14;break e;case Z:b=16,c=null;break e}b=29,r=Error(s(130,t===null?"null":typeof t,"")),c=null}return n=Zt(b,r,n,f),n.elementType=t,n.type=c,n.lanes=p,n}function da(t,n,r,c){return t=Zt(7,t,c,n),t.lanes=r,t}function tu(t,n,r){return t=Zt(6,t,null,n),t.lanes=r,t}function Dm(t){var n=Zt(18,null,null,0);return n.stateNode=t,n}function nu(t,n,r){return n=Zt(4,t.children!==null?t.children:[],t.key,n),n.lanes=r,n.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},n}var Om=new WeakMap;function cn(t,n){if(typeof t=="object"&&t!==null){var r=Om.get(t);return r!==void 0?r:(n={value:t,source:n,stack:Df(n)},Om.set(t,n),n)}return{value:t,source:n,stack:Df(n)}}var Ja=[],Qa=0,wo=null,Ws=0,un=[],dn=0,Ti=null,Dn=1,On="";function Jn(t,n){Ja[Qa++]=Ws,Ja[Qa++]=wo,wo=t,Ws=n}function Pm(t,n,r){un[dn++]=Dn,un[dn++]=On,un[dn++]=Ti,Ti=t;var c=Dn;t=On;var f=32-Xt(c)-1;c&=~(1<<f),r+=1;var p=32-Xt(n)+f;if(30<p){var b=f-f%5;p=(c&(1<<b)-1).toString(32),c>>=b,f-=b,Dn=1<<32-Xt(n)+f|r<<f|c,On=p+t}else Dn=1<<p|r<<f|c,On=t}function iu(t){t.return!==null&&(Jn(t,1),Pm(t,1,0))}function au(t){for(;t===wo;)wo=Ja[--Qa],Ja[Qa]=null,Ws=Ja[--Qa],Ja[Qa]=null;for(;t===Ti;)Ti=un[--dn],un[dn]=null,On=un[--dn],un[dn]=null,Dn=un[--dn],un[dn]=null}function jm(t,n){un[dn++]=Dn,un[dn++]=On,un[dn++]=Ti,Dn=n.id,On=n.overflow,Ti=t}var Et=null,We=null,Re=!1,ki=null,hn=!1,su=Error(s(519));function Ei(t){var n=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Zs(cn(n,t)),su}function Im(t){var n=t.stateNode,r=t.type,c=t.memoizedProps;switch(n[kt]=t,n[Ut]=c,r){case"dialog":ke("cancel",n),ke("close",n);break;case"iframe":case"object":case"embed":ke("load",n);break;case"video":case"audio":for(r=0;r<Sr.length;r++)ke(Sr[r],n);break;case"source":ke("error",n);break;case"img":case"image":case"link":ke("error",n),ke("load",n);break;case"details":ke("toggle",n);break;case"input":ke("invalid",n),Qf(n,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":ke("invalid",n);break;case"textarea":ke("invalid",n),Wf(n,c.value,c.defaultValue,c.children)}r=c.children,typeof r!="string"&&typeof r!="number"&&typeof r!="bigint"||n.textContent===""+r||c.suppressHydrationWarning===!0||$g(n.textContent,r)?(c.popover!=null&&(ke("beforetoggle",n),ke("toggle",n)),c.onScroll!=null&&ke("scroll",n),c.onScrollEnd!=null&&ke("scrollend",n),c.onClick!=null&&(n.onclick=Gn),n=!0):n=!1,n||Ei(t,!0)}function Lm(t){for(Et=t.return;Et;)switch(Et.tag){case 5:case 31:case 13:hn=!1;return;case 27:case 3:hn=!0;return;default:Et=Et.return}}function Xa(t){if(t!==Et)return!1;if(!Re)return Lm(t),Re=!0,!1;var n=t.tag,r;if((r=n!==3&&n!==27)&&((r=n===5)&&(r=t.type,r=!(r!=="form"&&r!=="button")||kd(t.type,t.memoizedProps)),r=!r),r&&We&&Ei(t),Lm(t),n===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(s(317));We=lv(t)}else if(n===31){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(s(317));We=lv(t)}else n===27?(n=We,Ui(t.type)?(t=Rd,Rd=null,We=t):We=n):We=Et?mn(t.stateNode.nextSibling):null;return!0}function ha(){We=Et=null,Re=!1}function ru(){var t=ki;return t!==null&&(Ht===null?Ht=t:Ht.push.apply(Ht,t),ki=null),t}function Zs(t){ki===null?ki=[t]:ki.push(t)}var ou=A(null),fa=null,Qn=null;function _i(t,n,r){se(ou,n._currentValue),n._currentValue=r}function Xn(t){t._currentValue=ou.current,Y(ou)}function lu(t,n,r){for(;t!==null;){var c=t.alternate;if((t.childLanes&n)!==n?(t.childLanes|=n,c!==null&&(c.childLanes|=n)):c!==null&&(c.childLanes&n)!==n&&(c.childLanes|=n),t===r)break;t=t.return}}function cu(t,n,r,c){var f=t.child;for(f!==null&&(f.return=t);f!==null;){var p=f.dependencies;if(p!==null){var b=f.child;p=p.firstContext;e:for(;p!==null;){var C=p;p=f;for(var w=0;w<n.length;w++)if(C.context===n[w]){p.lanes|=r,C=p.alternate,C!==null&&(C.lanes|=r),lu(p.return,r,t),c||(b=null);break e}p=C.next}}else if(f.tag===18){if(b=f.return,b===null)throw Error(s(341));b.lanes|=r,p=b.alternate,p!==null&&(p.lanes|=r),lu(b,r,t),b=null}else b=f.child;if(b!==null)b.return=f;else for(b=f;b!==null;){if(b===t){b=null;break}if(f=b.sibling,f!==null){f.return=b.return,b=f;break}b=b.return}f=b}}function Wa(t,n,r,c){t=null;for(var f=n,p=!1;f!==null;){if(!p){if((f.flags&524288)!==0)p=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var b=f.alternate;if(b===null)throw Error(s(387));if(b=b.memoizedProps,b!==null){var C=f.type;Wt(f.pendingProps.value,b.value)||(t!==null?t.push(C):t=[C])}}else if(f===Be.current){if(b=f.alternate,b===null)throw Error(s(387));b.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(t!==null?t.push(_r):t=[_r])}f=f.return}t!==null&&cu(n,t,r,c),n.flags|=262144}function xo(t){for(t=t.firstContext;t!==null;){if(!Wt(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function ma(t){fa=t,Qn=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function _t(t){return Um(fa,t)}function Ro(t,n){return fa===null&&ma(t),Um(t,n)}function Um(t,n){var r=n._currentValue;if(n={context:n,memoizedValue:r,next:null},Qn===null){if(t===null)throw Error(s(308));Qn=n,t.dependencies={lanes:0,firstContext:n},t.flags|=524288}else Qn=Qn.next=n;return r}var PT=typeof AbortController<"u"?AbortController:function(){var t=[],n=this.signal={aborted:!1,addEventListener:function(r,c){t.push(c)}};this.abort=function(){n.aborted=!0,t.forEach(function(r){return r()})}},jT=a.unstable_scheduleCallback,IT=a.unstable_NormalPriority,ft={$$typeof:L,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function uu(){return{controller:new PT,data:new Map,refCount:0}}function $s(t){t.refCount--,t.refCount===0&&jT(IT,function(){t.controller.abort()})}var er=null,du=0,Za=0,$a=null;function LT(t,n){if(er===null){var r=er=[];du=0,Za=md(),$a={status:"pending",value:void 0,then:function(c){r.push(c)}}}return du++,n.then(Bm,Bm),n}function Bm(){if(--du===0&&er!==null){$a!==null&&($a.status="fulfilled");var t=er;er=null,Za=0,$a=null;for(var n=0;n<t.length;n++)(0,t[n])()}}function UT(t,n){var r=[],c={status:"pending",value:null,reason:null,then:function(f){r.push(f)}};return t.then(function(){c.status="fulfilled",c.value=n;for(var f=0;f<r.length;f++)(0,r[f])(n)},function(f){for(c.status="rejected",c.reason=f,f=0;f<r.length;f++)(0,r[f])(void 0)}),c}var qm=F.S;F.S=function(t,n){kg=Jt(),typeof n=="object"&&n!==null&&typeof n.then=="function"&&LT(t,n),qm!==null&&qm(t,n)};var pa=A(null);function hu(){var t=pa.current;return t!==null?t:Ye.pooledCache}function Mo(t,n){n===null?se(pa,pa.current):se(pa,n.pool)}function zm(){var t=hu();return t===null?null:{parent:ft._currentValue,pool:t}}var es=Error(s(460)),fu=Error(s(474)),Ao=Error(s(542)),No={then:function(){}};function Fm(t){return t=t.status,t==="fulfilled"||t==="rejected"}function Hm(t,n,r){switch(r=t[r],r===void 0?t.push(n):r!==n&&(n.then(Gn,Gn),n=r),n.status){case"fulfilled":return n.value;case"rejected":throw t=n.reason,Gm(t),t;default:if(typeof n.status=="string")n.then(Gn,Gn);else{if(t=Ye,t!==null&&100<t.shellSuspendCounter)throw Error(s(482));t=n,t.status="pending",t.then(function(c){if(n.status==="pending"){var f=n;f.status="fulfilled",f.value=c}},function(c){if(n.status==="pending"){var f=n;f.status="rejected",f.reason=c}})}switch(n.status){case"fulfilled":return n.value;case"rejected":throw t=n.reason,Gm(t),t}throw va=n,es}}function ga(t){try{var n=t._init;return n(t._payload)}catch(r){throw r!==null&&typeof r=="object"&&typeof r.then=="function"?(va=r,es):r}}var va=null;function Vm(){if(va===null)throw Error(s(459));var t=va;return va=null,t}function Gm(t){if(t===es||t===Ao)throw Error(s(483))}var ts=null,tr=0;function Do(t){var n=tr;return tr+=1,ts===null&&(ts=[]),Hm(ts,t,n)}function nr(t,n){n=n.props.ref,t.ref=n!==void 0?n:null}function Oo(t,n){throw n.$$typeof===S?Error(s(525)):(t=Object.prototype.toString.call(n),Error(s(31,t==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":t)))}function Km(t){function n(j,M){if(t){var B=j.deletions;B===null?(j.deletions=[M],j.flags|=16):B.push(M)}}function r(j,M){if(!t)return null;for(;M!==null;)n(j,M),M=M.sibling;return null}function c(j){for(var M=new Map;j!==null;)j.key!==null?M.set(j.key,j):M.set(j.index,j),j=j.sibling;return M}function f(j,M){return j=Yn(j,M),j.index=0,j.sibling=null,j}function p(j,M,B){return j.index=B,t?(B=j.alternate,B!==null?(B=B.index,B<M?(j.flags|=67108866,M):B):(j.flags|=67108866,M)):(j.flags|=1048576,M)}function b(j){return t&&j.alternate===null&&(j.flags|=67108866),j}function C(j,M,B,K){return M===null||M.tag!==6?(M=tu(B,j.mode,K),M.return=j,M):(M=f(M,B),M.return=j,M)}function w(j,M,B,K){var de=B.type;return de===E?G(j,M,B.props.children,K,B.key):M!==null&&(M.elementType===de||typeof de=="object"&&de!==null&&de.$$typeof===Z&&ga(de)===M.type)?(M=f(M,B.props),nr(M,B),M.return=j,M):(M=_o(B.type,B.key,B.props,null,j.mode,K),nr(M,B),M.return=j,M)}function q(j,M,B,K){return M===null||M.tag!==4||M.stateNode.containerInfo!==B.containerInfo||M.stateNode.implementation!==B.implementation?(M=nu(B,j.mode,K),M.return=j,M):(M=f(M,B.children||[]),M.return=j,M)}function G(j,M,B,K,de){return M===null||M.tag!==7?(M=da(B,j.mode,K,de),M.return=j,M):(M=f(M,B),M.return=j,M)}function J(j,M,B){if(typeof M=="string"&&M!==""||typeof M=="number"||typeof M=="bigint")return M=tu(""+M,j.mode,B),M.return=j,M;if(typeof M=="object"&&M!==null){switch(M.$$typeof){case T:return B=_o(M.type,M.key,M.props,null,j.mode,B),nr(B,M),B.return=j,B;case x:return M=nu(M,j.mode,B),M.return=j,M;case Z:return M=ga(M),J(j,M,B)}if(Fe(M)||ue(M))return M=da(M,j.mode,B,null),M.return=j,M;if(typeof M.then=="function")return J(j,Do(M),B);if(M.$$typeof===L)return J(j,Ro(j,M),B);Oo(j,M)}return null}function z(j,M,B,K){var de=M!==null?M.key:null;if(typeof B=="string"&&B!==""||typeof B=="number"||typeof B=="bigint")return de!==null?null:C(j,M,""+B,K);if(typeof B=="object"&&B!==null){switch(B.$$typeof){case T:return B.key===de?w(j,M,B,K):null;case x:return B.key===de?q(j,M,B,K):null;case Z:return B=ga(B),z(j,M,B,K)}if(Fe(B)||ue(B))return de!==null?null:G(j,M,B,K,null);if(typeof B.then=="function")return z(j,M,Do(B),K);if(B.$$typeof===L)return z(j,M,Ro(j,B),K);Oo(j,B)}return null}function V(j,M,B,K,de){if(typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint")return j=j.get(B)||null,C(M,j,""+K,de);if(typeof K=="object"&&K!==null){switch(K.$$typeof){case T:return j=j.get(K.key===null?B:K.key)||null,w(M,j,K,de);case x:return j=j.get(K.key===null?B:K.key)||null,q(M,j,K,de);case Z:return K=ga(K),V(j,M,B,K,de)}if(Fe(K)||ue(K))return j=j.get(B)||null,G(M,j,K,de,null);if(typeof K.then=="function")return V(j,M,B,Do(K),de);if(K.$$typeof===L)return V(j,M,B,Ro(M,K),de);Oo(M,K)}return null}function oe(j,M,B,K){for(var de=null,Pe=null,ce=M,be=M=0,xe=null;ce!==null&&be<B.length;be++){ce.index>be?(xe=ce,ce=null):xe=ce.sibling;var je=z(j,ce,B[be],K);if(je===null){ce===null&&(ce=xe);break}t&&ce&&je.alternate===null&&n(j,ce),M=p(je,M,be),Pe===null?de=je:Pe.sibling=je,Pe=je,ce=xe}if(be===B.length)return r(j,ce),Re&&Jn(j,be),de;if(ce===null){for(;be<B.length;be++)ce=J(j,B[be],K),ce!==null&&(M=p(ce,M,be),Pe===null?de=ce:Pe.sibling=ce,Pe=ce);return Re&&Jn(j,be),de}for(ce=c(ce);be<B.length;be++)xe=V(ce,j,be,B[be],K),xe!==null&&(t&&xe.alternate!==null&&ce.delete(xe.key===null?be:xe.key),M=p(xe,M,be),Pe===null?de=xe:Pe.sibling=xe,Pe=xe);return t&&ce.forEach(function(Hi){return n(j,Hi)}),Re&&Jn(j,be),de}function fe(j,M,B,K){if(B==null)throw Error(s(151));for(var de=null,Pe=null,ce=M,be=M=0,xe=null,je=B.next();ce!==null&&!je.done;be++,je=B.next()){ce.index>be?(xe=ce,ce=null):xe=ce.sibling;var Hi=z(j,ce,je.value,K);if(Hi===null){ce===null&&(ce=xe);break}t&&ce&&Hi.alternate===null&&n(j,ce),M=p(Hi,M,be),Pe===null?de=Hi:Pe.sibling=Hi,Pe=Hi,ce=xe}if(je.done)return r(j,ce),Re&&Jn(j,be),de;if(ce===null){for(;!je.done;be++,je=B.next())je=J(j,je.value,K),je!==null&&(M=p(je,M,be),Pe===null?de=je:Pe.sibling=je,Pe=je);return Re&&Jn(j,be),de}for(ce=c(ce);!je.done;be++,je=B.next())je=V(ce,j,be,je.value,K),je!==null&&(t&&je.alternate!==null&&ce.delete(je.key===null?be:je.key),M=p(je,M,be),Pe===null?de=je:Pe.sibling=je,Pe=je);return t&&ce.forEach(function(Qk){return n(j,Qk)}),Re&&Jn(j,be),de}function Ge(j,M,B,K){if(typeof B=="object"&&B!==null&&B.type===E&&B.key===null&&(B=B.props.children),typeof B=="object"&&B!==null){switch(B.$$typeof){case T:e:{for(var de=B.key;M!==null;){if(M.key===de){if(de=B.type,de===E){if(M.tag===7){r(j,M.sibling),K=f(M,B.props.children),K.return=j,j=K;break e}}else if(M.elementType===de||typeof de=="object"&&de!==null&&de.$$typeof===Z&&ga(de)===M.type){r(j,M.sibling),K=f(M,B.props),nr(K,B),K.return=j,j=K;break e}r(j,M);break}else n(j,M);M=M.sibling}B.type===E?(K=da(B.props.children,j.mode,K,B.key),K.return=j,j=K):(K=_o(B.type,B.key,B.props,null,j.mode,K),nr(K,B),K.return=j,j=K)}return b(j);case x:e:{for(de=B.key;M!==null;){if(M.key===de)if(M.tag===4&&M.stateNode.containerInfo===B.containerInfo&&M.stateNode.implementation===B.implementation){r(j,M.sibling),K=f(M,B.children||[]),K.return=j,j=K;break e}else{r(j,M);break}else n(j,M);M=M.sibling}K=nu(B,j.mode,K),K.return=j,j=K}return b(j);case Z:return B=ga(B),Ge(j,M,B,K)}if(Fe(B))return oe(j,M,B,K);if(ue(B)){if(de=ue(B),typeof de!="function")throw Error(s(150));return B=de.call(B),fe(j,M,B,K)}if(typeof B.then=="function")return Ge(j,M,Do(B),K);if(B.$$typeof===L)return Ge(j,M,Ro(j,B),K);Oo(j,B)}return typeof B=="string"&&B!==""||typeof B=="number"||typeof B=="bigint"?(B=""+B,M!==null&&M.tag===6?(r(j,M.sibling),K=f(M,B),K.return=j,j=K):(r(j,M),K=tu(B,j.mode,K),K.return=j,j=K),b(j)):r(j,M)}return function(j,M,B,K){try{tr=0;var de=Ge(j,M,B,K);return ts=null,de}catch(ce){if(ce===es||ce===Ao)throw ce;var Pe=Zt(29,ce,null,j.mode);return Pe.lanes=K,Pe.return=j,Pe}}}var ya=Km(!0),Ym=Km(!1),wi=!1;function mu(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function pu(t,n){t=t.updateQueue,n.updateQueue===t&&(n.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function xi(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function Ri(t,n,r){var c=t.updateQueue;if(c===null)return null;if(c=c.shared,(Ue&2)!==0){var f=c.pending;return f===null?n.next=n:(n.next=f.next,f.next=n),c.pending=n,n=Eo(t),Am(t,null,r),n}return ko(t,c,n,r),Eo(t)}function ir(t,n,r){if(n=n.updateQueue,n!==null&&(n=n.shared,(r&4194048)!==0)){var c=n.lanes;c&=t.pendingLanes,r|=c,n.lanes=r,Uf(t,r)}}function gu(t,n){var r=t.updateQueue,c=t.alternate;if(c!==null&&(c=c.updateQueue,r===c)){var f=null,p=null;if(r=r.firstBaseUpdate,r!==null){do{var b={lane:r.lane,tag:r.tag,payload:r.payload,callback:null,next:null};p===null?f=p=b:p=p.next=b,r=r.next}while(r!==null);p===null?f=p=n:p=p.next=n}else f=p=n;r={baseState:c.baseState,firstBaseUpdate:f,lastBaseUpdate:p,shared:c.shared,callbacks:c.callbacks},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=n:t.next=n,r.lastBaseUpdate=n}var vu=!1;function ar(){if(vu){var t=$a;if(t!==null)throw t}}function sr(t,n,r,c){vu=!1;var f=t.updateQueue;wi=!1;var p=f.firstBaseUpdate,b=f.lastBaseUpdate,C=f.shared.pending;if(C!==null){f.shared.pending=null;var w=C,q=w.next;w.next=null,b===null?p=q:b.next=q,b=w;var G=t.alternate;G!==null&&(G=G.updateQueue,C=G.lastBaseUpdate,C!==b&&(C===null?G.firstBaseUpdate=q:C.next=q,G.lastBaseUpdate=w))}if(p!==null){var J=f.baseState;b=0,G=q=w=null,C=p;do{var z=C.lane&-536870913,V=z!==C.lane;if(V?(we&z)===z:(c&z)===z){z!==0&&z===Za&&(vu=!0),G!==null&&(G=G.next={lane:0,tag:C.tag,payload:C.payload,callback:null,next:null});e:{var oe=t,fe=C;z=n;var Ge=r;switch(fe.tag){case 1:if(oe=fe.payload,typeof oe=="function"){J=oe.call(Ge,J,z);break e}J=oe;break e;case 3:oe.flags=oe.flags&-65537|128;case 0:if(oe=fe.payload,z=typeof oe=="function"?oe.call(Ge,J,z):oe,z==null)break e;J=y({},J,z);break e;case 2:wi=!0}}z=C.callback,z!==null&&(t.flags|=64,V&&(t.flags|=8192),V=f.callbacks,V===null?f.callbacks=[z]:V.push(z))}else V={lane:z,tag:C.tag,payload:C.payload,callback:C.callback,next:null},G===null?(q=G=V,w=J):G=G.next=V,b|=z;if(C=C.next,C===null){if(C=f.shared.pending,C===null)break;V=C,C=V.next,V.next=null,f.lastBaseUpdate=V,f.shared.pending=null}}while(!0);G===null&&(w=J),f.baseState=w,f.firstBaseUpdate=q,f.lastBaseUpdate=G,p===null&&(f.shared.lanes=0),Oi|=b,t.lanes=b,t.memoizedState=J}}function Jm(t,n){if(typeof t!="function")throw Error(s(191,t));t.call(n)}function Qm(t,n){var r=t.callbacks;if(r!==null)for(t.callbacks=null,t=0;t<r.length;t++)Jm(r[t],n)}var ns=A(null),Po=A(0);function Xm(t,n){t=si,se(Po,t),se(ns,n),si=t|n.baseLanes}function yu(){se(Po,si),se(ns,ns.current)}function bu(){si=Po.current,Y(ns),Y(Po)}var $t=A(null),fn=null;function Mi(t){var n=t.alternate;se(lt,lt.current&1),se($t,t),fn===null&&(n===null||ns.current!==null||n.memoizedState!==null)&&(fn=t)}function Su(t){se(lt,lt.current),se($t,t),fn===null&&(fn=t)}function Wm(t){t.tag===22?(se(lt,lt.current),se($t,t),fn===null&&(fn=t)):Ai()}function Ai(){se(lt,lt.current),se($t,$t.current)}function en(t){Y($t),fn===t&&(fn=null),Y(lt)}var lt=A(0);function jo(t){for(var n=t;n!==null;){if(n.tag===13){var r=n.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||wd(r)||xd(r)))return n}else if(n.tag===19&&(n.memoizedProps.revealOrder==="forwards"||n.memoizedProps.revealOrder==="backwards"||n.memoizedProps.revealOrder==="unstable_legacy-backwards"||n.memoizedProps.revealOrder==="together")){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var Wn=0,ve=null,He=null,mt=null,Io=!1,is=!1,ba=!1,Lo=0,rr=0,as=null,BT=0;function it(){throw Error(s(321))}function Cu(t,n){if(n===null)return!1;for(var r=0;r<n.length&&r<t.length;r++)if(!Wt(t[r],n[r]))return!1;return!0}function Tu(t,n,r,c,f,p){return Wn=p,ve=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,F.H=t===null||t.memoizedState===null?Pp:Lu,ba=!1,p=r(c,f),ba=!1,is&&(p=$m(n,r,c,f)),Zm(t),p}function Zm(t){F.H=cr;var n=He!==null&&He.next!==null;if(Wn=0,mt=He=ve=null,Io=!1,rr=0,as=null,n)throw Error(s(300));t===null||pt||(t=t.dependencies,t!==null&&xo(t)&&(pt=!0))}function $m(t,n,r,c){ve=t;var f=0;do{if(is&&(as=null),rr=0,is=!1,25<=f)throw Error(s(301));if(f+=1,mt=He=null,t.updateQueue!=null){var p=t.updateQueue;p.lastEffect=null,p.events=null,p.stores=null,p.memoCache!=null&&(p.memoCache.index=0)}F.H=jp,p=n(r,c)}while(is);return p}function qT(){var t=F.H,n=t.useState()[0];return n=typeof n.then=="function"?or(n):n,t=t.useState()[0],(He!==null?He.memoizedState:null)!==t&&(ve.flags|=1024),n}function ku(){var t=Lo!==0;return Lo=0,t}function Eu(t,n,r){n.updateQueue=t.updateQueue,n.flags&=-2053,t.lanes&=~r}function _u(t){if(Io){for(t=t.memoizedState;t!==null;){var n=t.queue;n!==null&&(n.pending=null),t=t.next}Io=!1}Wn=0,mt=He=ve=null,is=!1,rr=Lo=0,as=null}function Ot(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return mt===null?ve.memoizedState=mt=t:mt=mt.next=t,mt}function ct(){if(He===null){var t=ve.alternate;t=t!==null?t.memoizedState:null}else t=He.next;var n=mt===null?ve.memoizedState:mt.next;if(n!==null)mt=n,He=t;else{if(t===null)throw ve.alternate===null?Error(s(467)):Error(s(310));He=t,t={memoizedState:He.memoizedState,baseState:He.baseState,baseQueue:He.baseQueue,queue:He.queue,next:null},mt===null?ve.memoizedState=mt=t:mt=mt.next=t}return mt}function Uo(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function or(t){var n=rr;return rr+=1,as===null&&(as=[]),t=Hm(as,t,n),n=ve,(mt===null?n.memoizedState:mt.next)===null&&(n=n.alternate,F.H=n===null||n.memoizedState===null?Pp:Lu),t}function Bo(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return or(t);if(t.$$typeof===L)return _t(t)}throw Error(s(438,String(t)))}function wu(t){var n=null,r=ve.updateQueue;if(r!==null&&(n=r.memoCache),n==null){var c=ve.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(n={data:c.data.map(function(f){return f.slice()}),index:0})))}if(n==null&&(n={data:[],index:0}),r===null&&(r=Uo(),ve.updateQueue=r),r.memoCache=n,r=n.data[n.index],r===void 0)for(r=n.data[n.index]=Array(t),c=0;c<t;c++)r[c]=te;return n.index++,r}function Zn(t,n){return typeof n=="function"?n(t):n}function qo(t){var n=ct();return xu(n,He,t)}function xu(t,n,r){var c=t.queue;if(c===null)throw Error(s(311));c.lastRenderedReducer=r;var f=t.baseQueue,p=c.pending;if(p!==null){if(f!==null){var b=f.next;f.next=p.next,p.next=b}n.baseQueue=f=p,c.pending=null}if(p=t.baseState,f===null)t.memoizedState=p;else{n=f.next;var C=b=null,w=null,q=n,G=!1;do{var J=q.lane&-536870913;if(J!==q.lane?(we&J)===J:(Wn&J)===J){var z=q.revertLane;if(z===0)w!==null&&(w=w.next={lane:0,revertLane:0,gesture:null,action:q.action,hasEagerState:q.hasEagerState,eagerState:q.eagerState,next:null}),J===Za&&(G=!0);else if((Wn&z)===z){q=q.next,z===Za&&(G=!0);continue}else J={lane:0,revertLane:q.revertLane,gesture:null,action:q.action,hasEagerState:q.hasEagerState,eagerState:q.eagerState,next:null},w===null?(C=w=J,b=p):w=w.next=J,ve.lanes|=z,Oi|=z;J=q.action,ba&&r(p,J),p=q.hasEagerState?q.eagerState:r(p,J)}else z={lane:J,revertLane:q.revertLane,gesture:q.gesture,action:q.action,hasEagerState:q.hasEagerState,eagerState:q.eagerState,next:null},w===null?(C=w=z,b=p):w=w.next=z,ve.lanes|=J,Oi|=J;q=q.next}while(q!==null&&q!==n);if(w===null?b=p:w.next=C,!Wt(p,t.memoizedState)&&(pt=!0,G&&(r=$a,r!==null)))throw r;t.memoizedState=p,t.baseState=b,t.baseQueue=w,c.lastRenderedState=p}return f===null&&(c.lanes=0),[t.memoizedState,c.dispatch]}function Ru(t){var n=ct(),r=n.queue;if(r===null)throw Error(s(311));r.lastRenderedReducer=t;var c=r.dispatch,f=r.pending,p=n.memoizedState;if(f!==null){r.pending=null;var b=f=f.next;do p=t(p,b.action),b=b.next;while(b!==f);Wt(p,n.memoizedState)||(pt=!0),n.memoizedState=p,n.baseQueue===null&&(n.baseState=p),r.lastRenderedState=p}return[p,c]}function ep(t,n,r){var c=ve,f=ct(),p=Re;if(p){if(r===void 0)throw Error(s(407));r=r()}else r=n();var b=!Wt((He||f).memoizedState,r);if(b&&(f.memoizedState=r,pt=!0),f=f.queue,Nu(ip.bind(null,c,f,t),[t]),f.getSnapshot!==n||b||mt!==null&&mt.memoizedState.tag&1){if(c.flags|=2048,ss(9,{destroy:void 0},np.bind(null,c,f,r,n),null),Ye===null)throw Error(s(349));p||(Wn&127)!==0||tp(c,n,r)}return r}function tp(t,n,r){t.flags|=16384,t={getSnapshot:n,value:r},n=ve.updateQueue,n===null?(n=Uo(),ve.updateQueue=n,n.stores=[t]):(r=n.stores,r===null?n.stores=[t]:r.push(t))}function np(t,n,r,c){n.value=r,n.getSnapshot=c,ap(n)&&sp(t)}function ip(t,n,r){return r(function(){ap(n)&&sp(t)})}function ap(t){var n=t.getSnapshot;t=t.value;try{var r=n();return!Wt(t,r)}catch{return!0}}function sp(t){var n=ua(t,2);n!==null&&Vt(n,t,2)}function Mu(t){var n=Ot();if(typeof t=="function"){var r=t;if(t=r(),ba){bi(!0);try{r()}finally{bi(!1)}}}return n.memoizedState=n.baseState=t,n.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Zn,lastRenderedState:t},n}function rp(t,n,r,c){return t.baseState=r,xu(t,He,typeof c=="function"?c:Zn)}function zT(t,n,r,c,f){if(Ho(t))throw Error(s(485));if(t=n.action,t!==null){var p={payload:f,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(b){p.listeners.push(b)}};F.T!==null?r(!0):p.isTransition=!1,c(p),r=n.pending,r===null?(p.next=n.pending=p,op(n,p)):(p.next=r.next,n.pending=r.next=p)}}function op(t,n){var r=n.action,c=n.payload,f=t.state;if(n.isTransition){var p=F.T,b={};F.T=b;try{var C=r(f,c),w=F.S;w!==null&&w(b,C),lp(t,n,C)}catch(q){Au(t,n,q)}finally{p!==null&&b.types!==null&&(p.types=b.types),F.T=p}}else try{p=r(f,c),lp(t,n,p)}catch(q){Au(t,n,q)}}function lp(t,n,r){r!==null&&typeof r=="object"&&typeof r.then=="function"?r.then(function(c){cp(t,n,c)},function(c){return Au(t,n,c)}):cp(t,n,r)}function cp(t,n,r){n.status="fulfilled",n.value=r,up(n),t.state=r,n=t.pending,n!==null&&(r=n.next,r===n?t.pending=null:(r=r.next,n.next=r,op(t,r)))}function Au(t,n,r){var c=t.pending;if(t.pending=null,c!==null){c=c.next;do n.status="rejected",n.reason=r,up(n),n=n.next;while(n!==c)}t.action=null}function up(t){t=t.listeners;for(var n=0;n<t.length;n++)(0,t[n])()}function dp(t,n){return n}function hp(t,n){if(Re){var r=Ye.formState;if(r!==null){e:{var c=ve;if(Re){if(We){t:{for(var f=We,p=hn;f.nodeType!==8;){if(!p){f=null;break t}if(f=mn(f.nextSibling),f===null){f=null;break t}}p=f.data,f=p==="F!"||p==="F"?f:null}if(f){We=mn(f.nextSibling),c=f.data==="F!";break e}}Ei(c)}c=!1}c&&(n=r[0])}}return r=Ot(),r.memoizedState=r.baseState=n,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:dp,lastRenderedState:n},r.queue=c,r=Np.bind(null,ve,c),c.dispatch=r,c=Mu(!1),p=Iu.bind(null,ve,!1,c.queue),c=Ot(),f={state:n,dispatch:null,action:t,pending:null},c.queue=f,r=zT.bind(null,ve,f,p,r),f.dispatch=r,c.memoizedState=t,[n,r,!1]}function fp(t){var n=ct();return mp(n,He,t)}function mp(t,n,r){if(n=xu(t,n,dp)[0],t=qo(Zn)[0],typeof n=="object"&&n!==null&&typeof n.then=="function")try{var c=or(n)}catch(b){throw b===es?Ao:b}else c=n;n=ct();var f=n.queue,p=f.dispatch;return r!==n.memoizedState&&(ve.flags|=2048,ss(9,{destroy:void 0},FT.bind(null,f,r),null)),[c,p,t]}function FT(t,n){t.action=n}function pp(t){var n=ct(),r=He;if(r!==null)return mp(n,r,t);ct(),n=n.memoizedState,r=ct();var c=r.queue.dispatch;return r.memoizedState=t,[n,c,!1]}function ss(t,n,r,c){return t={tag:t,create:r,deps:c,inst:n,next:null},n=ve.updateQueue,n===null&&(n=Uo(),ve.updateQueue=n),r=n.lastEffect,r===null?n.lastEffect=t.next=t:(c=r.next,r.next=t,t.next=c,n.lastEffect=t),t}function gp(){return ct().memoizedState}function zo(t,n,r,c){var f=Ot();ve.flags|=t,f.memoizedState=ss(1|n,{destroy:void 0},r,c===void 0?null:c)}function Fo(t,n,r,c){var f=ct();c=c===void 0?null:c;var p=f.memoizedState.inst;He!==null&&c!==null&&Cu(c,He.memoizedState.deps)?f.memoizedState=ss(n,p,r,c):(ve.flags|=t,f.memoizedState=ss(1|n,p,r,c))}function vp(t,n){zo(8390656,8,t,n)}function Nu(t,n){Fo(2048,8,t,n)}function HT(t){ve.flags|=4;var n=ve.updateQueue;if(n===null)n=Uo(),ve.updateQueue=n,n.events=[t];else{var r=n.events;r===null?n.events=[t]:r.push(t)}}function yp(t){var n=ct().memoizedState;return HT({ref:n,nextImpl:t}),function(){if((Ue&2)!==0)throw Error(s(440));return n.impl.apply(void 0,arguments)}}function bp(t,n){return Fo(4,2,t,n)}function Sp(t,n){return Fo(4,4,t,n)}function Cp(t,n){if(typeof n=="function"){t=t();var r=n(t);return function(){typeof r=="function"?r():n(null)}}if(n!=null)return t=t(),n.current=t,function(){n.current=null}}function Tp(t,n,r){r=r!=null?r.concat([t]):null,Fo(4,4,Cp.bind(null,n,t),r)}function Du(){}function kp(t,n){var r=ct();n=n===void 0?null:n;var c=r.memoizedState;return n!==null&&Cu(n,c[1])?c[0]:(r.memoizedState=[t,n],t)}function Ep(t,n){var r=ct();n=n===void 0?null:n;var c=r.memoizedState;if(n!==null&&Cu(n,c[1]))return c[0];if(c=t(),ba){bi(!0);try{t()}finally{bi(!1)}}return r.memoizedState=[c,n],c}function Ou(t,n,r){return r===void 0||(Wn&1073741824)!==0&&(we&261930)===0?t.memoizedState=n:(t.memoizedState=r,t=_g(),ve.lanes|=t,Oi|=t,r)}function _p(t,n,r,c){return Wt(r,n)?r:ns.current!==null?(t=Ou(t,r,c),Wt(t,n)||(pt=!0),t):(Wn&42)===0||(Wn&1073741824)!==0&&(we&261930)===0?(pt=!0,t.memoizedState=r):(t=_g(),ve.lanes|=t,Oi|=t,n)}function wp(t,n,r,c,f){var p=ne.p;ne.p=p!==0&&8>p?p:8;var b=F.T,C={};F.T=C,Iu(t,!1,n,r);try{var w=f(),q=F.S;if(q!==null&&q(C,w),w!==null&&typeof w=="object"&&typeof w.then=="function"){var G=UT(w,c);lr(t,n,G,an(t))}else lr(t,n,c,an(t))}catch(J){lr(t,n,{then:function(){},status:"rejected",reason:J},an())}finally{ne.p=p,b!==null&&C.types!==null&&(b.types=C.types),F.T=b}}function VT(){}function Pu(t,n,r,c){if(t.tag!==5)throw Error(s(476));var f=xp(t).queue;wp(t,f,n,he,r===null?VT:function(){return Rp(t),r(c)})}function xp(t){var n=t.memoizedState;if(n!==null)return n;n={memoizedState:he,baseState:he,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Zn,lastRenderedState:he},next:null};var r={};return n.next={memoizedState:r,baseState:r,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Zn,lastRenderedState:r},next:null},t.memoizedState=n,t=t.alternate,t!==null&&(t.memoizedState=n),n}function Rp(t){var n=xp(t);n.next===null&&(n=t.alternate.memoizedState),lr(t,n.next.queue,{},an())}function ju(){return _t(_r)}function Mp(){return ct().memoizedState}function Ap(){return ct().memoizedState}function GT(t){for(var n=t.return;n!==null;){switch(n.tag){case 24:case 3:var r=an();t=xi(r);var c=Ri(n,t,r);c!==null&&(Vt(c,n,r),ir(c,n,r)),n={cache:uu()},t.payload=n;return}n=n.return}}function KT(t,n,r){var c=an();r={lane:c,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},Ho(t)?Dp(n,r):(r=$c(t,n,r,c),r!==null&&(Vt(r,t,c),Op(r,n,c)))}function Np(t,n,r){var c=an();lr(t,n,r,c)}function lr(t,n,r,c){var f={lane:c,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null};if(Ho(t))Dp(n,f);else{var p=t.alternate;if(t.lanes===0&&(p===null||p.lanes===0)&&(p=n.lastRenderedReducer,p!==null))try{var b=n.lastRenderedState,C=p(b,r);if(f.hasEagerState=!0,f.eagerState=C,Wt(C,b))return ko(t,n,f,0),Ye===null&&To(),!1}catch{}if(r=$c(t,n,f,c),r!==null)return Vt(r,t,c),Op(r,n,c),!0}return!1}function Iu(t,n,r,c){if(c={lane:2,revertLane:md(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Ho(t)){if(n)throw Error(s(479))}else n=$c(t,r,c,2),n!==null&&Vt(n,t,2)}function Ho(t){var n=t.alternate;return t===ve||n!==null&&n===ve}function Dp(t,n){is=Io=!0;var r=t.pending;r===null?n.next=n:(n.next=r.next,r.next=n),t.pending=n}function Op(t,n,r){if((r&4194048)!==0){var c=n.lanes;c&=t.pendingLanes,r|=c,n.lanes=r,Uf(t,r)}}var cr={readContext:_t,use:Bo,useCallback:it,useContext:it,useEffect:it,useImperativeHandle:it,useLayoutEffect:it,useInsertionEffect:it,useMemo:it,useReducer:it,useRef:it,useState:it,useDebugValue:it,useDeferredValue:it,useTransition:it,useSyncExternalStore:it,useId:it,useHostTransitionStatus:it,useFormState:it,useActionState:it,useOptimistic:it,useMemoCache:it,useCacheRefresh:it};cr.useEffectEvent=it;var Pp={readContext:_t,use:Bo,useCallback:function(t,n){return Ot().memoizedState=[t,n===void 0?null:n],t},useContext:_t,useEffect:vp,useImperativeHandle:function(t,n,r){r=r!=null?r.concat([t]):null,zo(4194308,4,Cp.bind(null,n,t),r)},useLayoutEffect:function(t,n){return zo(4194308,4,t,n)},useInsertionEffect:function(t,n){zo(4,2,t,n)},useMemo:function(t,n){var r=Ot();n=n===void 0?null:n;var c=t();if(ba){bi(!0);try{t()}finally{bi(!1)}}return r.memoizedState=[c,n],c},useReducer:function(t,n,r){var c=Ot();if(r!==void 0){var f=r(n);if(ba){bi(!0);try{r(n)}finally{bi(!1)}}}else f=n;return c.memoizedState=c.baseState=f,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:f},c.queue=t,t=t.dispatch=KT.bind(null,ve,t),[c.memoizedState,t]},useRef:function(t){var n=Ot();return t={current:t},n.memoizedState=t},useState:function(t){t=Mu(t);var n=t.queue,r=Np.bind(null,ve,n);return n.dispatch=r,[t.memoizedState,r]},useDebugValue:Du,useDeferredValue:function(t,n){var r=Ot();return Ou(r,t,n)},useTransition:function(){var t=Mu(!1);return t=wp.bind(null,ve,t.queue,!0,!1),Ot().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,n,r){var c=ve,f=Ot();if(Re){if(r===void 0)throw Error(s(407));r=r()}else{if(r=n(),Ye===null)throw Error(s(349));(we&127)!==0||tp(c,n,r)}f.memoizedState=r;var p={value:r,getSnapshot:n};return f.queue=p,vp(ip.bind(null,c,p,t),[t]),c.flags|=2048,ss(9,{destroy:void 0},np.bind(null,c,p,r,n),null),r},useId:function(){var t=Ot(),n=Ye.identifierPrefix;if(Re){var r=On,c=Dn;r=(c&~(1<<32-Xt(c)-1)).toString(32)+r,n="_"+n+"R_"+r,r=Lo++,0<r&&(n+="H"+r.toString(32)),n+="_"}else r=BT++,n="_"+n+"r_"+r.toString(32)+"_";return t.memoizedState=n},useHostTransitionStatus:ju,useFormState:hp,useActionState:hp,useOptimistic:function(t){var n=Ot();n.memoizedState=n.baseState=t;var r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return n.queue=r,n=Iu.bind(null,ve,!0,r),r.dispatch=n,[t,n]},useMemoCache:wu,useCacheRefresh:function(){return Ot().memoizedState=GT.bind(null,ve)},useEffectEvent:function(t){var n=Ot(),r={impl:t};return n.memoizedState=r,function(){if((Ue&2)!==0)throw Error(s(440));return r.impl.apply(void 0,arguments)}}},Lu={readContext:_t,use:Bo,useCallback:kp,useContext:_t,useEffect:Nu,useImperativeHandle:Tp,useInsertionEffect:bp,useLayoutEffect:Sp,useMemo:Ep,useReducer:qo,useRef:gp,useState:function(){return qo(Zn)},useDebugValue:Du,useDeferredValue:function(t,n){var r=ct();return _p(r,He.memoizedState,t,n)},useTransition:function(){var t=qo(Zn)[0],n=ct().memoizedState;return[typeof t=="boolean"?t:or(t),n]},useSyncExternalStore:ep,useId:Mp,useHostTransitionStatus:ju,useFormState:fp,useActionState:fp,useOptimistic:function(t,n){var r=ct();return rp(r,He,t,n)},useMemoCache:wu,useCacheRefresh:Ap};Lu.useEffectEvent=yp;var jp={readContext:_t,use:Bo,useCallback:kp,useContext:_t,useEffect:Nu,useImperativeHandle:Tp,useInsertionEffect:bp,useLayoutEffect:Sp,useMemo:Ep,useReducer:Ru,useRef:gp,useState:function(){return Ru(Zn)},useDebugValue:Du,useDeferredValue:function(t,n){var r=ct();return He===null?Ou(r,t,n):_p(r,He.memoizedState,t,n)},useTransition:function(){var t=Ru(Zn)[0],n=ct().memoizedState;return[typeof t=="boolean"?t:or(t),n]},useSyncExternalStore:ep,useId:Mp,useHostTransitionStatus:ju,useFormState:pp,useActionState:pp,useOptimistic:function(t,n){var r=ct();return He!==null?rp(r,He,t,n):(r.baseState=t,[t,r.queue.dispatch])},useMemoCache:wu,useCacheRefresh:Ap};jp.useEffectEvent=yp;function Uu(t,n,r,c){n=t.memoizedState,r=r(c,n),r=r==null?n:y({},n,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Bu={enqueueSetState:function(t,n,r){t=t._reactInternals;var c=an(),f=xi(c);f.payload=n,r!=null&&(f.callback=r),n=Ri(t,f,c),n!==null&&(Vt(n,t,c),ir(n,t,c))},enqueueReplaceState:function(t,n,r){t=t._reactInternals;var c=an(),f=xi(c);f.tag=1,f.payload=n,r!=null&&(f.callback=r),n=Ri(t,f,c),n!==null&&(Vt(n,t,c),ir(n,t,c))},enqueueForceUpdate:function(t,n){t=t._reactInternals;var r=an(),c=xi(r);c.tag=2,n!=null&&(c.callback=n),n=Ri(t,c,r),n!==null&&(Vt(n,t,r),ir(n,t,r))}};function Ip(t,n,r,c,f,p,b){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(c,p,b):n.prototype&&n.prototype.isPureReactComponent?!Qs(r,c)||!Qs(f,p):!0}function Lp(t,n,r,c){t=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(r,c),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(r,c),n.state!==t&&Bu.enqueueReplaceState(n,n.state,null)}function Sa(t,n){var r=n;if("ref"in n){r={};for(var c in n)c!=="ref"&&(r[c]=n[c])}if(t=t.defaultProps){r===n&&(r=y({},r));for(var f in t)r[f]===void 0&&(r[f]=t[f])}return r}function Up(t){Co(t)}function Bp(t){console.error(t)}function qp(t){Co(t)}function Vo(t,n){try{var r=t.onUncaughtError;r(n.value,{componentStack:n.stack})}catch(c){setTimeout(function(){throw c})}}function zp(t,n,r){try{var c=t.onCaughtError;c(r.value,{componentStack:r.stack,errorBoundary:n.tag===1?n.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function qu(t,n,r){return r=xi(r),r.tag=3,r.payload={element:null},r.callback=function(){Vo(t,n)},r}function Fp(t){return t=xi(t),t.tag=3,t}function Hp(t,n,r,c){var f=r.type.getDerivedStateFromError;if(typeof f=="function"){var p=c.value;t.payload=function(){return f(p)},t.callback=function(){zp(n,r,c)}}var b=r.stateNode;b!==null&&typeof b.componentDidCatch=="function"&&(t.callback=function(){zp(n,r,c),typeof f!="function"&&(Pi===null?Pi=new Set([this]):Pi.add(this));var C=c.stack;this.componentDidCatch(c.value,{componentStack:C!==null?C:""})})}function YT(t,n,r,c,f){if(r.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(n=r.alternate,n!==null&&Wa(n,r,f,!0),r=$t.current,r!==null){switch(r.tag){case 31:case 13:return fn===null?nl():r.alternate===null&&at===0&&(at=3),r.flags&=-257,r.flags|=65536,r.lanes=f,c===No?r.flags|=16384:(n=r.updateQueue,n===null?r.updateQueue=new Set([c]):n.add(c),dd(t,c,f)),!1;case 22:return r.flags|=65536,c===No?r.flags|=16384:(n=r.updateQueue,n===null?(n={transitions:null,markerInstances:null,retryQueue:new Set([c])},r.updateQueue=n):(r=n.retryQueue,r===null?n.retryQueue=new Set([c]):r.add(c)),dd(t,c,f)),!1}throw Error(s(435,r.tag))}return dd(t,c,f),nl(),!1}if(Re)return n=$t.current,n!==null?((n.flags&65536)===0&&(n.flags|=256),n.flags|=65536,n.lanes=f,c!==su&&(t=Error(s(422),{cause:c}),Zs(cn(t,r)))):(c!==su&&(n=Error(s(423),{cause:c}),Zs(cn(n,r))),t=t.current.alternate,t.flags|=65536,f&=-f,t.lanes|=f,c=cn(c,r),f=qu(t.stateNode,c,f),gu(t,f),at!==4&&(at=2)),!1;var p=Error(s(520),{cause:c});if(p=cn(p,r),vr===null?vr=[p]:vr.push(p),at!==4&&(at=2),n===null)return!0;c=cn(c,r),r=n;do{switch(r.tag){case 3:return r.flags|=65536,t=f&-f,r.lanes|=t,t=qu(r.stateNode,c,t),gu(r,t),!1;case 1:if(n=r.type,p=r.stateNode,(r.flags&128)===0&&(typeof n.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(Pi===null||!Pi.has(p))))return r.flags|=65536,f&=-f,r.lanes|=f,f=Fp(f),Hp(f,t,r,c),gu(r,f),!1}r=r.return}while(r!==null);return!1}var zu=Error(s(461)),pt=!1;function wt(t,n,r,c){n.child=t===null?Ym(n,null,r,c):ya(n,t.child,r,c)}function Vp(t,n,r,c,f){r=r.render;var p=n.ref;if("ref"in c){var b={};for(var C in c)C!=="ref"&&(b[C]=c[C])}else b=c;return ma(n),c=Tu(t,n,r,b,p,f),C=ku(),t!==null&&!pt?(Eu(t,n,f),$n(t,n,f)):(Re&&C&&iu(n),n.flags|=1,wt(t,n,c,f),n.child)}function Gp(t,n,r,c,f){if(t===null){var p=r.type;return typeof p=="function"&&!eu(p)&&p.defaultProps===void 0&&r.compare===null?(n.tag=15,n.type=p,Kp(t,n,p,c,f)):(t=_o(r.type,null,c,n,n.mode,f),t.ref=n.ref,t.return=n,n.child=t)}if(p=t.child,!Qu(t,f)){var b=p.memoizedProps;if(r=r.compare,r=r!==null?r:Qs,r(b,c)&&t.ref===n.ref)return $n(t,n,f)}return n.flags|=1,t=Yn(p,c),t.ref=n.ref,t.return=n,n.child=t}function Kp(t,n,r,c,f){if(t!==null){var p=t.memoizedProps;if(Qs(p,c)&&t.ref===n.ref)if(pt=!1,n.pendingProps=c=p,Qu(t,f))(t.flags&131072)!==0&&(pt=!0);else return n.lanes=t.lanes,$n(t,n,f)}return Fu(t,n,r,c,f)}function Yp(t,n,r,c){var f=c.children,p=t!==null?t.memoizedState:null;if(t===null&&n.stateNode===null&&(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((n.flags&128)!==0){if(p=p!==null?p.baseLanes|r:r,t!==null){for(c=n.child=t.child,f=0;c!==null;)f=f|c.lanes|c.childLanes,c=c.sibling;c=f&~p}else c=0,n.child=null;return Jp(t,n,p,r,c)}if((r&536870912)!==0)n.memoizedState={baseLanes:0,cachePool:null},t!==null&&Mo(n,p!==null?p.cachePool:null),p!==null?Xm(n,p):yu(),Wm(n);else return c=n.lanes=536870912,Jp(t,n,p!==null?p.baseLanes|r:r,r,c)}else p!==null?(Mo(n,p.cachePool),Xm(n,p),Ai(),n.memoizedState=null):(t!==null&&Mo(n,null),yu(),Ai());return wt(t,n,f,r),n.child}function ur(t,n){return t!==null&&t.tag===22||n.stateNode!==null||(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),n.sibling}function Jp(t,n,r,c,f){var p=hu();return p=p===null?null:{parent:ft._currentValue,pool:p},n.memoizedState={baseLanes:r,cachePool:p},t!==null&&Mo(n,null),yu(),Wm(n),t!==null&&Wa(t,n,c,!0),n.childLanes=f,null}function Go(t,n){return n=Yo({mode:n.mode,children:n.children},t.mode),n.ref=t.ref,t.child=n,n.return=t,n}function Qp(t,n,r){return ya(n,t.child,null,r),t=Go(n,n.pendingProps),t.flags|=2,en(n),n.memoizedState=null,t}function JT(t,n,r){var c=n.pendingProps,f=(n.flags&128)!==0;if(n.flags&=-129,t===null){if(Re){if(c.mode==="hidden")return t=Go(n,c),n.lanes=536870912,ur(null,t);if(Su(n),(t=We)?(t=ov(t,hn),t=t!==null&&t.data==="&"?t:null,t!==null&&(n.memoizedState={dehydrated:t,treeContext:Ti!==null?{id:Dn,overflow:On}:null,retryLane:536870912,hydrationErrors:null},r=Dm(t),r.return=n,n.child=r,Et=n,We=null)):t=null,t===null)throw Ei(n);return n.lanes=536870912,null}return Go(n,c)}var p=t.memoizedState;if(p!==null){var b=p.dehydrated;if(Su(n),f)if(n.flags&256)n.flags&=-257,n=Qp(t,n,r);else if(n.memoizedState!==null)n.child=t.child,n.flags|=128,n=null;else throw Error(s(558));else if(pt||Wa(t,n,r,!1),f=(r&t.childLanes)!==0,pt||f){if(c=Ye,c!==null&&(b=Bf(c,r),b!==0&&b!==p.retryLane))throw p.retryLane=b,ua(t,b),Vt(c,t,b),zu;nl(),n=Qp(t,n,r)}else t=p.treeContext,We=mn(b.nextSibling),Et=n,Re=!0,ki=null,hn=!1,t!==null&&jm(n,t),n=Go(n,c),n.flags|=4096;return n}return t=Yn(t.child,{mode:c.mode,children:c.children}),t.ref=n.ref,n.child=t,t.return=n,t}function Ko(t,n){var r=n.ref;if(r===null)t!==null&&t.ref!==null&&(n.flags|=4194816);else{if(typeof r!="function"&&typeof r!="object")throw Error(s(284));(t===null||t.ref!==r)&&(n.flags|=4194816)}}function Fu(t,n,r,c,f){return ma(n),r=Tu(t,n,r,c,void 0,f),c=ku(),t!==null&&!pt?(Eu(t,n,f),$n(t,n,f)):(Re&&c&&iu(n),n.flags|=1,wt(t,n,r,f),n.child)}function Xp(t,n,r,c,f,p){return ma(n),n.updateQueue=null,r=$m(n,c,r,f),Zm(t),c=ku(),t!==null&&!pt?(Eu(t,n,p),$n(t,n,p)):(Re&&c&&iu(n),n.flags|=1,wt(t,n,r,p),n.child)}function Wp(t,n,r,c,f){if(ma(n),n.stateNode===null){var p=Ya,b=r.contextType;typeof b=="object"&&b!==null&&(p=_t(b)),p=new r(c,p),n.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=Bu,n.stateNode=p,p._reactInternals=n,p=n.stateNode,p.props=c,p.state=n.memoizedState,p.refs={},mu(n),b=r.contextType,p.context=typeof b=="object"&&b!==null?_t(b):Ya,p.state=n.memoizedState,b=r.getDerivedStateFromProps,typeof b=="function"&&(Uu(n,r,b,c),p.state=n.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(b=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),b!==p.state&&Bu.enqueueReplaceState(p,p.state,null),sr(n,c,p,f),ar(),p.state=n.memoizedState),typeof p.componentDidMount=="function"&&(n.flags|=4194308),c=!0}else if(t===null){p=n.stateNode;var C=n.memoizedProps,w=Sa(r,C);p.props=w;var q=p.context,G=r.contextType;b=Ya,typeof G=="object"&&G!==null&&(b=_t(G));var J=r.getDerivedStateFromProps;G=typeof J=="function"||typeof p.getSnapshotBeforeUpdate=="function",C=n.pendingProps!==C,G||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(C||q!==b)&&Lp(n,p,c,b),wi=!1;var z=n.memoizedState;p.state=z,sr(n,c,p,f),ar(),q=n.memoizedState,C||z!==q||wi?(typeof J=="function"&&(Uu(n,r,J,c),q=n.memoizedState),(w=wi||Ip(n,r,w,c,z,q,b))?(G||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(n.flags|=4194308)):(typeof p.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=c,n.memoizedState=q),p.props=c,p.state=q,p.context=b,c=w):(typeof p.componentDidMount=="function"&&(n.flags|=4194308),c=!1)}else{p=n.stateNode,pu(t,n),b=n.memoizedProps,G=Sa(r,b),p.props=G,J=n.pendingProps,z=p.context,q=r.contextType,w=Ya,typeof q=="object"&&q!==null&&(w=_t(q)),C=r.getDerivedStateFromProps,(q=typeof C=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(b!==J||z!==w)&&Lp(n,p,c,w),wi=!1,z=n.memoizedState,p.state=z,sr(n,c,p,f),ar();var V=n.memoizedState;b!==J||z!==V||wi||t!==null&&t.dependencies!==null&&xo(t.dependencies)?(typeof C=="function"&&(Uu(n,r,C,c),V=n.memoizedState),(G=wi||Ip(n,r,G,c,z,V,w)||t!==null&&t.dependencies!==null&&xo(t.dependencies))?(q||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(c,V,w),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(c,V,w)),typeof p.componentDidUpdate=="function"&&(n.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof p.componentDidUpdate!="function"||b===t.memoizedProps&&z===t.memoizedState||(n.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||b===t.memoizedProps&&z===t.memoizedState||(n.flags|=1024),n.memoizedProps=c,n.memoizedState=V),p.props=c,p.state=V,p.context=w,c=G):(typeof p.componentDidUpdate!="function"||b===t.memoizedProps&&z===t.memoizedState||(n.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||b===t.memoizedProps&&z===t.memoizedState||(n.flags|=1024),c=!1)}return p=c,Ko(t,n),c=(n.flags&128)!==0,p||c?(p=n.stateNode,r=c&&typeof r.getDerivedStateFromError!="function"?null:p.render(),n.flags|=1,t!==null&&c?(n.child=ya(n,t.child,null,f),n.child=ya(n,null,r,f)):wt(t,n,r,f),n.memoizedState=p.state,t=n.child):t=$n(t,n,f),t}function Zp(t,n,r,c){return ha(),n.flags|=256,wt(t,n,r,c),n.child}var Hu={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Vu(t){return{baseLanes:t,cachePool:zm()}}function Gu(t,n,r){return t=t!==null?t.childLanes&~r:0,n&&(t|=nn),t}function $p(t,n,r){var c=n.pendingProps,f=!1,p=(n.flags&128)!==0,b;if((b=p)||(b=t!==null&&t.memoizedState===null?!1:(lt.current&2)!==0),b&&(f=!0,n.flags&=-129),b=(n.flags&32)!==0,n.flags&=-33,t===null){if(Re){if(f?Mi(n):Ai(),(t=We)?(t=ov(t,hn),t=t!==null&&t.data!=="&"?t:null,t!==null&&(n.memoizedState={dehydrated:t,treeContext:Ti!==null?{id:Dn,overflow:On}:null,retryLane:536870912,hydrationErrors:null},r=Dm(t),r.return=n,n.child=r,Et=n,We=null)):t=null,t===null)throw Ei(n);return xd(t)?n.lanes=32:n.lanes=536870912,null}var C=c.children;return c=c.fallback,f?(Ai(),f=n.mode,C=Yo({mode:"hidden",children:C},f),c=da(c,f,r,null),C.return=n,c.return=n,C.sibling=c,n.child=C,c=n.child,c.memoizedState=Vu(r),c.childLanes=Gu(t,b,r),n.memoizedState=Hu,ur(null,c)):(Mi(n),Ku(n,C))}var w=t.memoizedState;if(w!==null&&(C=w.dehydrated,C!==null)){if(p)n.flags&256?(Mi(n),n.flags&=-257,n=Yu(t,n,r)):n.memoizedState!==null?(Ai(),n.child=t.child,n.flags|=128,n=null):(Ai(),C=c.fallback,f=n.mode,c=Yo({mode:"visible",children:c.children},f),C=da(C,f,r,null),C.flags|=2,c.return=n,C.return=n,c.sibling=C,n.child=c,ya(n,t.child,null,r),c=n.child,c.memoizedState=Vu(r),c.childLanes=Gu(t,b,r),n.memoizedState=Hu,n=ur(null,c));else if(Mi(n),xd(C)){if(b=C.nextSibling&&C.nextSibling.dataset,b)var q=b.dgst;b=q,c=Error(s(419)),c.stack="",c.digest=b,Zs({value:c,source:null,stack:null}),n=Yu(t,n,r)}else if(pt||Wa(t,n,r,!1),b=(r&t.childLanes)!==0,pt||b){if(b=Ye,b!==null&&(c=Bf(b,r),c!==0&&c!==w.retryLane))throw w.retryLane=c,ua(t,c),Vt(b,t,c),zu;wd(C)||nl(),n=Yu(t,n,r)}else wd(C)?(n.flags|=192,n.child=t.child,n=null):(t=w.treeContext,We=mn(C.nextSibling),Et=n,Re=!0,ki=null,hn=!1,t!==null&&jm(n,t),n=Ku(n,c.children),n.flags|=4096);return n}return f?(Ai(),C=c.fallback,f=n.mode,w=t.child,q=w.sibling,c=Yn(w,{mode:"hidden",children:c.children}),c.subtreeFlags=w.subtreeFlags&65011712,q!==null?C=Yn(q,C):(C=da(C,f,r,null),C.flags|=2),C.return=n,c.return=n,c.sibling=C,n.child=c,ur(null,c),c=n.child,C=t.child.memoizedState,C===null?C=Vu(r):(f=C.cachePool,f!==null?(w=ft._currentValue,f=f.parent!==w?{parent:w,pool:w}:f):f=zm(),C={baseLanes:C.baseLanes|r,cachePool:f}),c.memoizedState=C,c.childLanes=Gu(t,b,r),n.memoizedState=Hu,ur(t.child,c)):(Mi(n),r=t.child,t=r.sibling,r=Yn(r,{mode:"visible",children:c.children}),r.return=n,r.sibling=null,t!==null&&(b=n.deletions,b===null?(n.deletions=[t],n.flags|=16):b.push(t)),n.child=r,n.memoizedState=null,r)}function Ku(t,n){return n=Yo({mode:"visible",children:n},t.mode),n.return=t,t.child=n}function Yo(t,n){return t=Zt(22,t,null,n),t.lanes=0,t}function Yu(t,n,r){return ya(n,t.child,null,r),t=Ku(n,n.pendingProps.children),t.flags|=2,n.memoizedState=null,t}function eg(t,n,r){t.lanes|=n;var c=t.alternate;c!==null&&(c.lanes|=n),lu(t.return,n,r)}function Ju(t,n,r,c,f,p){var b=t.memoizedState;b===null?t.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:c,tail:r,tailMode:f,treeForkCount:p}:(b.isBackwards=n,b.rendering=null,b.renderingStartTime=0,b.last=c,b.tail=r,b.tailMode=f,b.treeForkCount=p)}function tg(t,n,r){var c=n.pendingProps,f=c.revealOrder,p=c.tail;c=c.children;var b=lt.current,C=(b&2)!==0;if(C?(b=b&1|2,n.flags|=128):b&=1,se(lt,b),wt(t,n,c,r),c=Re?Ws:0,!C&&t!==null&&(t.flags&128)!==0)e:for(t=n.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&eg(t,r,n);else if(t.tag===19)eg(t,r,n);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===n)break e;for(;t.sibling===null;){if(t.return===null||t.return===n)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}switch(f){case"forwards":for(r=n.child,f=null;r!==null;)t=r.alternate,t!==null&&jo(t)===null&&(f=r),r=r.sibling;r=f,r===null?(f=n.child,n.child=null):(f=r.sibling,r.sibling=null),Ju(n,!1,f,r,p,c);break;case"backwards":case"unstable_legacy-backwards":for(r=null,f=n.child,n.child=null;f!==null;){if(t=f.alternate,t!==null&&jo(t)===null){n.child=f;break}t=f.sibling,f.sibling=r,r=f,f=t}Ju(n,!0,r,null,p,c);break;case"together":Ju(n,!1,null,null,void 0,c);break;default:n.memoizedState=null}return n.child}function $n(t,n,r){if(t!==null&&(n.dependencies=t.dependencies),Oi|=n.lanes,(r&n.childLanes)===0)if(t!==null){if(Wa(t,n,r,!1),(r&n.childLanes)===0)return null}else return null;if(t!==null&&n.child!==t.child)throw Error(s(153));if(n.child!==null){for(t=n.child,r=Yn(t,t.pendingProps),n.child=r,r.return=n;t.sibling!==null;)t=t.sibling,r=r.sibling=Yn(t,t.pendingProps),r.return=n;r.sibling=null}return n.child}function Qu(t,n){return(t.lanes&n)!==0?!0:(t=t.dependencies,!!(t!==null&&xo(t)))}function QT(t,n,r){switch(n.tag){case 3:Dt(n,n.stateNode.containerInfo),_i(n,ft,t.memoizedState.cache),ha();break;case 27:case 5:Is(n);break;case 4:Dt(n,n.stateNode.containerInfo);break;case 10:_i(n,n.type,n.memoizedProps.value);break;case 31:if(n.memoizedState!==null)return n.flags|=128,Su(n),null;break;case 13:var c=n.memoizedState;if(c!==null)return c.dehydrated!==null?(Mi(n),n.flags|=128,null):(r&n.child.childLanes)!==0?$p(t,n,r):(Mi(n),t=$n(t,n,r),t!==null?t.sibling:null);Mi(n);break;case 19:var f=(t.flags&128)!==0;if(c=(r&n.childLanes)!==0,c||(Wa(t,n,r,!1),c=(r&n.childLanes)!==0),f){if(c)return tg(t,n,r);n.flags|=128}if(f=n.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),se(lt,lt.current),c)break;return null;case 22:return n.lanes=0,Yp(t,n,r,n.pendingProps);case 24:_i(n,ft,t.memoizedState.cache)}return $n(t,n,r)}function ng(t,n,r){if(t!==null)if(t.memoizedProps!==n.pendingProps)pt=!0;else{if(!Qu(t,r)&&(n.flags&128)===0)return pt=!1,QT(t,n,r);pt=(t.flags&131072)!==0}else pt=!1,Re&&(n.flags&1048576)!==0&&Pm(n,Ws,n.index);switch(n.lanes=0,n.tag){case 16:e:{var c=n.pendingProps;if(t=ga(n.elementType),n.type=t,typeof t=="function")eu(t)?(c=Sa(t,c),n.tag=1,n=Wp(null,n,t,c,r)):(n.tag=0,n=Fu(null,n,t,c,r));else{if(t!=null){var f=t.$$typeof;if(f===D){n.tag=11,n=Vp(null,n,t,c,r);break e}else if(f===H){n.tag=14,n=Gp(null,n,t,c,r);break e}}throw n=Xe(t)||t,Error(s(306,n,""))}}return n;case 0:return Fu(t,n,n.type,n.pendingProps,r);case 1:return c=n.type,f=Sa(c,n.pendingProps),Wp(t,n,c,f,r);case 3:e:{if(Dt(n,n.stateNode.containerInfo),t===null)throw Error(s(387));c=n.pendingProps;var p=n.memoizedState;f=p.element,pu(t,n),sr(n,c,null,r);var b=n.memoizedState;if(c=b.cache,_i(n,ft,c),c!==p.cache&&cu(n,[ft],r,!0),ar(),c=b.element,p.isDehydrated)if(p={element:c,isDehydrated:!1,cache:b.cache},n.updateQueue.baseState=p,n.memoizedState=p,n.flags&256){n=Zp(t,n,c,r);break e}else if(c!==f){f=cn(Error(s(424)),n),Zs(f),n=Zp(t,n,c,r);break e}else for(t=n.stateNode.containerInfo,t.nodeType===9?t=t.body:t=t.nodeName==="HTML"?t.ownerDocument.body:t,We=mn(t.firstChild),Et=n,Re=!0,ki=null,hn=!0,r=Ym(n,null,c,r),n.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(ha(),c===f){n=$n(t,n,r);break e}wt(t,n,c,r)}n=n.child}return n;case 26:return Ko(t,n),t===null?(r=fv(n.type,null,n.pendingProps,null))?n.memoizedState=r:Re||(r=n.type,t=n.pendingProps,c=cl(ye.current).createElement(r),c[kt]=n,c[Ut]=t,xt(c,r,t),bt(c),n.stateNode=c):n.memoizedState=fv(n.type,t.memoizedProps,n.pendingProps,t.memoizedState),null;case 27:return Is(n),t===null&&Re&&(c=n.stateNode=uv(n.type,n.pendingProps,ye.current),Et=n,hn=!0,f=We,Ui(n.type)?(Rd=f,We=mn(c.firstChild)):We=f),wt(t,n,n.pendingProps.children,r),Ko(t,n),t===null&&(n.flags|=4194304),n.child;case 5:return t===null&&Re&&((f=c=We)&&(c=_k(c,n.type,n.pendingProps,hn),c!==null?(n.stateNode=c,Et=n,We=mn(c.firstChild),hn=!1,f=!0):f=!1),f||Ei(n)),Is(n),f=n.type,p=n.pendingProps,b=t!==null?t.memoizedProps:null,c=p.children,kd(f,p)?c=null:b!==null&&kd(f,b)&&(n.flags|=32),n.memoizedState!==null&&(f=Tu(t,n,qT,null,null,r),_r._currentValue=f),Ko(t,n),wt(t,n,c,r),n.child;case 6:return t===null&&Re&&((t=r=We)&&(r=wk(r,n.pendingProps,hn),r!==null?(n.stateNode=r,Et=n,We=null,t=!0):t=!1),t||Ei(n)),null;case 13:return $p(t,n,r);case 4:return Dt(n,n.stateNode.containerInfo),c=n.pendingProps,t===null?n.child=ya(n,null,c,r):wt(t,n,c,r),n.child;case 11:return Vp(t,n,n.type,n.pendingProps,r);case 7:return wt(t,n,n.pendingProps,r),n.child;case 8:return wt(t,n,n.pendingProps.children,r),n.child;case 12:return wt(t,n,n.pendingProps.children,r),n.child;case 10:return c=n.pendingProps,_i(n,n.type,c.value),wt(t,n,c.children,r),n.child;case 9:return f=n.type._context,c=n.pendingProps.children,ma(n),f=_t(f),c=c(f),n.flags|=1,wt(t,n,c,r),n.child;case 14:return Gp(t,n,n.type,n.pendingProps,r);case 15:return Kp(t,n,n.type,n.pendingProps,r);case 19:return tg(t,n,r);case 31:return JT(t,n,r);case 22:return Yp(t,n,r,n.pendingProps);case 24:return ma(n),c=_t(ft),t===null?(f=hu(),f===null&&(f=Ye,p=uu(),f.pooledCache=p,p.refCount++,p!==null&&(f.pooledCacheLanes|=r),f=p),n.memoizedState={parent:c,cache:f},mu(n),_i(n,ft,f)):((t.lanes&r)!==0&&(pu(t,n),sr(n,null,null,r),ar()),f=t.memoizedState,p=n.memoizedState,f.parent!==c?(f={parent:c,cache:c},n.memoizedState=f,n.lanes===0&&(n.memoizedState=n.updateQueue.baseState=f),_i(n,ft,c)):(c=p.cache,_i(n,ft,c),c!==f.cache&&cu(n,[ft],r,!0))),wt(t,n,n.pendingProps.children,r),n.child;case 29:throw n.pendingProps}throw Error(s(156,n.tag))}function ei(t){t.flags|=4}function Xu(t,n,r,c,f){if((n=(t.mode&32)!==0)&&(n=!1),n){if(t.flags|=16777216,(f&335544128)===f)if(t.stateNode.complete)t.flags|=8192;else if(Mg())t.flags|=8192;else throw va=No,fu}else t.flags&=-16777217}function ig(t,n){if(n.type!=="stylesheet"||(n.state.loading&4)!==0)t.flags&=-16777217;else if(t.flags|=16777216,!yv(n))if(Mg())t.flags|=8192;else throw va=No,fu}function Jo(t,n){n!==null&&(t.flags|=4),t.flags&16384&&(n=t.tag!==22?If():536870912,t.lanes|=n,cs|=n)}function dr(t,n){if(!Re)switch(t.tailMode){case"hidden":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var c=null;r!==null;)r.alternate!==null&&(c=r),r=r.sibling;c===null?n||t.tail===null?t.tail=null:t.tail.sibling=null:c.sibling=null}}function Ze(t){var n=t.alternate!==null&&t.alternate.child===t.child,r=0,c=0;if(n)for(var f=t.child;f!==null;)r|=f.lanes|f.childLanes,c|=f.subtreeFlags&65011712,c|=f.flags&65011712,f.return=t,f=f.sibling;else for(f=t.child;f!==null;)r|=f.lanes|f.childLanes,c|=f.subtreeFlags,c|=f.flags,f.return=t,f=f.sibling;return t.subtreeFlags|=c,t.childLanes=r,n}function XT(t,n,r){var c=n.pendingProps;switch(au(n),n.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ze(n),null;case 1:return Ze(n),null;case 3:return r=n.stateNode,c=null,t!==null&&(c=t.memoizedState.cache),n.memoizedState.cache!==c&&(n.flags|=2048),Xn(ft),ot(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Xa(n)?ei(n):t===null||t.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,ru())),Ze(n),null;case 26:var f=n.type,p=n.memoizedState;return t===null?(ei(n),p!==null?(Ze(n),ig(n,p)):(Ze(n),Xu(n,f,null,c,r))):p?p!==t.memoizedState?(ei(n),Ze(n),ig(n,p)):(Ze(n),n.flags&=-16777217):(t=t.memoizedProps,t!==c&&ei(n),Ze(n),Xu(n,f,t,c,r)),null;case 27:if(ao(n),r=ye.current,f=n.type,t!==null&&n.stateNode!=null)t.memoizedProps!==c&&ei(n);else{if(!c){if(n.stateNode===null)throw Error(s(166));return Ze(n),null}t=le.current,Xa(n)?Im(n):(t=uv(f,c,r),n.stateNode=t,ei(n))}return Ze(n),null;case 5:if(ao(n),f=n.type,t!==null&&n.stateNode!=null)t.memoizedProps!==c&&ei(n);else{if(!c){if(n.stateNode===null)throw Error(s(166));return Ze(n),null}if(p=le.current,Xa(n))Im(n);else{var b=cl(ye.current);switch(p){case 1:p=b.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:p=b.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":p=b.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":p=b.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":p=b.createElement("div"),p.innerHTML="<script><\/script>",p=p.removeChild(p.firstChild);break;case"select":p=typeof c.is=="string"?b.createElement("select",{is:c.is}):b.createElement("select"),c.multiple?p.multiple=!0:c.size&&(p.size=c.size);break;default:p=typeof c.is=="string"?b.createElement(f,{is:c.is}):b.createElement(f)}}p[kt]=n,p[Ut]=c;e:for(b=n.child;b!==null;){if(b.tag===5||b.tag===6)p.appendChild(b.stateNode);else if(b.tag!==4&&b.tag!==27&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===n)break e;for(;b.sibling===null;){if(b.return===null||b.return===n)break e;b=b.return}b.sibling.return=b.return,b=b.sibling}n.stateNode=p;e:switch(xt(p,f,c),f){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&ei(n)}}return Ze(n),Xu(n,n.type,t===null?null:t.memoizedProps,n.pendingProps,r),null;case 6:if(t&&n.stateNode!=null)t.memoizedProps!==c&&ei(n);else{if(typeof c!="string"&&n.stateNode===null)throw Error(s(166));if(t=ye.current,Xa(n)){if(t=n.stateNode,r=n.memoizedProps,c=null,f=Et,f!==null)switch(f.tag){case 27:case 5:c=f.memoizedProps}t[kt]=n,t=!!(t.nodeValue===r||c!==null&&c.suppressHydrationWarning===!0||$g(t.nodeValue,r)),t||Ei(n,!0)}else t=cl(t).createTextNode(c),t[kt]=n,n.stateNode=t}return Ze(n),null;case 31:if(r=n.memoizedState,t===null||t.memoizedState!==null){if(c=Xa(n),r!==null){if(t===null){if(!c)throw Error(s(318));if(t=n.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(s(557));t[kt]=n}else ha(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;Ze(n),t=!1}else r=ru(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=r),t=!0;if(!t)return n.flags&256?(en(n),n):(en(n),null);if((n.flags&128)!==0)throw Error(s(558))}return Ze(n),null;case 13:if(c=n.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(f=Xa(n),c!==null&&c.dehydrated!==null){if(t===null){if(!f)throw Error(s(318));if(f=n.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(s(317));f[kt]=n}else ha(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;Ze(n),f=!1}else f=ru(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=f),f=!0;if(!f)return n.flags&256?(en(n),n):(en(n),null)}return en(n),(n.flags&128)!==0?(n.lanes=r,n):(r=c!==null,t=t!==null&&t.memoizedState!==null,r&&(c=n.child,f=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(f=c.alternate.memoizedState.cachePool.pool),p=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(p=c.memoizedState.cachePool.pool),p!==f&&(c.flags|=2048)),r!==t&&r&&(n.child.flags|=8192),Jo(n,n.updateQueue),Ze(n),null);case 4:return ot(),t===null&&yd(n.stateNode.containerInfo),Ze(n),null;case 10:return Xn(n.type),Ze(n),null;case 19:if(Y(lt),c=n.memoizedState,c===null)return Ze(n),null;if(f=(n.flags&128)!==0,p=c.rendering,p===null)if(f)dr(c,!1);else{if(at!==0||t!==null&&(t.flags&128)!==0)for(t=n.child;t!==null;){if(p=jo(t),p!==null){for(n.flags|=128,dr(c,!1),t=p.updateQueue,n.updateQueue=t,Jo(n,t),n.subtreeFlags=0,t=r,r=n.child;r!==null;)Nm(r,t),r=r.sibling;return se(lt,lt.current&1|2),Re&&Jn(n,c.treeForkCount),n.child}t=t.sibling}c.tail!==null&&Jt()>$o&&(n.flags|=128,f=!0,dr(c,!1),n.lanes=4194304)}else{if(!f)if(t=jo(p),t!==null){if(n.flags|=128,f=!0,t=t.updateQueue,n.updateQueue=t,Jo(n,t),dr(c,!0),c.tail===null&&c.tailMode==="hidden"&&!p.alternate&&!Re)return Ze(n),null}else 2*Jt()-c.renderingStartTime>$o&&r!==536870912&&(n.flags|=128,f=!0,dr(c,!1),n.lanes=4194304);c.isBackwards?(p.sibling=n.child,n.child=p):(t=c.last,t!==null?t.sibling=p:n.child=p,c.last=p)}return c.tail!==null?(t=c.tail,c.rendering=t,c.tail=t.sibling,c.renderingStartTime=Jt(),t.sibling=null,r=lt.current,se(lt,f?r&1|2:r&1),Re&&Jn(n,c.treeForkCount),t):(Ze(n),null);case 22:case 23:return en(n),bu(),c=n.memoizedState!==null,t!==null?t.memoizedState!==null!==c&&(n.flags|=8192):c&&(n.flags|=8192),c?(r&536870912)!==0&&(n.flags&128)===0&&(Ze(n),n.subtreeFlags&6&&(n.flags|=8192)):Ze(n),r=n.updateQueue,r!==null&&Jo(n,r.retryQueue),r=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(r=t.memoizedState.cachePool.pool),c=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(c=n.memoizedState.cachePool.pool),c!==r&&(n.flags|=2048),t!==null&&Y(pa),null;case 24:return r=null,t!==null&&(r=t.memoizedState.cache),n.memoizedState.cache!==r&&(n.flags|=2048),Xn(ft),Ze(n),null;case 25:return null;case 30:return null}throw Error(s(156,n.tag))}function WT(t,n){switch(au(n),n.tag){case 1:return t=n.flags,t&65536?(n.flags=t&-65537|128,n):null;case 3:return Xn(ft),ot(),t=n.flags,(t&65536)!==0&&(t&128)===0?(n.flags=t&-65537|128,n):null;case 26:case 27:case 5:return ao(n),null;case 31:if(n.memoizedState!==null){if(en(n),n.alternate===null)throw Error(s(340));ha()}return t=n.flags,t&65536?(n.flags=t&-65537|128,n):null;case 13:if(en(n),t=n.memoizedState,t!==null&&t.dehydrated!==null){if(n.alternate===null)throw Error(s(340));ha()}return t=n.flags,t&65536?(n.flags=t&-65537|128,n):null;case 19:return Y(lt),null;case 4:return ot(),null;case 10:return Xn(n.type),null;case 22:case 23:return en(n),bu(),t!==null&&Y(pa),t=n.flags,t&65536?(n.flags=t&-65537|128,n):null;case 24:return Xn(ft),null;case 25:return null;default:return null}}function ag(t,n){switch(au(n),n.tag){case 3:Xn(ft),ot();break;case 26:case 27:case 5:ao(n);break;case 4:ot();break;case 31:n.memoizedState!==null&&en(n);break;case 13:en(n);break;case 19:Y(lt);break;case 10:Xn(n.type);break;case 22:case 23:en(n),bu(),t!==null&&Y(pa);break;case 24:Xn(ft)}}function hr(t,n){try{var r=n.updateQueue,c=r!==null?r.lastEffect:null;if(c!==null){var f=c.next;r=f;do{if((r.tag&t)===t){c=void 0;var p=r.create,b=r.inst;c=p(),b.destroy=c}r=r.next}while(r!==f)}}catch(C){ze(n,n.return,C)}}function Ni(t,n,r){try{var c=n.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var p=f.next;c=p;do{if((c.tag&t)===t){var b=c.inst,C=b.destroy;if(C!==void 0){b.destroy=void 0,f=n;var w=r,q=C;try{q()}catch(G){ze(f,w,G)}}}c=c.next}while(c!==p)}}catch(G){ze(n,n.return,G)}}function sg(t){var n=t.updateQueue;if(n!==null){var r=t.stateNode;try{Qm(n,r)}catch(c){ze(t,t.return,c)}}}function rg(t,n,r){r.props=Sa(t.type,t.memoizedProps),r.state=t.memoizedState;try{r.componentWillUnmount()}catch(c){ze(t,n,c)}}function fr(t,n){try{var r=t.ref;if(r!==null){switch(t.tag){case 26:case 27:case 5:var c=t.stateNode;break;case 30:c=t.stateNode;break;default:c=t.stateNode}typeof r=="function"?t.refCleanup=r(c):r.current=c}}catch(f){ze(t,n,f)}}function Pn(t,n){var r=t.ref,c=t.refCleanup;if(r!==null)if(typeof c=="function")try{c()}catch(f){ze(t,n,f)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof r=="function")try{r(null)}catch(f){ze(t,n,f)}else r.current=null}function og(t){var n=t.type,r=t.memoizedProps,c=t.stateNode;try{e:switch(n){case"button":case"input":case"select":case"textarea":r.autoFocus&&c.focus();break e;case"img":r.src?c.src=r.src:r.srcSet&&(c.srcset=r.srcSet)}}catch(f){ze(t,t.return,f)}}function Wu(t,n,r){try{var c=t.stateNode;bk(c,t.type,r,n),c[Ut]=n}catch(f){ze(t,t.return,f)}}function lg(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&Ui(t.type)||t.tag===4}function Zu(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||lg(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&Ui(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function $u(t,n,r){var c=t.tag;if(c===5||c===6)t=t.stateNode,n?(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r).insertBefore(t,n):(n=r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,n.appendChild(t),r=r._reactRootContainer,r!=null||n.onclick!==null||(n.onclick=Gn));else if(c!==4&&(c===27&&Ui(t.type)&&(r=t.stateNode,n=null),t=t.child,t!==null))for($u(t,n,r),t=t.sibling;t!==null;)$u(t,n,r),t=t.sibling}function Qo(t,n,r){var c=t.tag;if(c===5||c===6)t=t.stateNode,n?r.insertBefore(t,n):r.appendChild(t);else if(c!==4&&(c===27&&Ui(t.type)&&(r=t.stateNode),t=t.child,t!==null))for(Qo(t,n,r),t=t.sibling;t!==null;)Qo(t,n,r),t=t.sibling}function cg(t){var n=t.stateNode,r=t.memoizedProps;try{for(var c=t.type,f=n.attributes;f.length;)n.removeAttributeNode(f[0]);xt(n,c,r),n[kt]=t,n[Ut]=r}catch(p){ze(t,t.return,p)}}var ti=!1,gt=!1,ed=!1,ug=typeof WeakSet=="function"?WeakSet:Set,St=null;function ZT(t,n){if(t=t.containerInfo,Cd=gl,t=Tm(t),Yc(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var c=r.getSelection&&r.getSelection();if(c&&c.rangeCount!==0){r=c.anchorNode;var f=c.anchorOffset,p=c.focusNode;c=c.focusOffset;try{r.nodeType,p.nodeType}catch{r=null;break e}var b=0,C=-1,w=-1,q=0,G=0,J=t,z=null;t:for(;;){for(var V;J!==r||f!==0&&J.nodeType!==3||(C=b+f),J!==p||c!==0&&J.nodeType!==3||(w=b+c),J.nodeType===3&&(b+=J.nodeValue.length),(V=J.firstChild)!==null;)z=J,J=V;for(;;){if(J===t)break t;if(z===r&&++q===f&&(C=b),z===p&&++G===c&&(w=b),(V=J.nextSibling)!==null)break;J=z,z=J.parentNode}J=V}r=C===-1||w===-1?null:{start:C,end:w}}else r=null}r=r||{start:0,end:0}}else r=null;for(Td={focusedElem:t,selectionRange:r},gl=!1,St=n;St!==null;)if(n=St,t=n.child,(n.subtreeFlags&1028)!==0&&t!==null)t.return=n,St=t;else for(;St!==null;){switch(n=St,p=n.alternate,t=n.flags,n.tag){case 0:if((t&4)!==0&&(t=n.updateQueue,t=t!==null?t.events:null,t!==null))for(r=0;r<t.length;r++)f=t[r],f.ref.impl=f.nextImpl;break;case 11:case 15:break;case 1:if((t&1024)!==0&&p!==null){t=void 0,r=n,f=p.memoizedProps,p=p.memoizedState,c=r.stateNode;try{var oe=Sa(r.type,f);t=c.getSnapshotBeforeUpdate(oe,p),c.__reactInternalSnapshotBeforeUpdate=t}catch(fe){ze(r,r.return,fe)}}break;case 3:if((t&1024)!==0){if(t=n.stateNode.containerInfo,r=t.nodeType,r===9)_d(t);else if(r===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":_d(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((t&1024)!==0)throw Error(s(163))}if(t=n.sibling,t!==null){t.return=n.return,St=t;break}St=n.return}}function dg(t,n,r){var c=r.flags;switch(r.tag){case 0:case 11:case 15:ii(t,r),c&4&&hr(5,r);break;case 1:if(ii(t,r),c&4)if(t=r.stateNode,n===null)try{t.componentDidMount()}catch(b){ze(r,r.return,b)}else{var f=Sa(r.type,n.memoizedProps);n=n.memoizedState;try{t.componentDidUpdate(f,n,t.__reactInternalSnapshotBeforeUpdate)}catch(b){ze(r,r.return,b)}}c&64&&sg(r),c&512&&fr(r,r.return);break;case 3:if(ii(t,r),c&64&&(t=r.updateQueue,t!==null)){if(n=null,r.child!==null)switch(r.child.tag){case 27:case 5:n=r.child.stateNode;break;case 1:n=r.child.stateNode}try{Qm(t,n)}catch(b){ze(r,r.return,b)}}break;case 27:n===null&&c&4&&cg(r);case 26:case 5:ii(t,r),n===null&&c&4&&og(r),c&512&&fr(r,r.return);break;case 12:ii(t,r);break;case 31:ii(t,r),c&4&&mg(t,r);break;case 13:ii(t,r),c&4&&pg(t,r),c&64&&(t=r.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(r=ok.bind(null,r),xk(t,r))));break;case 22:if(c=r.memoizedState!==null||ti,!c){n=n!==null&&n.memoizedState!==null||gt,f=ti;var p=gt;ti=c,(gt=n)&&!p?ai(t,r,(r.subtreeFlags&8772)!==0):ii(t,r),ti=f,gt=p}break;case 30:break;default:ii(t,r)}}function hg(t){var n=t.alternate;n!==null&&(t.alternate=null,hg(n)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(n=t.stateNode,n!==null&&Ac(n)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var $e=null,qt=!1;function ni(t,n,r){for(r=r.child;r!==null;)fg(t,n,r),r=r.sibling}function fg(t,n,r){if(Qt&&typeof Qt.onCommitFiberUnmount=="function")try{Qt.onCommitFiberUnmount(Ls,r)}catch{}switch(r.tag){case 26:gt||Pn(r,n),ni(t,n,r),r.memoizedState?r.memoizedState.count--:r.stateNode&&(r=r.stateNode,r.parentNode.removeChild(r));break;case 27:gt||Pn(r,n);var c=$e,f=qt;Ui(r.type)&&($e=r.stateNode,qt=!1),ni(t,n,r),Tr(r.stateNode),$e=c,qt=f;break;case 5:gt||Pn(r,n);case 6:if(c=$e,f=qt,$e=null,ni(t,n,r),$e=c,qt=f,$e!==null)if(qt)try{($e.nodeType===9?$e.body:$e.nodeName==="HTML"?$e.ownerDocument.body:$e).removeChild(r.stateNode)}catch(p){ze(r,n,p)}else try{$e.removeChild(r.stateNode)}catch(p){ze(r,n,p)}break;case 18:$e!==null&&(qt?(t=$e,sv(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,r.stateNode),vs(t)):sv($e,r.stateNode));break;case 4:c=$e,f=qt,$e=r.stateNode.containerInfo,qt=!0,ni(t,n,r),$e=c,qt=f;break;case 0:case 11:case 14:case 15:Ni(2,r,n),gt||Ni(4,r,n),ni(t,n,r);break;case 1:gt||(Pn(r,n),c=r.stateNode,typeof c.componentWillUnmount=="function"&&rg(r,n,c)),ni(t,n,r);break;case 21:ni(t,n,r);break;case 22:gt=(c=gt)||r.memoizedState!==null,ni(t,n,r),gt=c;break;default:ni(t,n,r)}}function mg(t,n){if(n.memoizedState===null&&(t=n.alternate,t!==null&&(t=t.memoizedState,t!==null))){t=t.dehydrated;try{vs(t)}catch(r){ze(n,n.return,r)}}}function pg(t,n){if(n.memoizedState===null&&(t=n.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{vs(t)}catch(r){ze(n,n.return,r)}}function $T(t){switch(t.tag){case 31:case 13:case 19:var n=t.stateNode;return n===null&&(n=t.stateNode=new ug),n;case 22:return t=t.stateNode,n=t._retryCache,n===null&&(n=t._retryCache=new ug),n;default:throw Error(s(435,t.tag))}}function Xo(t,n){var r=$T(t);n.forEach(function(c){if(!r.has(c)){r.add(c);var f=lk.bind(null,t,c);c.then(f,f)}})}function zt(t,n){var r=n.deletions;if(r!==null)for(var c=0;c<r.length;c++){var f=r[c],p=t,b=n,C=b;e:for(;C!==null;){switch(C.tag){case 27:if(Ui(C.type)){$e=C.stateNode,qt=!1;break e}break;case 5:$e=C.stateNode,qt=!1;break e;case 3:case 4:$e=C.stateNode.containerInfo,qt=!0;break e}C=C.return}if($e===null)throw Error(s(160));fg(p,b,f),$e=null,qt=!1,p=f.alternate,p!==null&&(p.return=null),f.return=null}if(n.subtreeFlags&13886)for(n=n.child;n!==null;)gg(n,t),n=n.sibling}var Tn=null;function gg(t,n){var r=t.alternate,c=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:zt(n,t),Ft(t),c&4&&(Ni(3,t,t.return),hr(3,t),Ni(5,t,t.return));break;case 1:zt(n,t),Ft(t),c&512&&(gt||r===null||Pn(r,r.return)),c&64&&ti&&(t=t.updateQueue,t!==null&&(c=t.callbacks,c!==null&&(r=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=r===null?c:r.concat(c))));break;case 26:var f=Tn;if(zt(n,t),Ft(t),c&512&&(gt||r===null||Pn(r,r.return)),c&4){var p=r!==null?r.memoizedState:null;if(c=t.memoizedState,r===null)if(c===null)if(t.stateNode===null){e:{c=t.type,r=t.memoizedProps,f=f.ownerDocument||f;t:switch(c){case"title":p=f.getElementsByTagName("title")[0],(!p||p[qs]||p[kt]||p.namespaceURI==="http://www.w3.org/2000/svg"||p.hasAttribute("itemprop"))&&(p=f.createElement(c),f.head.insertBefore(p,f.querySelector("head > title"))),xt(p,c,r),p[kt]=t,bt(p),c=p;break e;case"link":var b=gv("link","href",f).get(c+(r.href||""));if(b){for(var C=0;C<b.length;C++)if(p=b[C],p.getAttribute("href")===(r.href==null||r.href===""?null:r.href)&&p.getAttribute("rel")===(r.rel==null?null:r.rel)&&p.getAttribute("title")===(r.title==null?null:r.title)&&p.getAttribute("crossorigin")===(r.crossOrigin==null?null:r.crossOrigin)){b.splice(C,1);break t}}p=f.createElement(c),xt(p,c,r),f.head.appendChild(p);break;case"meta":if(b=gv("meta","content",f).get(c+(r.content||""))){for(C=0;C<b.length;C++)if(p=b[C],p.getAttribute("content")===(r.content==null?null:""+r.content)&&p.getAttribute("name")===(r.name==null?null:r.name)&&p.getAttribute("property")===(r.property==null?null:r.property)&&p.getAttribute("http-equiv")===(r.httpEquiv==null?null:r.httpEquiv)&&p.getAttribute("charset")===(r.charSet==null?null:r.charSet)){b.splice(C,1);break t}}p=f.createElement(c),xt(p,c,r),f.head.appendChild(p);break;default:throw Error(s(468,c))}p[kt]=t,bt(p),c=p}t.stateNode=c}else vv(f,t.type,t.stateNode);else t.stateNode=pv(f,c,t.memoizedProps);else p!==c?(p===null?r.stateNode!==null&&(r=r.stateNode,r.parentNode.removeChild(r)):p.count--,c===null?vv(f,t.type,t.stateNode):pv(f,c,t.memoizedProps)):c===null&&t.stateNode!==null&&Wu(t,t.memoizedProps,r.memoizedProps)}break;case 27:zt(n,t),Ft(t),c&512&&(gt||r===null||Pn(r,r.return)),r!==null&&c&4&&Wu(t,t.memoizedProps,r.memoizedProps);break;case 5:if(zt(n,t),Ft(t),c&512&&(gt||r===null||Pn(r,r.return)),t.flags&32){f=t.stateNode;try{qa(f,"")}catch(oe){ze(t,t.return,oe)}}c&4&&t.stateNode!=null&&(f=t.memoizedProps,Wu(t,f,r!==null?r.memoizedProps:f)),c&1024&&(ed=!0);break;case 6:if(zt(n,t),Ft(t),c&4){if(t.stateNode===null)throw Error(s(162));c=t.memoizedProps,r=t.stateNode;try{r.nodeValue=c}catch(oe){ze(t,t.return,oe)}}break;case 3:if(hl=null,f=Tn,Tn=ul(n.containerInfo),zt(n,t),Tn=f,Ft(t),c&4&&r!==null&&r.memoizedState.isDehydrated)try{vs(n.containerInfo)}catch(oe){ze(t,t.return,oe)}ed&&(ed=!1,vg(t));break;case 4:c=Tn,Tn=ul(t.stateNode.containerInfo),zt(n,t),Ft(t),Tn=c;break;case 12:zt(n,t),Ft(t);break;case 31:zt(n,t),Ft(t),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,Xo(t,c)));break;case 13:zt(n,t),Ft(t),t.child.flags&8192&&t.memoizedState!==null!=(r!==null&&r.memoizedState!==null)&&(Zo=Jt()),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,Xo(t,c)));break;case 22:f=t.memoizedState!==null;var w=r!==null&&r.memoizedState!==null,q=ti,G=gt;if(ti=q||f,gt=G||w,zt(n,t),gt=G,ti=q,Ft(t),c&8192)e:for(n=t.stateNode,n._visibility=f?n._visibility&-2:n._visibility|1,f&&(r===null||w||ti||gt||Ca(t)),r=null,n=t;;){if(n.tag===5||n.tag===26){if(r===null){w=r=n;try{if(p=w.stateNode,f)b=p.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none";else{C=w.stateNode;var J=w.memoizedProps.style,z=J!=null&&J.hasOwnProperty("display")?J.display:null;C.style.display=z==null||typeof z=="boolean"?"":(""+z).trim()}}catch(oe){ze(w,w.return,oe)}}}else if(n.tag===6){if(r===null){w=n;try{w.stateNode.nodeValue=f?"":w.memoizedProps}catch(oe){ze(w,w.return,oe)}}}else if(n.tag===18){if(r===null){w=n;try{var V=w.stateNode;f?rv(V,!0):rv(w.stateNode,!1)}catch(oe){ze(w,w.return,oe)}}}else if((n.tag!==22&&n.tag!==23||n.memoizedState===null||n===t)&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break e;for(;n.sibling===null;){if(n.return===null||n.return===t)break e;r===n&&(r=null),n=n.return}r===n&&(r=null),n.sibling.return=n.return,n=n.sibling}c&4&&(c=t.updateQueue,c!==null&&(r=c.retryQueue,r!==null&&(c.retryQueue=null,Xo(t,r))));break;case 19:zt(n,t),Ft(t),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,Xo(t,c)));break;case 30:break;case 21:break;default:zt(n,t),Ft(t)}}function Ft(t){var n=t.flags;if(n&2){try{for(var r,c=t.return;c!==null;){if(lg(c)){r=c;break}c=c.return}if(r==null)throw Error(s(160));switch(r.tag){case 27:var f=r.stateNode,p=Zu(t);Qo(t,p,f);break;case 5:var b=r.stateNode;r.flags&32&&(qa(b,""),r.flags&=-33);var C=Zu(t);Qo(t,C,b);break;case 3:case 4:var w=r.stateNode.containerInfo,q=Zu(t);$u(t,q,w);break;default:throw Error(s(161))}}catch(G){ze(t,t.return,G)}t.flags&=-3}n&4096&&(t.flags&=-4097)}function vg(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var n=t;vg(n),n.tag===5&&n.flags&1024&&n.stateNode.reset(),t=t.sibling}}function ii(t,n){if(n.subtreeFlags&8772)for(n=n.child;n!==null;)dg(t,n.alternate,n),n=n.sibling}function Ca(t){for(t=t.child;t!==null;){var n=t;switch(n.tag){case 0:case 11:case 14:case 15:Ni(4,n,n.return),Ca(n);break;case 1:Pn(n,n.return);var r=n.stateNode;typeof r.componentWillUnmount=="function"&&rg(n,n.return,r),Ca(n);break;case 27:Tr(n.stateNode);case 26:case 5:Pn(n,n.return),Ca(n);break;case 22:n.memoizedState===null&&Ca(n);break;case 30:Ca(n);break;default:Ca(n)}t=t.sibling}}function ai(t,n,r){for(r=r&&(n.subtreeFlags&8772)!==0,n=n.child;n!==null;){var c=n.alternate,f=t,p=n,b=p.flags;switch(p.tag){case 0:case 11:case 15:ai(f,p,r),hr(4,p);break;case 1:if(ai(f,p,r),c=p,f=c.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(q){ze(c,c.return,q)}if(c=p,f=c.updateQueue,f!==null){var C=c.stateNode;try{var w=f.shared.hiddenCallbacks;if(w!==null)for(f.shared.hiddenCallbacks=null,f=0;f<w.length;f++)Jm(w[f],C)}catch(q){ze(c,c.return,q)}}r&&b&64&&sg(p),fr(p,p.return);break;case 27:cg(p);case 26:case 5:ai(f,p,r),r&&c===null&&b&4&&og(p),fr(p,p.return);break;case 12:ai(f,p,r);break;case 31:ai(f,p,r),r&&b&4&&mg(f,p);break;case 13:ai(f,p,r),r&&b&4&&pg(f,p);break;case 22:p.memoizedState===null&&ai(f,p,r),fr(p,p.return);break;case 30:break;default:ai(f,p,r)}n=n.sibling}}function td(t,n){var r=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(r=t.memoizedState.cachePool.pool),t=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(t=n.memoizedState.cachePool.pool),t!==r&&(t!=null&&t.refCount++,r!=null&&$s(r))}function nd(t,n){t=null,n.alternate!==null&&(t=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==t&&(n.refCount++,t!=null&&$s(t))}function kn(t,n,r,c){if(n.subtreeFlags&10256)for(n=n.child;n!==null;)yg(t,n,r,c),n=n.sibling}function yg(t,n,r,c){var f=n.flags;switch(n.tag){case 0:case 11:case 15:kn(t,n,r,c),f&2048&&hr(9,n);break;case 1:kn(t,n,r,c);break;case 3:kn(t,n,r,c),f&2048&&(t=null,n.alternate!==null&&(t=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==t&&(n.refCount++,t!=null&&$s(t)));break;case 12:if(f&2048){kn(t,n,r,c),t=n.stateNode;try{var p=n.memoizedProps,b=p.id,C=p.onPostCommit;typeof C=="function"&&C(b,n.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(w){ze(n,n.return,w)}}else kn(t,n,r,c);break;case 31:kn(t,n,r,c);break;case 13:kn(t,n,r,c);break;case 23:break;case 22:p=n.stateNode,b=n.alternate,n.memoizedState!==null?p._visibility&2?kn(t,n,r,c):mr(t,n):p._visibility&2?kn(t,n,r,c):(p._visibility|=2,rs(t,n,r,c,(n.subtreeFlags&10256)!==0||!1)),f&2048&&td(b,n);break;case 24:kn(t,n,r,c),f&2048&&nd(n.alternate,n);break;default:kn(t,n,r,c)}}function rs(t,n,r,c,f){for(f=f&&((n.subtreeFlags&10256)!==0||!1),n=n.child;n!==null;){var p=t,b=n,C=r,w=c,q=b.flags;switch(b.tag){case 0:case 11:case 15:rs(p,b,C,w,f),hr(8,b);break;case 23:break;case 22:var G=b.stateNode;b.memoizedState!==null?G._visibility&2?rs(p,b,C,w,f):mr(p,b):(G._visibility|=2,rs(p,b,C,w,f)),f&&q&2048&&td(b.alternate,b);break;case 24:rs(p,b,C,w,f),f&&q&2048&&nd(b.alternate,b);break;default:rs(p,b,C,w,f)}n=n.sibling}}function mr(t,n){if(n.subtreeFlags&10256)for(n=n.child;n!==null;){var r=t,c=n,f=c.flags;switch(c.tag){case 22:mr(r,c),f&2048&&td(c.alternate,c);break;case 24:mr(r,c),f&2048&&nd(c.alternate,c);break;default:mr(r,c)}n=n.sibling}}var pr=8192;function os(t,n,r){if(t.subtreeFlags&pr)for(t=t.child;t!==null;)bg(t,n,r),t=t.sibling}function bg(t,n,r){switch(t.tag){case 26:os(t,n,r),t.flags&pr&&t.memoizedState!==null&&Bk(r,Tn,t.memoizedState,t.memoizedProps);break;case 5:os(t,n,r);break;case 3:case 4:var c=Tn;Tn=ul(t.stateNode.containerInfo),os(t,n,r),Tn=c;break;case 22:t.memoizedState===null&&(c=t.alternate,c!==null&&c.memoizedState!==null?(c=pr,pr=16777216,os(t,n,r),pr=c):os(t,n,r));break;default:os(t,n,r)}}function Sg(t){var n=t.alternate;if(n!==null&&(t=n.child,t!==null)){n.child=null;do n=t.sibling,t.sibling=null,t=n;while(t!==null)}}function gr(t){var n=t.deletions;if((t.flags&16)!==0){if(n!==null)for(var r=0;r<n.length;r++){var c=n[r];St=c,Tg(c,t)}Sg(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)Cg(t),t=t.sibling}function Cg(t){switch(t.tag){case 0:case 11:case 15:gr(t),t.flags&2048&&Ni(9,t,t.return);break;case 3:gr(t);break;case 12:gr(t);break;case 22:var n=t.stateNode;t.memoizedState!==null&&n._visibility&2&&(t.return===null||t.return.tag!==13)?(n._visibility&=-3,Wo(t)):gr(t);break;default:gr(t)}}function Wo(t){var n=t.deletions;if((t.flags&16)!==0){if(n!==null)for(var r=0;r<n.length;r++){var c=n[r];St=c,Tg(c,t)}Sg(t)}for(t=t.child;t!==null;){switch(n=t,n.tag){case 0:case 11:case 15:Ni(8,n,n.return),Wo(n);break;case 22:r=n.stateNode,r._visibility&2&&(r._visibility&=-3,Wo(n));break;default:Wo(n)}t=t.sibling}}function Tg(t,n){for(;St!==null;){var r=St;switch(r.tag){case 0:case 11:case 15:Ni(8,r,n);break;case 23:case 22:if(r.memoizedState!==null&&r.memoizedState.cachePool!==null){var c=r.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:$s(r.memoizedState.cache)}if(c=r.child,c!==null)c.return=r,St=c;else e:for(r=t;St!==null;){c=St;var f=c.sibling,p=c.return;if(hg(c),c===r){St=null;break e}if(f!==null){f.return=p,St=f;break e}St=p}}}var ek={getCacheForType:function(t){var n=_t(ft),r=n.data.get(t);return r===void 0&&(r=t(),n.data.set(t,r)),r},cacheSignal:function(){return _t(ft).controller.signal}},tk=typeof WeakMap=="function"?WeakMap:Map,Ue=0,Ye=null,Te=null,we=0,qe=0,tn=null,Di=!1,ls=!1,id=!1,si=0,at=0,Oi=0,Ta=0,ad=0,nn=0,cs=0,vr=null,Ht=null,sd=!1,Zo=0,kg=0,$o=1/0,el=null,Pi=null,yt=0,ji=null,us=null,ri=0,rd=0,od=null,Eg=null,yr=0,ld=null;function an(){return(Ue&2)!==0&&we!==0?we&-we:F.T!==null?md():qf()}function _g(){if(nn===0)if((we&536870912)===0||Re){var t=oo;oo<<=1,(oo&3932160)===0&&(oo=262144),nn=t}else nn=536870912;return t=$t.current,t!==null&&(t.flags|=32),nn}function Vt(t,n,r){(t===Ye&&(qe===2||qe===9)||t.cancelPendingCommit!==null)&&(ds(t,0),Ii(t,we,nn,!1)),Bs(t,r),((Ue&2)===0||t!==Ye)&&(t===Ye&&((Ue&2)===0&&(Ta|=r),at===4&&Ii(t,we,nn,!1)),jn(t))}function wg(t,n,r){if((Ue&6)!==0)throw Error(s(327));var c=!r&&(n&127)===0&&(n&t.expiredLanes)===0||Us(t,n),f=c?ak(t,n):ud(t,n,!0),p=c;do{if(f===0){ls&&!c&&Ii(t,n,0,!1);break}else{if(r=t.current.alternate,p&&!nk(r)){f=ud(t,n,!1),p=!1;continue}if(f===2){if(p=n,t.errorRecoveryDisabledLanes&p)var b=0;else b=t.pendingLanes&-536870913,b=b!==0?b:b&536870912?536870912:0;if(b!==0){n=b;e:{var C=t;f=vr;var w=C.current.memoizedState.isDehydrated;if(w&&(ds(C,b).flags|=256),b=ud(C,b,!1),b!==2){if(id&&!w){C.errorRecoveryDisabledLanes|=p,Ta|=p,f=4;break e}p=Ht,Ht=f,p!==null&&(Ht===null?Ht=p:Ht.push.apply(Ht,p))}f=b}if(p=!1,f!==2)continue}}if(f===1){ds(t,0),Ii(t,n,0,!0);break}e:{switch(c=t,p=f,p){case 0:case 1:throw Error(s(345));case 4:if((n&4194048)!==n)break;case 6:Ii(c,n,nn,!Di);break e;case 2:Ht=null;break;case 3:case 5:break;default:throw Error(s(329))}if((n&62914560)===n&&(f=Zo+300-Jt(),10<f)){if(Ii(c,n,nn,!Di),co(c,0,!0)!==0)break e;ri=n,c.timeoutHandle=iv(xg.bind(null,c,r,Ht,el,sd,n,nn,Ta,cs,Di,p,"Throttled",-0,0),f);break e}xg(c,r,Ht,el,sd,n,nn,Ta,cs,Di,p,null,-0,0)}}break}while(!0);jn(t)}function xg(t,n,r,c,f,p,b,C,w,q,G,J,z,V){if(t.timeoutHandle=-1,J=n.subtreeFlags,J&8192||(J&16785408)===16785408){J={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Gn},bg(n,p,J);var oe=(p&62914560)===p?Zo-Jt():(p&4194048)===p?kg-Jt():0;if(oe=qk(J,oe),oe!==null){ri=p,t.cancelPendingCommit=oe(jg.bind(null,t,n,p,r,c,f,b,C,w,G,J,null,z,V)),Ii(t,p,b,!q);return}}jg(t,n,p,r,c,f,b,C,w)}function nk(t){for(var n=t;;){var r=n.tag;if((r===0||r===11||r===15)&&n.flags&16384&&(r=n.updateQueue,r!==null&&(r=r.stores,r!==null)))for(var c=0;c<r.length;c++){var f=r[c],p=f.getSnapshot;f=f.value;try{if(!Wt(p(),f))return!1}catch{return!1}}if(r=n.child,n.subtreeFlags&16384&&r!==null)r.return=n,n=r;else{if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function Ii(t,n,r,c){n&=~ad,n&=~Ta,t.suspendedLanes|=n,t.pingedLanes&=~n,c&&(t.warmLanes|=n),c=t.expirationTimes;for(var f=n;0<f;){var p=31-Xt(f),b=1<<p;c[p]=-1,f&=~b}r!==0&&Lf(t,r,n)}function tl(){return(Ue&6)===0?(br(0),!1):!0}function cd(){if(Te!==null){if(qe===0)var t=Te.return;else t=Te,Qn=fa=null,_u(t),ts=null,tr=0,t=Te;for(;t!==null;)ag(t.alternate,t),t=t.return;Te=null}}function ds(t,n){var r=t.timeoutHandle;r!==-1&&(t.timeoutHandle=-1,Tk(r)),r=t.cancelPendingCommit,r!==null&&(t.cancelPendingCommit=null,r()),ri=0,cd(),Ye=t,Te=r=Yn(t.current,null),we=n,qe=0,tn=null,Di=!1,ls=Us(t,n),id=!1,cs=nn=ad=Ta=Oi=at=0,Ht=vr=null,sd=!1,(n&8)!==0&&(n|=n&32);var c=t.entangledLanes;if(c!==0)for(t=t.entanglements,c&=n;0<c;){var f=31-Xt(c),p=1<<f;n|=t[f],c&=~p}return si=n,To(),r}function Rg(t,n){ve=null,F.H=cr,n===es||n===Ao?(n=Vm(),qe=3):n===fu?(n=Vm(),qe=4):qe=n===zu?8:n!==null&&typeof n=="object"&&typeof n.then=="function"?6:1,tn=n,Te===null&&(at=1,Vo(t,cn(n,t.current)))}function Mg(){var t=$t.current;return t===null?!0:(we&4194048)===we?fn===null:(we&62914560)===we||(we&536870912)!==0?t===fn:!1}function Ag(){var t=F.H;return F.H=cr,t===null?cr:t}function Ng(){var t=F.A;return F.A=ek,t}function nl(){at=4,Di||(we&4194048)!==we&&$t.current!==null||(ls=!0),(Oi&134217727)===0&&(Ta&134217727)===0||Ye===null||Ii(Ye,we,nn,!1)}function ud(t,n,r){var c=Ue;Ue|=2;var f=Ag(),p=Ng();(Ye!==t||we!==n)&&(el=null,ds(t,n)),n=!1;var b=at;e:do try{if(qe!==0&&Te!==null){var C=Te,w=tn;switch(qe){case 8:cd(),b=6;break e;case 3:case 2:case 9:case 6:$t.current===null&&(n=!0);var q=qe;if(qe=0,tn=null,hs(t,C,w,q),r&&ls){b=0;break e}break;default:q=qe,qe=0,tn=null,hs(t,C,w,q)}}ik(),b=at;break}catch(G){Rg(t,G)}while(!0);return n&&t.shellSuspendCounter++,Qn=fa=null,Ue=c,F.H=f,F.A=p,Te===null&&(Ye=null,we=0,To()),b}function ik(){for(;Te!==null;)Dg(Te)}function ak(t,n){var r=Ue;Ue|=2;var c=Ag(),f=Ng();Ye!==t||we!==n?(el=null,$o=Jt()+500,ds(t,n)):ls=Us(t,n);e:do try{if(qe!==0&&Te!==null){n=Te;var p=tn;t:switch(qe){case 1:qe=0,tn=null,hs(t,n,p,1);break;case 2:case 9:if(Fm(p)){qe=0,tn=null,Og(n);break}n=function(){qe!==2&&qe!==9||Ye!==t||(qe=7),jn(t)},p.then(n,n);break e;case 3:qe=7;break e;case 4:qe=5;break e;case 7:Fm(p)?(qe=0,tn=null,Og(n)):(qe=0,tn=null,hs(t,n,p,7));break;case 5:var b=null;switch(Te.tag){case 26:b=Te.memoizedState;case 5:case 27:var C=Te;if(b?yv(b):C.stateNode.complete){qe=0,tn=null;var w=C.sibling;if(w!==null)Te=w;else{var q=C.return;q!==null?(Te=q,il(q)):Te=null}break t}}qe=0,tn=null,hs(t,n,p,5);break;case 6:qe=0,tn=null,hs(t,n,p,6);break;case 8:cd(),at=6;break e;default:throw Error(s(462))}}sk();break}catch(G){Rg(t,G)}while(!0);return Qn=fa=null,F.H=c,F.A=f,Ue=r,Te!==null?0:(Ye=null,we=0,To(),at)}function sk(){for(;Te!==null&&!RC();)Dg(Te)}function Dg(t){var n=ng(t.alternate,t,si);t.memoizedProps=t.pendingProps,n===null?il(t):Te=n}function Og(t){var n=t,r=n.alternate;switch(n.tag){case 15:case 0:n=Xp(r,n,n.pendingProps,n.type,void 0,we);break;case 11:n=Xp(r,n,n.pendingProps,n.type.render,n.ref,we);break;case 5:_u(n);default:ag(r,n),n=Te=Nm(n,si),n=ng(r,n,si)}t.memoizedProps=t.pendingProps,n===null?il(t):Te=n}function hs(t,n,r,c){Qn=fa=null,_u(n),ts=null,tr=0;var f=n.return;try{if(YT(t,f,n,r,we)){at=1,Vo(t,cn(r,t.current)),Te=null;return}}catch(p){if(f!==null)throw Te=f,p;at=1,Vo(t,cn(r,t.current)),Te=null;return}n.flags&32768?(Re||c===1?t=!0:ls||(we&536870912)!==0?t=!1:(Di=t=!0,(c===2||c===9||c===3||c===6)&&(c=$t.current,c!==null&&c.tag===13&&(c.flags|=16384))),Pg(n,t)):il(n)}function il(t){var n=t;do{if((n.flags&32768)!==0){Pg(n,Di);return}t=n.return;var r=XT(n.alternate,n,si);if(r!==null){Te=r;return}if(n=n.sibling,n!==null){Te=n;return}Te=n=t}while(n!==null);at===0&&(at=5)}function Pg(t,n){do{var r=WT(t.alternate,t);if(r!==null){r.flags&=32767,Te=r;return}if(r=t.return,r!==null&&(r.flags|=32768,r.subtreeFlags=0,r.deletions=null),!n&&(t=t.sibling,t!==null)){Te=t;return}Te=t=r}while(t!==null);at=6,Te=null}function jg(t,n,r,c,f,p,b,C,w){t.cancelPendingCommit=null;do al();while(yt!==0);if((Ue&6)!==0)throw Error(s(327));if(n!==null){if(n===t.current)throw Error(s(177));if(p=n.lanes|n.childLanes,p|=Zc,UC(t,r,p,b,C,w),t===Ye&&(Te=Ye=null,we=0),us=n,ji=t,ri=r,rd=p,od=f,Eg=c,(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?(t.callbackNode=null,t.callbackPriority=0,ck(so,function(){return qg(),null})):(t.callbackNode=null,t.callbackPriority=0),c=(n.flags&13878)!==0,(n.subtreeFlags&13878)!==0||c){c=F.T,F.T=null,f=ne.p,ne.p=2,b=Ue,Ue|=4;try{ZT(t,n,r)}finally{Ue=b,ne.p=f,F.T=c}}yt=1,Ig(),Lg(),Ug()}}function Ig(){if(yt===1){yt=0;var t=ji,n=us,r=(n.flags&13878)!==0;if((n.subtreeFlags&13878)!==0||r){r=F.T,F.T=null;var c=ne.p;ne.p=2;var f=Ue;Ue|=4;try{gg(n,t);var p=Td,b=Tm(t.containerInfo),C=p.focusedElem,w=p.selectionRange;if(b!==C&&C&&C.ownerDocument&&Cm(C.ownerDocument.documentElement,C)){if(w!==null&&Yc(C)){var q=w.start,G=w.end;if(G===void 0&&(G=q),"selectionStart"in C)C.selectionStart=q,C.selectionEnd=Math.min(G,C.value.length);else{var J=C.ownerDocument||document,z=J&&J.defaultView||window;if(z.getSelection){var V=z.getSelection(),oe=C.textContent.length,fe=Math.min(w.start,oe),Ge=w.end===void 0?fe:Math.min(w.end,oe);!V.extend&&fe>Ge&&(b=Ge,Ge=fe,fe=b);var j=Sm(C,fe),M=Sm(C,Ge);if(j&&M&&(V.rangeCount!==1||V.anchorNode!==j.node||V.anchorOffset!==j.offset||V.focusNode!==M.node||V.focusOffset!==M.offset)){var B=J.createRange();B.setStart(j.node,j.offset),V.removeAllRanges(),fe>Ge?(V.addRange(B),V.extend(M.node,M.offset)):(B.setEnd(M.node,M.offset),V.addRange(B))}}}}for(J=[],V=C;V=V.parentNode;)V.nodeType===1&&J.push({element:V,left:V.scrollLeft,top:V.scrollTop});for(typeof C.focus=="function"&&C.focus(),C=0;C<J.length;C++){var K=J[C];K.element.scrollLeft=K.left,K.element.scrollTop=K.top}}gl=!!Cd,Td=Cd=null}finally{Ue=f,ne.p=c,F.T=r}}t.current=n,yt=2}}function Lg(){if(yt===2){yt=0;var t=ji,n=us,r=(n.flags&8772)!==0;if((n.subtreeFlags&8772)!==0||r){r=F.T,F.T=null;var c=ne.p;ne.p=2;var f=Ue;Ue|=4;try{dg(t,n.alternate,n)}finally{Ue=f,ne.p=c,F.T=r}}yt=3}}function Ug(){if(yt===4||yt===3){yt=0,MC();var t=ji,n=us,r=ri,c=Eg;(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?yt=5:(yt=0,us=ji=null,Bg(t,t.pendingLanes));var f=t.pendingLanes;if(f===0&&(Pi=null),Rc(r),n=n.stateNode,Qt&&typeof Qt.onCommitFiberRoot=="function")try{Qt.onCommitFiberRoot(Ls,n,void 0,(n.current.flags&128)===128)}catch{}if(c!==null){n=F.T,f=ne.p,ne.p=2,F.T=null;try{for(var p=t.onRecoverableError,b=0;b<c.length;b++){var C=c[b];p(C.value,{componentStack:C.stack})}}finally{F.T=n,ne.p=f}}(ri&3)!==0&&al(),jn(t),f=t.pendingLanes,(r&261930)!==0&&(f&42)!==0?t===ld?yr++:(yr=0,ld=t):yr=0,br(0)}}function Bg(t,n){(t.pooledCacheLanes&=n)===0&&(n=t.pooledCache,n!=null&&(t.pooledCache=null,$s(n)))}function al(){return Ig(),Lg(),Ug(),qg()}function qg(){if(yt!==5)return!1;var t=ji,n=rd;rd=0;var r=Rc(ri),c=F.T,f=ne.p;try{ne.p=32>r?32:r,F.T=null,r=od,od=null;var p=ji,b=ri;if(yt=0,us=ji=null,ri=0,(Ue&6)!==0)throw Error(s(331));var C=Ue;if(Ue|=4,Cg(p.current),yg(p,p.current,b,r),Ue=C,br(0,!1),Qt&&typeof Qt.onPostCommitFiberRoot=="function")try{Qt.onPostCommitFiberRoot(Ls,p)}catch{}return!0}finally{ne.p=f,F.T=c,Bg(t,n)}}function zg(t,n,r){n=cn(r,n),n=qu(t.stateNode,n,2),t=Ri(t,n,2),t!==null&&(Bs(t,2),jn(t))}function ze(t,n,r){if(t.tag===3)zg(t,t,r);else for(;n!==null;){if(n.tag===3){zg(n,t,r);break}else if(n.tag===1){var c=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Pi===null||!Pi.has(c))){t=cn(r,t),r=Fp(2),c=Ri(n,r,2),c!==null&&(Hp(r,c,n,t),Bs(c,2),jn(c));break}}n=n.return}}function dd(t,n,r){var c=t.pingCache;if(c===null){c=t.pingCache=new tk;var f=new Set;c.set(n,f)}else f=c.get(n),f===void 0&&(f=new Set,c.set(n,f));f.has(r)||(id=!0,f.add(r),t=rk.bind(null,t,n,r),n.then(t,t))}function rk(t,n,r){var c=t.pingCache;c!==null&&c.delete(n),t.pingedLanes|=t.suspendedLanes&r,t.warmLanes&=~r,Ye===t&&(we&r)===r&&(at===4||at===3&&(we&62914560)===we&&300>Jt()-Zo?(Ue&2)===0&&ds(t,0):ad|=r,cs===we&&(cs=0)),jn(t)}function Fg(t,n){n===0&&(n=If()),t=ua(t,n),t!==null&&(Bs(t,n),jn(t))}function ok(t){var n=t.memoizedState,r=0;n!==null&&(r=n.retryLane),Fg(t,r)}function lk(t,n){var r=0;switch(t.tag){case 31:case 13:var c=t.stateNode,f=t.memoizedState;f!==null&&(r=f.retryLane);break;case 19:c=t.stateNode;break;case 22:c=t.stateNode._retryCache;break;default:throw Error(s(314))}c!==null&&c.delete(n),Fg(t,r)}function ck(t,n){return Ec(t,n)}var sl=null,fs=null,hd=!1,rl=!1,fd=!1,Li=0;function jn(t){t!==fs&&t.next===null&&(fs===null?sl=fs=t:fs=fs.next=t),rl=!0,hd||(hd=!0,dk())}function br(t,n){if(!fd&&rl){fd=!0;do for(var r=!1,c=sl;c!==null;){if(t!==0){var f=c.pendingLanes;if(f===0)var p=0;else{var b=c.suspendedLanes,C=c.pingedLanes;p=(1<<31-Xt(42|t)+1)-1,p&=f&~(b&~C),p=p&201326741?p&201326741|1:p?p|2:0}p!==0&&(r=!0,Kg(c,p))}else p=we,p=co(c,c===Ye?p:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(p&3)===0||Us(c,p)||(r=!0,Kg(c,p));c=c.next}while(r);fd=!1}}function uk(){Hg()}function Hg(){rl=hd=!1;var t=0;Li!==0&&Ck()&&(t=Li);for(var n=Jt(),r=null,c=sl;c!==null;){var f=c.next,p=Vg(c,n);p===0?(c.next=null,r===null?sl=f:r.next=f,f===null&&(fs=r)):(r=c,(t!==0||(p&3)!==0)&&(rl=!0)),c=f}yt!==0&&yt!==5||br(t),Li!==0&&(Li=0)}function Vg(t,n){for(var r=t.suspendedLanes,c=t.pingedLanes,f=t.expirationTimes,p=t.pendingLanes&-62914561;0<p;){var b=31-Xt(p),C=1<<b,w=f[b];w===-1?((C&r)===0||(C&c)!==0)&&(f[b]=LC(C,n)):w<=n&&(t.expiredLanes|=C),p&=~C}if(n=Ye,r=we,r=co(t,t===n?r:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),c=t.callbackNode,r===0||t===n&&(qe===2||qe===9)||t.cancelPendingCommit!==null)return c!==null&&c!==null&&_c(c),t.callbackNode=null,t.callbackPriority=0;if((r&3)===0||Us(t,r)){if(n=r&-r,n===t.callbackPriority)return n;switch(c!==null&&_c(c),Rc(r)){case 2:case 8:r=Pf;break;case 32:r=so;break;case 268435456:r=jf;break;default:r=so}return c=Gg.bind(null,t),r=Ec(r,c),t.callbackPriority=n,t.callbackNode=r,n}return c!==null&&c!==null&&_c(c),t.callbackPriority=2,t.callbackNode=null,2}function Gg(t,n){if(yt!==0&&yt!==5)return t.callbackNode=null,t.callbackPriority=0,null;var r=t.callbackNode;if(al()&&t.callbackNode!==r)return null;var c=we;return c=co(t,t===Ye?c:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),c===0?null:(wg(t,c,n),Vg(t,Jt()),t.callbackNode!=null&&t.callbackNode===r?Gg.bind(null,t):null)}function Kg(t,n){if(al())return null;wg(t,n,!0)}function dk(){kk(function(){(Ue&6)!==0?Ec(Of,uk):Hg()})}function md(){if(Li===0){var t=Za;t===0&&(t=ro,ro<<=1,(ro&261888)===0&&(ro=256)),Li=t}return Li}function Yg(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:mo(""+t)}function Jg(t,n){var r=n.ownerDocument.createElement("input");return r.name=n.name,r.value=n.value,t.id&&r.setAttribute("form",t.id),n.parentNode.insertBefore(r,n),t=new FormData(t),r.parentNode.removeChild(r),t}function hk(t,n,r,c,f){if(n==="submit"&&r&&r.stateNode===f){var p=Yg((f[Ut]||null).action),b=c.submitter;b&&(n=(n=b[Ut]||null)?Yg(n.formAction):b.getAttribute("formAction"),n!==null&&(p=n,b=null));var C=new yo("action","action",null,c,f);t.push({event:C,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Li!==0){var w=b?Jg(f,b):new FormData(f);Pu(r,{pending:!0,data:w,method:f.method,action:p},null,w)}}else typeof p=="function"&&(C.preventDefault(),w=b?Jg(f,b):new FormData(f),Pu(r,{pending:!0,data:w,method:f.method,action:p},p,w))},currentTarget:f}]})}}for(var pd=0;pd<Wc.length;pd++){var gd=Wc[pd],fk=gd.toLowerCase(),mk=gd[0].toUpperCase()+gd.slice(1);Cn(fk,"on"+mk)}Cn(_m,"onAnimationEnd"),Cn(wm,"onAnimationIteration"),Cn(xm,"onAnimationStart"),Cn("dblclick","onDoubleClick"),Cn("focusin","onFocus"),Cn("focusout","onBlur"),Cn(AT,"onTransitionRun"),Cn(NT,"onTransitionStart"),Cn(DT,"onTransitionCancel"),Cn(Rm,"onTransitionEnd"),Ua("onMouseEnter",["mouseout","mouseover"]),Ua("onMouseLeave",["mouseout","mouseover"]),Ua("onPointerEnter",["pointerout","pointerover"]),Ua("onPointerLeave",["pointerout","pointerover"]),ra("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ra("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ra("onBeforeInput",["compositionend","keypress","textInput","paste"]),ra("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ra("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ra("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Sr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),pk=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Sr));function Qg(t,n){n=(n&4)!==0;for(var r=0;r<t.length;r++){var c=t[r],f=c.event;c=c.listeners;e:{var p=void 0;if(n)for(var b=c.length-1;0<=b;b--){var C=c[b],w=C.instance,q=C.currentTarget;if(C=C.listener,w!==p&&f.isPropagationStopped())break e;p=C,f.currentTarget=q;try{p(f)}catch(G){Co(G)}f.currentTarget=null,p=w}else for(b=0;b<c.length;b++){if(C=c[b],w=C.instance,q=C.currentTarget,C=C.listener,w!==p&&f.isPropagationStopped())break e;p=C,f.currentTarget=q;try{p(f)}catch(G){Co(G)}f.currentTarget=null,p=w}}}}function ke(t,n){var r=n[Mc];r===void 0&&(r=n[Mc]=new Set);var c=t+"__bubble";r.has(c)||(Xg(n,t,2,!1),r.add(c))}function vd(t,n,r){var c=0;n&&(c|=4),Xg(r,t,c,n)}var ol="_reactListening"+Math.random().toString(36).slice(2);function yd(t){if(!t[ol]){t[ol]=!0,Hf.forEach(function(r){r!=="selectionchange"&&(pk.has(r)||vd(r,!1,t),vd(r,!0,t))});var n=t.nodeType===9?t:t.ownerDocument;n===null||n[ol]||(n[ol]=!0,vd("selectionchange",!1,n))}}function Xg(t,n,r,c){switch(_v(n)){case 2:var f=Hk;break;case 8:f=Vk;break;default:f=Od}r=f.bind(null,n,r,t),f=void 0,!Uc||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(f=!0),c?f!==void 0?t.addEventListener(n,r,{capture:!0,passive:f}):t.addEventListener(n,r,!0):f!==void 0?t.addEventListener(n,r,{passive:f}):t.addEventListener(n,r,!1)}function bd(t,n,r,c,f){var p=c;if((n&1)===0&&(n&2)===0&&c!==null)e:for(;;){if(c===null)return;var b=c.tag;if(b===3||b===4){var C=c.stateNode.containerInfo;if(C===f)break;if(b===4)for(b=c.return;b!==null;){var w=b.tag;if((w===3||w===4)&&b.stateNode.containerInfo===f)return;b=b.return}for(;C!==null;){if(b=ja(C),b===null)return;if(w=b.tag,w===5||w===6||w===26||w===27){c=p=b;continue e}C=C.parentNode}}c=c.return}tm(function(){var q=p,G=Ic(r),J=[];e:{var z=Mm.get(t);if(z!==void 0){var V=yo,oe=t;switch(t){case"keypress":if(go(r)===0)break e;case"keydown":case"keyup":V=lT;break;case"focusin":oe="focus",V=Fc;break;case"focusout":oe="blur",V=Fc;break;case"beforeblur":case"afterblur":V=Fc;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":V=am;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":V=XC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":V=dT;break;case _m:case wm:case xm:V=$C;break;case Rm:V=fT;break;case"scroll":case"scrollend":V=JC;break;case"wheel":V=pT;break;case"copy":case"cut":case"paste":V=tT;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":V=rm;break;case"toggle":case"beforetoggle":V=vT}var fe=(n&4)!==0,Ge=!fe&&(t==="scroll"||t==="scrollend"),j=fe?z!==null?z+"Capture":null:z;fe=[];for(var M=q,B;M!==null;){var K=M;if(B=K.stateNode,K=K.tag,K!==5&&K!==26&&K!==27||B===null||j===null||(K=Fs(M,j),K!=null&&fe.push(Cr(M,K,B))),Ge)break;M=M.return}0<fe.length&&(z=new V(z,oe,null,r,G),J.push({event:z,listeners:fe}))}}if((n&7)===0){e:{if(z=t==="mouseover"||t==="pointerover",V=t==="mouseout"||t==="pointerout",z&&r!==jc&&(oe=r.relatedTarget||r.fromElement)&&(ja(oe)||oe[Pa]))break e;if((V||z)&&(z=G.window===G?G:(z=G.ownerDocument)?z.defaultView||z.parentWindow:window,V?(oe=r.relatedTarget||r.toElement,V=q,oe=oe?ja(oe):null,oe!==null&&(Ge=l(oe),fe=oe.tag,oe!==Ge||fe!==5&&fe!==27&&fe!==6)&&(oe=null)):(V=null,oe=q),V!==oe)){if(fe=am,K="onMouseLeave",j="onMouseEnter",M="mouse",(t==="pointerout"||t==="pointerover")&&(fe=rm,K="onPointerLeave",j="onPointerEnter",M="pointer"),Ge=V==null?z:zs(V),B=oe==null?z:zs(oe),z=new fe(K,M+"leave",V,r,G),z.target=Ge,z.relatedTarget=B,K=null,ja(G)===q&&(fe=new fe(j,M+"enter",oe,r,G),fe.target=B,fe.relatedTarget=Ge,K=fe),Ge=K,V&&oe)t:{for(fe=gk,j=V,M=oe,B=0,K=j;K;K=fe(K))B++;K=0;for(var de=M;de;de=fe(de))K++;for(;0<B-K;)j=fe(j),B--;for(;0<K-B;)M=fe(M),K--;for(;B--;){if(j===M||M!==null&&j===M.alternate){fe=j;break t}j=fe(j),M=fe(M)}fe=null}else fe=null;V!==null&&Wg(J,z,V,fe,!1),oe!==null&&Ge!==null&&Wg(J,Ge,oe,fe,!0)}}e:{if(z=q?zs(q):window,V=z.nodeName&&z.nodeName.toLowerCase(),V==="select"||V==="input"&&z.type==="file")var Pe=mm;else if(hm(z))if(pm)Pe=xT;else{Pe=_T;var ce=ET}else V=z.nodeName,!V||V.toLowerCase()!=="input"||z.type!=="checkbox"&&z.type!=="radio"?q&&Pc(q.elementType)&&(Pe=mm):Pe=wT;if(Pe&&(Pe=Pe(t,q))){fm(J,Pe,r,G);break e}ce&&ce(t,z,q),t==="focusout"&&q&&z.type==="number"&&q.memoizedProps.value!=null&&Oc(z,"number",z.value)}switch(ce=q?zs(q):window,t){case"focusin":(hm(ce)||ce.contentEditable==="true")&&(Va=ce,Jc=q,Xs=null);break;case"focusout":Xs=Jc=Va=null;break;case"mousedown":Qc=!0;break;case"contextmenu":case"mouseup":case"dragend":Qc=!1,km(J,r,G);break;case"selectionchange":if(MT)break;case"keydown":case"keyup":km(J,r,G)}var be;if(Vc)e:{switch(t){case"compositionstart":var xe="onCompositionStart";break e;case"compositionend":xe="onCompositionEnd";break e;case"compositionupdate":xe="onCompositionUpdate";break e}xe=void 0}else Ha?um(t,r)&&(xe="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(xe="onCompositionStart");xe&&(om&&r.locale!=="ko"&&(Ha||xe!=="onCompositionStart"?xe==="onCompositionEnd"&&Ha&&(be=nm()):(Ci=G,Bc="value"in Ci?Ci.value:Ci.textContent,Ha=!0)),ce=ll(q,xe),0<ce.length&&(xe=new sm(xe,t,null,r,G),J.push({event:xe,listeners:ce}),be?xe.data=be:(be=dm(r),be!==null&&(xe.data=be)))),(be=bT?ST(t,r):CT(t,r))&&(xe=ll(q,"onBeforeInput"),0<xe.length&&(ce=new sm("onBeforeInput","beforeinput",null,r,G),J.push({event:ce,listeners:xe}),ce.data=be)),hk(J,t,q,r,G)}Qg(J,n)})}function Cr(t,n,r){return{instance:t,listener:n,currentTarget:r}}function ll(t,n){for(var r=n+"Capture",c=[];t!==null;){var f=t,p=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||p===null||(f=Fs(t,r),f!=null&&c.unshift(Cr(t,f,p)),f=Fs(t,n),f!=null&&c.push(Cr(t,f,p))),t.tag===3)return c;t=t.return}return[]}function gk(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function Wg(t,n,r,c,f){for(var p=n._reactName,b=[];r!==null&&r!==c;){var C=r,w=C.alternate,q=C.stateNode;if(C=C.tag,w!==null&&w===c)break;C!==5&&C!==26&&C!==27||q===null||(w=q,f?(q=Fs(r,p),q!=null&&b.unshift(Cr(r,q,w))):f||(q=Fs(r,p),q!=null&&b.push(Cr(r,q,w)))),r=r.return}b.length!==0&&t.push({event:n,listeners:b})}var vk=/\r\n?/g,yk=/\u0000|\uFFFD/g;function Zg(t){return(typeof t=="string"?t:""+t).replace(vk,`
`).replace(yk,"")}function $g(t,n){return n=Zg(n),Zg(t)===n}function Ve(t,n,r,c,f,p){switch(r){case"children":typeof c=="string"?n==="body"||n==="textarea"&&c===""||qa(t,c):(typeof c=="number"||typeof c=="bigint")&&n!=="body"&&qa(t,""+c);break;case"className":ho(t,"class",c);break;case"tabIndex":ho(t,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":ho(t,r,c);break;case"style":$f(t,c,p);break;case"data":if(n!=="object"){ho(t,"data",c);break}case"src":case"href":if(c===""&&(n!=="a"||r!=="href")){t.removeAttribute(r);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){t.removeAttribute(r);break}c=mo(""+c),t.setAttribute(r,c);break;case"action":case"formAction":if(typeof c=="function"){t.setAttribute(r,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof p=="function"&&(r==="formAction"?(n!=="input"&&Ve(t,n,"name",f.name,f,null),Ve(t,n,"formEncType",f.formEncType,f,null),Ve(t,n,"formMethod",f.formMethod,f,null),Ve(t,n,"formTarget",f.formTarget,f,null)):(Ve(t,n,"encType",f.encType,f,null),Ve(t,n,"method",f.method,f,null),Ve(t,n,"target",f.target,f,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){t.removeAttribute(r);break}c=mo(""+c),t.setAttribute(r,c);break;case"onClick":c!=null&&(t.onclick=Gn);break;case"onScroll":c!=null&&ke("scroll",t);break;case"onScrollEnd":c!=null&&ke("scrollend",t);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(s(61));if(r=c.__html,r!=null){if(f.children!=null)throw Error(s(60));t.innerHTML=r}}break;case"multiple":t.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":t.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){t.removeAttribute("xlink:href");break}r=mo(""+c),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(r,""+c):t.removeAttribute(r);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(r,""):t.removeAttribute(r);break;case"capture":case"download":c===!0?t.setAttribute(r,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(r,c):t.removeAttribute(r);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?t.setAttribute(r,c):t.removeAttribute(r);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?t.removeAttribute(r):t.setAttribute(r,c);break;case"popover":ke("beforetoggle",t),ke("toggle",t),uo(t,"popover",c);break;case"xlinkActuate":Vn(t,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":Vn(t,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":Vn(t,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":Vn(t,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":Vn(t,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":Vn(t,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":Vn(t,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":Vn(t,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":Vn(t,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":uo(t,"is",c);break;case"innerText":case"textContent":break;default:(!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(r=KC.get(r)||r,uo(t,r,c))}}function Sd(t,n,r,c,f,p){switch(r){case"style":$f(t,c,p);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(s(61));if(r=c.__html,r!=null){if(f.children!=null)throw Error(s(60));t.innerHTML=r}}break;case"children":typeof c=="string"?qa(t,c):(typeof c=="number"||typeof c=="bigint")&&qa(t,""+c);break;case"onScroll":c!=null&&ke("scroll",t);break;case"onScrollEnd":c!=null&&ke("scrollend",t);break;case"onClick":c!=null&&(t.onclick=Gn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Vf.hasOwnProperty(r))e:{if(r[0]==="o"&&r[1]==="n"&&(f=r.endsWith("Capture"),n=r.slice(2,f?r.length-7:void 0),p=t[Ut]||null,p=p!=null?p[r]:null,typeof p=="function"&&t.removeEventListener(n,p,f),typeof c=="function")){typeof p!="function"&&p!==null&&(r in t?t[r]=null:t.hasAttribute(r)&&t.removeAttribute(r)),t.addEventListener(n,c,f);break e}r in t?t[r]=c:c===!0?t.setAttribute(r,""):uo(t,r,c)}}}function xt(t,n,r){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ke("error",t),ke("load",t);var c=!1,f=!1,p;for(p in r)if(r.hasOwnProperty(p)){var b=r[p];if(b!=null)switch(p){case"src":c=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,n));default:Ve(t,n,p,b,r,null)}}f&&Ve(t,n,"srcSet",r.srcSet,r,null),c&&Ve(t,n,"src",r.src,r,null);return;case"input":ke("invalid",t);var C=p=b=f=null,w=null,q=null;for(c in r)if(r.hasOwnProperty(c)){var G=r[c];if(G!=null)switch(c){case"name":f=G;break;case"type":b=G;break;case"checked":w=G;break;case"defaultChecked":q=G;break;case"value":p=G;break;case"defaultValue":C=G;break;case"children":case"dangerouslySetInnerHTML":if(G!=null)throw Error(s(137,n));break;default:Ve(t,n,c,G,r,null)}}Qf(t,p,C,w,q,b,f,!1);return;case"select":ke("invalid",t),c=b=p=null;for(f in r)if(r.hasOwnProperty(f)&&(C=r[f],C!=null))switch(f){case"value":p=C;break;case"defaultValue":b=C;break;case"multiple":c=C;default:Ve(t,n,f,C,r,null)}n=p,r=b,t.multiple=!!c,n!=null?Ba(t,!!c,n,!1):r!=null&&Ba(t,!!c,r,!0);return;case"textarea":ke("invalid",t),p=f=c=null;for(b in r)if(r.hasOwnProperty(b)&&(C=r[b],C!=null))switch(b){case"value":c=C;break;case"defaultValue":f=C;break;case"children":p=C;break;case"dangerouslySetInnerHTML":if(C!=null)throw Error(s(91));break;default:Ve(t,n,b,C,r,null)}Wf(t,c,f,p);return;case"option":for(w in r)r.hasOwnProperty(w)&&(c=r[w],c!=null)&&(w==="selected"?t.selected=c&&typeof c!="function"&&typeof c!="symbol":Ve(t,n,w,c,r,null));return;case"dialog":ke("beforetoggle",t),ke("toggle",t),ke("cancel",t),ke("close",t);break;case"iframe":case"object":ke("load",t);break;case"video":case"audio":for(c=0;c<Sr.length;c++)ke(Sr[c],t);break;case"image":ke("error",t),ke("load",t);break;case"details":ke("toggle",t);break;case"embed":case"source":case"link":ke("error",t),ke("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(q in r)if(r.hasOwnProperty(q)&&(c=r[q],c!=null))switch(q){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,n));default:Ve(t,n,q,c,r,null)}return;default:if(Pc(n)){for(G in r)r.hasOwnProperty(G)&&(c=r[G],c!==void 0&&Sd(t,n,G,c,r,void 0));return}}for(C in r)r.hasOwnProperty(C)&&(c=r[C],c!=null&&Ve(t,n,C,c,r,null))}function bk(t,n,r,c){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,p=null,b=null,C=null,w=null,q=null,G=null;for(V in r){var J=r[V];if(r.hasOwnProperty(V)&&J!=null)switch(V){case"checked":break;case"value":break;case"defaultValue":w=J;default:c.hasOwnProperty(V)||Ve(t,n,V,null,c,J)}}for(var z in c){var V=c[z];if(J=r[z],c.hasOwnProperty(z)&&(V!=null||J!=null))switch(z){case"type":p=V;break;case"name":f=V;break;case"checked":q=V;break;case"defaultChecked":G=V;break;case"value":b=V;break;case"defaultValue":C=V;break;case"children":case"dangerouslySetInnerHTML":if(V!=null)throw Error(s(137,n));break;default:V!==J&&Ve(t,n,z,V,c,J)}}Dc(t,b,C,w,q,G,p,f);return;case"select":V=b=C=z=null;for(p in r)if(w=r[p],r.hasOwnProperty(p)&&w!=null)switch(p){case"value":break;case"multiple":V=w;default:c.hasOwnProperty(p)||Ve(t,n,p,null,c,w)}for(f in c)if(p=c[f],w=r[f],c.hasOwnProperty(f)&&(p!=null||w!=null))switch(f){case"value":z=p;break;case"defaultValue":C=p;break;case"multiple":b=p;default:p!==w&&Ve(t,n,f,p,c,w)}n=C,r=b,c=V,z!=null?Ba(t,!!r,z,!1):!!c!=!!r&&(n!=null?Ba(t,!!r,n,!0):Ba(t,!!r,r?[]:"",!1));return;case"textarea":V=z=null;for(C in r)if(f=r[C],r.hasOwnProperty(C)&&f!=null&&!c.hasOwnProperty(C))switch(C){case"value":break;case"children":break;default:Ve(t,n,C,null,c,f)}for(b in c)if(f=c[b],p=r[b],c.hasOwnProperty(b)&&(f!=null||p!=null))switch(b){case"value":z=f;break;case"defaultValue":V=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(s(91));break;default:f!==p&&Ve(t,n,b,f,c,p)}Xf(t,z,V);return;case"option":for(var oe in r)z=r[oe],r.hasOwnProperty(oe)&&z!=null&&!c.hasOwnProperty(oe)&&(oe==="selected"?t.selected=!1:Ve(t,n,oe,null,c,z));for(w in c)z=c[w],V=r[w],c.hasOwnProperty(w)&&z!==V&&(z!=null||V!=null)&&(w==="selected"?t.selected=z&&typeof z!="function"&&typeof z!="symbol":Ve(t,n,w,z,c,V));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var fe in r)z=r[fe],r.hasOwnProperty(fe)&&z!=null&&!c.hasOwnProperty(fe)&&Ve(t,n,fe,null,c,z);for(q in c)if(z=c[q],V=r[q],c.hasOwnProperty(q)&&z!==V&&(z!=null||V!=null))switch(q){case"children":case"dangerouslySetInnerHTML":if(z!=null)throw Error(s(137,n));break;default:Ve(t,n,q,z,c,V)}return;default:if(Pc(n)){for(var Ge in r)z=r[Ge],r.hasOwnProperty(Ge)&&z!==void 0&&!c.hasOwnProperty(Ge)&&Sd(t,n,Ge,void 0,c,z);for(G in c)z=c[G],V=r[G],!c.hasOwnProperty(G)||z===V||z===void 0&&V===void 0||Sd(t,n,G,z,c,V);return}}for(var j in r)z=r[j],r.hasOwnProperty(j)&&z!=null&&!c.hasOwnProperty(j)&&Ve(t,n,j,null,c,z);for(J in c)z=c[J],V=r[J],!c.hasOwnProperty(J)||z===V||z==null&&V==null||Ve(t,n,J,z,c,V)}function ev(t){switch(t){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Sk(){if(typeof performance.getEntriesByType=="function"){for(var t=0,n=0,r=performance.getEntriesByType("resource"),c=0;c<r.length;c++){var f=r[c],p=f.transferSize,b=f.initiatorType,C=f.duration;if(p&&C&&ev(b)){for(b=0,C=f.responseEnd,c+=1;c<r.length;c++){var w=r[c],q=w.startTime;if(q>C)break;var G=w.transferSize,J=w.initiatorType;G&&ev(J)&&(w=w.responseEnd,b+=G*(w<C?1:(C-q)/(w-q)))}if(--c,n+=8*(p+b)/(f.duration/1e3),t++,10<t)break}}if(0<t)return n/t/1e6}return navigator.connection&&(t=navigator.connection.downlink,typeof t=="number")?t:5}var Cd=null,Td=null;function cl(t){return t.nodeType===9?t:t.ownerDocument}function tv(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function nv(t,n){if(t===0)switch(n){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&n==="foreignObject"?0:t}function kd(t,n){return t==="textarea"||t==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.children=="bigint"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var Ed=null;function Ck(){var t=window.event;return t&&t.type==="popstate"?t===Ed?!1:(Ed=t,!0):(Ed=null,!1)}var iv=typeof setTimeout=="function"?setTimeout:void 0,Tk=typeof clearTimeout=="function"?clearTimeout:void 0,av=typeof Promise=="function"?Promise:void 0,kk=typeof queueMicrotask=="function"?queueMicrotask:typeof av<"u"?function(t){return av.resolve(null).then(t).catch(Ek)}:iv;function Ek(t){setTimeout(function(){throw t})}function Ui(t){return t==="head"}function sv(t,n){var r=n,c=0;do{var f=r.nextSibling;if(t.removeChild(r),f&&f.nodeType===8)if(r=f.data,r==="/$"||r==="/&"){if(c===0){t.removeChild(f),vs(n);return}c--}else if(r==="$"||r==="$?"||r==="$~"||r==="$!"||r==="&")c++;else if(r==="html")Tr(t.ownerDocument.documentElement);else if(r==="head"){r=t.ownerDocument.head,Tr(r);for(var p=r.firstChild;p;){var b=p.nextSibling,C=p.nodeName;p[qs]||C==="SCRIPT"||C==="STYLE"||C==="LINK"&&p.rel.toLowerCase()==="stylesheet"||r.removeChild(p),p=b}}else r==="body"&&Tr(t.ownerDocument.body);r=f}while(r);vs(n)}function rv(t,n){var r=t;t=0;do{var c=r.nextSibling;if(r.nodeType===1?n?(r._stashedDisplay=r.style.display,r.style.display="none"):(r.style.display=r._stashedDisplay||"",r.getAttribute("style")===""&&r.removeAttribute("style")):r.nodeType===3&&(n?(r._stashedText=r.nodeValue,r.nodeValue=""):r.nodeValue=r._stashedText||""),c&&c.nodeType===8)if(r=c.data,r==="/$"){if(t===0)break;t--}else r!=="$"&&r!=="$?"&&r!=="$~"&&r!=="$!"||t++;r=c}while(r)}function _d(t){var n=t.firstChild;for(n&&n.nodeType===10&&(n=n.nextSibling);n;){var r=n;switch(n=n.nextSibling,r.nodeName){case"HTML":case"HEAD":case"BODY":_d(r),Ac(r);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(r.rel.toLowerCase()==="stylesheet")continue}t.removeChild(r)}}function _k(t,n,r,c){for(;t.nodeType===1;){var f=r;if(t.nodeName.toLowerCase()!==n.toLowerCase()){if(!c&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(c){if(!t[qs])switch(n){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(p=t.getAttribute("rel"),p==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(p!==f.rel||t.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||t.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||t.getAttribute("title")!==(f.title==null?null:f.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(p=t.getAttribute("src"),(p!==(f.src==null?null:f.src)||t.getAttribute("type")!==(f.type==null?null:f.type)||t.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&p&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(n==="input"&&t.type==="hidden"){var p=f.name==null?null:""+f.name;if(f.type==="hidden"&&t.getAttribute("name")===p)return t}else return t;if(t=mn(t.nextSibling),t===null)break}return null}function wk(t,n,r){if(n==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!r||(t=mn(t.nextSibling),t===null))return null;return t}function ov(t,n){for(;t.nodeType!==8;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!n||(t=mn(t.nextSibling),t===null))return null;return t}function wd(t){return t.data==="$?"||t.data==="$~"}function xd(t){return t.data==="$!"||t.data==="$?"&&t.ownerDocument.readyState!=="loading"}function xk(t,n){var r=t.ownerDocument;if(t.data==="$~")t._reactRetry=n;else if(t.data!=="$?"||r.readyState!=="loading")n();else{var c=function(){n(),r.removeEventListener("DOMContentLoaded",c)};r.addEventListener("DOMContentLoaded",c),t._reactRetry=c}}function mn(t){for(;t!=null;t=t.nextSibling){var n=t.nodeType;if(n===1||n===3)break;if(n===8){if(n=t.data,n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"||n==="F!"||n==="F")break;if(n==="/$"||n==="/&")return null}}return t}var Rd=null;function lv(t){t=t.nextSibling;for(var n=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"||r==="/&"){if(n===0)return mn(t.nextSibling);n--}else r!=="$"&&r!=="$!"&&r!=="$?"&&r!=="$~"&&r!=="&"||n++}t=t.nextSibling}return null}function cv(t){t=t.previousSibling;for(var n=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"){if(n===0)return t;n--}else r!=="/$"&&r!=="/&"||n++}t=t.previousSibling}return null}function uv(t,n,r){switch(n=cl(r),t){case"html":if(t=n.documentElement,!t)throw Error(s(452));return t;case"head":if(t=n.head,!t)throw Error(s(453));return t;case"body":if(t=n.body,!t)throw Error(s(454));return t;default:throw Error(s(451))}}function Tr(t){for(var n=t.attributes;n.length;)t.removeAttributeNode(n[0]);Ac(t)}var pn=new Map,dv=new Set;function ul(t){return typeof t.getRootNode=="function"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var oi=ne.d;ne.d={f:Rk,r:Mk,D:Ak,C:Nk,L:Dk,m:Ok,X:jk,S:Pk,M:Ik};function Rk(){var t=oi.f(),n=tl();return t||n}function Mk(t){var n=Ia(t);n!==null&&n.tag===5&&n.type==="form"?Rp(n):oi.r(t)}var ms=typeof document>"u"?null:document;function hv(t,n,r){var c=ms;if(c&&typeof n=="string"&&n){var f=on(n);f='link[rel="'+t+'"][href="'+f+'"]',typeof r=="string"&&(f+='[crossorigin="'+r+'"]'),dv.has(f)||(dv.add(f),t={rel:t,crossOrigin:r,href:n},c.querySelector(f)===null&&(n=c.createElement("link"),xt(n,"link",t),bt(n),c.head.appendChild(n)))}}function Ak(t){oi.D(t),hv("dns-prefetch",t,null)}function Nk(t,n){oi.C(t,n),hv("preconnect",t,n)}function Dk(t,n,r){oi.L(t,n,r);var c=ms;if(c&&t&&n){var f='link[rel="preload"][as="'+on(n)+'"]';n==="image"&&r&&r.imageSrcSet?(f+='[imagesrcset="'+on(r.imageSrcSet)+'"]',typeof r.imageSizes=="string"&&(f+='[imagesizes="'+on(r.imageSizes)+'"]')):f+='[href="'+on(t)+'"]';var p=f;switch(n){case"style":p=ps(t);break;case"script":p=gs(t)}pn.has(p)||(t=y({rel:"preload",href:n==="image"&&r&&r.imageSrcSet?void 0:t,as:n},r),pn.set(p,t),c.querySelector(f)!==null||n==="style"&&c.querySelector(kr(p))||n==="script"&&c.querySelector(Er(p))||(n=c.createElement("link"),xt(n,"link",t),bt(n),c.head.appendChild(n)))}}function Ok(t,n){oi.m(t,n);var r=ms;if(r&&t){var c=n&&typeof n.as=="string"?n.as:"script",f='link[rel="modulepreload"][as="'+on(c)+'"][href="'+on(t)+'"]',p=f;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":p=gs(t)}if(!pn.has(p)&&(t=y({rel:"modulepreload",href:t},n),pn.set(p,t),r.querySelector(f)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(r.querySelector(Er(p)))return}c=r.createElement("link"),xt(c,"link",t),bt(c),r.head.appendChild(c)}}}function Pk(t,n,r){oi.S(t,n,r);var c=ms;if(c&&t){var f=La(c).hoistableStyles,p=ps(t);n=n||"default";var b=f.get(p);if(!b){var C={loading:0,preload:null};if(b=c.querySelector(kr(p)))C.loading=5;else{t=y({rel:"stylesheet",href:t,"data-precedence":n},r),(r=pn.get(p))&&Md(t,r);var w=b=c.createElement("link");bt(w),xt(w,"link",t),w._p=new Promise(function(q,G){w.onload=q,w.onerror=G}),w.addEventListener("load",function(){C.loading|=1}),w.addEventListener("error",function(){C.loading|=2}),C.loading|=4,dl(b,n,c)}b={type:"stylesheet",instance:b,count:1,state:C},f.set(p,b)}}}function jk(t,n){oi.X(t,n);var r=ms;if(r&&t){var c=La(r).hoistableScripts,f=gs(t),p=c.get(f);p||(p=r.querySelector(Er(f)),p||(t=y({src:t,async:!0},n),(n=pn.get(f))&&Ad(t,n),p=r.createElement("script"),bt(p),xt(p,"link",t),r.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},c.set(f,p))}}function Ik(t,n){oi.M(t,n);var r=ms;if(r&&t){var c=La(r).hoistableScripts,f=gs(t),p=c.get(f);p||(p=r.querySelector(Er(f)),p||(t=y({src:t,async:!0,type:"module"},n),(n=pn.get(f))&&Ad(t,n),p=r.createElement("script"),bt(p),xt(p,"link",t),r.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},c.set(f,p))}}function fv(t,n,r,c){var f=(f=ye.current)?ul(f):null;if(!f)throw Error(s(446));switch(t){case"meta":case"title":return null;case"style":return typeof r.precedence=="string"&&typeof r.href=="string"?(n=ps(r.href),r=La(f).hoistableStyles,c=r.get(n),c||(c={type:"style",instance:null,count:0,state:null},r.set(n,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(r.rel==="stylesheet"&&typeof r.href=="string"&&typeof r.precedence=="string"){t=ps(r.href);var p=La(f).hoistableStyles,b=p.get(t);if(b||(f=f.ownerDocument||f,b={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},p.set(t,b),(p=f.querySelector(kr(t)))&&!p._p&&(b.instance=p,b.state.loading=5),pn.has(t)||(r={rel:"preload",as:"style",href:r.href,crossOrigin:r.crossOrigin,integrity:r.integrity,media:r.media,hrefLang:r.hrefLang,referrerPolicy:r.referrerPolicy},pn.set(t,r),p||Lk(f,t,r,b.state))),n&&c===null)throw Error(s(528,""));return b}if(n&&c!==null)throw Error(s(529,""));return null;case"script":return n=r.async,r=r.src,typeof r=="string"&&n&&typeof n!="function"&&typeof n!="symbol"?(n=gs(r),r=La(f).hoistableScripts,c=r.get(n),c||(c={type:"script",instance:null,count:0,state:null},r.set(n,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,t))}}function ps(t){return'href="'+on(t)+'"'}function kr(t){return'link[rel="stylesheet"]['+t+"]"}function mv(t){return y({},t,{"data-precedence":t.precedence,precedence:null})}function Lk(t,n,r,c){t.querySelector('link[rel="preload"][as="style"]['+n+"]")?c.loading=1:(n=t.createElement("link"),c.preload=n,n.addEventListener("load",function(){return c.loading|=1}),n.addEventListener("error",function(){return c.loading|=2}),xt(n,"link",r),bt(n),t.head.appendChild(n))}function gs(t){return'[src="'+on(t)+'"]'}function Er(t){return"script[async]"+t}function pv(t,n,r){if(n.count++,n.instance===null)switch(n.type){case"style":var c=t.querySelector('style[data-href~="'+on(r.href)+'"]');if(c)return n.instance=c,bt(c),c;var f=y({},r,{"data-href":r.href,"data-precedence":r.precedence,href:null,precedence:null});return c=(t.ownerDocument||t).createElement("style"),bt(c),xt(c,"style",f),dl(c,r.precedence,t),n.instance=c;case"stylesheet":f=ps(r.href);var p=t.querySelector(kr(f));if(p)return n.state.loading|=4,n.instance=p,bt(p),p;c=mv(r),(f=pn.get(f))&&Md(c,f),p=(t.ownerDocument||t).createElement("link"),bt(p);var b=p;return b._p=new Promise(function(C,w){b.onload=C,b.onerror=w}),xt(p,"link",c),n.state.loading|=4,dl(p,r.precedence,t),n.instance=p;case"script":return p=gs(r.src),(f=t.querySelector(Er(p)))?(n.instance=f,bt(f),f):(c=r,(f=pn.get(p))&&(c=y({},r),Ad(c,f)),t=t.ownerDocument||t,f=t.createElement("script"),bt(f),xt(f,"link",c),t.head.appendChild(f),n.instance=f);case"void":return null;default:throw Error(s(443,n.type))}else n.type==="stylesheet"&&(n.state.loading&4)===0&&(c=n.instance,n.state.loading|=4,dl(c,r.precedence,t));return n.instance}function dl(t,n,r){for(var c=r.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=c.length?c[c.length-1]:null,p=f,b=0;b<c.length;b++){var C=c[b];if(C.dataset.precedence===n)p=C;else if(p!==f)break}p?p.parentNode.insertBefore(t,p.nextSibling):(n=r.nodeType===9?r.head:r,n.insertBefore(t,n.firstChild))}function Md(t,n){t.crossOrigin==null&&(t.crossOrigin=n.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=n.referrerPolicy),t.title==null&&(t.title=n.title)}function Ad(t,n){t.crossOrigin==null&&(t.crossOrigin=n.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=n.referrerPolicy),t.integrity==null&&(t.integrity=n.integrity)}var hl=null;function gv(t,n,r){if(hl===null){var c=new Map,f=hl=new Map;f.set(r,c)}else f=hl,c=f.get(r),c||(c=new Map,f.set(r,c));if(c.has(t))return c;for(c.set(t,null),r=r.getElementsByTagName(t),f=0;f<r.length;f++){var p=r[f];if(!(p[qs]||p[kt]||t==="link"&&p.getAttribute("rel")==="stylesheet")&&p.namespaceURI!=="http://www.w3.org/2000/svg"){var b=p.getAttribute(n)||"";b=t+b;var C=c.get(b);C?C.push(p):c.set(b,[p])}}return c}function vv(t,n,r){t=t.ownerDocument||t,t.head.insertBefore(r,n==="title"?t.querySelector("head > title"):null)}function Uk(t,n,r){if(r===1||n.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof n.precedence!="string"||typeof n.href!="string"||n.href==="")break;return!0;case"link":if(typeof n.rel!="string"||typeof n.href!="string"||n.href===""||n.onLoad||n.onError)break;return n.rel==="stylesheet"?(t=n.disabled,typeof n.precedence=="string"&&t==null):!0;case"script":if(n.async&&typeof n.async!="function"&&typeof n.async!="symbol"&&!n.onLoad&&!n.onError&&n.src&&typeof n.src=="string")return!0}return!1}function yv(t){return!(t.type==="stylesheet"&&(t.state.loading&3)===0)}function Bk(t,n,r,c){if(r.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(r.state.loading&4)===0){if(r.instance===null){var f=ps(c.href),p=n.querySelector(kr(f));if(p){n=p._p,n!==null&&typeof n=="object"&&typeof n.then=="function"&&(t.count++,t=fl.bind(t),n.then(t,t)),r.state.loading|=4,r.instance=p,bt(p);return}p=n.ownerDocument||n,c=mv(c),(f=pn.get(f))&&Md(c,f),p=p.createElement("link"),bt(p);var b=p;b._p=new Promise(function(C,w){b.onload=C,b.onerror=w}),xt(p,"link",c),r.instance=p}t.stylesheets===null&&(t.stylesheets=new Map),t.stylesheets.set(r,n),(n=r.state.preload)&&(r.state.loading&3)===0&&(t.count++,r=fl.bind(t),n.addEventListener("load",r),n.addEventListener("error",r))}}var Nd=0;function qk(t,n){return t.stylesheets&&t.count===0&&pl(t,t.stylesheets),0<t.count||0<t.imgCount?function(r){var c=setTimeout(function(){if(t.stylesheets&&pl(t,t.stylesheets),t.unsuspend){var p=t.unsuspend;t.unsuspend=null,p()}},6e4+n);0<t.imgBytes&&Nd===0&&(Nd=62500*Sk());var f=setTimeout(function(){if(t.waitingForImages=!1,t.count===0&&(t.stylesheets&&pl(t,t.stylesheets),t.unsuspend)){var p=t.unsuspend;t.unsuspend=null,p()}},(t.imgBytes>Nd?50:800)+n);return t.unsuspend=r,function(){t.unsuspend=null,clearTimeout(c),clearTimeout(f)}}:null}function fl(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)pl(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var ml=null;function pl(t,n){t.stylesheets=null,t.unsuspend!==null&&(t.count++,ml=new Map,n.forEach(zk,t),ml=null,fl.call(t))}function zk(t,n){if(!(n.state.loading&4)){var r=ml.get(t);if(r)var c=r.get(null);else{r=new Map,ml.set(t,r);for(var f=t.querySelectorAll("link[data-precedence],style[data-precedence]"),p=0;p<f.length;p++){var b=f[p];(b.nodeName==="LINK"||b.getAttribute("media")!=="not all")&&(r.set(b.dataset.precedence,b),c=b)}c&&r.set(null,c)}f=n.instance,b=f.getAttribute("data-precedence"),p=r.get(b)||c,p===c&&r.set(null,f),r.set(b,f),this.count++,c=fl.bind(this),f.addEventListener("load",c),f.addEventListener("error",c),p?p.parentNode.insertBefore(f,p.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(f,t.firstChild)),n.state.loading|=4}}var _r={$$typeof:L,Provider:null,Consumer:null,_currentValue:he,_currentValue2:he,_threadCount:0};function Fk(t,n,r,c,f,p,b,C,w){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=wc(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=wc(0),this.hiddenUpdates=wc(null),this.identifierPrefix=c,this.onUncaughtError=f,this.onCaughtError=p,this.onRecoverableError=b,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=w,this.incompleteTransitions=new Map}function bv(t,n,r,c,f,p,b,C,w,q,G,J){return t=new Fk(t,n,r,b,w,q,G,J,C),n=1,p===!0&&(n|=24),p=Zt(3,null,null,n),t.current=p,p.stateNode=t,n=uu(),n.refCount++,t.pooledCache=n,n.refCount++,p.memoizedState={element:c,isDehydrated:r,cache:n},mu(p),t}function Sv(t){return t?(t=Ya,t):Ya}function Cv(t,n,r,c,f,p){f=Sv(f),c.context===null?c.context=f:c.pendingContext=f,c=xi(n),c.payload={element:r},p=p===void 0?null:p,p!==null&&(c.callback=p),r=Ri(t,c,n),r!==null&&(Vt(r,t,n),ir(r,t,n))}function Tv(t,n){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<n?r:n}}function Dd(t,n){Tv(t,n),(t=t.alternate)&&Tv(t,n)}function kv(t){if(t.tag===13||t.tag===31){var n=ua(t,67108864);n!==null&&Vt(n,t,67108864),Dd(t,67108864)}}function Ev(t){if(t.tag===13||t.tag===31){var n=an();n=xc(n);var r=ua(t,n);r!==null&&Vt(r,t,n),Dd(t,n)}}var gl=!0;function Hk(t,n,r,c){var f=F.T;F.T=null;var p=ne.p;try{ne.p=2,Od(t,n,r,c)}finally{ne.p=p,F.T=f}}function Vk(t,n,r,c){var f=F.T;F.T=null;var p=ne.p;try{ne.p=8,Od(t,n,r,c)}finally{ne.p=p,F.T=f}}function Od(t,n,r,c){if(gl){var f=Pd(c);if(f===null)bd(t,n,c,vl,r),wv(t,c);else if(Kk(f,t,n,r,c))c.stopPropagation();else if(wv(t,c),n&4&&-1<Gk.indexOf(t)){for(;f!==null;){var p=Ia(f);if(p!==null)switch(p.tag){case 3:if(p=p.stateNode,p.current.memoizedState.isDehydrated){var b=sa(p.pendingLanes);if(b!==0){var C=p;for(C.pendingLanes|=2,C.entangledLanes|=2;b;){var w=1<<31-Xt(b);C.entanglements[1]|=w,b&=~w}jn(p),(Ue&6)===0&&($o=Jt()+500,br(0))}}break;case 31:case 13:C=ua(p,2),C!==null&&Vt(C,p,2),tl(),Dd(p,2)}if(p=Pd(c),p===null&&bd(t,n,c,vl,r),p===f)break;f=p}f!==null&&c.stopPropagation()}else bd(t,n,c,null,r)}}function Pd(t){return t=Ic(t),jd(t)}var vl=null;function jd(t){if(vl=null,t=ja(t),t!==null){var n=l(t);if(n===null)t=null;else{var r=n.tag;if(r===13){if(t=d(n),t!==null)return t;t=null}else if(r===31){if(t=u(n),t!==null)return t;t=null}else if(r===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;t=null}else n!==t&&(t=null)}}return vl=t,null}function _v(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(AC()){case Of:return 2;case Pf:return 8;case so:case NC:return 32;case jf:return 268435456;default:return 32}default:return 32}}var Id=!1,Bi=null,qi=null,zi=null,wr=new Map,xr=new Map,Fi=[],Gk="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function wv(t,n){switch(t){case"focusin":case"focusout":Bi=null;break;case"dragenter":case"dragleave":qi=null;break;case"mouseover":case"mouseout":zi=null;break;case"pointerover":case"pointerout":wr.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":xr.delete(n.pointerId)}}function Rr(t,n,r,c,f,p){return t===null||t.nativeEvent!==p?(t={blockedOn:n,domEventName:r,eventSystemFlags:c,nativeEvent:p,targetContainers:[f]},n!==null&&(n=Ia(n),n!==null&&kv(n)),t):(t.eventSystemFlags|=c,n=t.targetContainers,f!==null&&n.indexOf(f)===-1&&n.push(f),t)}function Kk(t,n,r,c,f){switch(n){case"focusin":return Bi=Rr(Bi,t,n,r,c,f),!0;case"dragenter":return qi=Rr(qi,t,n,r,c,f),!0;case"mouseover":return zi=Rr(zi,t,n,r,c,f),!0;case"pointerover":var p=f.pointerId;return wr.set(p,Rr(wr.get(p)||null,t,n,r,c,f)),!0;case"gotpointercapture":return p=f.pointerId,xr.set(p,Rr(xr.get(p)||null,t,n,r,c,f)),!0}return!1}function xv(t){var n=ja(t.target);if(n!==null){var r=l(n);if(r!==null){if(n=r.tag,n===13){if(n=d(r),n!==null){t.blockedOn=n,zf(t.priority,function(){Ev(r)});return}}else if(n===31){if(n=u(r),n!==null){t.blockedOn=n,zf(t.priority,function(){Ev(r)});return}}else if(n===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function yl(t){if(t.blockedOn!==null)return!1;for(var n=t.targetContainers;0<n.length;){var r=Pd(t.nativeEvent);if(r===null){r=t.nativeEvent;var c=new r.constructor(r.type,r);jc=c,r.target.dispatchEvent(c),jc=null}else return n=Ia(r),n!==null&&kv(n),t.blockedOn=r,!1;n.shift()}return!0}function Rv(t,n,r){yl(t)&&r.delete(n)}function Yk(){Id=!1,Bi!==null&&yl(Bi)&&(Bi=null),qi!==null&&yl(qi)&&(qi=null),zi!==null&&yl(zi)&&(zi=null),wr.forEach(Rv),xr.forEach(Rv)}function bl(t,n){t.blockedOn===n&&(t.blockedOn=null,Id||(Id=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Yk)))}var Sl=null;function Mv(t){Sl!==t&&(Sl=t,a.unstable_scheduleCallback(a.unstable_NormalPriority,function(){Sl===t&&(Sl=null);for(var n=0;n<t.length;n+=3){var r=t[n],c=t[n+1],f=t[n+2];if(typeof c!="function"){if(jd(c||r)===null)continue;break}var p=Ia(r);p!==null&&(t.splice(n,3),n-=3,Pu(p,{pending:!0,data:f,method:r.method,action:c},c,f))}}))}function vs(t){function n(w){return bl(w,t)}Bi!==null&&bl(Bi,t),qi!==null&&bl(qi,t),zi!==null&&bl(zi,t),wr.forEach(n),xr.forEach(n);for(var r=0;r<Fi.length;r++){var c=Fi[r];c.blockedOn===t&&(c.blockedOn=null)}for(;0<Fi.length&&(r=Fi[0],r.blockedOn===null);)xv(r),r.blockedOn===null&&Fi.shift();if(r=(t.ownerDocument||t).$$reactFormReplay,r!=null)for(c=0;c<r.length;c+=3){var f=r[c],p=r[c+1],b=f[Ut]||null;if(typeof p=="function")b||Mv(r);else if(b){var C=null;if(p&&p.hasAttribute("formAction")){if(f=p,b=p[Ut]||null)C=b.formAction;else if(jd(f)!==null)continue}else C=b.action;typeof C=="function"?r[c+1]=C:(r.splice(c,3),c-=3),Mv(r)}}}function Av(){function t(p){p.canIntercept&&p.info==="react-transition"&&p.intercept({handler:function(){return new Promise(function(b){return f=b})},focusReset:"manual",scroll:"manual"})}function n(){f!==null&&(f(),f=null),c||setTimeout(r,20)}function r(){if(!c&&!navigation.transition){var p=navigation.currentEntry;p&&p.url!=null&&navigation.navigate(p.url,{state:p.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,f=null;return navigation.addEventListener("navigate",t),navigation.addEventListener("navigatesuccess",n),navigation.addEventListener("navigateerror",n),setTimeout(r,100),function(){c=!0,navigation.removeEventListener("navigate",t),navigation.removeEventListener("navigatesuccess",n),navigation.removeEventListener("navigateerror",n),f!==null&&(f(),f=null)}}}function Ld(t){this._internalRoot=t}Cl.prototype.render=Ld.prototype.render=function(t){var n=this._internalRoot;if(n===null)throw Error(s(409));var r=n.current,c=an();Cv(r,c,t,n,null,null)},Cl.prototype.unmount=Ld.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var n=t.containerInfo;Cv(t.current,2,null,t,null,null),tl(),n[Pa]=null}};function Cl(t){this._internalRoot=t}Cl.prototype.unstable_scheduleHydration=function(t){if(t){var n=qf();t={blockedOn:null,target:t,priority:n};for(var r=0;r<Fi.length&&n!==0&&n<Fi[r].priority;r++);Fi.splice(r,0,t),r===0&&xv(t)}};var Nv=e.version;if(Nv!=="19.2.4")throw Error(s(527,Nv,"19.2.4"));ne.findDOMNode=function(t){var n=t._reactInternals;if(n===void 0)throw typeof t.render=="function"?Error(s(188)):(t=Object.keys(t).join(","),Error(s(268,t)));return t=m(n),t=t!==null?g(t):null,t=t===null?null:t.stateNode,t};var Jk={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:F,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Tl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Tl.isDisabled&&Tl.supportsFiber)try{Ls=Tl.inject(Jk),Qt=Tl}catch{}}return Ar.createRoot=function(t,n){if(!o(t))throw Error(s(299));var r=!1,c="",f=Up,p=Bp,b=qp;return n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(c=n.identifierPrefix),n.onUncaughtError!==void 0&&(f=n.onUncaughtError),n.onCaughtError!==void 0&&(p=n.onCaughtError),n.onRecoverableError!==void 0&&(b=n.onRecoverableError)),n=bv(t,1,!1,null,null,r,c,null,f,p,b,Av),t[Pa]=n.current,yd(t),new Ld(n)},Ar.hydrateRoot=function(t,n,r){if(!o(t))throw Error(s(299));var c=!1,f="",p=Up,b=Bp,C=qp,w=null;return r!=null&&(r.unstable_strictMode===!0&&(c=!0),r.identifierPrefix!==void 0&&(f=r.identifierPrefix),r.onUncaughtError!==void 0&&(p=r.onUncaughtError),r.onCaughtError!==void 0&&(b=r.onCaughtError),r.onRecoverableError!==void 0&&(C=r.onRecoverableError),r.formState!==void 0&&(w=r.formState)),n=bv(t,1,!0,n,r??null,c,f,w,p,b,C,Av),n.context=Sv(null),r=n.current,c=an(),c=xc(c),f=xi(c),f.callback=null,Ri(r,f,c),r=c,n.current.lanes=r,Bs(n,r),jn(n),t[Pa]=n.current,yd(t),new Cl(n)},Ar.version="19.2.4",Ar}var zv;function r1(){if(zv)return qd.exports;zv=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(e){console.error(e)}}return a(),qd.exports=s1(),qd.exports}var o1=r1();var Fv="popstate";function l1(a={}){function e(s,o){let{pathname:l,search:d,hash:u}=s.location;return mh("",{pathname:l,search:d,hash:u},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function i(s,o){return typeof o=="string"?o:Kr(o)}return u1(e,i,null,a)}function nt(a,e){if(a===!1||a===null||typeof a>"u")throw new Error(e)}function Nn(a,e){if(!a){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function c1(){return Math.random().toString(36).substring(2,10)}function Hv(a,e){return{usr:a.state,key:a.key,idx:e}}function mh(a,e,i=null,s){return{pathname:typeof a=="string"?a:a.pathname,search:"",hash:"",...typeof e=="string"?Ps(e):e,state:i,key:e&&e.key||s||c1()}}function Kr({pathname:a="/",search:e="",hash:i=""}){return e&&e!=="?"&&(a+=e.charAt(0)==="?"?e:"?"+e),i&&i!=="#"&&(a+=i.charAt(0)==="#"?i:"#"+i),a}function Ps(a){let e={};if(a){let i=a.indexOf("#");i>=0&&(e.hash=a.substring(i),a=a.substring(0,i));let s=a.indexOf("?");s>=0&&(e.search=a.substring(s),a=a.substring(0,s)),a&&(e.pathname=a)}return e}function u1(a,e,i,s={}){let{window:o=document.defaultView,v5Compat:l=!1}=s,d=o.history,u="POP",h=null,m=g();m==null&&(m=0,d.replaceState({...d.state,idx:m},""));function g(){return(d.state||{idx:null}).idx}function y(){u="POP";let k=g(),R=k==null?null:k-m;m=k,h&&h({action:u,location:E.location,delta:R})}function S(k,R){u="PUSH";let O=mh(E.location,k,R);m=g()+1;let L=Hv(O,m),D=E.createHref(O);try{d.pushState(L,"",D)}catch(I){if(I instanceof DOMException&&I.name==="DataCloneError")throw I;o.location.assign(D)}l&&h&&h({action:u,location:E.location,delta:1})}function T(k,R){u="REPLACE";let O=mh(E.location,k,R);m=g();let L=Hv(O,m),D=E.createHref(O);d.replaceState(L,"",D),l&&h&&h({action:u,location:E.location,delta:0})}function x(k){return d1(k)}let E={get action(){return u},get location(){return a(o,d)},listen(k){if(h)throw new Error("A history only accepts one active listener");return o.addEventListener(Fv,y),h=k,()=>{o.removeEventListener(Fv,y),h=null}},createHref(k){return e(o,k)},createURL:x,encodeLocation(k){let R=x(k);return{pathname:R.pathname,search:R.search,hash:R.hash}},push:S,replace:T,go(k){return d.go(k)}};return E}function d1(a,e=!1){let i="http://localhost";typeof window<"u"&&(i=window.location.origin!=="null"?window.location.origin:window.location.href),nt(i,"No window.location.(origin|href) available to create URL");let s=typeof a=="string"?a:Kr(a);return s=s.replace(/ $/,"%20"),!e&&s.startsWith("//")&&(s=i+s),new URL(s,i)}function Y0(a,e,i="/"){return h1(a,e,i,!1)}function h1(a,e,i,s){let o=typeof e=="string"?Ps(e):e,l=vi(o.pathname||"/",i);if(l==null)return null;let d=J0(a);f1(d);let u=null;for(let h=0;u==null&&h<d.length;++h){let m=E1(l);u=T1(d[h],m,s)}return u}function J0(a,e=[],i=[],s="",o=!1){let l=(d,u,h=o,m)=>{let g={relativePath:m===void 0?d.path||"":m,caseSensitive:d.caseSensitive===!0,childrenIndex:u,route:d};if(g.relativePath.startsWith("/")){if(!g.relativePath.startsWith(s)&&h)return;nt(g.relativePath.startsWith(s),`Absolute route path "${g.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),g.relativePath=g.relativePath.slice(s.length)}let y=gi([s,g.relativePath]),S=i.concat(g);d.children&&d.children.length>0&&(nt(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${y}".`),J0(d.children,e,S,y,h)),!(d.path==null&&!d.index)&&e.push({path:y,score:S1(y,d.index),routesMeta:S})};return a.forEach((d,u)=>{if(d.path===""||!d.path?.includes("?"))l(d,u);else for(let h of Q0(d.path))l(d,u,!0,h)}),e}function Q0(a){let e=a.split("/");if(e.length===0)return[];let[i,...s]=e,o=i.endsWith("?"),l=i.replace(/\?$/,"");if(s.length===0)return o?[l,""]:[l];let d=Q0(s.join("/")),u=[];return u.push(...d.map(h=>h===""?l:[l,h].join("/"))),o&&u.push(...d),u.map(h=>a.startsWith("/")&&h===""?"/":h)}function f1(a){a.sort((e,i)=>e.score!==i.score?i.score-e.score:C1(e.routesMeta.map(s=>s.childrenIndex),i.routesMeta.map(s=>s.childrenIndex)))}var m1=/^:[\w-]+$/,p1=3,g1=2,v1=1,y1=10,b1=-2,Vv=a=>a==="*";function S1(a,e){let i=a.split("/"),s=i.length;return i.some(Vv)&&(s+=b1),e&&(s+=g1),i.filter(o=>!Vv(o)).reduce((o,l)=>o+(m1.test(l)?p1:l===""?v1:y1),s)}function C1(a,e){return a.length===e.length&&a.slice(0,-1).every((s,o)=>s===e[o])?a[a.length-1]-e[e.length-1]:0}function T1(a,e,i=!1){let{routesMeta:s}=a,o={},l="/",d=[];for(let u=0;u<s.length;++u){let h=s[u],m=u===s.length-1,g=l==="/"?e:e.slice(l.length)||"/",y=Vl({path:h.relativePath,caseSensitive:h.caseSensitive,end:m},g),S=h.route;if(!y&&m&&i&&!s[s.length-1].route.index&&(y=Vl({path:h.relativePath,caseSensitive:h.caseSensitive,end:!1},g)),!y)return null;Object.assign(o,y.params),d.push({params:o,pathname:gi([l,y.pathname]),pathnameBase:R1(gi([l,y.pathnameBase])),route:S}),y.pathnameBase!=="/"&&(l=gi([l,y.pathnameBase]))}return d}function Vl(a,e){typeof a=="string"&&(a={path:a,caseSensitive:!1,end:!0});let[i,s]=k1(a.path,a.caseSensitive,a.end),o=e.match(i);if(!o)return null;let l=o[0],d=l.replace(/(.)\/+$/,"$1"),u=o.slice(1);return{params:s.reduce((m,{paramName:g,isOptional:y},S)=>{if(g==="*"){let x=u[S]||"";d=l.slice(0,l.length-x.length).replace(/(.)\/+$/,"$1")}const T=u[S];return y&&!T?m[g]=void 0:m[g]=(T||"").replace(/%2F/g,"/"),m},{}),pathname:l,pathnameBase:d,pattern:a}}function k1(a,e=!1,i=!0){Nn(a==="*"||!a.endsWith("*")||a.endsWith("/*"),`Route path "${a}" will be treated as if it were "${a.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${a.replace(/\*$/,"/*")}".`);let s=[],o="^"+a.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,u,h)=>(s.push({paramName:u,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return a.endsWith("*")?(s.push({paramName:"*"}),o+=a==="*"||a==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):i?o+="\\/*$":a!==""&&a!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,e?void 0:"i"),s]}function E1(a){try{return a.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Nn(!1,`The URL path "${a}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),a}}function vi(a,e){if(e==="/")return a;if(!a.toLowerCase().startsWith(e.toLowerCase()))return null;let i=e.endsWith("/")?e.length-1:e.length,s=a.charAt(i);return s&&s!=="/"?null:a.slice(i)||"/"}var _1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function w1(a,e="/"){let{pathname:i,search:s="",hash:o=""}=typeof a=="string"?Ps(a):a,l;return i?(i=i.replace(/\/\/+/g,"/"),i.startsWith("/")?l=Gv(i.substring(1),"/"):l=Gv(i,e)):l=e,{pathname:l,search:M1(s),hash:A1(o)}}function Gv(a,e){let i=e.replace(/\/+$/,"").split("/");return a.split("/").forEach(o=>{o===".."?i.length>1&&i.pop():o!=="."&&i.push(o)}),i.length>1?i.join("/"):"/"}function Vd(a,e,i,s){return`Cannot include a '${a}' character in a manually specified \`to.${e}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${i}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function x1(a){return a.filter((e,i)=>i===0||e.route.path&&e.route.path.length>0)}function X0(a){let e=x1(a);return e.map((i,s)=>s===e.length-1?i.pathname:i.pathnameBase)}function W0(a,e,i,s=!1){let o;typeof a=="string"?o=Ps(a):(o={...a},nt(!o.pathname||!o.pathname.includes("?"),Vd("?","pathname","search",o)),nt(!o.pathname||!o.pathname.includes("#"),Vd("#","pathname","hash",o)),nt(!o.search||!o.search.includes("#"),Vd("#","search","hash",o)));let l=a===""||o.pathname==="",d=l?"/":o.pathname,u;if(d==null)u=i;else{let y=e.length-1;if(!s&&d.startsWith("..")){let S=d.split("/");for(;S[0]==="..";)S.shift(),y-=1;o.pathname=S.join("/")}u=y>=0?e[y]:"/"}let h=w1(o,u),m=d&&d!=="/"&&d.endsWith("/"),g=(l||d===".")&&i.endsWith("/");return!h.pathname.endsWith("/")&&(m||g)&&(h.pathname+="/"),h}var gi=a=>a.join("/").replace(/\/\/+/g,"/"),R1=a=>a.replace(/\/+$/,"").replace(/^\/*/,"/"),M1=a=>!a||a==="?"?"":a.startsWith("?")?a:"?"+a,A1=a=>!a||a==="#"?"":a.startsWith("#")?a:"#"+a,N1=class{constructor(a,e,i,s=!1){this.status=a,this.statusText=e||"",this.internal=s,i instanceof Error?(this.data=i.toString(),this.error=i):this.data=i}};function D1(a){return a!=null&&typeof a.status=="number"&&typeof a.statusText=="string"&&typeof a.internal=="boolean"&&"data"in a}function O1(a){return a.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var Z0=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function $0(a,e){let i=a;if(typeof i!="string"||!_1.test(i))return{absoluteURL:void 0,isExternal:!1,to:i};let s=i,o=!1;if(Z0)try{let l=new URL(window.location.href),d=i.startsWith("//")?new URL(l.protocol+i):new URL(i),u=vi(d.pathname,e);d.origin===l.origin&&u!=null?i=u+d.search+d.hash:o=!0}catch{Nn(!1,`<Link to="${i}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:s,isExternal:o,to:i}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var eb=["POST","PUT","PATCH","DELETE"];new Set(eb);var P1=["GET",...eb];new Set(P1);var js=N.createContext(null);js.displayName="DataRouter";var lc=N.createContext(null);lc.displayName="DataRouterState";var j1=N.createContext(!1),tb=N.createContext({isTransitioning:!1});tb.displayName="ViewTransition";var I1=N.createContext(new Map);I1.displayName="Fetchers";var L1=N.createContext(null);L1.displayName="Await";var Sn=N.createContext(null);Sn.displayName="Navigation";var to=N.createContext(null);to.displayName="Location";var Fn=N.createContext({outlet:null,matches:[],isDataRoute:!1});Fn.displayName="Route";var Jh=N.createContext(null);Jh.displayName="RouteError";var nb="REACT_ROUTER_ERROR",U1="REDIRECT",B1="ROUTE_ERROR_RESPONSE";function q1(a){if(a.startsWith(`${nb}:${U1}:{`))try{let e=JSON.parse(a.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function z1(a){if(a.startsWith(`${nb}:${B1}:{`))try{let e=JSON.parse(a.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new N1(e.status,e.statusText,e.data)}catch{}}function F1(a,{relative:e}={}){nt(no(),"useHref() may be used only in the context of a <Router> component.");let{basename:i,navigator:s}=N.useContext(Sn),{hash:o,pathname:l,search:d}=io(a,{relative:e}),u=l;return i!=="/"&&(u=l==="/"?i:gi([i,l])),s.createHref({pathname:u,search:d,hash:o})}function no(){return N.useContext(to)!=null}function ea(){return nt(no(),"useLocation() may be used only in the context of a <Router> component."),N.useContext(to).location}var ib="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function ab(a){N.useContext(Sn).static||N.useLayoutEffect(a)}function Na(){let{isDataRoute:a}=N.useContext(Fn);return a?nE():H1()}function H1(){nt(no(),"useNavigate() may be used only in the context of a <Router> component.");let a=N.useContext(js),{basename:e,navigator:i}=N.useContext(Sn),{matches:s}=N.useContext(Fn),{pathname:o}=ea(),l=JSON.stringify(X0(s)),d=N.useRef(!1);return ab(()=>{d.current=!0}),N.useCallback((h,m={})=>{if(Nn(d.current,ib),!d.current)return;if(typeof h=="number"){i.go(h);return}let g=W0(h,JSON.parse(l),o,m.relative==="path");a==null&&e!=="/"&&(g.pathname=g.pathname==="/"?e:gi([e,g.pathname])),(m.replace?i.replace:i.push)(g,m.state,m)},[e,i,l,o,a])}N.createContext(null);function V1(){let{matches:a}=N.useContext(Fn),e=a[a.length-1];return e?e.params:{}}function io(a,{relative:e}={}){let{matches:i}=N.useContext(Fn),{pathname:s}=ea(),o=JSON.stringify(X0(i));return N.useMemo(()=>W0(a,JSON.parse(o),s,e==="path"),[a,o,s,e])}function G1(a,e){return sb(a,e)}function sb(a,e,i,s,o){nt(no(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:l}=N.useContext(Sn),{matches:d}=N.useContext(Fn),u=d[d.length-1],h=u?u.params:{},m=u?u.pathname:"/",g=u?u.pathnameBase:"/",y=u&&u.route;{let O=y&&y.path||"";ob(m,!y||O.endsWith("*")||O.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${m}" (under <Route path="${O}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${O}"> to <Route path="${O==="/"?"*":`${O}/*`}">.`)}let S=ea(),T;if(e){let O=typeof e=="string"?Ps(e):e;nt(g==="/"||O.pathname?.startsWith(g),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${g}" but pathname "${O.pathname}" was given in the \`location\` prop.`),T=O}else T=S;let x=T.pathname||"/",E=x;if(g!=="/"){let O=g.replace(/^\//,"").split("/");E="/"+x.replace(/^\//,"").split("/").slice(O.length).join("/")}let k=Y0(a,{pathname:E});Nn(y||k!=null,`No routes matched location "${T.pathname}${T.search}${T.hash}" `),Nn(k==null||k[k.length-1].route.element!==void 0||k[k.length-1].route.Component!==void 0||k[k.length-1].route.lazy!==void 0,`Matched leaf route at location "${T.pathname}${T.search}${T.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let R=X1(k&&k.map(O=>Object.assign({},O,{params:Object.assign({},h,O.params),pathname:gi([g,l.encodeLocation?l.encodeLocation(O.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:O.pathname]),pathnameBase:O.pathnameBase==="/"?g:gi([g,l.encodeLocation?l.encodeLocation(O.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:O.pathnameBase])})),d,i,s,o);return e&&R?N.createElement(to.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...T},navigationType:"POP"}},R):R}function K1(){let a=tE(),e=D1(a)?`${a.status} ${a.statusText}`:a instanceof Error?a.message:JSON.stringify(a),i=a instanceof Error?a.stack:null,s="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:s},l={padding:"2px 4px",backgroundColor:s},d=null;return console.error("Error handled by React Router default ErrorBoundary:",a),d=N.createElement(N.Fragment,null,N.createElement("p",null," Hey developer "),N.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",N.createElement("code",{style:l},"ErrorBoundary")," or"," ",N.createElement("code",{style:l},"errorElement")," prop on your route.")),N.createElement(N.Fragment,null,N.createElement("h2",null,"Unexpected Application Error!"),N.createElement("h3",{style:{fontStyle:"italic"}},e),i?N.createElement("pre",{style:o},i):null,d)}var Y1=N.createElement(K1,null),rb=class extends N.Component{constructor(a){super(a),this.state={location:a.location,revalidation:a.revalidation,error:a.error}}static getDerivedStateFromError(a){return{error:a}}static getDerivedStateFromProps(a,e){return e.location!==a.location||e.revalidation!=="idle"&&a.revalidation==="idle"?{error:a.error,location:a.location,revalidation:a.revalidation}:{error:a.error!==void 0?a.error:e.error,location:e.location,revalidation:a.revalidation||e.revalidation}}componentDidCatch(a,e){this.props.onError?this.props.onError(a,e):console.error("React Router caught the following error during render",a)}render(){let a=this.state.error;if(this.context&&typeof a=="object"&&a&&"digest"in a&&typeof a.digest=="string"){const i=z1(a.digest);i&&(a=i)}let e=a!==void 0?N.createElement(Fn.Provider,{value:this.props.routeContext},N.createElement(Jh.Provider,{value:a,children:this.props.component})):this.props.children;return this.context?N.createElement(J1,{error:a},e):e}};rb.contextType=j1;var Gd=new WeakMap;function J1({children:a,error:e}){let{basename:i}=N.useContext(Sn);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let s=q1(e.digest);if(s){let o=Gd.get(e);if(o)throw o;let l=$0(s.location,i);if(Z0&&!Gd.get(e))if(l.isExternal||s.reloadDocument)window.location.href=l.absoluteURL||l.to;else{const d=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(l.to,{replace:s.replace}));throw Gd.set(e,d),d}return N.createElement("meta",{httpEquiv:"refresh",content:`0;url=${l.absoluteURL||l.to}`})}}return a}function Q1({routeContext:a,match:e,children:i}){let s=N.useContext(js);return s&&s.static&&s.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=e.route.id),N.createElement(Fn.Provider,{value:a},i)}function X1(a,e=[],i=null,s=null,o=null){if(a==null){if(!i)return null;if(i.errors)a=i.matches;else if(e.length===0&&!i.initialized&&i.matches.length>0)a=i.matches;else return null}let l=a,d=i?.errors;if(d!=null){let g=l.findIndex(y=>y.route.id&&d?.[y.route.id]!==void 0);nt(g>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),l=l.slice(0,Math.min(l.length,g+1))}let u=!1,h=-1;if(i)for(let g=0;g<l.length;g++){let y=l[g];if((y.route.HydrateFallback||y.route.hydrateFallbackElement)&&(h=g),y.route.id){let{loaderData:S,errors:T}=i,x=y.route.loader&&!S.hasOwnProperty(y.route.id)&&(!T||T[y.route.id]===void 0);if(y.route.lazy||x){u=!0,h>=0?l=l.slice(0,h+1):l=[l[0]];break}}}let m=i&&s?(g,y)=>{s(g,{location:i.location,params:i.matches?.[0]?.params??{},unstable_pattern:O1(i.matches),errorInfo:y})}:void 0;return l.reduceRight((g,y,S)=>{let T,x=!1,E=null,k=null;i&&(T=d&&y.route.id?d[y.route.id]:void 0,E=y.route.errorElement||Y1,u&&(h<0&&S===0?(ob("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),x=!0,k=null):h===S&&(x=!0,k=y.route.hydrateFallbackElement||null)));let R=e.concat(l.slice(0,S+1)),O=()=>{let L;return T?L=E:x?L=k:y.route.Component?L=N.createElement(y.route.Component,null):y.route.element?L=y.route.element:L=g,N.createElement(Q1,{match:y,routeContext:{outlet:g,matches:R,isDataRoute:i!=null},children:L})};return i&&(y.route.ErrorBoundary||y.route.errorElement||S===0)?N.createElement(rb,{location:i.location,revalidation:i.revalidation,component:E,error:T,children:O(),routeContext:{outlet:null,matches:R,isDataRoute:!0},onError:m}):O()},null)}function Qh(a){return`${a} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function W1(a){let e=N.useContext(js);return nt(e,Qh(a)),e}function Z1(a){let e=N.useContext(lc);return nt(e,Qh(a)),e}function $1(a){let e=N.useContext(Fn);return nt(e,Qh(a)),e}function Xh(a){let e=$1(a),i=e.matches[e.matches.length-1];return nt(i.route.id,`${a} can only be used on routes that contain a unique "id"`),i.route.id}function eE(){return Xh("useRouteId")}function tE(){let a=N.useContext(Jh),e=Z1("useRouteError"),i=Xh("useRouteError");return a!==void 0?a:e.errors?.[i]}function nE(){let{router:a}=W1("useNavigate"),e=Xh("useNavigate"),i=N.useRef(!1);return ab(()=>{i.current=!0}),N.useCallback(async(o,l={})=>{Nn(i.current,ib),i.current&&(typeof o=="number"?await a.navigate(o):await a.navigate(o,{fromRouteId:e,...l}))},[a,e])}var Kv={};function ob(a,e,i){!e&&!Kv[a]&&(Kv[a]=!0,Nn(!1,i))}N.memo(iE);function iE({routes:a,future:e,state:i,onError:s}){return sb(a,void 0,i,s,e)}function li(a){nt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function aE({basename:a="/",children:e=null,location:i,navigationType:s="POP",navigator:o,static:l=!1,unstable_useTransitions:d}){nt(!no(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let u=a.replace(/^\/*/,"/"),h=N.useMemo(()=>({basename:u,navigator:o,static:l,unstable_useTransitions:d,future:{}}),[u,o,l,d]);typeof i=="string"&&(i=Ps(i));let{pathname:m="/",search:g="",hash:y="",state:S=null,key:T="default"}=i,x=N.useMemo(()=>{let E=vi(m,u);return E==null?null:{location:{pathname:E,search:g,hash:y,state:S,key:T},navigationType:s}},[u,m,g,y,S,T,s]);return Nn(x!=null,`<Router basename="${u}"> is not able to match the URL "${m}${g}${y}" because it does not start with the basename, so the <Router> won't render anything.`),x==null?null:N.createElement(Sn.Provider,{value:h},N.createElement(to.Provider,{children:e,value:x}))}function sE({children:a,location:e}){return G1(ph(a),e)}function ph(a,e=[]){let i=[];return N.Children.forEach(a,(s,o)=>{if(!N.isValidElement(s))return;let l=[...e,o];if(s.type===N.Fragment){i.push.apply(i,ph(s.props.children,l));return}nt(s.type===li,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),nt(!s.props.index||!s.props.children,"An index route cannot have child routes.");let d={id:s.props.id||l.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,middleware:s.props.middleware,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(d.children=ph(s.props.children,l)),i.push(d)}),i}var xl="get",Rl="application/x-www-form-urlencoded";function cc(a){return typeof HTMLElement<"u"&&a instanceof HTMLElement}function rE(a){return cc(a)&&a.tagName.toLowerCase()==="button"}function oE(a){return cc(a)&&a.tagName.toLowerCase()==="form"}function lE(a){return cc(a)&&a.tagName.toLowerCase()==="input"}function cE(a){return!!(a.metaKey||a.altKey||a.ctrlKey||a.shiftKey)}function uE(a,e){return a.button===0&&(!e||e==="_self")&&!cE(a)}function gh(a=""){return new URLSearchParams(typeof a=="string"||Array.isArray(a)||a instanceof URLSearchParams?a:Object.keys(a).reduce((e,i)=>{let s=a[i];return e.concat(Array.isArray(s)?s.map(o=>[i,o]):[[i,s]])},[]))}function dE(a,e){let i=gh(a);return e&&e.forEach((s,o)=>{i.has(o)||e.getAll(o).forEach(l=>{i.append(o,l)})}),i}var kl=null;function hE(){if(kl===null)try{new FormData(document.createElement("form"),0),kl=!1}catch{kl=!0}return kl}var fE=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Kd(a){return a!=null&&!fE.has(a)?(Nn(!1,`"${a}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Rl}"`),null):a}function mE(a,e){let i,s,o,l,d;if(oE(a)){let u=a.getAttribute("action");s=u?vi(u,e):null,i=a.getAttribute("method")||xl,o=Kd(a.getAttribute("enctype"))||Rl,l=new FormData(a)}else if(rE(a)||lE(a)&&(a.type==="submit"||a.type==="image")){let u=a.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let h=a.getAttribute("formaction")||u.getAttribute("action");if(s=h?vi(h,e):null,i=a.getAttribute("formmethod")||u.getAttribute("method")||xl,o=Kd(a.getAttribute("formenctype"))||Kd(u.getAttribute("enctype"))||Rl,l=new FormData(u,a),!hE()){let{name:m,type:g,value:y}=a;if(g==="image"){let S=m?`${m}.`:"";l.append(`${S}x`,"0"),l.append(`${S}y`,"0")}else m&&l.append(m,y)}}else{if(cc(a))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');i=xl,s=null,o=Rl,d=a}return l&&o==="text/plain"&&(d=l,l=void 0),{action:s,method:i.toLowerCase(),encType:o,formData:l,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Wh(a,e){if(a===!1||a===null||typeof a>"u")throw new Error(e)}function pE(a,e,i,s){let o=typeof a=="string"?new URL(a,typeof window>"u"?"server://singlefetch/":window.location.origin):a;return i?o.pathname.endsWith("/")?o.pathname=`${o.pathname}_.${s}`:o.pathname=`${o.pathname}.${s}`:o.pathname==="/"?o.pathname=`_root.${s}`:e&&vi(o.pathname,e)==="/"?o.pathname=`${e.replace(/\/$/,"")}/_root.${s}`:o.pathname=`${o.pathname.replace(/\/$/,"")}.${s}`,o}async function gE(a,e){if(a.id in e)return e[a.id];try{let i=await import(a.module);return e[a.id]=i,i}catch(i){return console.error(`Error loading route module \`${a.module}\`, reloading page...`),console.error(i),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function vE(a){return a==null?!1:a.href==null?a.rel==="preload"&&typeof a.imageSrcSet=="string"&&typeof a.imageSizes=="string":typeof a.rel=="string"&&typeof a.href=="string"}async function yE(a,e,i){let s=await Promise.all(a.map(async o=>{let l=e.routes[o.route.id];if(l){let d=await gE(l,i);return d.links?d.links():[]}return[]}));return TE(s.flat(1).filter(vE).filter(o=>o.rel==="stylesheet"||o.rel==="preload").map(o=>o.rel==="stylesheet"?{...o,rel:"prefetch",as:"style"}:{...o,rel:"prefetch"}))}function Yv(a,e,i,s,o,l){let d=(h,m)=>i[m]?h.route.id!==i[m].route.id:!0,u=(h,m)=>i[m].pathname!==h.pathname||i[m].route.path?.endsWith("*")&&i[m].params["*"]!==h.params["*"];return l==="assets"?e.filter((h,m)=>d(h,m)||u(h,m)):l==="data"?e.filter((h,m)=>{let g=s.routes[h.route.id];if(!g||!g.hasLoader)return!1;if(d(h,m)||u(h,m))return!0;if(h.route.shouldRevalidate){let y=h.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:i[0]?.params||{},nextUrl:new URL(a,window.origin),nextParams:h.params,defaultShouldRevalidate:!0});if(typeof y=="boolean")return y}return!0}):[]}function bE(a,e,{includeHydrateFallback:i}={}){return SE(a.map(s=>{let o=e.routes[s.route.id];if(!o)return[];let l=[o.module];return o.clientActionModule&&(l=l.concat(o.clientActionModule)),o.clientLoaderModule&&(l=l.concat(o.clientLoaderModule)),i&&o.hydrateFallbackModule&&(l=l.concat(o.hydrateFallbackModule)),o.imports&&(l=l.concat(o.imports)),l}).flat(1))}function SE(a){return[...new Set(a)]}function CE(a){let e={},i=Object.keys(a).sort();for(let s of i)e[s]=a[s];return e}function TE(a,e){let i=new Set;return new Set(e),a.reduce((s,o)=>{let l=JSON.stringify(CE(o));return i.has(l)||(i.add(l),s.push({key:l,link:o})),s},[])}function lb(){let a=N.useContext(js);return Wh(a,"You must render this element inside a <DataRouterContext.Provider> element"),a}function kE(){let a=N.useContext(lc);return Wh(a,"You must render this element inside a <DataRouterStateContext.Provider> element"),a}var Zh=N.createContext(void 0);Zh.displayName="FrameworkContext";function cb(){let a=N.useContext(Zh);return Wh(a,"You must render this element inside a <HydratedRouter> element"),a}function EE(a,e){let i=N.useContext(Zh),[s,o]=N.useState(!1),[l,d]=N.useState(!1),{onFocus:u,onBlur:h,onMouseEnter:m,onMouseLeave:g,onTouchStart:y}=e,S=N.useRef(null);N.useEffect(()=>{if(a==="render"&&d(!0),a==="viewport"){let E=R=>{R.forEach(O=>{d(O.isIntersecting)})},k=new IntersectionObserver(E,{threshold:.5});return S.current&&k.observe(S.current),()=>{k.disconnect()}}},[a]),N.useEffect(()=>{if(s){let E=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(E)}}},[s]);let T=()=>{o(!0)},x=()=>{o(!1),d(!1)};return i?a!=="intent"?[l,S,{}]:[l,S,{onFocus:Nr(u,T),onBlur:Nr(h,x),onMouseEnter:Nr(m,T),onMouseLeave:Nr(g,x),onTouchStart:Nr(y,T)}]:[!1,S,{}]}function Nr(a,e){return i=>{a&&a(i),i.defaultPrevented||e(i)}}function _E({page:a,...e}){let{router:i}=lb(),s=N.useMemo(()=>Y0(i.routes,a,i.basename),[i.routes,a,i.basename]);return s?N.createElement(xE,{page:a,matches:s,...e}):null}function wE(a){let{manifest:e,routeModules:i}=cb(),[s,o]=N.useState([]);return N.useEffect(()=>{let l=!1;return yE(a,e,i).then(d=>{l||o(d)}),()=>{l=!0}},[a,e,i]),s}function xE({page:a,matches:e,...i}){let s=ea(),{future:o,manifest:l,routeModules:d}=cb(),{basename:u}=lb(),{loaderData:h,matches:m}=kE(),g=N.useMemo(()=>Yv(a,e,m,l,s,"data"),[a,e,m,l,s]),y=N.useMemo(()=>Yv(a,e,m,l,s,"assets"),[a,e,m,l,s]),S=N.useMemo(()=>{if(a===s.pathname+s.search+s.hash)return[];let E=new Set,k=!1;if(e.forEach(O=>{let L=l.routes[O.route.id];!L||!L.hasLoader||(!g.some(D=>D.route.id===O.route.id)&&O.route.id in h&&d[O.route.id]?.shouldRevalidate||L.hasClientLoader?k=!0:E.add(O.route.id))}),E.size===0)return[];let R=pE(a,u,o.unstable_trailingSlashAwareDataRequests,"data");return k&&E.size>0&&R.searchParams.set("_routes",e.filter(O=>E.has(O.route.id)).map(O=>O.route.id).join(",")),[R.pathname+R.search]},[u,o.unstable_trailingSlashAwareDataRequests,h,s,l,g,e,a,d]),T=N.useMemo(()=>bE(y,l),[y,l]),x=wE(y);return N.createElement(N.Fragment,null,S.map(E=>N.createElement("link",{key:E,rel:"prefetch",as:"fetch",href:E,...i})),T.map(E=>N.createElement("link",{key:E,rel:"modulepreload",href:E,...i})),x.map(({key:E,link:k})=>N.createElement("link",{key:E,nonce:i.nonce,...k,crossOrigin:k.crossOrigin??i.crossOrigin})))}function RE(...a){return e=>{a.forEach(i=>{typeof i=="function"?i(e):i!=null&&(i.current=e)})}}var ME=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{ME&&(window.__reactRouterVersion="7.13.0")}catch{}function AE({basename:a,children:e,unstable_useTransitions:i,window:s}){let o=N.useRef();o.current==null&&(o.current=l1({window:s,v5Compat:!0}));let l=o.current,[d,u]=N.useState({action:l.action,location:l.location}),h=N.useCallback(m=>{i===!1?u(m):N.startTransition(()=>u(m))},[i]);return N.useLayoutEffect(()=>l.listen(h),[l,h]),N.createElement(aE,{basename:a,children:e,location:d.location,navigationType:d.action,navigator:l,unstable_useTransitions:i})}var ub=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,De=N.forwardRef(function({onClick:e,discover:i="render",prefetch:s="none",relative:o,reloadDocument:l,replace:d,state:u,target:h,to:m,preventScrollReset:g,viewTransition:y,unstable_defaultShouldRevalidate:S,...T},x){let{basename:E,unstable_useTransitions:k}=N.useContext(Sn),R=typeof m=="string"&&ub.test(m),O=$0(m,E);m=O.to;let L=F1(m,{relative:o}),[D,I,P]=EE(s,T),H=PE(m,{replace:d,state:u,target:h,preventScrollReset:g,relative:o,viewTransition:y,unstable_defaultShouldRevalidate:S,unstable_useTransitions:k});function Z(te){e&&e(te),te.defaultPrevented||H(te)}let ee=N.createElement("a",{...T,...P,href:O.absoluteURL||L,onClick:O.isExternal||l?e:Z,ref:RE(x,I),target:h,"data-discover":!R&&i==="render"?"true":void 0});return D&&!R?N.createElement(N.Fragment,null,ee,N.createElement(_E,{page:L})):ee});De.displayName="Link";var NE=N.forwardRef(function({"aria-current":e="page",caseSensitive:i=!1,className:s="",end:o=!1,style:l,to:d,viewTransition:u,children:h,...m},g){let y=io(d,{relative:m.relative}),S=ea(),T=N.useContext(lc),{navigator:x,basename:E}=N.useContext(Sn),k=T!=null&&qE(y)&&u===!0,R=x.encodeLocation?x.encodeLocation(y).pathname:y.pathname,O=S.pathname,L=T&&T.navigation&&T.navigation.location?T.navigation.location.pathname:null;i||(O=O.toLowerCase(),L=L?L.toLowerCase():null,R=R.toLowerCase()),L&&E&&(L=vi(L,E)||L);const D=R!=="/"&&R.endsWith("/")?R.length-1:R.length;let I=O===R||!o&&O.startsWith(R)&&O.charAt(D)==="/",P=L!=null&&(L===R||!o&&L.startsWith(R)&&L.charAt(R.length)==="/"),H={isActive:I,isPending:P,isTransitioning:k},Z=I?e:void 0,ee;typeof s=="function"?ee=s(H):ee=[s,I?"active":null,P?"pending":null,k?"transitioning":null].filter(Boolean).join(" ");let te=typeof l=="function"?l(H):l;return N.createElement(De,{...m,"aria-current":Z,className:ee,ref:g,style:te,to:d,viewTransition:u},typeof h=="function"?h(H):h)});NE.displayName="NavLink";var DE=N.forwardRef(({discover:a="render",fetcherKey:e,navigate:i,reloadDocument:s,replace:o,state:l,method:d=xl,action:u,onSubmit:h,relative:m,preventScrollReset:g,viewTransition:y,unstable_defaultShouldRevalidate:S,...T},x)=>{let{unstable_useTransitions:E}=N.useContext(Sn),k=UE(),R=BE(u,{relative:m}),O=d.toLowerCase()==="get"?"get":"post",L=typeof u=="string"&&ub.test(u),D=I=>{if(h&&h(I),I.defaultPrevented)return;I.preventDefault();let P=I.nativeEvent.submitter,H=P?.getAttribute("formmethod")||d,Z=()=>k(P||I.currentTarget,{fetcherKey:e,method:H,navigate:i,replace:o,state:l,relative:m,preventScrollReset:g,viewTransition:y,unstable_defaultShouldRevalidate:S});E&&i!==!1?N.startTransition(()=>Z()):Z()};return N.createElement("form",{ref:x,method:O,action:R,onSubmit:s?h:D,...T,"data-discover":!L&&a==="render"?"true":void 0})});DE.displayName="Form";function OE(a){return`${a} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function db(a){let e=N.useContext(js);return nt(e,OE(a)),e}function PE(a,{target:e,replace:i,state:s,preventScrollReset:o,relative:l,viewTransition:d,unstable_defaultShouldRevalidate:u,unstable_useTransitions:h}={}){let m=Na(),g=ea(),y=io(a,{relative:l});return N.useCallback(S=>{if(uE(S,e)){S.preventDefault();let T=i!==void 0?i:Kr(g)===Kr(y),x=()=>m(a,{replace:T,state:s,preventScrollReset:o,relative:l,viewTransition:d,unstable_defaultShouldRevalidate:u});h?N.startTransition(()=>x()):x()}},[g,m,y,i,s,e,a,o,l,d,u,h])}function jE(a){Nn(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=N.useRef(gh(a)),i=N.useRef(!1),s=ea(),o=N.useMemo(()=>dE(s.search,i.current?null:e.current),[s.search]),l=Na(),d=N.useCallback((u,h)=>{const m=gh(typeof u=="function"?u(new URLSearchParams(o)):u);i.current=!0,l("?"+m,h)},[l,o]);return[o,d]}var IE=0,LE=()=>`__${String(++IE)}__`;function UE(){let{router:a}=db("useSubmit"),{basename:e}=N.useContext(Sn),i=eE(),s=a.fetch,o=a.navigate;return N.useCallback(async(l,d={})=>{let{action:u,method:h,encType:m,formData:g,body:y}=mE(l,e);if(d.navigate===!1){let S=d.fetcherKey||LE();await s(S,i,d.action||u,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:g,body:y,formMethod:d.method||h,formEncType:d.encType||m,flushSync:d.flushSync})}else await o(d.action||u,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:g,body:y,formMethod:d.method||h,formEncType:d.encType||m,replace:d.replace,state:d.state,fromRouteId:i,flushSync:d.flushSync,viewTransition:d.viewTransition})},[s,o,e,i])}function BE(a,{relative:e}={}){let{basename:i}=N.useContext(Sn),s=N.useContext(Fn);nt(s,"useFormAction must be used inside a RouteContext");let[o]=s.matches.slice(-1),l={...io(a||".",{relative:e})},d=ea();if(a==null){l.search=d.search;let u=new URLSearchParams(l.search),h=u.getAll("index");if(h.some(g=>g==="")){u.delete("index"),h.filter(y=>y).forEach(y=>u.append("index",y));let g=u.toString();l.search=g?`?${g}`:""}}return(!a||a===".")&&o.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),i!=="/"&&(l.pathname=l.pathname==="/"?i:gi([i,l.pathname])),Kr(l)}function qE(a,{relative:e}={}){let i=N.useContext(tb);nt(i!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=db("useViewTransitionState"),o=io(a,{relative:e});if(!i.isTransitioning)return!1;let l=vi(i.currentLocation.pathname,s)||i.currentLocation.pathname,d=vi(i.nextLocation.pathname,s)||i.nextLocation.pathname;return Vl(o.pathname,d)!=null||Vl(o.pathname,l)!=null}const zE=(a,e)=>{switch(e.type){case"ADD_ITEM":{const i=a.items.findIndex(s=>s.id===e.payload.id&&s.pack===e.payload.pack);if(i>=0){const s=[...a.items];return s[i]={...s[i],quantity:s[i].quantity+e.payload.quantity},{...a,items:s,isOpen:!0}}return{...a,items:[...a.items,e.payload],isOpen:!0}}case"REMOVE_ITEM":return{...a,items:a.items.filter(i=>!(i.id===e.payload.id&&i.pack===e.payload.pack))};case"UPDATE_QUANTITY":return e.payload.quantity<=0?{...a,items:a.items.filter(i=>!(i.id===e.payload.id&&i.pack===e.payload.pack))}:{...a,items:a.items.map(i=>i.id===e.payload.id&&i.pack===e.payload.pack?{...i,quantity:e.payload.quantity}:i)};case"CLEAR_CART":return{...a,items:[]};case"TOGGLE_CART":return{...a,isOpen:!a.isOpen};case"OPEN_CART":return{...a,isOpen:!0};case"CLOSE_CART":return{...a,isOpen:!1};default:return a}},hb=N.createContext(null),FE=()=>{try{const a=localStorage.getItem("ammafoods_cart");if(a)return{items:JSON.parse(a),isOpen:!1}}catch{}return{items:[],isOpen:!1}},HE=({children:a})=>{const[e,i]=N.useReducer(zE,FE());N.useEffect(()=>{localStorage.setItem("ammafoods_cart",JSON.stringify(e.items))},[e.items]);const s=e.items.reduce((d,u)=>d+u.quantity,0),o=e.items.reduce((d,u)=>d+u.price*u.quantity,0),l=e.items.reduce((d,u)=>d+(u.originalPrice-u.price)*u.quantity,0);return v.jsx(hb.Provider,{value:{state:e,addToCart:d=>i({type:"ADD_ITEM",payload:d}),removeFromCart:(d,u)=>i({type:"REMOVE_ITEM",payload:{id:d,pack:u}}),updateQuantity:(d,u,h)=>i({type:"UPDATE_QUANTITY",payload:{id:d,pack:u,quantity:h}}),clearCart:()=>i({type:"CLEAR_CART"}),toggleCart:()=>i({type:"TOGGLE_CART"}),openCart:()=>i({type:"OPEN_CART"}),closeCart:()=>i({type:"CLOSE_CART"}),cartCount:s,cartTotal:o,cartSavings:l},children:a})},Da=()=>{const a=N.useContext(hb);if(!a)throw new Error("useCart must be used within CartProvider");return a},Jv=[" FREE Delivery on all orders across India"," Flat 12% OFF on your first order"," Buy 2 Get 1 FREE on selected combos"," 100% Natural & Authentic Ayurvedic Products"," Cash on Delivery (COD) Available PAN-India"," Trusted by 5 Lakh+ Happy Customers"," Up to 25% OFF on Super Saver Combos"," Free shipping on orders above 499"],VE=()=>{const a=[...Jv,...Jv];return v.jsx("div",{className:"promo-bar",children:v.jsx("div",{className:"promo-track",children:a.map((e,i)=>v.jsxs("span",{className:"promo-item",children:[e," ",v.jsx("span",{className:"promo-dot",children:""})]},i))})})};const fb=(...a)=>a.filter((e,i,s)=>!!e&&e.trim()!==""&&s.indexOf(e)===i).join(" ").trim();const GE=a=>a.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();const KE=a=>a.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,i,s)=>s?s.toUpperCase():i.toLowerCase());const Qv=a=>{const e=KE(a);return e.charAt(0).toUpperCase()+e.slice(1)};var YE={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const JE=a=>{for(const e in a)if(e.startsWith("aria-")||e==="role"||e==="title")return!0;return!1};const QE=N.forwardRef(({color:a="currentColor",size:e=24,strokeWidth:i=2,absoluteStrokeWidth:s,className:o="",children:l,iconNode:d,...u},h)=>N.createElement("svg",{ref:h,...YE,width:e,height:e,stroke:a,strokeWidth:s?Number(i)*24/Number(e):i,className:fb("lucide",o),...!l&&!JE(u)&&{"aria-hidden":"true"},...u},[...d.map(([m,g])=>N.createElement(m,g)),...Array.isArray(l)?l:[l]]));const Me=(a,e)=>{const i=N.forwardRef(({className:s,...o},l)=>N.createElement(QE,{ref:l,iconNode:e,className:fb(`lucide-${GE(Qv(a))}`,`lucide-${a}`,s),...o}));return i.displayName=Qv(a),i};const XE=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],WE=Me("briefcase",XE);const ZE=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],mb=Me("check",ZE);const $E=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Gl=Me("chevron-down",$E);const e_=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Ml=Me("chevron-left",e_);const t_=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Al=Me("chevron-right",t_);const n_=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],i_=Me("ellipsis",n_);const a_=[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]],s_=Me("facebook",a_);const r_=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],o_=Me("funnel",r_);const l_=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],c_=Me("house",l_);const u_=[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]],d_=Me("instagram",u_);const h_=[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]],f_=Me("leaf",h_);const m_=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],pb=Me("mail",m_);const p_=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],gb=Me("map-pin",p_);const g_=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],v_=Me("menu",g_);const y_=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]],Xv=Me("mic",y_);const b_=[["path",{d:"M5 12h14",key:"1ays0h"}]],vb=Me("minus",b_);const S_=[["path",{d:"M10.1 13.9a14 14 0 0 0 3.732 2.668 1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2 18 18 0 0 1-12.728-5.272",key:"1wngk7"}],["path",{d:"M22 2 2 22",key:"y4kqgn"}],["path",{d:"M4.76 13.582A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 .244.473",key:"10hv5p"}]],C_=Me("phone-off",S_);const T_=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],yb=Me("phone",T_);const k_=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],bb=Me("plus",k_);const E_=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Sb=Me("refresh-cw",E_);const __=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],vh=Me("search",__);const w_=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],x_=Me("shield-check",w_);const R_=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],M_=Me("shield",R_);const A_=[["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}],["path",{d:"M3.103 6.034h17.794",key:"awc11p"}],["path",{d:"M3.4 5.467a2 2 0 0 0-.4 1.2V20a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6.667a2 2 0 0 0-.4-1.2l-2-2.667A2 2 0 0 0 17 2H7a2 2 0 0 0-1.6.8z",key:"o988cm"}]],N_=Me("shopping-bag",A_);const D_=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],$h=Me("shopping-cart",D_);const O_=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Kl=Me("star",O_);const P_=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],j_=Me("trash-2",P_);const I_=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],Yl=Me("truck",I_);const L_=[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]],U_=Me("twitter",L_);const B_=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],q_=Me("user",B_);const z_=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],F_=Me("users",z_);const H_=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],V_=Me("volume-2",H_);const G_=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],uc=Me("x",G_);const K_=[["path",{d:"M2.5 17a24.12 24.12 0 0 1 0-10 2 2 0 0 1 1.4-1.4 49.56 49.56 0 0 1 16.2 0A2 2 0 0 1 21.5 7a24.12 24.12 0 0 1 0 10 2 2 0 0 1-1.4 1.4 49.55 49.55 0 0 1-16.2 0A2 2 0 0 1 2.5 17",key:"1q2vi4"}],["path",{d:"m10 15 5-3-5-3z",key:"1jp15x"}]],Y_=Me("youtube",K_),J_=[{icon:"",name:"Herbal Supplements",sub:["Single Herb","Multi-Herb","Condition Specific"],cat:"Herbal Supplements"},{icon:"",name:"Organic Foods",sub:["Pulses & Dals","Salt & Spices","Oats & Quinoa"],cat:"Organic Foods"},{icon:"",name:"Teas & Infusions",sub:["Green Teas","Herbal Infusions","Black Tea","Detox Teas"],cat:"Teas & Infusions"},{icon:"",name:"Detox Programs",sub:["Kits","Shakes","Colon Cleanse"],cat:"Detox Programs"},{icon:"",name:"Sugar Alternatives",sub:["Honey","Jaggery","Stevia","Khandsari Sugar"],cat:"Sugar Alternatives"},{icon:"",name:"Oils & Ghee",sub:["Cow Ghee","Cold Pressed Oils"],cat:"Oils & Ghee"},{icon:"",name:"Coffee",sub:["Filter Coffee","Herbal Coffee","Cold Brew"],cat:"Coffee"},{icon:"",name:"Gift Boxes",sub:["Wellness Kits","Festival Combos"],cat:"Gift Boxes"},{icon:"",name:"Gym Diet",sub:["Plant Proteins","Fitness Supplements","Energy Foods"],cat:"Gym Diet",isNew:!0}],Q_=()=>v.jsx("div",{className:"mega-menu",children:v.jsx("div",{className:"container mega-inner",children:v.jsx("div",{className:"mega-grid",children:J_.map(a=>v.jsxs("div",{className:"mega-cat",children:[v.jsxs(De,{to:`/products?category=${encodeURIComponent(a.cat)}`,className:"mega-cat-title",children:[v.jsx("span",{className:"mega-cat-icon",children:a.icon}),a.name,a.isNew&&v.jsx("span",{className:"mega-new-badge",children:"NEW"})]}),v.jsx("ul",{className:"mega-sub-list",children:a.sub.map(e=>v.jsx("li",{children:v.jsx(De,{to:`/products?category=${encodeURIComponent(a.cat)}&sub=${encodeURIComponent(e)}`,children:e})},e))})]},a.name))})})}),X_=[{group:" Gut Care",items:["Bloating / Gas / Indigestion","Constipation","IBS / IBD","Colon Cleansing","Gut Cleansing"]},{group:" Liver / Kidney",items:["Liver Support","Kidney Care","Detox"]},{group:" Immunity Care",items:["Cough / Cold","Respiratory Care","Nasal Congestion","Pollution Care"]},{group:" Heart Care",items:["Cholesterol","Triglycerides","Hypertension","Palpitations"]},{group:" Nutrition",items:["Anaemia","Plant Proteins","Healthy Cooking Medium","Healthy Sweeteners"]},{group:" Joint Care",items:["Arthritis / Joint Pain","Muscle Care"]},{group:" Quick Links",items:["Men's Health","Women's Health","Sleep Care","Metabolism Care"]}],W_=()=>v.jsx("div",{className:"mega-menu",children:v.jsx("div",{className:"container mega-inner",children:v.jsx("div",{className:"mega-grid mega-grid-cond",children:X_.map(a=>v.jsxs("div",{className:"mega-cat",children:[v.jsx("div",{className:"mega-cat-title mega-cat-group",children:a.group}),v.jsx("ul",{className:"mega-sub-list",children:a.items.map(e=>v.jsx("li",{children:v.jsx(De,{to:`/products?condition=${encodeURIComponent(e)}`,children:e})},e))})]},a.group))})})}),Z_=[{name:"Active Start Combo",img:"https://images.unsplash.com/photo-1622979135225-d2ba269cf1ac?w=200&q=80",off:"20% OFF",id:"p6"},{name:"Calm & Balance Combo",img:"https://images.unsplash.com/photo-1611694300810-c1c3e84bc3f8?w=200&q=80",off:"21% OFF",id:"p7"},{name:"Gut Reset Combo",img:"https://images.unsplash.com/photo-1512621776951-a57141f2eefd?w=200&q=80",off:"22% OFF",id:"p8"},{name:"Wellness Starter Pack",img:"https://images.unsplash.com/photo-1576678927484-cc907957088c?w=200&q=80",off:"25% OFF",id:"p9"},{name:"Clean 7 Days Kit",img:"https://images.unsplash.com/photo-1547592180-85f173990554?w=200&q=80",off:"20% OFF",id:"p10"}],$_=()=>v.jsx("div",{className:"mega-menu",children:v.jsxs("div",{className:"container mega-inner",children:[v.jsxs("div",{className:"combo-header",children:[v.jsx("h3",{children:" Super Saver Combos"}),v.jsx("p",{children:"Curated wellness bundles at unbeatable prices"})]}),v.jsx("div",{className:"combo-grid",children:Z_.map(a=>v.jsxs(De,{to:`/product/${a.id}`,className:"combo-card",children:[v.jsxs("div",{className:"combo-img-wrap",children:[v.jsx("img",{src:a.img,alt:a.name}),v.jsx("span",{className:"combo-badge",children:a.off})]}),v.jsx("span",{className:"combo-name",children:a.name})]},a.id))}),v.jsx(De,{to:"/products?category=Super+Saver+Combos",className:"view-all-link",children:"View All Combos "})]})}),ew=[{icon:"",label:"Energy & Stamina",goal:"Energy",color:"#ff6b35"},{icon:"",label:"Calm & Stress Relief",goal:"Calm",color:"#7b68ee"},{icon:"",label:"Digestion & Gut",goal:"Digestion",color:"#2e7d32"},{icon:"",label:"Immunity Boost",goal:"Immunity",color:"#e65100"},{icon:"",label:"Detox & Cleanse",goal:"Detox",color:"#00838f"},{icon:"",label:"Gym & Fitness",goal:"Fitness",color:"#1565c0"},{icon:"",label:"Sleep Support",goal:"Sleep",color:"#4a148c"},{icon:"",label:"Weight Management",goal:"Weight",color:"#bf360c"},{icon:"",label:"Overall Wellness",goal:"Wellness",color:"#558b2f"}],tw=()=>v.jsx("div",{className:"mega-menu",children:v.jsx("div",{className:"container mega-inner",children:v.jsx("div",{className:"goals-grid",children:ew.map(a=>v.jsxs(De,{to:`/products?goal=${encodeURIComponent(a.goal)}`,className:"goal-tile",children:[v.jsx("div",{className:"goal-icon",style:{background:`${a.color}18`,color:a.color},children:a.icon}),v.jsx("span",{className:"goal-label",children:a.label})]},a.goal))})})}),Cb="/assets/amma_foods_logo-C7dseYIW.jpg",Wv=[{label:"Shop By Category",menu:"category"},{label:"Shop By Condition",menu:"condition"},{label:"Super Saver Combos",menu:"combos"},{label:"Shop By Goal",menu:"goal"}],nw=()=>{const{cartCount:a,toggleCart:e}=Da(),[i,s]=N.useState(null),[o,l]=N.useState(!1),[d,u]=N.useState(!1),[h,m]=N.useState(""),[g,y]=N.useState(!1),S=Na(),T=N.useRef(null),x=N.useRef(null);N.useEffect(()=>{const L=()=>u(window.scrollY>10);return window.addEventListener("scroll",L),()=>window.removeEventListener("scroll",L)},[]);const E=L=>{x.current!==null&&clearTimeout(x.current),s(L)},k=()=>{x.current=window.setTimeout(()=>s(null),150)},R=L=>{L.preventDefault(),h.trim()&&S(`/products?q=${encodeURIComponent(h.trim())}`)},O=()=>{if(!i)return null;switch(i){case"category":return v.jsx(Q_,{});case"condition":return v.jsx(W_,{});case"combos":return v.jsx($_,{});case"goal":return v.jsx(tw,{});default:return null}};return v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:`header-wrapper ${d?"scrolled":""}`,ref:T,children:[v.jsx("header",{className:"main-header",children:v.jsxs("div",{className:"container header-inner",children:[v.jsxs(De,{to:"/",className:"logo",children:[v.jsx("div",{className:"logo-icon",children:v.jsx("img",{src:Cb,alt:"AmmaFoods Logo",style:{width:"48px",height:"48px",objectFit:"contain",borderRadius:"50%"}})}),v.jsxs("div",{className:"logo-text",children:[v.jsx("span",{className:"logo-name",children:"AmmaFoods"}),v.jsx("span",{className:"logo-tag",children:"Herbal  Healthy  Tasty"})]})]}),v.jsxs("form",{className:"search-form hide-mobile",onSubmit:R,children:[v.jsx("input",{type:"text",placeholder:"Search herbs, supplements, teas...",value:h,onChange:L=>m(L.target.value),className:"search-input"}),v.jsx("button",{type:"submit",className:"search-btn",children:v.jsx(vh,{size:18})})]}),v.jsxs("div",{className:"header-actions",children:[v.jsxs("div",{className:"action-icon delivery-icon hide-mobile",onMouseEnter:()=>y(!0),onMouseLeave:()=>y(!1),children:[v.jsx(Yl,{size:22}),g&&v.jsxs("div",{className:"delivery-tooltip",children:[v.jsx("strong",{children:"Free PAN-India Delivery"}),v.jsx("span",{children:"On orders above 499"}),v.jsx("span",{children:"COD Available"})]})]}),v.jsxs("button",{className:"action-icon cart-btn",onClick:e,"aria-label":"Open cart",children:[v.jsx($h,{size:22}),a>0&&v.jsx("span",{className:"cart-badge",children:a})]}),v.jsx("button",{className:"hamburger hide-desktop",onClick:()=>l(!o),"aria-label":"Toggle menu",children:o?v.jsx(uc,{size:24}):v.jsx(v_,{size:24})})]})]})}),v.jsx("nav",{className:"primary-nav hide-mobile",children:v.jsxs("div",{className:"container nav-inner",children:[Wv.map(L=>v.jsxs("div",{className:`nav-item ${i===L.menu?"active":""}`,onMouseEnter:()=>E(L.menu),onMouseLeave:k,children:[v.jsxs("span",{className:"nav-label",children:[L.label,v.jsx(Gl,{size:14,className:"nav-chevron"})]}),i===L.menu&&v.jsx("div",{className:"mega-menu-wrapper",onMouseEnter:()=>E(L.menu),onMouseLeave:k,children:O()})]},L.menu)),v.jsx(De,{to:"/products",className:"nav-item nav-link-plain",children:"All Products"}),v.jsx(De,{to:"/products?tag=bestseller",className:"nav-item nav-link-plain nav-highlight",children:" Best Sellers"}),v.jsx(De,{to:"/maruthompal",className:"nav-item nav-link-plain nav-maruthompal",children:" Maruthompal"})]})})]}),o&&v.jsxs("div",{className:"mobile-menu",children:[v.jsxs("form",{className:"search-form mobile-search",onSubmit:R,children:[v.jsx("input",{type:"text",placeholder:"Search products...",value:h,onChange:L=>m(L.target.value),className:"search-input"}),v.jsx("button",{type:"submit",className:"search-btn",children:v.jsx(vh,{size:18})})]}),Wv.map(L=>v.jsx("div",{className:"mobile-nav-item",children:v.jsxs("button",{className:"mobile-nav-btn",onClick:()=>s(i===L.menu?null:L.menu),children:[L.label,v.jsx(Gl,{size:14,style:{transform:i===L.menu?"rotate(180deg)":"none",transition:"0.2s"}})]})},L.menu)),v.jsx(De,{to:"/products",className:"mobile-nav-link",onClick:()=>l(!1),children:"All Products"}),v.jsx(De,{to:"/products?tag=bestseller",className:"mobile-nav-link",onClick:()=>l(!1),children:"Best Sellers"}),v.jsx(De,{to:"/maruthompal",className:"mobile-nav-link mobile-maruthompal",onClick:()=>l(!1),children:" Maruthompal"})]})]})},iw=()=>{const{state:a,closeCart:e,removeFromCart:i,updateQuantity:s,cartTotal:o,cartSavings:l}=Da(),d=Na();if(!a.isOpen)return null;const u=()=>{e(),d("/checkout")};return v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"overlay",onClick:e}),v.jsxs("div",{className:"cart-drawer",children:[v.jsxs("div",{className:"cart-header",children:[v.jsxs("div",{className:"cart-title",children:[v.jsx(N_,{size:20}),v.jsx("span",{children:"My Cart"}),a.items.length>0&&v.jsx("span",{className:"cart-count-badge",children:a.items.reduce((h,m)=>h+m.quantity,0)})]}),v.jsx("button",{className:"cart-close",onClick:e,"aria-label":"Close cart",children:v.jsx(uc,{size:20})})]}),a.items.length===0?v.jsxs("div",{className:"cart-empty",children:[v.jsx("div",{className:"empty-icon",children:""}),v.jsx("h3",{children:"Your cart is empty"}),v.jsx("p",{children:"Add some healthy products to get started!"}),v.jsx("button",{className:"btn btn-primary",onClick:()=>{e(),d("/products")},children:"Shop Now"})]}):v.jsxs(v.Fragment,{children:[l>0&&v.jsxs("div",{className:"savings-banner",children:[" You're saving ",v.jsxs("strong",{children:["",l.toLocaleString()]})," on this order!"]}),v.jsx("div",{className:"cart-items",children:a.items.map(h=>v.jsxs("div",{className:"cart-item",children:[v.jsx(De,{to:`/product/${h.id}`,onClick:e,className:"cart-item-img",children:v.jsx("img",{src:h.image,alt:h.name})}),v.jsxs("div",{className:"cart-item-info",children:[v.jsx(De,{to:`/product/${h.id}`,onClick:e,className:"cart-item-name",children:h.name}),v.jsx("span",{className:"cart-item-pack",children:h.pack}),v.jsxs("div",{className:"cart-item-price",children:[v.jsxs("span",{className:"price-current",children:["",h.price]}),v.jsxs("span",{className:"price-original",children:["",h.originalPrice]})]}),v.jsxs("div",{className:"cart-item-actions",children:[v.jsxs("div",{className:"qty-ctrl",children:[v.jsx("button",{onClick:()=>s(h.id,h.pack,h.quantity-1),"aria-label":"Decrease",children:v.jsx(vb,{size:12})}),v.jsx("span",{children:h.quantity}),v.jsx("button",{onClick:()=>s(h.id,h.pack,h.quantity+1),"aria-label":"Increase",children:v.jsx(bb,{size:12})})]}),v.jsxs("span",{className:"item-subtotal",children:["",(h.price*h.quantity).toLocaleString()]}),v.jsx("button",{className:"remove-btn",onClick:()=>i(h.id,h.pack),"aria-label":"Remove",children:v.jsx(j_,{size:14})})]})]})]},`${h.id}-${h.pack}`))}),v.jsxs("div",{className:"cart-footer",children:[v.jsxs("div",{className:"cart-summary",children:[v.jsxs("div",{className:"summary-row",children:[v.jsx("span",{children:"Subtotal"}),v.jsxs("span",{children:["",o.toLocaleString()]})]}),l>0&&v.jsxs("div",{className:"summary-row green",children:[v.jsx("span",{children:"Savings"}),v.jsxs("span",{children:["-",l.toLocaleString()]})]}),v.jsxs("div",{className:"summary-row",children:[v.jsx("span",{children:"Delivery"}),v.jsx("span",{className:"free-tag",children:o>=499?"FREE ":"49"})]}),v.jsxs("div",{className:"summary-row total",children:[v.jsx("span",{children:"Total"}),v.jsxs("span",{children:["",(o+(o>=499?0:49)).toLocaleString()]})]})]}),v.jsx("button",{className:"checkout-btn",onClick:u,children:"Proceed to Checkout "}),v.jsx("button",{className:"continue-btn",onClick:()=>{e(),d("/products")},children:"Continue Shopping"})]})]})]})]})},aw=()=>v.jsxs("footer",{className:"footer",children:[v.jsx("div",{className:"footer-top",children:v.jsxs("div",{className:"container footer-grid",children:[v.jsxs("div",{className:"footer-brand",children:[v.jsxs(De,{to:"/",className:"footer-logo",children:[v.jsx("div",{className:"footer-logo-icon",children:v.jsx("img",{src:Cb,alt:"AmmaFoods",style:{width:"40px",height:"40px",objectFit:"contain",borderRadius:"50%"}})}),v.jsx("span",{children:"AmmaFoods"})]}),v.jsx("p",{children:"India's trusted source for premium herbal supplements, organic foods, and natural wellness products. 100% natural, lab-tested, and FSSAI certified."}),v.jsxs("div",{className:"footer-social",children:[v.jsx("a",{href:"#","aria-label":"Instagram",children:v.jsx(d_,{size:18})}),v.jsx("a",{href:"#","aria-label":"Facebook",children:v.jsx(s_,{size:18})}),v.jsx("a",{href:"#","aria-label":"YouTube",children:v.jsx(Y_,{size:18})}),v.jsx("a",{href:"#","aria-label":"Twitter",children:v.jsx(U_,{size:18})})]})]}),v.jsxs("div",{className:"footer-col",children:[v.jsx("h4",{children:"Quick Links"}),v.jsx("ul",{children:[["/","Home"],["/products","All Products"],["/products?tag=bestseller","Best Sellers"],["/products?category=Super+Saver+Combos","Combos"],["/products?category=Detox+Programs","Detox Programs"]].map(([a,e])=>v.jsx("li",{children:v.jsx(De,{to:a,children:e})},e))})]}),v.jsxs("div",{className:"footer-col",children:[v.jsx("h4",{children:"Categories"}),v.jsx("ul",{children:["Herbal Supplements","Teas & Infusions","Organic Foods","Oils & Ghee","Sugar Alternatives","Gym Diet"].map(a=>v.jsx("li",{children:v.jsx(De,{to:`/products?category=${encodeURIComponent(a)}`,children:a})},a))})]}),v.jsxs("div",{className:"footer-col",children:[v.jsx("h4",{children:"Contact Us"}),v.jsxs("div",{className:"footer-contact",children:[v.jsxs("div",{className:"contact-item",children:[v.jsx(yb,{size:14})," ",v.jsx("span",{children:"+91 98765 43210"})]}),v.jsxs("div",{className:"contact-item",children:[v.jsx(pb,{size:14})," ",v.jsx("span",{children:"support@ammafoods.com.au"})]}),v.jsxs("div",{className:"contact-item",children:[v.jsx(gb,{size:14})," ",v.jsx("span",{children:"Mumbai, Maharashtra, India"})]})]}),v.jsxs("div",{className:"footer-trust",children:[v.jsx("span",{children:" FSSAI Certified"}),v.jsx("span",{children:" Lab Tested"}),v.jsx("span",{children:" ISO 9001"})]})]})]})}),v.jsx("div",{className:"footer-bottom",children:v.jsxs("div",{className:"container footer-bottom-inner",children:[v.jsx("span",{children:" 2024 AmmaFoods. All rights reserved."}),v.jsxs("div",{className:"footer-links",children:[v.jsx("a",{href:"#",children:"Privacy Policy"}),v.jsx("a",{href:"#",children:"Terms & Conditions"}),v.jsx("a",{href:"#",children:"Refund Policy"}),v.jsx("a",{href:"#",children:"Shipping Policy"})]})]})})]}),Yr=({product:a})=>{const{addToCart:e}=Da(),[i,s]=N.useState(a.packs[0]),[o,l]=N.useState(!1),d=u=>{u.preventDefault(),e({id:a.id,name:a.name,price:a.price,originalPrice:a.originalPrice,image:a.image,quantity:1,pack:i,discount:a.discount}),l(!0),setTimeout(()=>l(!1),1800)};return v.jsxs("div",{className:"product-card",children:[v.jsx(De,{to:`/product/${a.id}`,className:"card-img-link",children:v.jsxs("div",{className:"card-img-wrap",children:[v.jsx("img",{src:a.image,alt:a.name,loading:"lazy"}),a.discount>0&&v.jsxs("span",{className:"card-discount",children:[a.discount,"% OFF"]}),a.tag&&a.tag!==`${a.discount}% OFF`&&v.jsx("span",{className:"card-tag",children:a.tag})]})}),v.jsxs("div",{className:"card-body",children:[v.jsxs("div",{className:"card-rating",children:[v.jsx(Kl,{size:12,fill:"#f9a825",color:"#f9a825"}),v.jsx("span",{children:a.rating}),v.jsxs("span",{className:"rating-count",children:["(",a.reviews.toLocaleString(),")"]})]}),v.jsx(De,{to:`/product/${a.id}`,className:"card-name",children:a.name}),v.jsxs("div",{className:"card-price",children:[v.jsxs("span",{className:"price-now",children:["",a.price]}),v.jsxs("span",{className:"price-was",children:["",a.originalPrice]}),v.jsxs("span",{className:"price-save",children:["Save ",a.originalPrice-a.price]})]}),a.packs.length>1&&v.jsx("div",{className:"card-packs",children:a.packs.map(u=>v.jsx("button",{className:`pack-btn ${i===u?"active":""}`,onClick:()=>s(u),children:u},u))}),v.jsx("button",{className:`card-atc ${o?"added":""}`,onClick:d,children:o?v.jsxs(v.Fragment,{children:[v.jsx(mb,{size:15})," Added!"]}):v.jsxs(v.Fragment,{children:[v.jsx($h,{size:15})," Add to Cart"]})})]})]})},Zv="/assets/Aavaram_idlypodi-CXc7KiXz.jpg",$v="/assets/BeetRoot_idlypodi-DaNF3zc5.jpg",ey="/assets/BitterMelon_idlypodi-DM__NpYK.jpg",ty="/assets/BlackJamunLeaves_idlypodi-bPBh8qBU.jpg",ny="/assets/CurryLeaves_idlypodi-C_NTgTxD.jpg",iy="/assets/Fenugreekleaves_idlypodi-Bj1Aw35F.jpg",ay="/assets/FigLeaves_idlypodi-CvMmJCsG.jpg",sy="/assets/FlaxSeeds_idlypodi-DR6rh-YB.jpg",ry="/assets/HerbalMasalaTea-DX1gqtqW.jpg",oy="/assets/HerbalSpicedCoffee-CGyihuF4.jpg",ly="/assets/HibiscusFlower_idlypodi-CLlvCrDl.jpg",cy="/assets/HorseGramRasamMix_idlypodi-yk13Hmhv.jpg",uy="/assets/HorseGram_idlypodi-CdWIoQJO.jpg",dy="/assets/Kurinja_idlypodi-DAeg-a_p.jpg",hy="/assets/MangoLeaves_idlypodi-UGpnIVsU.jpg",fy="/assets/ManiththakaaliLeaves_idlypodi-DDdHUFtL.jpg",my="/assets/MoringaLeavesCrab_masala-CljRlFLs.jpg",py="/assets/MornigaLeaves_idlypodi-B3H6mtdP.jpg",gy="/assets/Mulmurunkai_idlypodi-4SDby0Hn.jpg",vy="/assets/NeemFlower_idlypodi-9WiJQV66.jpg",yy="/assets/RosellaLeaves_idlypodi-CFPs9woZ.jpg",by="/assets/Sitrakaththi_idlypodi-Ddv6SGxX.jpg",Sy="/assets/SweetPotatoLeaves_idlypodi-CUiChC3A.jpg",Cy="/assets/SweetPotato_idlypodi-BiqmfcLc.jpg",Ty="/assets/Vallaarai_idlypodi-CR35Z5Wy.jpg",ky="/assets/VineLeaves_idlypodi-C47eM8_l.jpg",Ey="/assets/amla_idlypodi-Bm7185Oa.jpg",_y="/assets/moringa%20powder_p1-BZDoADPB.webp",wy="/assets/cow_ghee-BjEAQkYe.jpg",yi=[{id:"p1",name:"Organic Moringa Powder",category:"Herbal Supplements",condition:["Nutrition Supplements","Immunity Care"],goal:["Immunity","Energy"],price:349,originalPrice:399,discount:12,image:_y,images:[_y],description:"Premium organic moringa leaf powder rich in vitamins, minerals, and antioxidants. Supports overall health, boosts immunity and energy levels naturally.",benefits:["Rich in vitamins A, C, E","Boosts immunity","Supports energy levels","Anti-inflammatory properties","Rich in iron for anemia"],howToUse:"Mix 1 teaspoon in water, juice, or smoothie. Best consumed in the morning.",ingredients:"100% Organic Moringa Oleifera Leaf Powder",packs:["100g","200g","500g"],rating:4.7,reviews:1284,isBestSeller:!0,tag:"Best Seller"},{id:"p2",name:"Liver & Kidney Care",category:"Herbal Supplements",condition:["Liver / Kidney Care"],goal:["Detox","Wellness"],price:449,originalPrice:549,discount:18,image:"https://images.unsplash.com/photo-1615485500704-8e990f9900f7?w=600&q=80",images:["https://images.unsplash.com/photo-1615485500704-8e990f9900f7?w=600&q=80","https://images.unsplash.com/photo-1512621776951-a57141f2eefd?w=600&q=80"],description:"A scientifically formulated blend of traditional herbs to support liver detoxification and kidney health. Contains Kutki, Punarnava, and Bhumi Amla.",benefits:["Liver detox support","Kidney function support","Reduces toxin buildup","Supports healthy digestion"],howToUse:"Take 2 capsules twice daily after meals with water.",ingredients:"Kutki, Punarnava, Bhumi Amla, Kalmegh, Giloy",packs:["60 Capsules","120 Capsules"],rating:4.5,reviews:876,isBestSeller:!0,tag:"Best Seller"},{id:"p3",name:"Psyllium Whole Husk Isabgol",category:"Herbal Supplements",condition:["Gut Care","Constipation"],goal:["Digestion","Gut Health"],price:299,originalPrice:349,discount:14,image:"https://images.unsplash.com/photo-1586201375761-83865001e31c?w=600&q=80",images:["https://images.unsplash.com/photo-1586201375761-83865001e31c?w=600&q=80","https://images.unsplash.com/photo-1543353071-087092ec393a?w=600&q=80"],description:"Natural psyllium husk (Isabgol) for digestive health. Rich in soluble fiber that supports bowel regularity and gut health.",benefits:["Relieves constipation","Supports gut health","Natural fiber source","Helps manage cholesterol"],howToUse:"Mix 1-2 teaspoons in a glass of water or juice. Drink immediately before it thickens.",ingredients:"100% Natural Psyllium Husk (Plantago Ovata)",packs:["200g","400g","1kg"],rating:4.6,reviews:2134,isBestSeller:!0},{id:"p4",name:"Simply Chamomile Tea",category:"Teas & Infusions",condition:["Sleep Care"],goal:["Sleep","Calm"],price:249,originalPrice:299,discount:17,image:"https://images.unsplash.com/photo-1597318181409-cf64d0b5d8a2?w=600&q=80",images:["https://images.unsplash.com/photo-1597318181409-cf64d0b5d8a2?w=600&q=80","https://images.unsplash.com/photo-1576090503553-f37aba1d0e45?w=600&q=80"],description:"Pure chamomile flower tea for calm and restful sleep. Contains 100% whole chamomile flowers, no additives.",benefits:["Promotes relaxation","Supports restful sleep","Soothes anxiety","Gentle on stomach"],howToUse:"Steep 1 tea bag or 1 tsp in hot water (90C) for 3-5 minutes.",ingredients:"100% Dried Chamomile Flowers",packs:["20 Tea Bags","50 Tea Bags","100g Loose Leaf"],rating:4.8,reviews:1560,isBestSeller:!0,tag:"Fan Favourite"},{id:"p5",name:"Virgin Coconut Oil",category:"Oils & Ghee",condition:["Healthy Cooking Medium"],goal:["Fitness","Wellness"],price:499,originalPrice:599,discount:17,image:"https://images.unsplash.com/photo-1474979266404-7eaacbcd87c5?w=600&q=80",images:["https://images.unsplash.com/photo-1474979266404-7eaacbcd87c5?w=600&q=80","https://images.unsplash.com/photo-1526045612212-70caf35c14df?w=600&q=80"],description:"Cold-pressed virgin coconut oil retaining all natural nutrients. Ideal for cooking, skin care, and hair care.",benefits:["Cold-pressed & unrefined","Rich in MCTs","Supports metabolism","Antimicrobial properties"],howToUse:"Use as cooking oil, or apply topically for skin and hair.",ingredients:"100% Cold-Pressed Virgin Coconut Oil",packs:["250ml","500ml","1000ml"],rating:4.6,reviews:987,isBestSeller:!0},{id:"p6",name:"Active Start Combo",category:"Super Saver Combos",condition:["Metabolism Care","Immunity Care"],goal:["Energy","Fitness"],price:799,originalPrice:999,discount:20,image:"https://images.unsplash.com/photo-1490645935967-10de6ba17061?w=600&q=80",images:["https://images.unsplash.com/photo-1490645935967-10de6ba17061?w=600&q=80","https://images.unsplash.com/photo-1543353071-087092ec393a?w=600&q=80"],description:"Start your wellness journey with our Active Start Combo  moringa powder + ashwagandha + tulsi green tea for all-day energy.",benefits:["Complete energy support","Immunity booster","Adaptogenic herbs","Great for beginners"],howToUse:"Follow individual product instructions. Best taken in morning.",ingredients:"Moringa Powder 100g, Ashwagandha 60caps, Tulsi Green Tea 20 bags",packs:["Starter Kit"],rating:4.9,reviews:654,tag:"20% OFF"},{id:"p7",name:"Calm & Balance Combo",category:"Super Saver Combos",condition:["Sleep Care"],goal:["Calm","Sleep"],price:749,originalPrice:949,discount:21,image:"https://images.unsplash.com/photo-1544787219-7f47ccb76574?w=600&q=80",images:["https://images.unsplash.com/photo-1544787219-7f47ccb76574?w=600&q=80"],description:"Find your calm with Ashwagandha, Chamomile Tea, and our Stress Relief formula  designed for modern life stress management.",benefits:["Reduces cortisol","Promotes sleep","Balances mood","Adaptogenic support"],howToUse:"Take capsules at bedtime; drink chamomile tea 30 mins before sleep.",ingredients:"Ashwagandha 60caps, Chamomile Tea 20bags, Brahmi 60caps",packs:["Full Kit"],rating:4.7,reviews:432},{id:"p8",name:"Gut Reset Combo",category:"Super Saver Combos",condition:["Gut Care","Bloating / Gas"],goal:["Digestion","Gut Health"],price:699,originalPrice:899,discount:22,image:"https://images.unsplash.com/photo-1512621776951-a57141f2eefd?w=600&q=80",images:["https://images.unsplash.com/photo-1512621776951-a57141f2eefd?w=600&q=80"],description:"Complete gut reset with Triphala, Isabgol, and Jeera-Ajwain blend. Supports healthy digestion and gut microbiome.",benefits:["Relieves bloating","Supports gut flora","Detoxifies colon","Improves digestion"],howToUse:"Follow individual product guides. Best taken before bedtime.",ingredients:"Triphala 60caps, Isabgol 200g, Jeera-Ajwain Mix 100g",packs:["Gut Kit"],rating:4.6,reviews:389},{id:"p10",name:"Clean 7 Days Detox Kit",category:"Detox Programs",condition:["Gut Care","Liver / Kidney Care"],goal:["Detox","Weight"],price:1199,originalPrice:1499,discount:20,image:"https://images.unsplash.com/photo-1547592180-85f173990554?w=600&q=80",images:["https://images.unsplash.com/photo-1547592180-85f173990554?w=600&q=80"],description:"7-day complete body cleanse with herbal detox shakes, gut cleansing capsules, and liver support formula.",benefits:["Full body detox","Liver cleanse","Gut reset","Improved energy after 7 days"],howToUse:"Follow the included 7-day schedule card. Drink plenty of water.",ingredients:"Detox Shake Mix 300g, Triphala 30caps, Liver Support 30caps",packs:["7-Day Kit"],rating:4.5,reviews:312,isNew:!0,tag:"NEW"},{id:"p11",name:"Plant Protein Powder",category:"Gym Diet",condition:["Nutrition Supplements","Muscle Care"],goal:["Fitness","Weight"],price:1299,originalPrice:1599,discount:19,image:"https://images.unsplash.com/photo-1593095948071-474c5cc2989d?w=600&q=80",images:["https://images.unsplash.com/photo-1593095948071-474c5cc2989d?w=600&q=80"],description:"100% plant-based protein blend from pea, brown rice, and hemp. 25g protein per serving, no artificial flavors.",benefits:["25g protein per serving","All 9 essential amino acids","Easy to digest","No artificial sweeteners"],howToUse:"Mix 1 scoop in 250ml water or plant milk. 1-2 servings per day.",ingredients:"Pea Protein, Brown Rice Protein, Hemp Protein",packs:["500g","1kg","2kg"],rating:4.4,reviews:789,isNew:!0},{id:"p12",name:"Raw Organic Honey",category:"Sugar Alternatives",condition:["Immunity Care"],goal:["Immunity","Wellness"],price:449,originalPrice:549,discount:18,image:"https://images.unsplash.com/photo-1558642452-9d2a7deb7f62?w=600&q=80",images:["https://images.unsplash.com/photo-1558642452-9d2a7deb7f62?w=600&q=80"],description:"Unprocessed, unfiltered raw honey straight from the hive. Rich in enzymes, antioxidants, and natural goodness.",benefits:["Antibacterial properties","Rich in antioxidants","Natural energy source","Aids wound healing"],howToUse:"Use as sweetener in beverages, on toast, or directly by spoon.",ingredients:"100% Raw Unprocessed Honey",packs:["250g","500g","1kg"],rating:4.9,reviews:1876,isBestSeller:!0},{id:"p14",name:"Tulsi Green Tea",category:"Teas & Infusions",condition:["Immunity Care","Respiratory Care"],goal:["Immunity","Detox"],price:199,originalPrice:249,discount:20,image:"https://images.unsplash.com/photo-1556679343-c7306c1976bc?w=600&q=80",images:["https://images.unsplash.com/photo-1556679343-c7306c1976bc?w=600&q=80"],description:"A refreshing blend of Indian Holy Basil (Tulsi) and premium green tea. Rich in antioxidants and adaptogenic compounds.",benefits:["Boosts immunity","Rich in antioxidants","Respiratory support","Stress adaptogen"],howToUse:"Steep 1 tea bag in hot water (80C) for 2-3 minutes.",ingredients:"Green Tea Leaves, Tulsi (Holy Basil) leaves",packs:["25 Tea Bags","50 Tea Bags"],rating:4.6,reviews:934},{id:"p15",name:"Cow Ghee (A2)",category:"Oils & Ghee",condition:["Healthy Cooking Medium","Gut Care"],goal:["Wellness","Digestion"],price:799,originalPrice:999,discount:20,image:wy,images:[wy],description:"Pure A2 Gir Cow Ghee made using traditional bilona method. Rich in butyric acid, Omega-3, vitamins A, D, E, K.",benefits:["Improves gut health","Good cholesterol source","Brain food","Lactose-free"],howToUse:"Use for cooking, or take 1 tsp on empty stomach for gut health.",ingredients:"100% A2 Gir Cow Milk Ghee",packs:["250ml","500ml","1000ml"],rating:4.8,reviews:1432,isBestSeller:!0},{id:"p16",name:"Amla Powder (Indian Gooseberry)",category:"Herbal Supplements",condition:["Immunity Care","Heart Care"],goal:["Immunity","Wellness"],price:229,originalPrice:279,discount:18,image:"https://images.unsplash.com/photo-1551218808-94e220e084d2?w=600&q=80",images:["https://images.unsplash.com/photo-1551218808-94e220e084d2?w=600&q=80"],description:"Spray-dried pure Amla (Indian Gooseberry) powder. Richest natural source of Vitamin C. Supports immunity, hair, and skin.",benefits:["Highest Vitamin C source","Hair growth support","Skin brightening","Heart health"],howToUse:"Mix 1 tsp in warm water with honey. Drink on empty stomach.",ingredients:"100% Spray-Dried Amla Powder",packs:["100g","200g","500g"],rating:4.5,reviews:1123},{id:"p17",name:"Triphala Churna",category:"Herbal Supplements",condition:["Gut Care","Constipation","Colon Cleansing"],goal:["Digestion","Detox"],price:199,originalPrice:249,discount:20,image:"https://images.unsplash.com/photo-1505576399279-565b52d4ac71?w=600&q=80",images:["https://images.unsplash.com/photo-1505576399279-565b52d4ac71?w=600&q=80"],description:"Traditional Ayurvedic blend of three fruits (Amalaki, Bibhitaki, Haritaki) for complete digestive health and colon cleanse.",benefits:["Gentle laxative","Colon cleansing","Antioxidant rich","Liver support"],howToUse:"Mix 1 tsp in warm water at bedtime.",ingredients:"Amalaki, Bibhitaki, Haritaki in equal proportions",packs:["100g","200g","500g"],rating:4.6,reviews:1876},{id:"p20",name:"Detox Green Tea",category:"Teas & Infusions",condition:["Gut Care","Liver / Kidney Care"],goal:["Detox","Weight"],price:279,originalPrice:349,discount:20,image:"https://images.unsplash.com/photo-1564890369478-c89ca6d9cde9?w=600&q=80",images:["https://images.unsplash.com/photo-1564890369478-c89ca6d9cde9?w=600&q=80"],description:"A powerful detox blend with green tea, dandelion, milk thistle, and lemon peel. Supports liver cleansing and weight management.",benefits:["Liver detox support","Weight management","Metabolism boost","Rich in antioxidants"],howToUse:"Steep 1 tea bag in hot water for 3-4 minutes. Drink 2-3 cups daily.",ingredients:"Green Tea, Dandelion, Milk Thistle, Lemon Peel, Licorice Root",packs:["25 Tea Bags","50 Tea Bags"],rating:4.5,reviews:743},{id:"p21",name:"Organic Turmeric Capsules",category:"Herbal Supplements",condition:["Joint Care","Immunity Care","Heart Care"],goal:["Immunity","Wellness"],price:349,originalPrice:449,discount:22,image:"https://images.unsplash.com/photo-1615485290382-441e4d049cb5?w=600&q=80",images:["https://images.unsplash.com/photo-1615485290382-441e4d049cb5?w=600&q=80"],description:"High-bioavailability turmeric capsules with black pepper extract (Bioperine). Contains 95% standardized curcuminoids.",benefits:["Powerful anti-inflammatory","Joint pain relief","Heart health","Brain health"],howToUse:"Take 1 capsule twice daily with meals.",ingredients:"Turmeric Root Extract 500mg (95% Curcumin), Black Pepper Extract 5mg",packs:["60 Capsules","120 Capsules"],rating:4.6,reviews:1234}],sw=yi.filter(a=>a.isBestSeller);yi.filter(a=>a.isNew);yi.filter(a=>a.category==="Super Saver Combos");const Tb=[{id:"m1",name:"Aavaram Idly Podi",category:"Maruthompal",condition:["Immunity Care","Nutrition Supplements"],goal:["Immunity","Wellness"],price:350,originalPrice:420,discount:17,image:Zv,images:[Zv],description:"Aavaram Idly Podi is a traditional herbal spice powder made from Aavaram (Senna auriculata) flowers and leaves. This unique blend adds a distinct flavour to your idly and dosa while providing medicinal benefits. Rich in antioxidants, it is a popular home remedy in South India for managing blood sugar and improving overall wellness.",benefits:["Helps regulate blood sugar levels","Rich in antioxidants and flavonoids","Supports liver health","Boosts immunity naturally","Improves digestion"],howToUse:"Mix 12 teaspoons with sesame oil or ghee and serve alongside idly, dosa, or rice. Can be mixed into hot rice with a drizzle of ghee.",ingredients:"Aavaram flower & leaf powder, Urad dal, Chana dal, Dried red chillies, Curry leaves, Rock salt, Asafoetida",packs:["100g","200g","500g"],rating:4.5,reviews:412},{id:"m2",name:"Beetroot Idly Podi",category:"Maruthompal",condition:["Nutrition Supplements","Heart Care"],goal:["Immunity","Energy"],price:280,originalPrice:340,discount:18,image:$v,images:[$v],description:"Beetroot Idly Podi is a vibrant, nutrient-rich spice powder made from sun-dried beetroot blended with traditional spices. It gives your idly and dosa a beautiful reddish hue while loading every bite with essential vitamins and minerals. Beetroot is known for its ability to improve blood circulation and stamina.",benefits:["Rich in iron and folate","Improves blood circulation","Natural energy booster","Supports heart health","Antioxidant-rich"],howToUse:"Mix 12 teaspoons with sesame oil and serve with idly or dosa. Also great as a seasoning in rice dishes.",ingredients:"Dried beetroot powder, Urad dal, Chana dal, Dried red chillies, Curry leaves, Rock salt, Sesame seeds",packs:["100g","200g","500g"],rating:4.3,reviews:287},{id:"m3",name:"Bitter Melon Idly Podi",category:"Maruthompal",condition:["Gut Care","Immunity Care"],goal:["Wellness","Detox"],price:320,originalPrice:390,discount:18,image:ey,images:[ey],description:"Bitter Melon (Pavakkai) Idly Podi is crafted from sun-dried bitter gourd combined with aromatic spices. Despite its slightly bitter taste, this podi is a powerhouse of medicinal compounds. It is especially popular among those managing diabetes and seeking detox benefits from a daily dietary addition.",benefits:["Supports healthy blood sugar levels","Natural detoxifier","Improves digestive health","Anti-inflammatory properties","Rich in Vitamin C"],howToUse:"Use 12 teaspoons mixed in oil with idly or dosa. Start with smaller amounts if new to bitter flavours.",ingredients:"Dried bitter melon powder, Urad dal, Grated coconut, Dried red chillies, Curry leaves, Rock salt, Cumin",packs:["100g","200g","500g"],rating:4.1,reviews:198},{id:"m4",name:"Black Jamun Leaves Idly Podi",category:"Maruthompal",condition:["Immunity Care","Gut Care"],goal:["Wellness","Immunity"],price:420,originalPrice:520,discount:19,image:ty,images:[ty],description:"Black Jamun Leaves Idly Podi is prepared from the dried leaves of the Java Plum (Syzygium cumini) tree, which are revered in Ayurveda for their anti-diabetic properties. This earthy, flavourful podi is an excellent addition to a health-conscious diet, especially for those seeking natural blood sugar management.",benefits:["Helps control blood sugar","Anti-diabetic compounds","Improves gut health","Rich in antioxidants","Supports kidney health"],howToUse:"Mix 12 teaspoons with gingelly (sesame) oil and serve with idly, dosa, or rice.",ingredients:"Dried Black Jamun leaf powder, Urad dal, Chana dal, Dried red chillies, Rock salt, Asafoetida, Curry leaves",packs:["100g","200g","500g"],rating:4.6,reviews:341},{id:"m5",name:"Curry Leaves Idly Podi",category:"Maruthompal",condition:["Immunity Care","Nutrition Supplements"],goal:["Immunity","Wellness"],price:250,originalPrice:310,discount:19,image:ny,images:[ny],description:"Curry Leaves (Kadi Patta) Idly Podi is a classic South Indian condiment bursting with the fresh, aromatic essence of fresh curry leaves. Curry leaves are packed with iron, calcium, and powerful antioxidants called carbazole alkaloids that support hair health, liver function, and immunity.",benefits:["Promotes hair growth and prevents hair fall","Rich in iron and calcium","Supports liver health","Strong antioxidant properties","Improves digestion"],howToUse:"Serve 12 teaspoons mixed with ghee or sesame oil alongside idly, dosa, or rice.",ingredients:"Dried curry leaf powder, Urad dal, Chana dal, Dried red chillies, Garlic, Rock salt, Asafoetida",packs:["100g","200g","500g"],rating:4.7,reviews:524},{id:"m6",name:"Fenugreek Leaves Idly Podi",category:"Maruthompal",condition:["Gut Care","Immunity Care"],goal:["Wellness","Digestion"],price:290,originalPrice:360,discount:19,image:iy,images:[iy],description:"Fenugreek Leaves (Vendhaya Keerai) Idly Podi is made from dried methi leaves blended with traditional spices. Fenugreek is one of the oldest medicinal herbs in the world, celebrated for its ability to improve digestion, control blood sugar, and support lactation in nursing mothers. This slightly bitter, flavourful podi is a wholesome addition to any meal.",benefits:["Controls blood glucose levels","Improves digestion and relieves gas","Supports lactation in nursing mothers","Anti-inflammatory benefits","Rich in fibre and iron"],howToUse:"Mix 12 teaspoons with sesame oil or ghee. Best served with idly, dosa, or rice.",ingredients:"Dried fenugreek leaf powder, Urad dal, Chana dal, Dried red chillies, Rock salt, Curry leaves, Sesame seeds",packs:["100g","200g","500g"],rating:4.4,reviews:309},{id:"m7",name:"Fig Leaves Idly Podi",category:"Maruthompal",condition:["Gut Care","Immunity Care"],goal:["Wellness","Digestion"],price:480,originalPrice:590,discount:19,image:ay,images:[ay],description:"Fig Leaves (Athi Ilai) Idly Podi is a rare and traditionally valued condiment made from dried fig leaves. Fig leaves contain compounds that benefit digestive health and have been used in traditional medicine to help manage blood sugar levels. This unique podi has a subtle, earthy flavour that pairs wonderfully with South Indian breakfast staples.",benefits:["Supports healthy blood sugar","Improves digestive health","Anti-inflammatory benefits","Rich in minerals","Supports respiratory health"],howToUse:"Mix 12 teaspoons with sesame oil and serve with idly or dosa.",ingredients:"Dried fig leaf powder, Urad dal, Sesame seeds, Dried red chillies, Rock salt, Asafoetida, Curry leaves",packs:["100g","200g"],rating:4.2,reviews:156},{id:"m8",name:"Flax Seeds Idly Podi",category:"Maruthompal",condition:["Heart Care","Nutrition Supplements"],goal:["Wellness","Fitness"],price:310,originalPrice:380,discount:18,image:sy,images:[sy],description:"Flax Seeds (Ali Virai) Idly Podi is a nutrient-dense spice blend made from roasted and ground flaxseeds. Flaxseeds are one of the richest plant sources of Omega-3 fatty acids and lignans, making this podi an excellent addition for heart health, hormone balance, and gut health. Its nutty, roasted flavour makes it a delicious everyday condiment.",benefits:["Excellent source of Omega-3 fatty acids","Supports heart health","Rich in fibre for gut health","Hormone-balancing lignans","Anti-cancer antioxidants"],howToUse:"Mix 12 teaspoons with sesame oil or ghee. Serve with idly, dosa, rice, or blend into smoothies.",ingredients:"Roasted flaxseed powder, Urad dal, Sesame seeds, Dried red chillies, Rock salt, Curry leaves, Cumin",packs:["100g","200g","500g"],rating:4.6,reviews:478},{id:"m9",name:"Herbal Masala Tea",category:"Maruthompal",condition:["Immunity Care","Respiratory Care"],goal:["Immunity","Energy"],price:450,originalPrice:560,discount:20,image:ry,images:[ry],description:"Herbal Masala Tea is an aromatic blend of premium black tea with traditional Indian spices and medicinal herbs. This warming beverage is crafted with ginger, cardamom, cinnamon, cloves, and pepper  each ingredient carefully selected for its therapeutic properties. A perfect morning ritual that energises the body and fortifies immunity.",benefits:["Boosts immunity and energy","Supports respiratory health","Relieves cold and congestion","Anti-inflammatory properties","Promotes digestive comfort"],howToUse:"Add 1 teaspoon to 150ml of boiling water/milk. Simmer for 23 minutes. Strain and enjoy with or without sweetener.",ingredients:"Black tea, Ginger, Cardamom, Cinnamon, Cloves, Black pepper, Tulsi, Star anise",packs:["50g","100g","200g"],rating:4.8,reviews:623},{id:"m10",name:"Herbal Spiced Coffee",category:"Maruthompal",condition:["Immunity Care","Metabolism Care"],goal:["Energy","Wellness"],price:520,originalPrice:640,discount:19,image:oy,images:[oy],description:"Herbal Spiced Coffee is a unique fusion of premium roasted coffee with a blend of Ayurvedic spices and adaptogens. This exceptional beverage provides the familiar comfort of coffee while incorporating the health benefits of traditional Indian herbs. It offers a smooth, spiced flavour profile with a warming, energising finish.",benefits:["Natural energy boost","Adaptogenic stress relief","Improves focus and alertness","Anti-inflammatory spices","Supports metabolism"],howToUse:"Mix 12 teaspoons in 150ml of hot water or milk. Simmer for 12 minutes. Sweeten with jaggery or honey as preferred.",ingredients:"Roasted Arabica coffee, Ashwagandha, Cardamom, Cinnamon, Ginger, Nutmeg, Black pepper",packs:["50g","100g","200g"],rating:4.7,reviews:389},{id:"m11",name:"Hibiscus Flower Idly Podi",category:"Maruthompal",condition:["Heart Care","Women's Health"],goal:["Wellness","Immunity"],price:380,originalPrice:470,discount:19,image:ly,images:[ly],description:"Hibiscus Flower (Sembaruthi) Idly Podi is made from dried hibiscus petals blended with traditional spices that lend a beautiful natural colour and a mild tangy flavour. Hibiscus is celebrated in Ayurveda and modern research for its ability to support heart health, manage blood pressure, and promote hair growth.",benefits:["Helps lower blood pressure","Rich in Vitamin C and antioxidants","Promotes hair growth","Supports liver health","Natural diuretic properties"],howToUse:"Mix 12 teaspoons with sesame oil or ghee and serve with idly or dosa.",ingredients:"Dried hibiscus flower powder, Urad dal, Sesame seeds, Dried red chillies, Rock salt, Curry leaves, Tamarind",packs:["100g","200g","500g"],rating:4.5,reviews:267},{id:"m12",name:"Horse Gram Rasam Mix",category:"Maruthompal",condition:["Gut Care","Nutrition Supplements"],goal:["Wellness","Digestion"],price:290,originalPrice:360,discount:19,image:cy,images:[cy],description:"Horse Gram Rasam Mix (Kollu Rasam) is a traditional South Indian soup mix made from earthy horse gram lentils combined with tamarind, tomato, and aromatic spices. Known in Tamil as 'Kollu', horse gram is one of the most protein-rich legumes and is celebrated for its powerful diuretic and weight management properties.",benefits:["High in protein and fibre","Supports kidney stone management","Natural diuretic properties","Aids weight management","Improves digestive health"],howToUse:"Mix 23 teaspoons in 500ml of water. Bring to a boil with a tempering of mustard seeds and curry leaves. Serve hot as a soup.",ingredients:"Horse gram powder, Tamarind, Tomato powder, Cumin, Black pepper, Garlic, Curry leaves, Rock salt, Asafoetida",packs:["100g","200g","500g"],rating:4.4,reviews:334},{id:"m13",name:"Horse Gram Idly Podi",category:"Maruthompal",condition:["Nutrition Supplements","Gut Care"],goal:["Fitness","Wellness"],price:260,originalPrice:320,discount:19,image:uy,images:[uy],description:"Horse Gram (Kollu) Idly Podi is a protein-packed traditional condiment made from roasted horse gram blended with dried red chillies, garlic, and aromatic spices. Horse gram is one of the few legumes with the highest protein content and is revered in South Indian cooking for both its nutrition and its powerful medicinal properties.",benefits:["High protein content","Supports weight management","Natural diuretic properties","Improves metabolic rate","Rich in iron and calcium"],howToUse:"Mix 12 teaspoons with sesame oil or ghee. Serve with idly, dosa, or rice.",ingredients:"Roasted horse gram powder, Dried red chillies, Garlic, Curry leaves, Rock salt, Asafoetida, Sesame seeds",packs:["100g","200g","500g"],rating:4.5,reviews:445},{id:"m14",name:"Kurinja Idly Podi",category:"Maruthompal",condition:["Gut Care","Immunity Care"],goal:["Wellness","Detox"],price:450,originalPrice:560,discount:20,image:dy,images:[dy],description:"Kurinja Idly Podi is crafted from the rare Kurinji plant (Strobilanthes kunthianus), famous for its once-in-12-years blooming cycle in the Nilgiri hills. This unique podi carries traditional medicinal properties and an earthy, distinctive taste that sets it apart from regular podis.",benefits:["Rare herbal medicinal properties","Supports respiratory health","Anti-inflammatory benefits","Natural immunity booster","Rich in unique phytonutrients"],howToUse:"Mix 1 teaspoon with sesame oil and serve alongside idly or dosa. Best consumed fresh.",ingredients:"Dried Kurinji plant powder, Urad dal, Dried red chillies, Rock salt, Sesame seeds, Curry leaves",packs:["100g","200g"],rating:4.3,reviews:142},{id:"m15",name:"Mango Leaves Idly Podi",category:"Maruthompal",condition:["Immunity Care","Gut Care"],goal:["Wellness","Immunity"],price:340,originalPrice:420,discount:19,image:hy,images:[hy],description:"Mango Leaves (Mangai Ilai) Idly Podi is prepared from tender dried mango leaves rich in mangiferin, a powerful antioxidant. In Ayurveda, mango leaves are used to manage diabetes, improve eye health, and treat kidney and gall bladder stones. This podi brings together traditional wisdom and culinary delight in every serving.",benefits:["Rich in mangiferin antioxidants","Helps manage diabetes","Supports kidney health","Improves eye health","Anti-inflammatory properties"],howToUse:"Mix 12 teaspoons with sesame oil or ghee and serve with idly or dosa.",ingredients:"Dried mango leaf powder, Urad dal, Chana dal, Dried red chillies, Rock salt, Curry leaves, Sesame seeds",packs:["100g","200g","500g"],rating:4.4,reviews:223},{id:"m16",name:"Manithakaali Leaves Idly Podi",category:"Maruthompal",condition:["Gut Care","Immunity Care"],goal:["Wellness","Digestion"],price:380,originalPrice:470,discount:19,image:fy,images:[fy],description:"Manithakaali (Black Night Shade / Manathakkali) Idly Podi is made from dried Solanum nigrum leaves and berries, a plant deeply rooted in Siddha and Ayurvedic medicine. Particularly known for its ability to heal mouth ulcers (canker sores), soothe stomach ailments, and support liver health, this podi is a precious traditional remedy in South Indian homes.",benefits:["Heals mouth ulcers effectively","Soothes stomach and intestinal ulcers","Supports liver health","Anti-inflammatory and analgesic","Rich in alkaloids and antioxidants"],howToUse:"Mix 12 teaspoons with sesame oil or ghee. Serve with idly, dosa, or rice.",ingredients:"Dried Manathakkali leaf and berry powder, Urad dal, Dried red chillies, Rock salt, Curry leaves, Cumin, Sesame seeds",packs:["100g","200g","500g"],rating:4.6,reviews:389},{id:"m17",name:"Moringa Leaves Crab Masala",category:"Maruthompal",condition:["Nutrition Supplements","Immunity Care"],goal:["Energy","Wellness"],price:650,originalPrice:800,discount:19,image:my,images:[my],description:"Moringa Leaves Crab Masala is a premium spice blend combining the nutritional powerhouse of moringa leaves with the bold, coastal flavours of traditional crab masala. This unique fusion spice mix is perfect for seafood dishes, especially crab curry, and adds both exceptional flavour and a rich nutritional profile to your meals.",benefits:["92 nutrients in moringa","Boosts energy and immunity","Rich in Vitamin C and iron","Supports bone health","Powerful antioxidant blend"],howToUse:"Use 23 teaspoons as a marinade or curry base for crab or other seafood. Can also be used for chicken and vegetarian dishes.",ingredients:"Dried moringa leaf powder, Coriander, Cumin, Red chillies, Black pepper, Fennel, Turmeric, Cinnamon, Cloves, Rock salt, Garlic",packs:["100g","200g"],rating:4.7,reviews:178},{id:"m18",name:"Moringa Leaves Idly Podi",category:"Maruthompal",condition:["Nutrition Supplements","Immunity Care"],goal:["Energy","Immunity"],price:300,originalPrice:370,discount:19,image:py,images:[py],description:"Moringa Leaves (Murungai Keerai) Idly Podi is made from the world's most nutritious plant  Moringa oleifera. This podi is packed with 92 nutrients, 46 antioxidants, and all essential amino acids. It is a perfect daily supplement disguised as a delicious condiment, making it easy to incorporate the benefits of moringa into every meal.",benefits:["92 nutrients and 46 antioxidants","All 9 essential amino acids","Boosts immunity and energy","Supports bone health","Iron-rich for anemia"],howToUse:"Mix 12 teaspoons with sesame oil or ghee. Serve with idly, dosa, or rice.",ingredients:"Dried moringa leaf powder, Urad dal, Sesame seeds, Dried red chillies, Garlic, Rock salt, Curry leaves",packs:["100g","200g","500g"],rating:4.8,reviews:567},{id:"m19",name:"Mulmurunkai Idly Podi",category:"Maruthompal",condition:["Immunity Care","Nutrition Supplements"],goal:["Immunity","Wellness"],price:420,originalPrice:520,discount:19,image:gy,images:[gy],description:"Mulmurunkai (Erythrina indica / Indian Coral Tree) Idly Podi is prepared from the dried leaves of the coral tree, a plant used in Siddha medicine for centuries. The leaves of Mulmurunkai are known for their anti-rheumatic, anti-inflammatory, and sedative properties, making this podi a truly medicinal condiment.",benefits:["Anti-inflammatory properties","Supports joint health","Calming and sedative effects","Antioxidant compounds","Traditional Siddha medicinal herb"],howToUse:"Mix 1 teaspoon with sesame oil and serve with idly or dosa. Use in moderation.",ingredients:"Dried Mulmurunkai leaf powder, Urad dal, Dried red chillies, Rock salt, Curry leaves, Sesame seeds",packs:["100g","200g"],rating:4.3,reviews:134},{id:"m20",name:"Neem Flower Idly Podi",category:"Maruthompal",condition:["Immunity Care","Gut Care"],goal:["Detox","Wellness"],price:360,originalPrice:450,discount:20,image:vy,images:[vy],description:"Neem Flower (Veppam Poo) Idly Podi is a traditional South Indian condiment made from dried neem flowers, celebrated for their intense bitter flavour and powerful medicinal properties. In Ayurveda, neem flowers are prized for purifying the blood, supporting liver function, and eliminating toxins from the body.",benefits:["Powerful blood purifier","Detoxifies the liver","Anti-diabetic properties","Eliminates intestinal worms","Supports skin health"],howToUse:"Mix 1 teaspoon with sesame oil and serve sparingly with idly or rice. Best consumed in small quantities due to intense bitter taste.",ingredients:"Dried neem flower powder, Urad dal, Dried red chillies, Rock salt, Asafoetida, Cumin, Sesame seeds",packs:["100g","200g"],rating:4.2,reviews:212},{id:"m21",name:"Rosella Leaves Idly Podi",category:"Maruthompal",condition:["Heart Care","Immunity Care"],goal:["Wellness","Immunity"],price:390,originalPrice:480,discount:19,image:yy,images:[yy],description:"Rosella Leaves (Gongura / Pulicha Keerai) Idly Podi is made from the tangy, iron-rich rosella plant that is iconic in Andhra and Tamil cuisine. Rich in Vitamin C and iron, this podi has a pleasantly sour taste and is known for its ability to improve haemoglobin levels and support digestion.",benefits:["Rich in iron and Vitamin C","Improves haemoglobin levels","Supports digestive health","Antioxidant-rich","Natural appetiser"],howToUse:"Mix 12 teaspoons with sesame oil and serve with idly, dosa, or rice.",ingredients:"Dried rosella leaf powder, Urad dal, Chana dal, Dried red chillies, Garlic, Rock salt, Cumin, Sesame seeds",packs:["100g","200g","500g"],rating:4.5,reviews:298},{id:"m22",name:"Sitrakaththi Idly Podi",category:"Maruthompal",condition:["Immunity Care","Gut Care"],goal:["Wellness","Immunity"],price:440,originalPrice:550,discount:20,image:by,images:[by],description:"Sitrakaththi (Andrographis paniculata / Kalmegh) Idly Podi is crafted from the 'King of Bitters', a plant revered in Siddha and Ayurvedic medicine for its exceptional immune-boosting and fever-fighting properties. This intensely bitter podi is a potent medicinal condiment traditionally used to ward off infections and support liver function.",benefits:["Potent immunity booster","Reduces fever naturally","Strong liver protector","Anti-viral and anti-bacterial","Bitter compounds aid digestion"],howToUse:"Mix 1 teaspoon with sesame oil and serve sparingly with idly, dosa, or rice.",ingredients:"Dried Andrographis leaf powder, Urad dal, Dried red chillies, Rock salt, Cumin, Black pepper, Curry leaves",packs:["100g","200g"],rating:4.4,reviews:167},{id:"m23",name:"Sweet Potato Leaves Idly Podi",category:"Maruthompal",condition:["Nutrition Supplements","Immunity Care"],goal:["Wellness","Immunity"],price:320,originalPrice:400,discount:20,image:Sy,images:[Sy],description:"Sweet Potato Leaves Idly Podi is prepared from the nutrient-dense leaves of the sweet potato plant (Ipomoea batatas), which are often more nutritious than the tuber itself. Rich in protein and antioxidants, these leaves are used in traditional cuisine across South and Southeast Asia and are now becoming increasingly popular in health-conscious diets.",benefits:["High in protein and iron","Rich in beta-carotene (Vitamin A)","Strong antioxidant properties","Supports eye health","Boosts immunity"],howToUse:"Mix 12 teaspoons with sesame oil and serve with idly, dosa, or rice.",ingredients:"Dried sweet potato leaf powder, Urad dal, Chana dal, Dried red chillies, Garlic, Rock salt, Sesame seeds, Curry leaves",packs:["100g","200g","500g"],rating:4.3,reviews:189},{id:"m24",name:"Sweet Potato Idly Podi",category:"Maruthompal",condition:["Nutrition Supplements","Gut Care"],goal:["Energy","Wellness"],price:270,originalPrice:340,discount:21,image:Cy,images:[Cy],description:"Sweet Potato (Sakkaraivalli Kizhangu) Idly Podi is made from sun-dried sweet potato blended with traditional spices. Sweet potato is a superfood rich in beta-carotene, complex carbohydrates, and dietary fibre. This mildly sweet and spiced podi is a healthy and delicious alternative to conventional idly podis.",benefits:["Rich in beta-carotene (Vitamin A)","Excellent source of dietary fibre","Sustained energy release","Gut-friendly prebiotic fibre","Immune-supporting antioxidants"],howToUse:"Mix 12 teaspoons with sesame oil or ghee and serve with idly, dosa, or rice.",ingredients:"Dried sweet potato powder, Urad dal, Sesame seeds, Dried red chillies, Rock salt, Curry leaves, Cumin",packs:["100g","200g","500g"],rating:4.4,reviews:302},{id:"m25",name:"Vallaarai Idly Podi",category:"Maruthompal",condition:["Immunity Care","Nutrition Supplements"],goal:["Wellness","Energy"],price:460,originalPrice:570,discount:19,image:Ty,images:[Ty],description:"Vallaarai (Centella asiatica / Gotu Kola) Idly Podi is made from one of the most prized herbs in Ayurveda and Siddha medicine. Vallaarai is revered as a brain tonic that enhances memory, concentration, and cognitive function. This earthy, mildly bitter podi is a delicious way to nourish the mind and nervous system daily.",benefits:["Enhances memory and concentration","Natural brain tonic (nootropic)","Reduces anxiety and stress","Supports wound healing","Improves blood circulation"],howToUse:"Mix 12 teaspoons with sesame oil or ghee and serve with idly, dosa, or rice.",ingredients:"Dried Vallaarai leaf powder, Urad dal, Sesame seeds, Dried red chillies, Rock salt, Curry leaves, Cumin",packs:["100g","200g","500g"],rating:4.7,reviews:512},{id:"m26",name:"Vine Leaves Idly Podi",category:"Maruthompal",condition:["Gut Care","Immunity Care"],goal:["Wellness","Digestion"],price:350,originalPrice:440,discount:20,image:ky,images:[ky],description:"Vine Leaves (Grape Leaves / Draksha Ilai) Idly Podi is a unique condiment made from dried grape vine leaves, which are rich in polyphenols, flavonoids, and antioxidants. Grape leaves have been used in Mediterranean and Ayurvedic traditions for their anti-inflammatory, digestive, and circulatory benefits.",benefits:["Rich in polyphenols and antioxidants","Supports healthy circulation","Anti-inflammatory properties","Aids digestive health","Rich in Vitamin K"],howToUse:"Mix 12 teaspoons with sesame oil and serve with idly, dosa, or rice.",ingredients:"Dried grape vine leaf powder, Urad dal, Chana dal, Dried red chillies, Rock salt, Sesame seeds, Cumin",packs:["100g","200g"],rating:4.2,reviews:127},{id:"m27",name:"Amla Idly Podi",category:"Maruthompal",condition:["Immunity Care","Heart Care"],goal:["Immunity","Wellness"],price:290,originalPrice:360,discount:19,image:Ey,images:[Ey],description:"Amla (Indian Gooseberry / Nellikai) Idly Podi is made from sun-dried amla, the richest natural source of Vitamin C. With 20 times more Vitamin C than oranges, amla is a true superfruit that supports immunity, hair growth, skin health, and eye health. This tangy, flavourful podi adds both taste and immense nutritional value to your daily meals.",benefits:["20x more Vitamin C than oranges","Promotes hair growth and reduces hair fall","Brightens skin naturally","Strengthens immunity","Supports eye and liver health"],howToUse:"Mix 12 teaspoons with sesame oil or ghee and serve with idly, dosa, or rice.",ingredients:"Dried amla powder, Urad dal, Sesame seeds, Dried red chillies, Rock salt, Curry leaves, Cumin",packs:["100g","200g","500g"],rating:4.6,reviews:456}],kb=()=>[...yi,...Tb],rw=a=>kb().find(e=>e.id===a),Vi=a=>yi.filter(e=>e.goal.includes(a));Vi("Energy"),Vi("Calm"),Vi("Digestion"),Vi("Immunity"),Vi("Detox"),Vi("Fitness"),Vi("Sleep"),Vi("Weight");const ys=[{title:"Nature's Best for Your Health",sub:"Premium Herbal Supplements, Organic Foods & Teas",cta:"Shop Now",link:"/products",bg:"linear-gradient(135deg, #1b5e20 0%, #2e7d32 50%, #388e3c 100%)",img:"https://images.unsplash.com/photo-1505576399279-565b52d4ac71?w=800&q=80"},{title:"Super Saver Combos",sub:"Curated wellness bundles  Up to 25% OFF",cta:"Explore Combos",link:"/products?category=Super+Saver+Combos",bg:"linear-gradient(135deg, #e65100 0%, #f57c00 100%)",img:"https://images.unsplash.com/photo-1622979135225-d2ba269cf1ac?w=800&q=80"},{title:"PAN-India Free Delivery",sub:"COD Available  Authentic Products  5 Lakh+ Customers",cta:"Browse Products",link:"/products",bg:"linear-gradient(135deg, #1a237e 0%, #283593 100%)",img:"https://images.unsplash.com/photo-1556909114-44e3e70034e2?w=800&q=80"}],ow=[{icon:"",label:"Energy",color:"#ff6b35"},{icon:"",label:"Calm",color:"#7b68ee"},{icon:"",label:"Digestion",color:"#2e7d32"},{icon:"",label:"Immunity",color:"#e65100"},{icon:"",label:"Detox",color:"#00838f"},{icon:"",label:"Fitness",color:"#1565c0"},{icon:"",label:"Sleep",color:"#4a148c"},{icon:"",label:"Weight",color:"#bf360c"}],Yd=yi.slice(0,6),Jd=sw.slice(0,8),lw=[{name:"Priya S.",loc:"Mumbai",rating:5,text:"The Moringa Powder has transformed my energy levels. I feel so much more active!",avatar:"P"},{name:"Raj K.",loc:"Delhi",rating:5,text:"Liver & Kidney Care capsules are incredible. My liver enzymes are back to normal.",avatar:"R"},{name:"Ananya M.",loc:"Bangalore",rating:5,text:"Chamomile Tea is my nightly ritual now. Deep, restful sleep every night!",avatar:"A"}],cw=()=>{const[a,e]=N.useState(0),[i,s]=N.useState(0),[o,l]=N.useState(0),d=N.useRef(null);e1.useEffect(()=>(d.current=window.setInterval(()=>e(m=>(m+1)%ys.length),5e3),()=>{d.current!==null&&clearInterval(d.current)}),[]);const u=Yd.slice(i,i+4),h=Jd.slice(o,o+4);return v.jsxs("main",{className:"page-content",children:[v.jsx("section",{className:"hero-section",children:v.jsxs("div",{className:"hero-slider",children:[ys.map((m,g)=>v.jsxs("div",{className:`hero-slide ${g===a?"active":""}`,style:{background:m.bg},children:[v.jsx("div",{className:"hero-img-wrap",children:v.jsx("img",{src:m.img,alt:m.title})}),v.jsxs("div",{className:"hero-content",children:[v.jsx("h1",{className:"hero-title",children:m.title}),v.jsx("p",{className:"hero-sub",children:m.sub}),v.jsxs("div",{className:"hero-ctas",children:[v.jsx(De,{to:m.link,className:"btn btn-accent",children:m.cta}),v.jsx(De,{to:"/products",className:"btn btn-outline hero-outline",children:"View All Products"})]})]})]},g)),v.jsx("div",{className:"hero-dots",children:ys.map((m,g)=>v.jsx("button",{className:`hero-dot ${g===a?"active":""}`,onClick:()=>e(g)},g))}),v.jsx("button",{className:"hero-arrow left",onClick:()=>e(m=>(m-1+ys.length)%ys.length),children:v.jsx(Ml,{size:20})}),v.jsx("button",{className:"hero-arrow right",onClick:()=>e(m=>(m+1)%ys.length),children:v.jsx(Al,{size:20})})]})}),v.jsx("section",{className:"badges-section",children:v.jsxs("div",{className:"container badges-inner",children:[v.jsxs("div",{className:"trust-badge",children:[v.jsx(Yl,{size:22}),v.jsx("span",{children:"Free PAN-India Delivery"})]}),v.jsxs("div",{className:"trust-badge",children:[v.jsx(x_,{size:22}),v.jsx("span",{children:"100% Authentic Products"})]}),v.jsxs("div",{className:"trust-badge",children:[v.jsx(Kl,{size:22}),v.jsx("span",{children:"5 Lakh+ Happy Customers"})]}),v.jsxs("div",{className:"trust-badge",children:[v.jsx(Sb,{size:22}),v.jsx("span",{children:"Easy Returns & Refunds"})]})]})}),v.jsx("section",{className:"section goals-section",children:v.jsxs("div",{className:"container",children:[v.jsx("h2",{className:"section-title",children:"Shop By Goal"}),v.jsx("p",{className:"section-sub",children:"Find the right products tailored to your health goals"}),v.jsx("div",{className:"goal-tiles",children:ow.map(m=>v.jsxs(De,{to:`/products?goal=${m.label}`,className:"goal-pill",style:{"--gc":m.color},children:[v.jsx("span",{className:"goal-pill-icon",children:m.icon}),v.jsx("span",{children:m.label})]},m.label))})]})}),v.jsx("section",{className:"section carousel-section",children:v.jsxs("div",{className:"container",children:[v.jsxs("div",{className:"section-header",children:[v.jsxs("div",{children:[v.jsx("h2",{className:"section-title",style:{textAlign:"left",marginBottom:0},children:"Featured Products"}),v.jsx("p",{className:"section-sub",style:{textAlign:"left",marginBottom:0},children:"Handpicked for your wellness journey"})]}),v.jsxs("div",{className:"carousel-arrows",children:[v.jsx("button",{className:"carousel-btn",onClick:()=>s(Math.max(0,i-1)),disabled:i===0,children:v.jsx(Ml,{size:18})}),v.jsx("button",{className:"carousel-btn",onClick:()=>s(Math.min(Yd.length-4,i+1)),disabled:i>=Yd.length-4,children:v.jsx(Al,{size:18})})]})]}),v.jsx("div",{className:"products-grid",children:u.map(m=>v.jsx(Yr,{product:m},m.id))})]})}),v.jsx("section",{className:"section carousel-section bestsellers-bg",children:v.jsxs("div",{className:"container",children:[v.jsxs("div",{className:"section-header",children:[v.jsxs("div",{children:[v.jsx("h2",{className:"section-title",style:{textAlign:"left",marginBottom:0},children:" Our Best Sellers"}),v.jsx("p",{className:"section-sub",style:{textAlign:"left",marginBottom:0},children:"Most loved by our customers"})]}),v.jsxs("div",{className:"carousel-arrows",children:[v.jsx("button",{className:"carousel-btn",onClick:()=>l(Math.max(0,o-1)),disabled:o===0,children:v.jsx(Ml,{size:18})}),v.jsx("button",{className:"carousel-btn",onClick:()=>l(Math.min(Jd.length-4,o+1)),disabled:o>=Jd.length-4,children:v.jsx(Al,{size:18})})]})]}),v.jsx("div",{className:"products-grid",children:h.map(m=>v.jsx(Yr,{product:m},m.id))}),v.jsx("div",{style:{textAlign:"center",marginTop:28},children:v.jsx(De,{to:"/products?tag=bestseller",className:"view-all-cta",children:"View All Best Sellers "})})]})}),v.jsx("section",{className:"section why-section",children:v.jsxs("div",{className:"container",children:[v.jsx("h2",{className:"section-title",children:"Why Choose AmmaFoods?"}),v.jsx("div",{className:"why-grid",children:[{icon:"",title:"100% Natural",desc:"All products are made from pure, natural ingredients  no synthetic additives."},{icon:"",title:"Lab Tested",desc:"Every batch is tested for quality, purity, and potency by third-party labs."},{icon:"",title:"FSSAI Certified",desc:"All products comply with Indian food safety standards and AYUSH guidelines."},{icon:"",title:"Free Delivery",desc:"Free shipping across India on orders above 499. COD available."},{icon:"",title:"Eco-Friendly",desc:"Sustainable packaging, minimal plastic, and carbon-conscious operations."},{icon:"",title:"5 Lakh+ Happy Customers",desc:"Over 5 lakh satisfied customers trust AmmaFoods for their health needs."}].map(m=>v.jsxs("div",{className:"why-card",children:[v.jsx("div",{className:"why-icon",children:m.icon}),v.jsx("h3",{children:m.title}),v.jsx("p",{children:m.desc})]},m.title))})]})}),v.jsx("section",{className:"section testimonial-section",children:v.jsxs("div",{className:"container",children:[v.jsx("h2",{className:"section-title",children:"What Our Customers Say"}),v.jsx("div",{className:"testimonials-grid",children:lw.map(m=>v.jsxs("div",{className:"testimonial-card",children:[v.jsx("div",{className:"t-stars",children:Array.from({length:m.rating}).map((g,y)=>v.jsx(Kl,{size:14,fill:"#f9a825",color:"#f9a825"},y))}),v.jsxs("p",{className:"t-text",children:['"',m.text,'"']}),v.jsxs("div",{className:"t-author",children:[v.jsx("div",{className:"t-avatar",children:m.avatar}),v.jsxs("div",{children:[v.jsx("strong",{children:m.name}),v.jsx("span",{children:m.loc})]})]})]},m.name))})]})})]})},uw=["Popularity","Price: Low to High","Price: High to Low","Discount","Rating"],dw=[...new Set(yi.map(a=>a.category))],hw=[...new Set(yi.flatMap(a=>a.goal))],fw=()=>{const[a]=jE(),[e,i]=N.useState("Popularity"),[s,o]=N.useState([]),[l,d]=N.useState([]),[u,h]=N.useState(2e3),[m,g]=N.useState(!1),[y,S]=N.useState(""),T=a.get("q")||"",x=a.get("category")||"",E=a.get("goal")||"",k=a.get("condition")||"",R=a.get("tag")||"",O=N.useMemo(()=>{let P=[...yi];switch(T&&(P=P.filter(H=>H.name.toLowerCase().includes(T.toLowerCase())||H.description.toLowerCase().includes(T.toLowerCase()))),x&&(P=P.filter(H=>H.category===x)),E&&(P=P.filter(H=>H.goal.includes(E))),k&&(P=P.filter(H=>H.condition.includes(k))),R==="bestseller"&&(P=P.filter(H=>H.isBestSeller)),s.length&&(P=P.filter(H=>s.includes(H.category))),l.length&&(P=P.filter(H=>H.goal.some(Z=>l.includes(Z)))),P=P.filter(H=>H.price<=u),y&&(P=P.filter(H=>H.name.toLowerCase().includes(y.toLowerCase()))),e){case"Price: Low to High":P.sort((H,Z)=>H.price-Z.price);break;case"Price: High to Low":P.sort((H,Z)=>Z.price-H.price);break;case"Discount":P.sort((H,Z)=>Z.discount-H.discount);break;case"Rating":P.sort((H,Z)=>Z.rating-H.rating);break}return P},[T,x,E,k,R,s,l,u,e,y]),L=P=>o(H=>H.includes(P)?H.filter(Z=>Z!==P):[...H,P]),D=P=>d(H=>H.includes(P)?H.filter(Z=>Z!==P):[...H,P]),I=x||E||k||(R==="bestseller"?"Best Sellers":"")||T||"All Products";return v.jsx("main",{className:"page-content plp-page",children:v.jsxs("div",{className:"container",children:[v.jsxs("div",{className:"plp-header",children:[v.jsxs("div",{children:[v.jsx("h1",{className:"plp-title",children:I}),v.jsxs("p",{className:"plp-count",children:[O.length," products found"]})]}),v.jsxs("div",{className:"plp-controls",children:[v.jsxs("div",{className:"plp-search",children:[v.jsx(vh,{size:16}),v.jsx("input",{placeholder:"Filter products...",value:y,onChange:P=>S(P.target.value)})]}),v.jsx("select",{className:"sort-select",value:e,onChange:P=>i(P.target.value),children:uw.map(P=>v.jsx("option",{children:P},P))}),v.jsxs("button",{className:"filter-btn hide-desktop",onClick:()=>g(!0),children:[v.jsx(o_,{size:16})," Filters"]})]})]}),v.jsxs("div",{className:"plp-layout",children:[v.jsxs("aside",{className:`plp-sidebar ${m?"open":""}`,children:[v.jsxs("div",{className:"sidebar-header",children:[v.jsx("h3",{children:"Filters"}),v.jsx("button",{className:"sidebar-close hide-desktop",onClick:()=>g(!1),children:v.jsx(uc,{size:18})})]}),v.jsxs("div",{className:"filter-group",children:[v.jsxs("h4",{children:["Category ",v.jsx(Gl,{size:14})]}),dw.map(P=>v.jsxs("label",{className:"filter-label",children:[v.jsx("input",{type:"checkbox",checked:s.includes(P),onChange:()=>L(P)}),v.jsx("span",{children:P})]},P))]}),v.jsxs("div",{className:"filter-group",children:[v.jsxs("h4",{children:["Health Goal ",v.jsx(Gl,{size:14})]}),hw.map(P=>v.jsxs("label",{className:"filter-label",children:[v.jsx("input",{type:"checkbox",checked:l.includes(P),onChange:()=>D(P)}),v.jsx("span",{children:P})]},P))]}),v.jsxs("div",{className:"filter-group",children:[v.jsxs("h4",{children:["Max Price: ",u]}),v.jsx("input",{type:"range",min:100,max:2e3,step:50,value:u,onChange:P=>h(+P.target.value),className:"price-range"}),v.jsxs("div",{className:"range-labels",children:[v.jsx("span",{children:"100"}),v.jsx("span",{children:"2000"})]})]}),v.jsx("button",{className:"clear-filters",onClick:()=>{o([]),d([]),h(2e3),S("")},children:"Clear All Filters"})]}),m&&v.jsx("div",{className:"overlay hide-desktop",onClick:()=>g(!1)}),v.jsx("div",{className:"plp-grid",children:O.length===0?v.jsxs("div",{className:"no-products",children:[v.jsx("div",{style:{fontSize:"3rem"},children:""}),v.jsx("h3",{children:"No products found"}),v.jsxs("p",{children:["Try different filters or ",v.jsx(De,{to:"/products",children:"browse all products"})]})]}):O.map(P=>v.jsx(Yr,{product:P},P.id))})]})]})})},mw=()=>{const{id:a}=V1(),e=rw(a||""),{addToCart:i}=Da(),[s,o]=N.useState(0),[l,d]=N.useState(e?.packs[0]||""),[u,h]=N.useState(1),[m,g]=N.useState(!1),[y,S]=N.useState("description");if(!e)return v.jsx("main",{className:"page-content",children:v.jsxs("div",{className:"container",style:{textAlign:"center",padding:"80px 0"},children:[v.jsx("div",{style:{fontSize:"3rem"},children:""}),v.jsx("h2",{children:"Product not found"}),v.jsx(De,{to:"/products",className:"btn btn-primary",style:{marginTop:20,display:"inline-flex"},children:"Browse Products"})]})});const T=kb().filter(E=>E.category===e.category&&E.id!==e.id).slice(0,4),x=()=>{i({id:e.id,name:e.name,price:e.price,originalPrice:e.originalPrice,image:e.image,quantity:u,pack:l,discount:e.discount}),g(!0),setTimeout(()=>g(!1),2e3)};return v.jsx("main",{className:"page-content",children:v.jsxs("div",{className:"container",children:[v.jsxs("nav",{className:"breadcrumb",children:[v.jsx(De,{to:"/",children:"Home"})," / ",v.jsx(De,{to:"/products",children:"Products"})," / ",v.jsx(De,{to:`/products?category=${encodeURIComponent(e.category)}`,children:e.category})," / ",v.jsx("span",{children:e.name})]}),v.jsxs("div",{className:"pdp-layout",children:[v.jsxs("div",{className:"pdp-gallery",children:[v.jsxs("div",{className:"main-img-wrap",children:[v.jsx("img",{src:e.images[s],alt:e.name}),e.images.length>1&&v.jsxs(v.Fragment,{children:[v.jsx("button",{className:"gallery-arrow left",onClick:()=>o(E=>(E-1+e.images.length)%e.images.length),children:v.jsx(Ml,{size:18})}),v.jsx("button",{className:"gallery-arrow right",onClick:()=>o(E=>(E+1)%e.images.length),children:v.jsx(Al,{size:18})})]}),e.discount>0&&v.jsxs("span",{className:"pdp-discount-badge",children:[e.discount,"% OFF"]})]}),v.jsx("div",{className:"thumbnails",children:e.images.map((E,k)=>v.jsx("button",{className:`thumb ${k===s?"active":""}`,onClick:()=>o(k),children:v.jsx("img",{src:E,alt:`${e.name} view ${k+1}`})},k))})]}),v.jsxs("div",{className:"pdp-info",children:[v.jsx("div",{className:"pdp-category-tag",children:e.category}),v.jsx("h1",{className:"pdp-title",children:e.name}),v.jsxs("div",{className:"pdp-rating",children:[Array.from({length:5}).map((E,k)=>v.jsx(Kl,{size:16,fill:k<Math.round(e.rating)?"#f9a825":"none",color:k<Math.round(e.rating)?"#f9a825":"#ccc"},k)),v.jsx("span",{className:"rating-val",children:e.rating}),v.jsxs("span",{className:"rating-rev",children:["(",e.reviews.toLocaleString()," reviews)"]})]}),v.jsxs("div",{className:"pdp-price-block",children:[v.jsxs("span",{className:"pdp-price",children:["",e.price]}),v.jsxs("span",{className:"pdp-was",children:["",e.originalPrice]}),v.jsxs("span",{className:"pdp-saving",children:["You save ",e.originalPrice-e.price," (",e.discount,"%)"]})]}),v.jsxs("div",{className:"pdp-free-delivery",children:[v.jsx(Yl,{size:16})," ",v.jsx("span",{children:"Free delivery on orders above 499  COD Available"})]}),v.jsx("div",{className:"pdp-section-label",children:"Choose Pack Size"}),v.jsx("div",{className:"pdp-packs",children:e.packs.map(E=>v.jsx("button",{className:`pdp-pack ${l===E?"active":""}`,onClick:()=>d(E),children:E},E))}),v.jsx("div",{className:"pdp-section-label",children:"Quantity"}),v.jsxs("div",{className:"pdp-qty",children:[v.jsx("button",{onClick:()=>h(E=>Math.max(1,E-1)),children:v.jsx(vb,{size:16})}),v.jsx("span",{children:u}),v.jsx("button",{onClick:()=>h(E=>E+1),children:v.jsx(bb,{size:16})})]}),v.jsx("button",{className:`pdp-atc ${m?"added":""}`,onClick:x,children:m?v.jsxs(v.Fragment,{children:[v.jsx(mb,{size:18})," Added to Cart!"]}):v.jsxs(v.Fragment,{children:[v.jsx($h,{size:18})," Add to Cart"]})}),v.jsxs("div",{className:"pdp-trust",children:[v.jsxs("div",{className:"trust-item",children:[v.jsx(M_,{size:16}),v.jsx("span",{children:"100% Natural & Authentic"})]}),v.jsxs("div",{className:"trust-item",children:[v.jsx(Sb,{size:16}),v.jsx("span",{children:"7-Day Easy Returns"})]}),v.jsxs("div",{className:"trust-item",children:[v.jsx(Yl,{size:16}),v.jsx("span",{children:"PAN-India Delivery"})]})]})]})]}),v.jsx("div",{className:"pdp-tabs",children:["description","benefits","howToUse","ingredients"].map(E=>v.jsx("button",{className:`tab-btn ${y===E?"active":""}`,onClick:()=>S(E),children:E==="howToUse"?"How to Use":E.charAt(0).toUpperCase()+E.slice(1)},E))}),v.jsxs("div",{className:"tab-content",children:[y==="description"&&v.jsx("p",{children:e.description}),y==="benefits"&&v.jsx("ul",{className:"benefits-list",children:e.benefits.map(E=>v.jsxs("li",{children:[" ",E]},E))}),y==="howToUse"&&v.jsx("p",{children:e.howToUse}),y==="ingredients"&&v.jsx("p",{children:e.ingredients})]}),T.length>0&&v.jsxs("section",{className:"related-section",children:[v.jsx("h2",{className:"section-title",style:{textAlign:"left",marginBottom:20},children:"You May Also Like"}),v.jsx("div",{className:"related-grid",children:T.map(E=>v.jsx(Yr,{product:E},E.id))})]})]})})},pw=["Andhra Pradesh","Arunachal Pradesh","Assam","Bihar","Chhattisgarh","Goa","Gujarat","Haryana","Himachal Pradesh","Jharkhand","Karnataka","Kerala","Madhya Pradesh","Maharashtra","Manipur","Meghalaya","Mizoram","Nagaland","Odisha","Punjab","Rajasthan","Sikkim","Tamil Nadu","Telangana","Tripura","Uttar Pradesh","Uttarakhand","West Bengal","Delhi","J&K","Ladakh","Chandigarh","Puducherry"],gw=[{label:"Home",icon:v.jsx(c_,{size:16})},{label:"Friends",icon:v.jsx(F_,{size:16})},{label:"Work",icon:v.jsx(WE,{size:16})},{label:"Other",icon:v.jsx(i_,{size:16})}],vw=()=>{const{state:a,cartTotal:e}=Da(),i=Na(),[s,o]=N.useState({fullName:"",email:"",phone:"",pincode:"",address:"",state:"Maharashtra",saveAs:"Home"}),[l,d]=N.useState({}),u=e>=499?0:49,h=()=>{const y={};return s.fullName.trim()||(y.fullName="Full name is required"),s.email.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/)||(y.email="Valid email required"),s.phone.match(/^[6-9]\d{9}$/)||(y.phone="Valid 10-digit mobile number required"),s.pincode.match(/^\d{6}$/)||(y.pincode="Valid 6-digit pincode required"),(!s.address.trim()||s.address.trim().length<10)&&(y.address="Please enter your full address (min 10 characters)"),s.state||(y.state="Please select your state"),d(y),Object.keys(y).length===0},m=y=>{y.preventDefault(),h()&&(localStorage.setItem("checkout_address",JSON.stringify(s)),i("/order-summary"))},g=(y,S)=>{o(T=>({...T,[y]:S})),l[y]&&d(T=>({...T,[y]:void 0}))};return a.items.length===0?v.jsx("main",{className:"page-content",children:v.jsxs("div",{className:"container empty-checkout",children:[v.jsx("div",{style:{fontSize:"3rem"},children:""}),v.jsx("h2",{children:"Your cart is empty"}),v.jsx("button",{className:"btn btn-primary",onClick:()=>i("/products"),children:"Shop Now"})]})}):v.jsx("main",{className:"page-content",children:v.jsxs("div",{className:"container",children:[v.jsxs("div",{className:"checkout-progress",children:[v.jsxs("div",{className:"step active",children:[v.jsx("div",{className:"step-num",children:"1"}),v.jsx("span",{children:"Delivery Address"})]}),v.jsx("div",{className:"step-line"}),v.jsxs("div",{className:"step",children:[v.jsx("div",{className:"step-num",children:"2"}),v.jsx("span",{children:"Order Summary"})]}),v.jsx("div",{className:"step-line"}),v.jsxs("div",{className:"step",children:[v.jsx("div",{className:"step-num",children:"3"}),v.jsx("span",{children:"Payment"})]})]}),v.jsxs("div",{className:"checkout-layout",children:[v.jsxs("div",{className:"checkout-form-wrap",children:[v.jsx("h2",{className:"form-title",children:"Delivery Address"}),v.jsxs("form",{onSubmit:m,className:"checkout-form",noValidate:!0,children:[v.jsx("div",{className:"form-row",children:v.jsxs("div",{className:`form-field ${l.fullName?"error":""}`,children:[v.jsxs("label",{children:[v.jsx(q_,{size:14})," Full Name *"]}),v.jsx("input",{type:"text",placeholder:"Enter your full name",value:s.fullName,onChange:y=>g("fullName",y.target.value)}),l.fullName&&v.jsx("span",{className:"field-error",children:l.fullName})]})}),v.jsxs("div",{className:"form-row two-col",children:[v.jsxs("div",{className:`form-field ${l.email?"error":""}`,children:[v.jsxs("label",{children:[v.jsx(pb,{size:14})," Email Address *"]}),v.jsx("input",{type:"email",placeholder:"you@example.com",value:s.email,onChange:y=>g("email",y.target.value)}),l.email&&v.jsx("span",{className:"field-error",children:l.email})]}),v.jsxs("div",{className:`form-field ${l.phone?"error":""}`,children:[v.jsxs("label",{children:[v.jsx(yb,{size:14})," Mobile Number *"]}),v.jsxs("div",{className:"phone-field",children:[v.jsx("span",{className:"country-code",children:" +91"}),v.jsx("input",{type:"tel",placeholder:"10-digit number",maxLength:10,value:s.phone,onChange:y=>g("phone",y.target.value.replace(/\D/g,""))})]}),l.phone&&v.jsx("span",{className:"field-error",children:l.phone})]})]}),v.jsxs("div",{className:"form-row two-col",children:[v.jsxs("div",{className:`form-field ${l.pincode?"error":""}`,children:[v.jsxs("label",{children:[v.jsx(gb,{size:14})," Pincode *"]}),v.jsx("input",{type:"text",placeholder:"6-digit pincode",maxLength:6,value:s.pincode,onChange:y=>g("pincode",y.target.value.replace(/\D/g,""))}),l.pincode&&v.jsx("span",{className:"field-error",children:l.pincode})]}),v.jsxs("div",{className:`form-field ${l.state?"error":""}`,children:[v.jsx("label",{children:"State *"}),v.jsx("select",{value:s.state,onChange:y=>g("state",y.target.value),children:pw.map(y=>v.jsx("option",{children:y},y))}),l.state&&v.jsx("span",{className:"field-error",children:l.state})]})]}),v.jsxs("div",{className:`form-field ${l.address?"error":""}`,children:[v.jsx("label",{children:"Full Address *"}),v.jsx("textarea",{placeholder:"House/flat no., building name, street, area, city...",rows:3,value:s.address,onChange:y=>g("address",y.target.value)}),l.address&&v.jsx("span",{className:"field-error",children:l.address})]}),v.jsxs("div",{className:"form-field",children:[v.jsx("label",{children:"Save Address As"}),v.jsx("div",{className:"save-as-options",children:gw.map(y=>v.jsxs("button",{type:"button",className:`save-as-btn ${s.saveAs===y.label?"active":""}`,onClick:()=>g("saveAs",y.label),children:[y.icon," ",y.label]},y.label))}),v.jsxs("p",{className:"save-as-note",children:[" This address will be secured with OTP on AmmaFoods checkouts. ",v.jsx("span",{children:"View Terms and conditions and Privacy Policy"})]})]}),v.jsx("button",{type:"submit",className:"submit-btn",children:"Save & Continue "})]})]}),v.jsxs("div",{className:"checkout-sidebar",children:[v.jsx("h3",{children:"Order Summary"}),v.jsx("div",{className:"mini-order",children:a.items.map(y=>v.jsxs("div",{className:"mini-item",children:[v.jsx("img",{src:y.image,alt:y.name}),v.jsxs("div",{children:[v.jsx("span",{className:"mini-name",children:y.name}),v.jsxs("span",{className:"mini-pack",children:[y.pack,"  ",y.quantity]})]}),v.jsxs("span",{className:"mini-price",children:["",(y.price*y.quantity).toLocaleString()]})]},`${y.id}-${y.pack}`))}),v.jsxs("div",{className:"checkout-totals",children:[v.jsxs("div",{className:"total-row",children:[v.jsx("span",{children:"Subtotal"}),v.jsxs("span",{children:["",e.toLocaleString()]})]}),v.jsxs("div",{className:"total-row",children:[v.jsx("span",{children:"Delivery"}),v.jsx("span",{children:u===0?"FREE":`${u}`})]}),v.jsxs("div",{className:"total-row grand",children:[v.jsx("span",{children:"Total"}),v.jsxs("span",{children:["",(e+u).toLocaleString()]})]})]})]})]})]})})},yw=()=>{const{state:a,cartTotal:e,cartSavings:i}=Da(),s=Na(),o=JSON.parse(localStorage.getItem("checkout_address")||"{}"),l=e>=499?0:49,d=e+l;return a.items.length===0?(s("/"),null):v.jsx("main",{className:"page-content",children:v.jsxs("div",{className:"container",children:[v.jsxs("div",{className:"checkout-progress",children:[v.jsxs("div",{className:"step done",children:[v.jsx("div",{className:"step-num",children:""}),v.jsx("span",{children:"Delivery Address"})]}),v.jsx("div",{className:"step-line active-line"}),v.jsxs("div",{className:"step active",children:[v.jsx("div",{className:"step-num",children:"2"}),v.jsx("span",{children:"Order Summary"})]}),v.jsx("div",{className:"step-line"}),v.jsxs("div",{className:"step",children:[v.jsx("div",{className:"step-num",children:"3"}),v.jsx("span",{children:"Payment"})]})]}),v.jsxs("div",{className:"os-layout",children:[v.jsxs("div",{className:"os-main",children:[v.jsxs("div",{className:"os-card",children:[v.jsx("h2",{children:"Order Items"}),a.items.map(u=>v.jsxs("div",{className:"os-item",children:[v.jsx("img",{src:u.image,alt:u.name}),v.jsxs("div",{className:"os-item-info",children:[v.jsx("span",{className:"os-item-name",children:u.name}),v.jsxs("span",{className:"os-item-pack",children:["Pack: ",u.pack]}),v.jsxs("span",{className:"os-item-qty",children:["Qty: ",u.quantity]})]}),v.jsxs("div",{className:"os-item-prices",children:[v.jsxs("span",{className:"os-price",children:["",(u.price*u.quantity).toLocaleString()]}),v.jsxs("span",{className:"os-was",children:["",(u.originalPrice*u.quantity).toLocaleString()]})]})]},`${u.id}-${u.pack}`))]}),v.jsxs("div",{className:"os-card",children:[v.jsx("h2",{children:"Delivery Address"}),v.jsxs("div",{className:"address-display",children:[v.jsx("strong",{children:o.fullName}),v.jsx("p",{children:o.address}),v.jsxs("p",{children:[o.state,"  ",o.pincode]}),v.jsxs("p",{children:[" +91 ",o.phone]}),v.jsxs("p",{children:[" ",o.email]}),v.jsx("span",{className:"address-type-tag",children:o.saveAs||"Home"})]}),v.jsx("button",{className:"change-btn",onClick:()=>s("/checkout"),children:"Change Address"})]})]}),v.jsx("div",{className:"os-sidebar",children:v.jsxs("div",{className:"os-totals-card",children:[v.jsx("h3",{children:"Price Details"}),v.jsxs("div",{className:"os-total-rows",children:[v.jsxs("div",{className:"os-row",children:[v.jsxs("span",{children:["Price (",a.items.reduce((u,h)=>u+h.quantity,0)," items)"]}),v.jsxs("span",{children:["",(e+i).toLocaleString()]})]}),i>0&&v.jsxs("div",{className:"os-row green",children:[v.jsx("span",{children:"Discount"}),v.jsxs("span",{children:["-",i.toLocaleString()]})]}),v.jsxs("div",{className:"os-row",children:[v.jsx("span",{children:"Delivery Charges"}),v.jsx("span",{className:l===0?"free-label":"",children:l===0?" FREE":`${l}`})]}),v.jsxs("div",{className:"os-row grand",children:[v.jsx("span",{children:"Total Payable"}),v.jsxs("span",{children:["",d.toLocaleString()]})]}),i>0&&v.jsxs("div",{className:"os-savings-note",children:[" You will save ",i.toLocaleString()," on this order"]})]}),v.jsxs("button",{className:"proceed-btn",onClick:()=>s("/payment"),children:["Proceed to Pay ",d.toLocaleString()," "]}),v.jsx("div",{className:"secure-note",children:" 100% Safe & Secure Payments"})]})})]})]})})},xy=["State Bank of India","HDFC Bank","ICICI Bank","Axis Bank","Kotak Mahindra","Punjab National Bank","Bank of Baroda","Yes Bank","Canara Bank","Union Bank"],bw=()=>{const{cartTotal:a,clearCart:e}=Da(),[i,s]=N.useState("upi"),[o,l]=N.useState(""),[d,u]=N.useState({number:"",expiry:"",cvv:"",name:""}),[h,m]=N.useState(xy[0]),[g,y]=N.useState(!1),S=Na(),T=a>=499?0:49,x=a+T,E=()=>{y(!0),setTimeout(()=>{e(),S("/order-confirmed")},2e3)},k=O=>O.replace(/\D/g,"").slice(0,16).replace(/(.{4})/g,"$1 ").trim(),R=O=>{const L=O.replace(/\D/g,"").slice(0,4);return L.length>=3?`${L.slice(0,2)}/${L.slice(2)}`:L};return v.jsx("main",{className:"page-content",children:v.jsxs("div",{className:"container",children:[v.jsxs("div",{className:"checkout-progress",children:[v.jsxs("div",{className:"step done",children:[v.jsx("div",{className:"step-num",children:""}),v.jsx("span",{children:"Delivery Address"})]}),v.jsx("div",{className:"step-line active-line"}),v.jsxs("div",{className:"step done",children:[v.jsx("div",{className:"step-num",children:""}),v.jsx("span",{children:"Order Summary"})]}),v.jsx("div",{className:"step-line active-line"}),v.jsxs("div",{className:"step active",children:[v.jsx("div",{className:"step-num",children:"3"}),v.jsx("span",{children:"Payment"})]})]}),v.jsxs("div",{className:"payment-layout",children:[v.jsxs("div",{className:"payment-methods",children:[v.jsx("h2",{children:"Choose Payment Method"}),v.jsx("div",{className:"method-tabs",children:[["upi"," UPI"],["card"," Card"],["netbanking"," Net Banking"],["cod"," Cash on Delivery"]].map(([O,L])=>v.jsx("button",{className:`method-tab ${i===O?"active":""}`,onClick:()=>s(O),children:L},O))}),i==="upi"&&v.jsxs("div",{className:"method-content",children:[v.jsx("div",{className:"upi-apps",children:["Google Pay","PhonePe","Paytm","BHIM"].map(O=>v.jsxs("div",{className:"upi-app-btn",children:[O==="Google Pay"?"":O==="PhonePe"?"":O==="Paytm"?"":""," ",O]},O))}),v.jsx("div",{className:"divider-or",children:v.jsx("span",{children:"or enter UPI ID"})}),v.jsxs("div",{className:"upi-input-wrap",children:[v.jsx("input",{type:"text",placeholder:"yourname@upi",value:o,onChange:O=>l(O.target.value),className:"pay-input"}),v.jsx("button",{className:"verify-btn",children:"Verify"})]})]}),i==="card"&&v.jsxs("div",{className:"method-content",children:[v.jsxs("div",{className:"card-visual",children:[v.jsx("div",{className:"card-num-display",children:d.number||"   "}),v.jsxs("div",{className:"card-bottom",children:[v.jsxs("div",{children:[v.jsx("div",{className:"card-lbl",children:"CARD HOLDER"}),v.jsx("div",{children:d.name||"YOUR NAME"})]}),v.jsxs("div",{children:[v.jsx("div",{className:"card-lbl",children:"EXPIRES"}),v.jsx("div",{children:d.expiry||"MM/YY"})]})]})]}),v.jsxs("div",{className:"card-fields",children:[v.jsxs("div",{className:"form-field",children:[v.jsx("label",{children:"Card Number"}),v.jsx("input",{type:"text",className:"pay-input",placeholder:"1234 5678 9012 3456",maxLength:19,value:d.number,onChange:O=>u(L=>({...L,number:k(O.target.value)}))})]}),v.jsxs("div",{className:"form-field",children:[v.jsx("label",{children:"Name on Card"}),v.jsx("input",{type:"text",className:"pay-input",placeholder:"Full name as on card",value:d.name,onChange:O=>u(L=>({...L,name:O.target.value}))})]}),v.jsxs("div",{className:"card-row-two",children:[v.jsxs("div",{className:"form-field",children:[v.jsx("label",{children:"Expiry Date"}),v.jsx("input",{type:"text",className:"pay-input",placeholder:"MM/YY",maxLength:5,value:d.expiry,onChange:O=>u(L=>({...L,expiry:R(O.target.value)}))})]}),v.jsxs("div",{className:"form-field",children:[v.jsx("label",{children:"CVV"}),v.jsx("input",{type:"password",className:"pay-input",placeholder:"",maxLength:3,value:d.cvv,onChange:O=>u(L=>({...L,cvv:O.target.value.replace(/\D/g,"").slice(0,3)}))})]})]})]})]}),i==="netbanking"&&v.jsxs("div",{className:"method-content",children:[v.jsxs("label",{className:"form-field",children:[v.jsx("span",{children:"Select Your Bank"}),v.jsx("select",{className:"pay-input",value:h,onChange:O=>m(O.target.value),children:xy.map(O=>v.jsx("option",{children:O},O))})]}),v.jsx("p",{className:"nb-note",children:"You will be redirected to your bank's secure portal to complete the payment."})]}),i==="cod"&&v.jsxs("div",{className:"method-content cod-content",children:[v.jsx("div",{className:"cod-icon",children:""}),v.jsx("h3",{children:"Cash on Delivery"}),v.jsx("p",{children:"Pay in cash when your order arrives at your doorstep. No additional charges."}),v.jsxs("ul",{children:[v.jsx("li",{children:" No extra COD fees"}),v.jsx("li",{children:" Available PAN-India"}),v.jsx("li",{children:" Pay only after inspection"})]})]}),v.jsx("button",{className:"pay-now-btn",onClick:E,disabled:g,children:g?v.jsxs(v.Fragment,{children:[v.jsx("span",{className:"spinner"})," Processing..."]}):`${i==="cod"?"Place Order":"Pay Now"} ${x.toLocaleString()}`}),v.jsx("p",{className:"secure-label",children:" Your payment is safe & secured with 256-bit SSL encryption"})]}),v.jsxs("div",{className:"payment-summary",children:[v.jsx("h3",{children:"Order Total"}),v.jsxs("div",{className:"pay-rows",children:[v.jsxs("div",{className:"pay-row",children:[v.jsx("span",{children:"Subtotal"}),v.jsxs("span",{children:["",a.toLocaleString()]})]}),v.jsxs("div",{className:"pay-row",children:[v.jsx("span",{children:"Delivery"}),v.jsx("span",{children:T===0?"FREE":`${T}`})]}),v.jsxs("div",{className:"pay-row grand",children:[v.jsx("span",{children:"Total"}),v.jsxs("span",{children:["",x.toLocaleString()]})]})]}),v.jsxs("div",{className:"payment-badges",children:[v.jsx("span",{children:" SSL Secured"}),v.jsx("span",{children:" RBI Compliant"}),v.jsx("span",{children:" PCI DSS"})]})]})]})]})})},Sw=()=>{const[a]=N.useState(()=>`HN${Date.now().toString().slice(-8)}`),[e,i]=N.useState(!1);N.useEffect(()=>{setTimeout(()=>i(!0),100)},[]);const s=new Date;s.setDate(s.getDate()+5);const o=s.toLocaleDateString("en-IN",{weekday:"long",day:"numeric",month:"long"});return v.jsx("main",{className:"page-content",children:v.jsx("div",{className:"container",children:v.jsxs("div",{className:`oc-wrapper ${e?"visible":""}`,children:[v.jsx("div",{className:"oc-success-icon",children:v.jsx("div",{className:"oc-circle",children:""})}),v.jsx("h1",{className:"oc-title",children:"Order Placed Successfully!"}),v.jsx("p",{className:"oc-sub",children:"Thank you for shopping with AmmaFoods! "}),v.jsxs("div",{className:"oc-order-card",children:[v.jsxs("div",{className:"oc-row",children:[v.jsx("span",{children:"Order ID"}),v.jsxs("strong",{children:["#",a]})]}),v.jsxs("div",{className:"oc-row",children:[v.jsx("span",{children:"Estimated Delivery"}),v.jsx("strong",{children:o})]}),v.jsxs("div",{className:"oc-row",children:[v.jsx("span",{children:"Status"}),v.jsx("span",{className:"oc-status",children:"Confirmed "})]})]}),v.jsx("div",{className:"oc-steps",children:[{icon:"",label:"Order Confirmed",done:!0},{icon:"",label:"Being Packed",done:!1},{icon:"",label:"Out for Delivery",done:!1},{icon:"",label:"Delivered",done:!1}].map((l,d)=>v.jsxs("div",{className:`oc-step ${l.done?"done":""}`,children:[v.jsx("div",{className:"oc-step-icon",children:l.icon}),v.jsx("span",{children:l.label})]},d))}),v.jsxs("div",{className:"oc-actions",children:[v.jsx(De,{to:"/products",className:"btn btn-primary",children:"Continue Shopping"}),v.jsx(De,{to:"/",className:"btn btn-outline",children:"Back to Home"})]}),v.jsx("p",{className:"oc-note",children:"You will receive an SMS and email confirmation shortly. For support, contact support@ammafoods.com.au"})]})})})};var Ry={};function Cw(a,e){return e.forEach(function(i){i&&typeof i!="string"&&!Array.isArray(i)&&Object.keys(i).forEach(function(s){if(s!=="default"&&!(s in a)){var o=Object.getOwnPropertyDescriptor(i,s);Object.defineProperty(a,s,o.get?o:{enumerable:!0,get:function(){return i[s]}})}})}),Object.freeze(a)}var Tw=Object.defineProperty,kw=(a,e,i)=>e in a?Tw(a,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[e]=i,My=(a,e,i)=>kw(a,typeof e!="symbol"?e+"":e,i);let It=class{constructor(){My(this,"_locking"),My(this,"_locks"),this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){this._locks+=1;let e;const i=new Promise(o=>e=()=>{this._locks-=1,o()}),s=this._locking.then(()=>e);return this._locking=this._locking.then(()=>i),s}};function st(a,e){if(!a)throw new Error(e)}const Ew=34028234663852886e22,_w=-34028234663852886e22,ww=4294967295,xw=2147483647,Rw=-2147483648;function Nl(a){if(typeof a!="number")throw new Error("invalid int 32: "+typeof a);if(!Number.isInteger(a)||a>xw||a<Rw)throw new Error("invalid int 32: "+a)}function yh(a){if(typeof a!="number")throw new Error("invalid uint 32: "+typeof a);if(!Number.isInteger(a)||a>ww||a<0)throw new Error("invalid uint 32: "+a)}function Eb(a){if(typeof a!="number")throw new Error("invalid float 32: "+typeof a);if(Number.isFinite(a)&&(a>Ew||a<_w))throw new Error("invalid float 32: "+a)}const _b=Symbol("@bufbuild/protobuf/enum-type");function Mw(a){const e=a[_b];return st(e,"missing enum type on enum object"),e}function wb(a,e,i,s){a[_b]=xb(e,i.map(o=>({no:o.no,name:o.name,localName:a[o.no]})))}function xb(a,e,i){const s=Object.create(null),o=Object.create(null),l=[];for(const d of e){const u=Rb(d);l.push(u),s[d.name]=u,o[d.no]=u}return{typeName:a,values:l,findName(d){return s[d]},findNumber(d){return o[d]}}}function Aw(a,e,i){const s={};for(const o of e){const l=Rb(o);s[l.localName]=l.no,s[l.no]=l.localName}return wb(s,a,e),s}function Rb(a){return"localName"in a?a:Object.assign(Object.assign({},a),{localName:a.name})}class ef{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,i){const s=this.getType(),o=s.runtime.bin,l=o.makeReadOptions(i);return o.readMessage(this,l.readerFactory(e),e.byteLength,l),this}fromJson(e,i){const s=this.getType(),o=s.runtime.json,l=o.makeReadOptions(i);return o.readMessage(s,e,l,this),this}fromJsonString(e,i){let s;try{s=JSON.parse(e)}catch(o){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(o instanceof Error?o.message:String(o)))}return this.fromJson(s,i)}toBinary(e){const i=this.getType(),s=i.runtime.bin,o=s.makeWriteOptions(e),l=o.writerFactory();return s.writeMessage(this,l,o),l.finish()}toJson(e){const i=this.getType(),s=i.runtime.json,o=s.makeWriteOptions(e);return s.writeMessage(this,o)}toJsonString(e){var i;const s=this.toJson(e);return JSON.stringify(s,null,(i=e?.prettySpaces)!==null&&i!==void 0?i:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function Nw(a,e,i,s){var o;const l=(o=s?.localName)!==null&&o!==void 0?o:e.substring(e.lastIndexOf(".")+1),d={[l]:function(u){a.util.initFields(this),a.util.initPartial(u,this)}}[l];return Object.setPrototypeOf(d.prototype,new ef),Object.assign(d,{runtime:a,typeName:e,fields:a.util.newFieldList(i),fromBinary(u,h){return new d().fromBinary(u,h)},fromJson(u,h){return new d().fromJson(u,h)},fromJsonString(u,h){return new d().fromJsonString(u,h)},equals(u,h){return a.util.equals(d,u,h)}}),d}function Dw(){let a=0,e=0;for(let s=0;s<28;s+=7){let o=this.buf[this.pos++];if(a|=(o&127)<<s,(o&128)==0)return this.assertBounds(),[a,e]}let i=this.buf[this.pos++];if(a|=(i&15)<<28,e=(i&112)>>4,(i&128)==0)return this.assertBounds(),[a,e];for(let s=3;s<=31;s+=7){let o=this.buf[this.pos++];if(e|=(o&127)<<s,(o&128)==0)return this.assertBounds(),[a,e]}throw new Error("invalid varint")}function Qd(a,e,i){for(let l=0;l<28;l=l+7){const d=a>>>l,u=!(!(d>>>7)&&e==0),h=(u?d|128:d)&255;if(i.push(h),!u)return}const s=a>>>28&15|(e&7)<<4,o=e>>3!=0;if(i.push((o?s|128:s)&255),!!o){for(let l=3;l<31;l=l+7){const d=e>>>l,u=!!(d>>>7),h=(u?d|128:d)&255;if(i.push(h),!u)return}i.push(e>>>31&1)}}const Dl=4294967296;function Ay(a){const e=a[0]==="-";e&&(a=a.slice(1));const i=1e6;let s=0,o=0;function l(d,u){const h=Number(a.slice(d,u));o*=i,s=s*i+h,s>=Dl&&(o=o+(s/Dl|0),s=s%Dl)}return l(-24,-18),l(-18,-12),l(-12,-6),l(-6),e?Ab(s,o):tf(s,o)}function Ow(a,e){let i=tf(a,e);const s=i.hi&2147483648;s&&(i=Ab(i.lo,i.hi));const o=Mb(i.lo,i.hi);return s?"-"+o:o}function Mb(a,e){if({lo:a,hi:e}=Pw(a,e),e<=2097151)return String(Dl*e+a);const i=a&16777215,s=(a>>>24|e<<8)&16777215,o=e>>16&65535;let l=i+s*6777216+o*6710656,d=s+o*8147497,u=o*2;const h=1e7;return l>=h&&(d+=Math.floor(l/h),l%=h),d>=h&&(u+=Math.floor(d/h),d%=h),u.toString()+Ny(d)+Ny(l)}function Pw(a,e){return{lo:a>>>0,hi:e>>>0}}function tf(a,e){return{lo:a|0,hi:e|0}}function Ab(a,e){return e=~e,a?a=~a+1:e+=1,tf(a,e)}const Ny=a=>{const e=String(a);return"0000000".slice(e.length)+e};function Dy(a,e){if(a>=0){for(;a>127;)e.push(a&127|128),a=a>>>7;e.push(a)}else{for(let i=0;i<9;i++)e.push(a&127|128),a=a>>7;e.push(1)}}function jw(){let a=this.buf[this.pos++],e=a&127;if((a&128)==0)return this.assertBounds(),e;if(a=this.buf[this.pos++],e|=(a&127)<<7,(a&128)==0)return this.assertBounds(),e;if(a=this.buf[this.pos++],e|=(a&127)<<14,(a&128)==0)return this.assertBounds(),e;if(a=this.buf[this.pos++],e|=(a&127)<<21,(a&128)==0)return this.assertBounds(),e;a=this.buf[this.pos++],e|=(a&15)<<28;for(let i=5;(a&128)!==0&&i<10;i++)a=this.buf[this.pos++];if((a&128)!=0)throw new Error("invalid varint");return this.assertBounds(),e>>>0}function Iw(){const a=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof a.getBigInt64=="function"&&typeof a.getBigUint64=="function"&&typeof a.setBigInt64=="function"&&typeof a.setBigUint64=="function"&&(typeof process!="object"||typeof Ry!="object"||Ry.BUF_BIGINT_DISABLE!=="1")){const o=BigInt("-9223372036854775808"),l=BigInt("9223372036854775807"),d=BigInt("0"),u=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(h){const m=typeof h=="bigint"?h:BigInt(h);if(m>l||m<o)throw new Error("int64 invalid: ".concat(h));return m},uParse(h){const m=typeof h=="bigint"?h:BigInt(h);if(m>u||m<d)throw new Error("uint64 invalid: ".concat(h));return m},enc(h){return a.setBigInt64(0,this.parse(h),!0),{lo:a.getInt32(0,!0),hi:a.getInt32(4,!0)}},uEnc(h){return a.setBigInt64(0,this.uParse(h),!0),{lo:a.getInt32(0,!0),hi:a.getInt32(4,!0)}},dec(h,m){return a.setInt32(0,h,!0),a.setInt32(4,m,!0),a.getBigInt64(0,!0)},uDec(h,m){return a.setInt32(0,h,!0),a.setInt32(4,m,!0),a.getBigUint64(0,!0)}}}const i=o=>st(/^-?[0-9]+$/.test(o),"int64 invalid: ".concat(o)),s=o=>st(/^[0-9]+$/.test(o),"uint64 invalid: ".concat(o));return{zero:"0",supported:!1,parse(o){return typeof o!="string"&&(o=o.toString()),i(o),o},uParse(o){return typeof o!="string"&&(o=o.toString()),s(o),o},enc(o){return typeof o!="string"&&(o=o.toString()),i(o),Ay(o)},uEnc(o){return typeof o!="string"&&(o=o.toString()),s(o),Ay(o)},dec(o,l){return Ow(o,l)},uDec(o,l){return Mb(o,l)}}}const et=Iw();var X;(function(a){a[a.DOUBLE=1]="DOUBLE",a[a.FLOAT=2]="FLOAT",a[a.INT64=3]="INT64",a[a.UINT64=4]="UINT64",a[a.INT32=5]="INT32",a[a.FIXED64=6]="FIXED64",a[a.FIXED32=7]="FIXED32",a[a.BOOL=8]="BOOL",a[a.STRING=9]="STRING",a[a.BYTES=12]="BYTES",a[a.UINT32=13]="UINT32",a[a.SFIXED32=15]="SFIXED32",a[a.SFIXED64=16]="SFIXED64",a[a.SINT32=17]="SINT32",a[a.SINT64=18]="SINT64"})(X||(X={}));var Zi;(function(a){a[a.BIGINT=0]="BIGINT",a[a.STRING=1]="STRING"})(Zi||(Zi={}));function Gi(a,e,i){if(e===i)return!0;if(a==X.BYTES){if(!(e instanceof Uint8Array)||!(i instanceof Uint8Array)||e.length!==i.length)return!1;for(let s=0;s<e.length;s++)if(e[s]!==i[s])return!1;return!0}switch(a){case X.UINT64:case X.FIXED64:case X.INT64:case X.SFIXED64:case X.SINT64:return e==i}return!1}function Ns(a,e){switch(a){case X.BOOL:return!1;case X.UINT64:case X.FIXED64:case X.INT64:case X.SFIXED64:case X.SINT64:return e==0?et.zero:"0";case X.DOUBLE:case X.FLOAT:return 0;case X.BYTES:return new Uint8Array(0);case X.STRING:return"";default:return 0}}function Nb(a,e){switch(a){case X.BOOL:return e===!1;case X.STRING:return e==="";case X.BYTES:return e instanceof Uint8Array&&!e.byteLength;default:return e==0}}var dt;(function(a){a[a.Varint=0]="Varint",a[a.Bit64=1]="Bit64",a[a.LengthDelimited=2]="LengthDelimited",a[a.StartGroup=3]="StartGroup",a[a.EndGroup=4]="EndGroup",a[a.Bit32=5]="Bit32"})(dt||(dt={}));class Lw{constructor(e){this.stack=[],this.textEncoder=e??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let o=0;o<this.chunks.length;o++)e+=this.chunks[o].length;let i=new Uint8Array(e),s=0;for(let o=0;o<this.chunks.length;o++)i.set(this.chunks[o],s),s+=this.chunks[o].length;return this.chunks=[],i}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),i=this.stack.pop();if(!i)throw new Error("invalid state, fork stack empty");return this.chunks=i.chunks,this.buf=i.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,i){return this.uint32((e<<3|i)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(yh(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return Nl(e),Dy(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let i=this.textEncoder.encode(e);return this.uint32(i.byteLength),this.raw(i)}float(e){Eb(e);let i=new Uint8Array(4);return new DataView(i.buffer).setFloat32(0,e,!0),this.raw(i)}double(e){let i=new Uint8Array(8);return new DataView(i.buffer).setFloat64(0,e,!0),this.raw(i)}fixed32(e){yh(e);let i=new Uint8Array(4);return new DataView(i.buffer).setUint32(0,e,!0),this.raw(i)}sfixed32(e){Nl(e);let i=new Uint8Array(4);return new DataView(i.buffer).setInt32(0,e,!0),this.raw(i)}sint32(e){return Nl(e),e=(e<<1^e>>31)>>>0,Dy(e,this.buf),this}sfixed64(e){let i=new Uint8Array(8),s=new DataView(i.buffer),o=et.enc(e);return s.setInt32(0,o.lo,!0),s.setInt32(4,o.hi,!0),this.raw(i)}fixed64(e){let i=new Uint8Array(8),s=new DataView(i.buffer),o=et.uEnc(e);return s.setInt32(0,o.lo,!0),s.setInt32(4,o.hi,!0),this.raw(i)}int64(e){let i=et.enc(e);return Qd(i.lo,i.hi,this.buf),this}sint64(e){let i=et.enc(e),s=i.hi>>31,o=i.lo<<1^s,l=(i.hi<<1|i.lo>>>31)^s;return Qd(o,l,this.buf),this}uint64(e){let i=et.uEnc(e);return Qd(i.lo,i.hi,this.buf),this}}class Uw{constructor(e,i){this.varint64=Dw,this.uint32=jw,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=i??new TextDecoder}tag(){let e=this.uint32(),i=e>>>3,s=e&7;if(i<=0||s<0||s>5)throw new Error("illegal tag: field no "+i+" wire type "+s);return[i,s]}skip(e,i){let s=this.pos;switch(e){case dt.Varint:for(;this.buf[this.pos++]&128;);break;case dt.Bit64:this.pos+=4;case dt.Bit32:this.pos+=4;break;case dt.LengthDelimited:let o=this.uint32();this.pos+=o;break;case dt.StartGroup:for(;;){const[l,d]=this.tag();if(d===dt.EndGroup){if(i!==void 0&&l!==i)throw new Error("invalid end group tag");break}this.skip(d,l)}break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(s,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return et.dec(...this.varint64())}uint64(){return et.uDec(...this.varint64())}sint64(){let[e,i]=this.varint64(),s=-(e&1);return e=(e>>>1|(i&1)<<31)^s,i=i>>>1^s,et.dec(e,i)}bool(){let[e,i]=this.varint64();return e!==0||i!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return et.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return et.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),i=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(i,i+e)}string(){return this.textDecoder.decode(this.bytes())}}function Bw(a,e,i,s){let o;return{typeName:e,extendee:i,get field(){if(!o){const l=typeof s=="function"?s():s;l.name=e.split(".").pop(),l.jsonName="[".concat(e,"]"),o=a.util.newFieldList([l]).list()[0]}return o},runtime:a}}function Db(a){const e=a.field.localName,i=Object.create(null);return i[e]=qw(a),[i,()=>i[e]]}function qw(a){const e=a.field;if(e.repeated)return[];if(e.default!==void 0)return e.default;switch(e.kind){case"enum":return e.T.values[0].no;case"scalar":return Ns(e.T,e.L);case"message":const i=e.T,s=new i;return i.fieldWrapper?i.fieldWrapper.unwrapField(s):s;case"map":throw"map fields are not allowed to be extensions"}}function zw(a,e){if(!e.repeated&&(e.kind=="enum"||e.kind=="scalar")){for(let i=a.length-1;i>=0;--i)if(a[i].no==e.no)return[a[i]];return[]}return a.filter(i=>i.no===e.no)}let hi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),dc=[];for(let a=0;a<hi.length;a++)dc[hi[a].charCodeAt(0)]=a;dc[45]=hi.indexOf("+");dc[95]=hi.indexOf("/");const Ob={dec(a){let e=a.length*3/4;a[a.length-2]=="="?e-=2:a[a.length-1]=="="&&(e-=1);let i=new Uint8Array(e),s=0,o=0,l,d=0;for(let u=0;u<a.length;u++){if(l=dc[a.charCodeAt(u)],l===void 0)switch(a[u]){case"=":o=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(o){case 0:d=l,o=1;break;case 1:i[s++]=d<<2|(l&48)>>4,d=l,o=2;break;case 2:i[s++]=(d&15)<<4|(l&60)>>2,d=l,o=3;break;case 3:i[s++]=(d&3)<<6|l,o=0;break}}if(o==1)throw Error("invalid base64 string.");return i.subarray(0,s)},enc(a){let e="",i=0,s,o=0;for(let l=0;l<a.length;l++)switch(s=a[l],i){case 0:e+=hi[s>>2],o=(s&3)<<4,i=1;break;case 1:e+=hi[o|s>>4],o=(s&15)<<2,i=2;break;case 2:e+=hi[o|s>>6],e+=hi[s&63],i=0;break}return i&&(e+=hi[o],e+="=",i==1&&(e+="=")),e}};function Fw(a,e,i){jb(e,a);const s=e.runtime.bin.makeReadOptions(i),o=zw(a.getType().runtime.bin.listUnknownFields(a),e.field),[l,d]=Db(e);for(const u of o)e.runtime.bin.readField(l,s.readerFactory(u.data),e.field,u.wireType,s);return d()}function Hw(a,e,i,s){jb(e,a);const o=e.runtime.bin.makeReadOptions(s),l=e.runtime.bin.makeWriteOptions(s);if(Pb(a,e)){const m=a.getType().runtime.bin.listUnknownFields(a).filter(g=>g.no!=e.field.no);a.getType().runtime.bin.discardUnknownFields(a);for(const g of m)a.getType().runtime.bin.onUnknownField(a,g.no,g.wireType,g.data)}const d=l.writerFactory();let u=e.field;!u.opt&&!u.repeated&&(u.kind=="enum"||u.kind=="scalar")&&(u=Object.assign(Object.assign({},e.field),{opt:!0})),e.runtime.bin.writeField(u,i,d,l);const h=o.readerFactory(d.finish());for(;h.pos<h.len;){const[m,g]=h.tag(),y=h.skip(g,m);a.getType().runtime.bin.onUnknownField(a,m,g,y)}}function Pb(a,e){const i=a.getType();return e.extendee.typeName===i.typeName&&!!i.runtime.bin.listUnknownFields(a).find(s=>s.no==e.field.no)}function jb(a,e){st(a.extendee.typeName==e.getType().typeName,"extension ".concat(a.typeName," can only be applied to message ").concat(a.extendee.typeName))}function Ib(a,e){const i=a.localName;if(a.repeated)return e[i].length>0;if(a.oneof)return e[a.oneof.localName].case===i;switch(a.kind){case"enum":case"scalar":return a.opt||a.req?e[i]!==void 0:a.kind=="enum"?e[i]!==a.T.values[0].no:!Nb(a.T,e[i]);case"message":return e[i]!==void 0;case"map":return Object.keys(e[i]).length>0}}function Oy(a,e){const i=a.localName,s=!a.opt&&!a.req;if(a.repeated)e[i]=[];else if(a.oneof)e[a.oneof.localName]={case:void 0};else switch(a.kind){case"map":e[i]={};break;case"enum":e[i]=s?a.T.values[0].no:void 0;break;case"scalar":e[i]=s?Ns(a.T,a.L):void 0;break;case"message":e[i]=void 0;break}}function fi(a,e){if(a===null||typeof a!="object"||!Object.getOwnPropertyNames(ef.prototype).every(s=>s in a&&typeof a[s]=="function"))return!1;const i=a.getType();return i===null||typeof i!="function"||!("typeName"in i)||typeof i.typeName!="string"?!1:e===void 0?!0:i.typeName==e.typeName}function Lb(a,e){return fi(e)||!a.fieldWrapper?e:a.fieldWrapper.wrapField(e)}X.DOUBLE,X.FLOAT,X.INT64,X.UINT64,X.INT32,X.UINT32,X.BOOL,X.STRING,X.BYTES;const Py={ignoreUnknownFields:!1},jy={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function Vw(a){return a?Object.assign(Object.assign({},Py),a):Py}function Gw(a){return a?Object.assign(Object.assign({},jy),a):jy}const Jl=Symbol(),Ol=Symbol();function Kw(){return{makeReadOptions:Vw,makeWriteOptions:Gw,readMessage(a,e,i,s){if(e==null||Array.isArray(e)||typeof e!="object")throw new Error("cannot decode message ".concat(a.typeName," from JSON: ").concat(Ln(e)));s=s??new a;const o=new Map,l=i.typeRegistry;for(const[d,u]of Object.entries(e)){const h=a.fields.findJsonName(d);if(h){if(h.oneof){if(u===null&&h.kind=="scalar")continue;const m=o.get(h.oneof);if(m!==void 0)throw new Error("cannot decode message ".concat(a.typeName,' from JSON: multiple keys for oneof "').concat(h.oneof.name,'" present: "').concat(m,'", "').concat(d,'"'));o.set(h.oneof,d)}Iy(s,u,h,i,a)}else{let m=!1;if(l?.findExtension&&d.startsWith("[")&&d.endsWith("]")){const g=l.findExtension(d.substring(1,d.length-1));if(g&&g.extendee.typeName==a.typeName){m=!0;const[y,S]=Db(g);Iy(y,u,g.field,i,g),Hw(s,g,S(),i)}}if(!m&&!i.ignoreUnknownFields)throw new Error("cannot decode message ".concat(a.typeName,' from JSON: key "').concat(d,'" is unknown'))}}return s},writeMessage(a,e){const i=a.getType(),s={};let o;try{for(o of i.fields.byNumber()){if(!Ib(o,a)){if(o.req)throw"required field not set";if(!e.emitDefaultValues||!Jw(o))continue}const d=o.oneof?a[o.oneof.localName].value:a[o.localName],u=Ly(o,d,e);u!==void 0&&(s[e.useProtoFieldName?o.name:o.jsonName]=u)}const l=e.typeRegistry;if(l?.findExtensionFor)for(const d of i.runtime.bin.listUnknownFields(a)){const u=l.findExtensionFor(i.typeName,d.no);if(u&&Pb(a,u)){const h=Fw(a,u,e),m=Ly(u.field,h,e);m!==void 0&&(s[u.field.jsonName]=m)}}}catch(l){const d=o?"cannot encode field ".concat(i.typeName,".").concat(o.name," to JSON"):"cannot encode message ".concat(i.typeName," to JSON"),u=l instanceof Error?l.message:String(l);throw new Error(d+(u.length>0?": ".concat(u):""))}return s},readScalar(a,e,i){return qr(a,e,i??Zi.BIGINT,!0)},writeScalar(a,e,i){if(e!==void 0&&(i||Nb(a,e)))return Pl(a,e)},debug:Ln}}function Ln(a){if(a===null)return"null";switch(typeof a){case"object":return Array.isArray(a)?"array":"object";case"string":return a.length>100?"string":'"'.concat(a.split('"').join('\\"'),'"');default:return String(a)}}function Iy(a,e,i,s,o){let l=i.localName;if(i.repeated){if(st(i.kind!="map"),e===null)return;if(!Array.isArray(e))throw new Error("cannot decode field ".concat(o.typeName,".").concat(i.name," from JSON: ").concat(Ln(e)));const d=a[l];for(const u of e){if(u===null)throw new Error("cannot decode field ".concat(o.typeName,".").concat(i.name," from JSON: ").concat(Ln(u)));switch(i.kind){case"message":d.push(i.T.fromJson(u,s));break;case"enum":const h=Xd(i.T,u,s.ignoreUnknownFields,!0);h!==Ol&&d.push(h);break;case"scalar":try{d.push(qr(i.T,u,i.L,!0))}catch(m){let g="cannot decode field ".concat(o.typeName,".").concat(i.name," from JSON: ").concat(Ln(u));throw m instanceof Error&&m.message.length>0&&(g+=": ".concat(m.message)),new Error(g)}break}}}else if(i.kind=="map"){if(e===null)return;if(typeof e!="object"||Array.isArray(e))throw new Error("cannot decode field ".concat(o.typeName,".").concat(i.name," from JSON: ").concat(Ln(e)));const d=a[l];for(const[u,h]of Object.entries(e)){if(h===null)throw new Error("cannot decode field ".concat(o.typeName,".").concat(i.name," from JSON: map value null"));let m;try{m=Yw(i.K,u)}catch(g){let y="cannot decode map key for field ".concat(o.typeName,".").concat(i.name," from JSON: ").concat(Ln(e));throw g instanceof Error&&g.message.length>0&&(y+=": ".concat(g.message)),new Error(y)}switch(i.V.kind){case"message":d[m]=i.V.T.fromJson(h,s);break;case"enum":const g=Xd(i.V.T,h,s.ignoreUnknownFields,!0);g!==Ol&&(d[m]=g);break;case"scalar":try{d[m]=qr(i.V.T,h,Zi.BIGINT,!0)}catch(y){let S="cannot decode map value for field ".concat(o.typeName,".").concat(i.name," from JSON: ").concat(Ln(e));throw y instanceof Error&&y.message.length>0&&(S+=": ".concat(y.message)),new Error(S)}break}}}else switch(i.oneof&&(a=a[i.oneof.localName]={case:l},l="value"),i.kind){case"message":const d=i.T;if(e===null&&d.typeName!="google.protobuf.Value")return;let u=a[l];fi(u)?u.fromJson(e,s):(a[l]=u=d.fromJson(e,s),d.fieldWrapper&&!i.oneof&&(a[l]=d.fieldWrapper.unwrapField(u)));break;case"enum":const h=Xd(i.T,e,s.ignoreUnknownFields,!1);switch(h){case Jl:Oy(i,a);break;case Ol:break;default:a[l]=h;break}break;case"scalar":try{const m=qr(i.T,e,i.L,!1);m===Jl?Oy(i,a):a[l]=m}catch(m){let g="cannot decode field ".concat(o.typeName,".").concat(i.name," from JSON: ").concat(Ln(e));throw m instanceof Error&&m.message.length>0&&(g+=": ".concat(m.message)),new Error(g)}break}}function Yw(a,e){if(a===X.BOOL)switch(e){case"true":e=!0;break;case"false":e=!1;break}return qr(a,e,Zi.BIGINT,!0).toString()}function qr(a,e,i,s){if(e===null)return s?Ns(a,i):Jl;switch(a){case X.DOUBLE:case X.FLOAT:if(e==="NaN")return Number.NaN;if(e==="Infinity")return Number.POSITIVE_INFINITY;if(e==="-Infinity")return Number.NEGATIVE_INFINITY;if(e===""||typeof e=="string"&&e.trim().length!==e.length||typeof e!="string"&&typeof e!="number")break;const o=Number(e);if(Number.isNaN(o)||!Number.isFinite(o))break;return a==X.FLOAT&&Eb(o),o;case X.INT32:case X.FIXED32:case X.SFIXED32:case X.SINT32:case X.UINT32:let l;if(typeof e=="number"?l=e:typeof e=="string"&&e.length>0&&e.trim().length===e.length&&(l=Number(e)),l===void 0)break;return a==X.UINT32||a==X.FIXED32?yh(l):Nl(l),l;case X.INT64:case X.SFIXED64:case X.SINT64:if(typeof e!="number"&&typeof e!="string")break;const d=et.parse(e);return i?d.toString():d;case X.FIXED64:case X.UINT64:if(typeof e!="number"&&typeof e!="string")break;const u=et.uParse(e);return i?u.toString():u;case X.BOOL:if(typeof e!="boolean")break;return e;case X.STRING:if(typeof e!="string")break;try{encodeURIComponent(e)}catch{throw new Error("invalid UTF8")}return e;case X.BYTES:if(e==="")return new Uint8Array(0);if(typeof e!="string")break;return Ob.dec(e)}throw new Error}function Xd(a,e,i,s){if(e===null)return a.typeName=="google.protobuf.NullValue"?0:s?a.values[0].no:Jl;switch(typeof e){case"number":if(Number.isInteger(e))return e;break;case"string":const o=a.findName(e);if(o!==void 0)return o.no;if(i)return Ol;break}throw new Error("cannot decode enum ".concat(a.typeName," from JSON: ").concat(Ln(e)))}function Jw(a){return a.repeated||a.kind=="map"?!0:!(a.oneof||a.kind=="message"||a.opt||a.req)}function Ly(a,e,i){if(a.kind=="map"){st(typeof e=="object"&&e!=null);const s={},o=Object.entries(e);switch(a.V.kind){case"scalar":for(const[d,u]of o)s[d.toString()]=Pl(a.V.T,u);break;case"message":for(const[d,u]of o)s[d.toString()]=u.toJson(i);break;case"enum":const l=a.V.T;for(const[d,u]of o)s[d.toString()]=Wd(l,u,i.enumAsInteger);break}return i.emitDefaultValues||o.length>0?s:void 0}if(a.repeated){st(Array.isArray(e));const s=[];switch(a.kind){case"scalar":for(let o=0;o<e.length;o++)s.push(Pl(a.T,e[o]));break;case"enum":for(let o=0;o<e.length;o++)s.push(Wd(a.T,e[o],i.enumAsInteger));break;case"message":for(let o=0;o<e.length;o++)s.push(e[o].toJson(i));break}return i.emitDefaultValues||s.length>0?s:void 0}switch(a.kind){case"scalar":return Pl(a.T,e);case"enum":return Wd(a.T,e,i.enumAsInteger);case"message":return Lb(a.T,e).toJson(i)}}function Wd(a,e,i){var s;if(st(typeof e=="number"),a.typeName=="google.protobuf.NullValue")return null;if(i)return e;const o=a.findNumber(e);return(s=o?.name)!==null&&s!==void 0?s:e}function Pl(a,e){switch(a){case X.INT32:case X.SFIXED32:case X.SINT32:case X.FIXED32:case X.UINT32:return st(typeof e=="number"),e;case X.FLOAT:case X.DOUBLE:return st(typeof e=="number"),Number.isNaN(e)?"NaN":e===Number.POSITIVE_INFINITY?"Infinity":e===Number.NEGATIVE_INFINITY?"-Infinity":e;case X.STRING:return st(typeof e=="string"),e;case X.BOOL:return st(typeof e=="boolean"),e;case X.UINT64:case X.FIXED64:case X.INT64:case X.SFIXED64:case X.SINT64:return st(typeof e=="bigint"||typeof e=="string"||typeof e=="number"),e.toString();case X.BYTES:return st(e instanceof Uint8Array),Ob.enc(e)}}const bs=Symbol("@bufbuild/protobuf/unknown-fields"),Uy={readUnknownFields:!0,readerFactory:a=>new Uw(a)},By={writeUnknownFields:!0,writerFactory:()=>new Lw};function Qw(a){return a?Object.assign(Object.assign({},Uy),a):Uy}function Xw(a){return a?Object.assign(Object.assign({},By),a):By}function Ww(){return{makeReadOptions:Qw,makeWriteOptions:Xw,listUnknownFields(a){var e;return(e=a[bs])!==null&&e!==void 0?e:[]},discardUnknownFields(a){delete a[bs]},writeUnknownFields(a,e){const s=a[bs];if(s)for(const o of s)e.tag(o.no,o.wireType).raw(o.data)},onUnknownField(a,e,i,s){const o=a;Array.isArray(o[bs])||(o[bs]=[]),o[bs].push({no:e,wireType:i,data:s})},readMessage(a,e,i,s,o){const l=a.getType(),d=o?e.len:e.pos+i;let u,h;for(;e.pos<d&&([u,h]=e.tag(),!(o===!0&&h==dt.EndGroup));){const m=l.fields.find(u);if(!m){const g=e.skip(h,u);s.readUnknownFields&&this.onUnknownField(a,u,h,g);continue}qy(a,e,m,h,s)}if(o&&(h!=dt.EndGroup||u!==i))throw new Error("invalid end group tag")},readField:qy,writeMessage(a,e,i){const s=a.getType();for(const o of s.fields.byNumber()){if(!Ib(o,a)){if(o.req)throw new Error("cannot encode field ".concat(s.typeName,".").concat(o.name," to binary: required field not set"));continue}const l=o.oneof?a[o.oneof.localName].value:a[o.localName];zy(o,l,e,i)}return i.writeUnknownFields&&this.writeUnknownFields(a,e),e},writeField(a,e,i,s){e!==void 0&&zy(a,e,i,s)}}}function qy(a,e,i,s,o){let{repeated:l,localName:d}=i;switch(i.oneof&&(a=a[i.oneof.localName],a.case!=d&&delete a.value,a.case=d,d="value"),i.kind){case"scalar":case"enum":const u=i.kind=="enum"?X.INT32:i.T;let h=Ql;if(i.kind=="scalar"&&i.L>0&&(h=$w),l){let S=a[d];if(s==dt.LengthDelimited&&u!=X.STRING&&u!=X.BYTES){let x=e.uint32()+e.pos;for(;e.pos<x;)S.push(h(e,u))}else S.push(h(e,u))}else a[d]=h(e,u);break;case"message":const m=i.T;l?a[d].push(jl(e,new m,o,i)):fi(a[d])?jl(e,a[d],o,i):(a[d]=jl(e,new m,o,i),m.fieldWrapper&&!i.oneof&&!i.repeated&&(a[d]=m.fieldWrapper.unwrapField(a[d])));break;case"map":let[g,y]=Zw(i,e,o);a[d][g]=y;break}}function jl(a,e,i,s){const o=e.getType().runtime.bin,l=s?.delimited;return o.readMessage(e,a,l?s.no:a.uint32(),i,l),e}function Zw(a,e,i){const s=e.uint32(),o=e.pos+s;let l,d;for(;e.pos<o;){const[u]=e.tag();switch(u){case 1:l=Ql(e,a.K);break;case 2:switch(a.V.kind){case"scalar":d=Ql(e,a.V.T);break;case"enum":d=e.int32();break;case"message":d=jl(e,new a.V.T,i,void 0);break}break}}if(l===void 0&&(l=Ns(a.K,Zi.BIGINT)),typeof l!="string"&&typeof l!="number"&&(l=l.toString()),d===void 0)switch(a.V.kind){case"scalar":d=Ns(a.V.T,Zi.BIGINT);break;case"enum":d=a.V.T.values[0].no;break;case"message":d=new a.V.T;break}return[l,d]}function $w(a,e){const i=Ql(a,e);return typeof i=="bigint"?i.toString():i}function Ql(a,e){switch(e){case X.STRING:return a.string();case X.BOOL:return a.bool();case X.DOUBLE:return a.double();case X.FLOAT:return a.float();case X.INT32:return a.int32();case X.INT64:return a.int64();case X.UINT64:return a.uint64();case X.FIXED64:return a.fixed64();case X.BYTES:return a.bytes();case X.FIXED32:return a.fixed32();case X.SFIXED32:return a.sfixed32();case X.SFIXED64:return a.sfixed64();case X.SINT64:return a.sint64();case X.UINT32:return a.uint32();case X.SINT32:return a.sint32()}}function zy(a,e,i,s){st(e!==void 0);const o=a.repeated;switch(a.kind){case"scalar":case"enum":let l=a.kind=="enum"?X.INT32:a.T;if(o)if(st(Array.isArray(e)),a.packed)tx(i,l,a.no,e);else for(const d of e)zr(i,l,a.no,d);else zr(i,l,a.no,e);break;case"message":if(o){st(Array.isArray(e));for(const d of e)Fy(i,s,a,d)}else Fy(i,s,a,e);break;case"map":st(typeof e=="object"&&e!=null);for(const[d,u]of Object.entries(e))ex(i,s,a,d,u);break}}function ex(a,e,i,s,o){a.tag(i.no,dt.LengthDelimited),a.fork();let l=s;switch(i.K){case X.INT32:case X.FIXED32:case X.UINT32:case X.SFIXED32:case X.SINT32:l=Number.parseInt(s);break;case X.BOOL:st(s=="true"||s=="false"),l=s=="true";break}switch(zr(a,i.K,1,l),i.V.kind){case"scalar":zr(a,i.V.T,2,o);break;case"enum":zr(a,X.INT32,2,o);break;case"message":st(o!==void 0),a.tag(2,dt.LengthDelimited).bytes(o.toBinary(e));break}a.join()}function Fy(a,e,i,s){const o=Lb(i.T,s);i.delimited?a.tag(i.no,dt.StartGroup).raw(o.toBinary(e)).tag(i.no,dt.EndGroup):a.tag(i.no,dt.LengthDelimited).bytes(o.toBinary(e))}function zr(a,e,i,s){st(s!==void 0);let[o,l]=Ub(e);a.tag(i,o)[l](s)}function tx(a,e,i,s){if(!s.length)return;a.tag(i,dt.LengthDelimited).fork();let[,o]=Ub(e);for(let l=0;l<s.length;l++)a[o](s[l]);a.join()}function Ub(a){let e=dt.Varint;switch(a){case X.BYTES:case X.STRING:e=dt.LengthDelimited;break;case X.DOUBLE:case X.FIXED64:case X.SFIXED64:e=dt.Bit64;break;case X.FIXED32:case X.SFIXED32:case X.FLOAT:e=dt.Bit32;break}const i=X[a].toLowerCase();return[e,i]}function nx(){return{setEnumType:wb,initPartial(a,e){if(a===void 0)return;const i=e.getType();for(const s of i.fields.byMember()){const o=s.localName,l=e,d=a;if(d[o]!=null)switch(s.kind){case"oneof":const u=d[o].case;if(u===void 0)continue;const h=s.findField(u);let m=d[o].value;h&&h.kind=="message"&&!fi(m,h.T)?m=new h.T(m):h&&h.kind==="scalar"&&h.T===X.BYTES&&(m=Dr(m)),l[o]={case:u,value:m};break;case"scalar":case"enum":let g=d[o];s.T===X.BYTES&&(g=s.repeated?g.map(Dr):Dr(g)),l[o]=g;break;case"map":switch(s.V.kind){case"scalar":case"enum":if(s.V.T===X.BYTES)for(const[T,x]of Object.entries(d[o]))l[o][T]=Dr(x);else Object.assign(l[o],d[o]);break;case"message":const S=s.V.T;for(const T of Object.keys(d[o])){let x=d[o][T];S.fieldWrapper||(x=new S(x)),l[o][T]=x}break}break;case"message":const y=s.T;if(s.repeated)l[o]=d[o].map(S=>fi(S,y)?S:new y(S));else{const S=d[o];y.fieldWrapper?y.typeName==="google.protobuf.BytesValue"?l[o]=Dr(S):l[o]=S:l[o]=fi(S,y)?S:new y(S)}break}}},equals(a,e,i){return e===i?!0:!e||!i?!1:a.fields.byMember().every(s=>{const o=e[s.localName],l=i[s.localName];if(s.repeated){if(o.length!==l.length)return!1;switch(s.kind){case"message":return o.every((d,u)=>s.T.equals(d,l[u]));case"scalar":return o.every((d,u)=>Gi(s.T,d,l[u]));case"enum":return o.every((d,u)=>Gi(X.INT32,d,l[u]))}throw new Error("repeated cannot contain ".concat(s.kind))}switch(s.kind){case"message":let d=o,u=l;return s.T.fieldWrapper&&(d!==void 0&&!fi(d)&&(d=s.T.fieldWrapper.wrapField(d)),u!==void 0&&!fi(u)&&(u=s.T.fieldWrapper.wrapField(u))),s.T.equals(d,u);case"enum":return Gi(X.INT32,o,l);case"scalar":return Gi(s.T,o,l);case"oneof":if(o.case!==l.case)return!1;const h=s.findField(o.case);if(h===void 0)return!0;switch(h.kind){case"message":return h.T.equals(o.value,l.value);case"enum":return Gi(X.INT32,o.value,l.value);case"scalar":return Gi(h.T,o.value,l.value)}throw new Error("oneof cannot contain ".concat(h.kind));case"map":const m=Object.keys(o).concat(Object.keys(l));switch(s.V.kind){case"message":const g=s.V.T;return m.every(S=>g.equals(o[S],l[S]));case"enum":return m.every(S=>Gi(X.INT32,o[S],l[S]));case"scalar":const y=s.V.T;return m.every(S=>Gi(y,o[S],l[S]))}break}})},clone(a){const e=a.getType(),i=new e,s=i;for(const o of e.fields.byMember()){const l=a[o.localName];let d;if(o.repeated)d=l.map(El);else if(o.kind=="map"){d=s[o.localName];for(const[u,h]of Object.entries(l))d[u]=El(h)}else o.kind=="oneof"?d=o.findField(l.case)?{case:l.case,value:El(l.value)}:{case:void 0}:d=El(l);s[o.localName]=d}for(const o of e.runtime.bin.listUnknownFields(a))e.runtime.bin.onUnknownField(s,o.no,o.wireType,o.data);return i}}}function El(a){if(a===void 0)return a;if(fi(a))return a.clone();if(a instanceof Uint8Array){const e=new Uint8Array(a.byteLength);return e.set(a),e}return a}function Dr(a){return a instanceof Uint8Array?a:new Uint8Array(a)}function ix(a,e,i){return{syntax:a,json:Kw(),bin:Ww(),util:Object.assign(Object.assign({},nx()),{newFieldList:e,initFields:i}),makeMessageType(s,o,l){return Nw(this,s,o,l)},makeEnum:Aw,makeEnumType:xb,getEnumType:Mw,makeExtension(s,o,l){return Bw(this,s,o,l)}}}class ax{constructor(e,i){this._fields=e,this._normalizer=i}findJsonName(e){if(!this.jsonNames){const i={};for(const s of this.list())i[s.jsonName]=i[s.name]=s;this.jsonNames=i}return this.jsonNames[e]}find(e){if(!this.numbers){const i={};for(const s of this.list())i[s.no]=s;this.numbers=i}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,i)=>e.no-i.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let i;for(const s of this.list())s.oneof?s.oneof!==i&&(i=s.oneof,e.push(i)):e.push(s)}return this.members}}function Bb(a,e){const i=qb(a);return e?i:ux(cx(i))}function sx(a){return Bb(a,!1)}const rx=qb;function qb(a){let e=!1;const i=[];for(let s=0;s<a.length;s++){let o=a.charAt(s);switch(o){case"_":e=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":i.push(o),e=!1;break;default:e&&(e=!1,o=o.toUpperCase()),i.push(o);break}}return i.join("")}const ox=new Set(["constructor","toString","toJSON","valueOf"]),lx=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),zb=a=>"".concat(a,"$"),cx=a=>lx.has(a)?zb(a):a,ux=a=>ox.has(a)?zb(a):a;class dx{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.req=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=sx(e)}addField(e){st(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let i=0;i<this.fields.length;i++)this._lookup[this.fields[i].localName]=this.fields[i]}return this._lookup[e]}}function hx(a,e){var i,s,o,l,d,u;const h=[];let m;for(const g of typeof a=="function"?a():a){const y=g;if(y.localName=Bb(g.name,g.oneof!==void 0),y.jsonName=(i=g.jsonName)!==null&&i!==void 0?i:rx(g.name),y.repeated=(s=g.repeated)!==null&&s!==void 0?s:!1,g.kind=="scalar"&&(y.L=(o=g.L)!==null&&o!==void 0?o:Zi.BIGINT),y.delimited=(l=g.delimited)!==null&&l!==void 0?l:!1,y.req=(d=g.req)!==null&&d!==void 0?d:!1,y.opt=(u=g.opt)!==null&&u!==void 0?u:!1,g.packed===void 0&&(y.packed=g.kind=="enum"||g.kind=="scalar"&&g.T!=X.BYTES&&g.T!=X.STRING),g.oneof!==void 0){const S=typeof g.oneof=="string"?g.oneof:g.oneof.name;(!m||m.name!=S)&&(m=new dx(S)),y.oneof=m,m.addField(y)}h.push(y)}return h}const U=ix("proto3",a=>new ax(a,e=>hx(e)),a=>{for(const e of a.getType().fields.byMember()){if(e.opt)continue;const i=e.localName,s=a;if(e.repeated){s[i]=[];continue}switch(e.kind){case"oneof":s[i]={case:void 0};break;case"enum":s[i]=0;break;case"map":s[i]={};break;case"scalar":s[i]=Ns(e.T,e.L);break}}});class Gt extends ef{constructor(e){super(),this.seconds=et.zero,this.nanos=0,U.util.initPartial(e,this)}fromJson(e,i){if(typeof e!="string")throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(U.json.debug(e)));const s=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!s)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const o=Date.parse(s[1]+"-"+s[2]+"-"+s[3]+"T"+s[4]+":"+s[5]+":"+s[6]+(s[8]?s[8]:"Z"));if(Number.isNaN(o))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(o<Date.parse("0001-01-01T00:00:00Z")||o>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=et.parse(o/1e3),this.nanos=0,s[7]&&(this.nanos=parseInt("1"+s[7]+"0".repeat(9-s[7].length))-1e9),this}toJson(e){const i=Number(this.seconds)*1e3;if(i<Date.parse("0001-01-01T00:00:00Z")||i>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let s="Z";if(this.nanos>0){const o=(this.nanos+1e9).toString().substring(1);o.substring(3)==="000000"?s="."+o.substring(0,3)+"Z":o.substring(6)==="000"?s="."+o.substring(0,6)+"Z":s="."+o+"Z"}return new Date(i).toISOString().replace(".000Z",s)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return Gt.fromDate(new Date)}static fromDate(e){const i=e.getTime();return new Gt({seconds:et.parse(Math.floor(i/1e3)),nanos:i%1e3*1e6})}static fromBinary(e,i){return new Gt().fromBinary(e,i)}static fromJson(e,i){return new Gt().fromJson(e,i)}static fromJsonString(e,i){return new Gt().fromJsonString(e,i)}static equals(e,i){return U.util.equals(Gt,e,i)}}Gt.runtime=U;Gt.typeName="google.protobuf.Timestamp";Gt.fields=U.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);const fx=U.makeMessageType("livekit.MetricsBatch",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:Gt},{no:3,name:"str_data",kind:"scalar",T:9,repeated:!0},{no:4,name:"time_series",kind:"message",T:mx,repeated:!0},{no:5,name:"events",kind:"message",T:gx,repeated:!0}]),mx=U.makeMessageType("livekit.TimeSeriesMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"samples",kind:"message",T:px,repeated:!0},{no:5,name:"rid",kind:"scalar",T:13}]),px=U.makeMessageType("livekit.MetricSample",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:Gt},{no:3,name:"value",kind:"scalar",T:2}]),gx=U.makeMessageType("livekit.EventMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"start_timestamp_ms",kind:"scalar",T:3},{no:5,name:"end_timestamp_ms",kind:"scalar",T:3,opt:!0},{no:6,name:"normalized_start_timestamp",kind:"message",T:Gt},{no:7,name:"normalized_end_timestamp",kind:"message",T:Gt,opt:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"rid",kind:"scalar",T:13}]),Fb=U.makeEnum("livekit.BackupCodecPolicy",[{no:0,name:"PREFER_REGRESSION"},{no:1,name:"SIMULCAST"},{no:2,name:"REGRESSION"}]),wn=U.makeEnum("livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]),vt=U.makeEnum("livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]),nf=U.makeEnum("livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]),Ur=U.makeEnum("livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]),Jr=U.makeEnum("livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]),Mn=U.makeEnum("livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"},{no:8,name:"MIGRATION"},{no:9,name:"SIGNAL_CLOSE"},{no:10,name:"ROOM_CLOSED"},{no:11,name:"USER_UNAVAILABLE"},{no:12,name:"USER_REJECTED"},{no:13,name:"SIP_TRUNK_FAILURE"},{no:14,name:"CONNECTION_TIMEOUT"},{no:15,name:"MEDIA_FAILURE"}]),ka=U.makeEnum("livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]),vx=U.makeEnum("livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]),Ct=U.makeEnum("livekit.AudioTrackFeature",[{no:0,name:"TF_STEREO"},{no:1,name:"TF_NO_DTX"},{no:2,name:"TF_AUTO_GAIN_CONTROL"},{no:3,name:"TF_ECHO_CANCELLATION"},{no:4,name:"TF_NOISE_SUPPRESSION"},{no:5,name:"TF_ENHANCED_NOISE_CANCELLATION"},{no:6,name:"TF_PRECONNECT_BUFFER"}]),hc=U.makeMessageType("livekit.Room",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:14,name:"departure_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:15,name:"creation_time_ms",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:Xl,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8},{no:13,name:"version",kind:"message",T:tS}]),Xl=U.makeMessageType("livekit.Codec",()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]),yx=U.makeMessageType("livekit.ParticipantPermission",()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:U.getEnumType(vt),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8},{no:12,name:"can_subscribe_metrics",kind:"scalar",T:8}]),Ra=U.makeMessageType("livekit.ParticipantInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:U.getEnumType(Es)},{no:4,name:"tracks",kind:"message",T:Cs,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:17,name:"joined_at_ms",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:yx},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8},{no:14,name:"kind",kind:"enum",T:U.getEnumType(Qr)},{no:15,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:16,name:"disconnect_reason",kind:"enum",T:U.getEnumType(Mn)},{no:18,name:"kind_details",kind:"enum",T:U.getEnumType(bx),repeated:!0},{no:19,name:"data_tracks",kind:"message",T:af,repeated:!0}]),Es=U.makeEnum("livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]),Qr=U.makeEnum("livekit.ParticipantInfo.Kind",[{no:0,name:"STANDARD"},{no:1,name:"INGRESS"},{no:2,name:"EGRESS"},{no:3,name:"SIP"},{no:4,name:"AGENT"},{no:7,name:"CONNECTOR"},{no:8,name:"BRIDGE"}]),bx=U.makeEnum("livekit.ParticipantInfo.KindDetail",[{no:0,name:"CLOUD_AGENT"},{no:1,name:"FORWARDED"},{no:2,name:"CONNECTOR_WHATSAPP"},{no:3,name:"CONNECTOR_TWILIO"},{no:4,name:"BRIDGE_RTSP"}]),ht=U.makeEnum("livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]),Sx=U.makeMessageType("livekit.SimulcastCodecInfo",()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:Xi,repeated:!0},{no:5,name:"video_layer_mode",kind:"enum",T:U.getEnumType(Hb)},{no:6,name:"sdp_cid",kind:"scalar",T:9}]),Cs=U.makeMessageType("livekit.TrackInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:U.getEnumType(wn)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:U.getEnumType(vt)},{no:10,name:"layers",kind:"message",T:Xi,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:Sx,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:U.getEnumType(ht)},{no:17,name:"stream",kind:"scalar",T:9},{no:18,name:"version",kind:"message",T:tS},{no:19,name:"audio_features",kind:"enum",T:U.getEnumType(Ct),repeated:!0},{no:20,name:"backup_codec_policy",kind:"enum",T:U.getEnumType(Fb)}]),af=U.makeMessageType("livekit.DataTrackInfo",()=>[{no:1,name:"pub_handle",kind:"scalar",T:13},{no:2,name:"sid",kind:"scalar",T:9},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"encryption",kind:"enum",T:U.getEnumType(ht)}]),Cx=U.makeMessageType("livekit.DataTrackSubscriptionOptions",()=>[{no:1,name:"target_fps",kind:"scalar",T:13,opt:!0}]),Xi=U.makeMessageType("livekit.VideoLayer",()=>[{no:1,name:"quality",kind:"enum",T:U.getEnumType(nf)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13},{no:6,name:"spatial_layer",kind:"scalar",T:5},{no:7,name:"rid",kind:"scalar",T:9},{no:8,name:"repair_ssrc",kind:"scalar",T:13}]),Hb=U.makeEnum("livekit.VideoLayer.Mode",[{no:0,name:"MODE_UNUSED"},{no:1,name:"ONE_SPATIAL_LAYER_PER_STREAM"},{no:2,name:"MULTIPLE_SPATIAL_LAYERS_PER_STREAM"},{no:3,name:"ONE_SPATIAL_LAYER_PER_STREAM_INCOMPLETE_RTCP_SR"}]),jt=U.makeMessageType("livekit.DataPacket",()=>[{no:1,name:"kind",kind:"enum",T:U.getEnumType(Ce)},{no:4,name:"participant_identity",kind:"scalar",T:9},{no:5,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:2,name:"user",kind:"message",T:sf,oneof:"value"},{no:3,name:"speaker",kind:"message",T:Tx,oneof:"value"},{no:6,name:"sip_dtmf",kind:"message",T:Yb,oneof:"value"},{no:7,name:"transcription",kind:"message",T:kx,oneof:"value"},{no:8,name:"metrics",kind:"message",T:fx,oneof:"value"},{no:9,name:"chat_message",kind:"message",T:Wl,oneof:"value"},{no:10,name:"rpc_request",kind:"message",T:rf,oneof:"value"},{no:11,name:"rpc_ack",kind:"message",T:of,oneof:"value"},{no:12,name:"rpc_response",kind:"message",T:lf,oneof:"value"},{no:13,name:"stream_header",kind:"message",T:Zl,oneof:"value"},{no:14,name:"stream_chunk",kind:"message",T:$l,oneof:"value"},{no:15,name:"stream_trailer",kind:"message",T:ec,oneof:"value"},{no:18,name:"encrypted_packet",kind:"message",T:Vb,oneof:"value"},{no:16,name:"sequence",kind:"scalar",T:13},{no:17,name:"participant_sid",kind:"scalar",T:9}]),Ce=U.makeEnum("livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]),Vb=U.makeMessageType("livekit.EncryptedPacket",()=>[{no:1,name:"encryption_type",kind:"enum",T:U.getEnumType(ht)},{no:2,name:"iv",kind:"scalar",T:12},{no:3,name:"key_index",kind:"scalar",T:13},{no:4,name:"encrypted_value",kind:"scalar",T:12}]),Gb=U.makeMessageType("livekit.EncryptedPacketPayload",()=>[{no:1,name:"user",kind:"message",T:sf,oneof:"value"},{no:3,name:"chat_message",kind:"message",T:Wl,oneof:"value"},{no:4,name:"rpc_request",kind:"message",T:rf,oneof:"value"},{no:5,name:"rpc_ack",kind:"message",T:of,oneof:"value"},{no:6,name:"rpc_response",kind:"message",T:lf,oneof:"value"},{no:7,name:"stream_header",kind:"message",T:Zl,oneof:"value"},{no:8,name:"stream_chunk",kind:"message",T:$l,oneof:"value"},{no:9,name:"stream_trailer",kind:"message",T:ec,oneof:"value"}]),Tx=U.makeMessageType("livekit.ActiveSpeakerUpdate",()=>[{no:1,name:"speakers",kind:"message",T:Kb,repeated:!0}]),Kb=U.makeMessageType("livekit.SpeakerInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]),sf=U.makeMessageType("livekit.UserPacket",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0},{no:8,name:"id",kind:"scalar",T:9,opt:!0},{no:9,name:"start_time",kind:"scalar",T:4,opt:!0},{no:10,name:"end_time",kind:"scalar",T:4,opt:!0},{no:11,name:"nonce",kind:"scalar",T:12}]),Yb=U.makeMessageType("livekit.SipDTMF",()=>[{no:3,name:"code",kind:"scalar",T:13},{no:4,name:"digit",kind:"scalar",T:9}]),kx=U.makeMessageType("livekit.Transcription",()=>[{no:2,name:"transcribed_participant_identity",kind:"scalar",T:9},{no:3,name:"track_id",kind:"scalar",T:9},{no:4,name:"segments",kind:"message",T:Ex,repeated:!0}]),Ex=U.makeMessageType("livekit.TranscriptionSegment",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"text",kind:"scalar",T:9},{no:3,name:"start_time",kind:"scalar",T:4},{no:4,name:"end_time",kind:"scalar",T:4},{no:5,name:"final",kind:"scalar",T:8},{no:6,name:"language",kind:"scalar",T:9}]),Wl=U.makeMessageType("livekit.ChatMessage",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"edit_timestamp",kind:"scalar",T:3,opt:!0},{no:4,name:"message",kind:"scalar",T:9},{no:5,name:"deleted",kind:"scalar",T:8},{no:6,name:"generated",kind:"scalar",T:8}]),rf=U.makeMessageType("livekit.RpcRequest",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"method",kind:"scalar",T:9},{no:3,name:"payload",kind:"scalar",T:9},{no:4,name:"response_timeout_ms",kind:"scalar",T:13},{no:5,name:"version",kind:"scalar",T:13}]),of=U.makeMessageType("livekit.RpcAck",()=>[{no:1,name:"request_id",kind:"scalar",T:9}]),lf=U.makeMessageType("livekit.RpcResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:9,oneof:"value"},{no:3,name:"error",kind:"message",T:Jb,oneof:"value"}]),Jb=U.makeMessageType("livekit.RpcError",()=>[{no:1,name:"code",kind:"scalar",T:13},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"data",kind:"scalar",T:9}]),Qb=U.makeMessageType("livekit.ParticipantTracks",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]),Xb=U.makeMessageType("livekit.ServerInfo",()=>[{no:1,name:"edition",kind:"enum",T:U.getEnumType(Wb)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9},{no:7,name:"agent_protocol",kind:"scalar",T:5}]),Wb=U.makeEnum("livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]),Zb=U.makeMessageType("livekit.ClientInfo",()=>[{no:1,name:"sdk",kind:"enum",T:U.getEnumType($b)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9},{no:11,name:"other_sdks",kind:"scalar",T:9}]),$b=U.makeEnum("livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"},{no:11,name:"UNITY_WEB"},{no:12,name:"NODE"},{no:13,name:"UNREAL"},{no:14,name:"ESP32"}]),eS=U.makeMessageType("livekit.ClientConfiguration",()=>[{no:1,name:"video",kind:"message",T:Hy},{no:2,name:"screen",kind:"message",T:Hy},{no:3,name:"resume_connection",kind:"enum",T:U.getEnumType(Jr)},{no:4,name:"disabled_codecs",kind:"message",T:_x},{no:5,name:"force_relay",kind:"enum",T:U.getEnumType(Jr)}]),Hy=U.makeMessageType("livekit.VideoConfiguration",()=>[{no:1,name:"hardware_encoder",kind:"enum",T:U.getEnumType(Jr)}]),_x=U.makeMessageType("livekit.DisabledCodecs",()=>[{no:1,name:"codecs",kind:"message",T:Xl,repeated:!0},{no:2,name:"publish",kind:"message",T:Xl,repeated:!0}]),tS=U.makeMessageType("livekit.TimedVersion",()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]),bh=U.makeEnum("livekit.DataStream.OperationType",[{no:0,name:"CREATE"},{no:1,name:"UPDATE"},{no:2,name:"DELETE"},{no:3,name:"REACTION"}]),nS=U.makeMessageType("livekit.DataStream.TextHeader",()=>[{no:1,name:"operation_type",kind:"enum",T:U.getEnumType(bh)},{no:2,name:"version",kind:"scalar",T:5},{no:3,name:"reply_to_stream_id",kind:"scalar",T:9},{no:4,name:"attached_stream_ids",kind:"scalar",T:9,repeated:!0},{no:5,name:"generated",kind:"scalar",T:8}],{localName:"DataStream_TextHeader"}),iS=U.makeMessageType("livekit.DataStream.ByteHeader",()=>[{no:1,name:"name",kind:"scalar",T:9}],{localName:"DataStream_ByteHeader"}),Zl=U.makeMessageType("livekit.DataStream.Header",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"topic",kind:"scalar",T:9},{no:4,name:"mime_type",kind:"scalar",T:9},{no:5,name:"total_length",kind:"scalar",T:4,opt:!0},{no:7,name:"encryption_type",kind:"enum",T:U.getEnumType(ht)},{no:8,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:9,name:"text_header",kind:"message",T:nS,oneof:"content_header"},{no:10,name:"byte_header",kind:"message",T:iS,oneof:"content_header"}],{localName:"DataStream_Header"}),$l=U.makeMessageType("livekit.DataStream.Chunk",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"chunk_index",kind:"scalar",T:4},{no:3,name:"content",kind:"scalar",T:12},{no:4,name:"version",kind:"scalar",T:5},{no:5,name:"iv",kind:"scalar",T:12,opt:!0}],{localName:"DataStream_Chunk"}),ec=U.makeMessageType("livekit.DataStream.Trailer",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"reason",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}}],{localName:"DataStream_Trailer"}),wx=U.makeMessageType("livekit.SubscribedAudioCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"enabled",kind:"scalar",T:8}]),xn=U.makeEnum("livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]),Sh=U.makeEnum("livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]),xx=U.makeEnum("livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]),Rx=U.makeMessageType("livekit.SignalRequest",()=>[{no:1,name:"offer",kind:"message",T:$i,oneof:"message"},{no:2,name:"answer",kind:"message",T:$i,oneof:"message"},{no:3,name:"trickle",kind:"message",T:fc,oneof:"message"},{no:4,name:"add_track",kind:"message",T:Xr,oneof:"message"},{no:5,name:"mute",kind:"message",T:mc,oneof:"message"},{no:6,name:"subscription",kind:"message",T:pc,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:oS,oneof:"message"},{no:8,name:"leave",kind:"message",T:gc,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:cS,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:hS,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:ff,oneof:"message"},{no:13,name:"simulate",kind:"message",T:In,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:df,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:pS,oneof:"message"},{no:17,name:"update_audio_track",kind:"message",T:uf,oneof:"message"},{no:18,name:"update_video_track",kind:"message",T:lS,oneof:"message"},{no:19,name:"publish_data_track_request",kind:"message",T:aS,oneof:"message"},{no:20,name:"unpublish_data_track_request",kind:"message",T:rS,oneof:"message"},{no:21,name:"update_data_subscription",kind:"message",T:Ix,oneof:"message"}]),Vy=U.makeMessageType("livekit.SignalResponse",()=>[{no:1,name:"join",kind:"message",T:Dx,oneof:"message"},{no:2,name:"answer",kind:"message",T:$i,oneof:"message"},{no:3,name:"offer",kind:"message",T:$i,oneof:"message"},{no:4,name:"trickle",kind:"message",T:fc,oneof:"message"},{no:5,name:"update",kind:"message",T:jx,oneof:"message"},{no:6,name:"track_published",kind:"message",T:cf,oneof:"message"},{no:8,name:"leave",kind:"message",T:gc,oneof:"message"},{no:9,name:"mute",kind:"message",T:mc,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:Ux,oneof:"message"},{no:11,name:"room_update",kind:"message",T:Bx,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:zx,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:Hx,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:Gx,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:Yx,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:Px,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:Ox,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:Qx,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:Zx,oneof:"message"},{no:22,name:"request_response",kind:"message",T:$x,oneof:"message"},{no:23,name:"track_subscribed",kind:"message",T:eR,oneof:"message"},{no:24,name:"room_moved",kind:"message",T:Jx,oneof:"message"},{no:25,name:"media_sections_requirement",kind:"message",T:aR,oneof:"message"},{no:26,name:"subscribed_audio_codec_update",kind:"message",T:Kx,oneof:"message"},{no:27,name:"publish_data_track_response",kind:"message",T:sS,oneof:"message"},{no:28,name:"unpublish_data_track_response",kind:"message",T:Mx,oneof:"message"},{no:29,name:"data_track_subscriber_handles",kind:"message",T:Ax,oneof:"message"}]),Ch=U.makeMessageType("livekit.SimulcastCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:Xi,repeated:!0},{no:5,name:"video_layer_mode",kind:"enum",T:U.getEnumType(Hb)}]),Xr=U.makeMessageType("livekit.AddTrackRequest",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:U.getEnumType(wn)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:U.getEnumType(vt)},{no:9,name:"layers",kind:"message",T:Xi,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:Ch,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:U.getEnumType(ht)},{no:15,name:"stream",kind:"scalar",T:9},{no:16,name:"backup_codec_policy",kind:"enum",T:U.getEnumType(Fb)},{no:17,name:"audio_features",kind:"enum",T:U.getEnumType(Ct),repeated:!0}]),aS=U.makeMessageType("livekit.PublishDataTrackRequest",()=>[{no:1,name:"pub_handle",kind:"scalar",T:13},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"encryption",kind:"enum",T:U.getEnumType(ht)}]),sS=U.makeMessageType("livekit.PublishDataTrackResponse",()=>[{no:1,name:"info",kind:"message",T:af}]),rS=U.makeMessageType("livekit.UnpublishDataTrackRequest",()=>[{no:1,name:"pub_handle",kind:"scalar",T:13}]),Mx=U.makeMessageType("livekit.UnpublishDataTrackResponse",()=>[{no:1,name:"info",kind:"message",T:af}]),Ax=U.makeMessageType("livekit.DataTrackSubscriberHandles",()=>[{no:1,name:"sub_handles",kind:"map",K:13,V:{kind:"message",T:Nx}}]),Nx=U.makeMessageType("livekit.DataTrackSubscriberHandles.PublishedDataTrack",()=>[{no:1,name:"publisher_identity",kind:"scalar",T:9},{no:2,name:"publisher_sid",kind:"scalar",T:9},{no:3,name:"track_sid",kind:"scalar",T:9}],{localName:"DataTrackSubscriberHandles_PublishedDataTrack"}),fc=U.makeMessageType("livekit.TrickleRequest",()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:U.getEnumType(xn)},{no:3,name:"final",kind:"scalar",T:8}]),mc=U.makeMessageType("livekit.MuteTrackRequest",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]),Dx=U.makeMessageType("livekit.JoinResponse",()=>[{no:1,name:"room",kind:"message",T:hc},{no:2,name:"participant",kind:"message",T:Ra},{no:3,name:"other_participants",kind:"message",T:Ra,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:uS,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:eS},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:Xb},{no:13,name:"sif_trailer",kind:"scalar",T:12},{no:14,name:"enabled_publish_codecs",kind:"message",T:Xl,repeated:!0},{no:15,name:"fast_publish",kind:"scalar",T:8}]),Ox=U.makeMessageType("livekit.ReconnectResponse",()=>[{no:1,name:"ice_servers",kind:"message",T:uS,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:eS},{no:3,name:"server_info",kind:"message",T:Xb},{no:4,name:"last_message_seq",kind:"scalar",T:13}]),cf=U.makeMessageType("livekit.TrackPublishedResponse",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:Cs}]),Px=U.makeMessageType("livekit.TrackUnpublishedResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]),$i=U.makeMessageType("livekit.SessionDescription",()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9},{no:3,name:"id",kind:"scalar",T:13},{no:4,name:"mid_to_track_id",kind:"map",K:9,V:{kind:"scalar",T:9}}]),jx=U.makeMessageType("livekit.ParticipantUpdate",()=>[{no:1,name:"participants",kind:"message",T:Ra,repeated:!0}]),pc=U.makeMessageType("livekit.UpdateSubscription",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:Qb,repeated:!0}]),Ix=U.makeMessageType("livekit.UpdateDataSubscription",()=>[{no:1,name:"updates",kind:"message",T:Lx,repeated:!0}]),Lx=U.makeMessageType("livekit.UpdateDataSubscription.Update",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"options",kind:"message",T:Cx}],{localName:"UpdateDataSubscription_Update"}),oS=U.makeMessageType("livekit.UpdateTrackSettings",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:U.getEnumType(nf)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]),uf=U.makeMessageType("livekit.UpdateLocalAudioTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"features",kind:"enum",T:U.getEnumType(Ct),repeated:!0}]),lS=U.makeMessageType("livekit.UpdateLocalVideoTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13}]),gc=U.makeMessageType("livekit.LeaveRequest",()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:U.getEnumType(Mn)},{no:3,name:"action",kind:"enum",T:U.getEnumType(_s)},{no:4,name:"regions",kind:"message",T:Xx}]),_s=U.makeEnum("livekit.LeaveRequest.Action",[{no:0,name:"DISCONNECT"},{no:1,name:"RESUME"},{no:2,name:"RECONNECT"}]),cS=U.makeMessageType("livekit.UpdateVideoLayers",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:Xi,repeated:!0}]),df=U.makeMessageType("livekit.UpdateParticipantMetadata",()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:4,name:"request_id",kind:"scalar",T:13}]),uS=U.makeMessageType("livekit.ICEServer",()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]),Ux=U.makeMessageType("livekit.SpeakersChanged",()=>[{no:1,name:"speakers",kind:"message",T:Kb,repeated:!0}]),Bx=U.makeMessageType("livekit.RoomUpdate",()=>[{no:1,name:"room",kind:"message",T:hc}]),qx=U.makeMessageType("livekit.ConnectionQualityInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:U.getEnumType(Ur)},{no:3,name:"score",kind:"scalar",T:2}]),zx=U.makeMessageType("livekit.ConnectionQualityUpdate",()=>[{no:1,name:"updates",kind:"message",T:qx,repeated:!0}]),Fx=U.makeMessageType("livekit.StreamStateInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:U.getEnumType(Sh)}]),Hx=U.makeMessageType("livekit.StreamStateUpdate",()=>[{no:1,name:"stream_states",kind:"message",T:Fx,repeated:!0}]),hf=U.makeMessageType("livekit.SubscribedQuality",()=>[{no:1,name:"quality",kind:"enum",T:U.getEnumType(nf)},{no:2,name:"enabled",kind:"scalar",T:8}]),Vx=U.makeMessageType("livekit.SubscribedCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:hf,repeated:!0}]),Gx=U.makeMessageType("livekit.SubscribedQualityUpdate",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:hf,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:Vx,repeated:!0}]),Kx=U.makeMessageType("livekit.SubscribedAudioCodecUpdate",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_audio_codecs",kind:"message",T:wx,repeated:!0}]),dS=U.makeMessageType("livekit.TrackPermission",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]),hS=U.makeMessageType("livekit.SubscriptionPermission",()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:dS,repeated:!0}]),Yx=U.makeMessageType("livekit.SubscriptionPermissionUpdate",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]),Jx=U.makeMessageType("livekit.RoomMovedResponse",()=>[{no:1,name:"room",kind:"message",T:hc},{no:2,name:"token",kind:"scalar",T:9},{no:3,name:"participant",kind:"message",T:Ra},{no:4,name:"other_participants",kind:"message",T:Ra,repeated:!0}]),ff=U.makeMessageType("livekit.SyncState",()=>[{no:1,name:"answer",kind:"message",T:$i},{no:2,name:"subscription",kind:"message",T:pc},{no:3,name:"publish_tracks",kind:"message",T:cf,repeated:!0},{no:4,name:"data_channels",kind:"message",T:mS,repeated:!0},{no:5,name:"offer",kind:"message",T:$i},{no:6,name:"track_sids_disabled",kind:"scalar",T:9,repeated:!0},{no:7,name:"datachannel_receive_states",kind:"message",T:fS,repeated:!0},{no:8,name:"publish_data_tracks",kind:"message",T:sS,repeated:!0}]),fS=U.makeMessageType("livekit.DataChannelReceiveState",()=>[{no:1,name:"publisher_sid",kind:"scalar",T:9},{no:2,name:"last_seq",kind:"scalar",T:13}]),mS=U.makeMessageType("livekit.DataChannelInfo",()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:U.getEnumType(xn)}]),In=U.makeMessageType("livekit.SimulateScenario",()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:U.getEnumType(xx),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"},{no:7,name:"disconnect_signal_on_resume",kind:"scalar",T:8,oneof:"scenario"},{no:8,name:"disconnect_signal_on_resume_no_messages",kind:"scalar",T:8,oneof:"scenario"},{no:9,name:"leave_request_full_reconnect",kind:"scalar",T:8,oneof:"scenario"}]),pS=U.makeMessageType("livekit.Ping",()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]),Qx=U.makeMessageType("livekit.Pong",()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]),Xx=U.makeMessageType("livekit.RegionSettings",()=>[{no:1,name:"regions",kind:"message",T:Wx,repeated:!0}]),Wx=U.makeMessageType("livekit.RegionInfo",()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]),Zx=U.makeMessageType("livekit.SubscriptionResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:U.getEnumType(vx)}]),$x=U.makeMessageType("livekit.RequestResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:13},{no:2,name:"reason",kind:"enum",T:U.getEnumType(mf)},{no:3,name:"message",kind:"scalar",T:9},{no:4,name:"trickle",kind:"message",T:fc,oneof:"request"},{no:5,name:"add_track",kind:"message",T:Xr,oneof:"request"},{no:6,name:"mute",kind:"message",T:mc,oneof:"request"},{no:7,name:"update_metadata",kind:"message",T:df,oneof:"request"},{no:8,name:"update_audio_track",kind:"message",T:uf,oneof:"request"},{no:9,name:"update_video_track",kind:"message",T:lS,oneof:"request"},{no:10,name:"publish_data_track",kind:"message",T:aS,oneof:"request"},{no:11,name:"unpublish_data_track",kind:"message",T:rS,oneof:"request"}]),mf=U.makeEnum("livekit.RequestResponse.Reason",[{no:0,name:"OK"},{no:1,name:"NOT_FOUND"},{no:2,name:"NOT_ALLOWED"},{no:3,name:"LIMIT_EXCEEDED"},{no:4,name:"QUEUED"},{no:5,name:"UNSUPPORTED_TYPE"},{no:6,name:"UNCLASSIFIED_ERROR"},{no:7,name:"INVALID_HANDLE"},{no:8,name:"INVALID_NAME"},{no:9,name:"DUPLICATE_HANDLE"},{no:10,name:"DUPLICATE_NAME"}]),eR=U.makeMessageType("livekit.TrackSubscribed",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]),gS=U.makeMessageType("livekit.ConnectionSettings",()=>[{no:1,name:"auto_subscribe",kind:"scalar",T:8},{no:2,name:"adaptive_stream",kind:"scalar",T:8},{no:3,name:"subscriber_allow_pause",kind:"scalar",T:8,opt:!0},{no:4,name:"disable_ice_lite",kind:"scalar",T:8},{no:5,name:"auto_subscribe_data_track",kind:"scalar",T:8,opt:!0}]),tR=U.makeMessageType("livekit.JoinRequest",()=>[{no:1,name:"client_info",kind:"message",T:Zb},{no:2,name:"connection_settings",kind:"message",T:gS},{no:3,name:"metadata",kind:"scalar",T:9},{no:4,name:"participant_attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:5,name:"add_track_requests",kind:"message",T:Xr,repeated:!0},{no:6,name:"publisher_offer",kind:"message",T:$i},{no:7,name:"reconnect",kind:"scalar",T:8},{no:8,name:"reconnect_reason",kind:"enum",T:U.getEnumType(ka)},{no:9,name:"participant_sid",kind:"scalar",T:9},{no:10,name:"sync_state",kind:"message",T:ff}]),nR=U.makeMessageType("livekit.WrappedJoinRequest",()=>[{no:1,name:"compression",kind:"enum",T:U.getEnumType(iR)},{no:2,name:"join_request",kind:"scalar",T:12}]),iR=U.makeEnum("livekit.WrappedJoinRequest.Compression",[{no:0,name:"NONE"},{no:1,name:"GZIP"}]),aR=U.makeMessageType("livekit.MediaSectionsRequirement",()=>[{no:1,name:"num_audios",kind:"scalar",T:13},{no:2,name:"num_videos",kind:"scalar",T:13}]);function sR(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var Il={exports:{}},rR=Il.exports,Gy;function oR(){return Gy||(Gy=1,(function(a){(function(e,i){a.exports?a.exports=i():e.log=i()})(rR,function(){var e=function(){},i="undefined",s=typeof window!==i&&typeof window.navigator!==i&&/Trident\/|MSIE /.test(window.navigator.userAgent),o=["trace","debug","info","warn","error"],l={},d=null;function u(E,k){var R=E[k];if(typeof R.bind=="function")return R.bind(E);try{return Function.prototype.bind.call(R,E)}catch{return function(){return Function.prototype.apply.apply(R,[E,arguments])}}}function h(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function m(E){return E==="debug"&&(E="log"),typeof console===i?!1:E==="trace"&&s?h:console[E]!==void 0?u(console,E):console.log!==void 0?u(console,"log"):e}function g(){for(var E=this.getLevel(),k=0;k<o.length;k++){var R=o[k];this[R]=k<E?e:this.methodFactory(R,E,this.name)}if(this.log=this.debug,typeof console===i&&E<this.levels.SILENT)return"No console available for logging"}function y(E){return function(){typeof console!==i&&(g.call(this),this[E].apply(this,arguments))}}function S(E,k,R){return m(E)||y.apply(this,arguments)}function T(E,k){var R=this,O,L,D,I="loglevel";typeof E=="string"?I+=":"+E:typeof E=="symbol"&&(I=void 0);function P(re){var ue=(o[re]||"silent").toUpperCase();if(!(typeof window===i||!I)){try{window.localStorage[I]=ue;return}catch{}try{window.document.cookie=encodeURIComponent(I)+"="+ue+";"}catch{}}}function H(){var re;if(!(typeof window===i||!I)){try{re=window.localStorage[I]}catch{}if(typeof re===i)try{var ue=window.document.cookie,Ae=encodeURIComponent(I),Xe=ue.indexOf(Ae+"=");Xe!==-1&&(re=/^([^;]+)/.exec(ue.slice(Xe+Ae.length+1))[1])}catch{}return R.levels[re]===void 0&&(re=void 0),re}}function Z(){if(!(typeof window===i||!I)){try{window.localStorage.removeItem(I)}catch{}try{window.document.cookie=encodeURIComponent(I)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function ee(re){var ue=re;if(typeof ue=="string"&&R.levels[ue.toUpperCase()]!==void 0&&(ue=R.levels[ue.toUpperCase()]),typeof ue=="number"&&ue>=0&&ue<=R.levels.SILENT)return ue;throw new TypeError("log.setLevel() called with invalid level: "+re)}R.name=E,R.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},R.methodFactory=k||S,R.getLevel=function(){return D??L??O},R.setLevel=function(re,ue){return D=ee(re),ue!==!1&&P(D),g.call(R)},R.setDefaultLevel=function(re){L=ee(re),H()||R.setLevel(re,!1)},R.resetLevel=function(){D=null,Z(),g.call(R)},R.enableAll=function(re){R.setLevel(R.levels.TRACE,re)},R.disableAll=function(re){R.setLevel(R.levels.SILENT,re)},R.rebuild=function(){if(d!==R&&(O=ee(d.getLevel())),g.call(R),d===R)for(var re in l)l[re].rebuild()},O=ee(d?d.getLevel():"WARN");var te=H();te!=null&&(D=ee(te)),g.call(R)}d=new T,d.getLogger=function(k){if(typeof k!="symbol"&&typeof k!="string"||k==="")throw new TypeError("You must supply a name when creating a logger.");var R=l[k];return R||(R=l[k]=new T(k,d.methodFactory)),R};var x=typeof window!==i?window.log:void 0;return d.noConflict=function(){return typeof window!==i&&window.log===d&&(window.log=x),d},d.getLoggers=function(){return l},d.default=d,d})})(Il)),Il.exports}var vc=oR(),Th;(function(a){a[a.trace=0]="trace",a[a.debug=1]="debug",a[a.info=2]="info",a[a.warn=3]="warn",a[a.error=4]="error",a[a.silent=5]="silent"})(Th||(Th={}));var bn;(function(a){a.Default="livekit",a.Room="livekit-room",a.TokenSource="livekit-token-source",a.Participant="livekit-participant",a.Track="livekit-track",a.Publication="livekit-track-publication",a.Engine="livekit-engine",a.Signal="livekit-signal",a.PCManager="livekit-pc-manager",a.PCTransport="livekit-pc-transport",a.E2EE="lk-e2ee",a.DataTracks="livekit-data-tracks"})(bn||(bn={}));let Se=vc.getLogger("livekit");Object.values(bn).map(a=>vc.getLogger(a));Se.setDefaultLevel(Th.info);function Bn(a){const e=vc.getLogger(a);return e.setDefaultLevel(Se.getLevel()),e}const lR=vc.getLogger("lk-e2ee"),Or=7e3,cR=[0,300,4*300,9*300,16*300,Or,Or,Or,Or,Or];class uR{constructor(e){this._retryDelays=e!==void 0?[...e]:cR}nextRetryDelayInMs(e){if(e.retryCount>=this._retryDelays.length)return null;const i=this._retryDelays[e.retryCount];return e.retryCount<=1?i:i+Math.random()*1e3}}function dR(a,e){var i={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&e.indexOf(s)<0&&(i[s]=a[s]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(a);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(a,s[o])&&(i[s[o]]=a[s[o]]);return i}function _(a,e,i,s){function o(l){return l instanceof i?l:new i(function(d){d(l)})}return new(i||(i=Promise))(function(l,d){function u(g){try{m(s.next(g))}catch(y){d(y)}}function h(g){try{m(s.throw(g))}catch(y){d(y)}}function m(g){g.done?l(g.value):o(g.value).then(u,h)}m((s=s.apply(a,e||[])).next())})}function Ky(a){var e=typeof Symbol=="function"&&Symbol.iterator,i=e&&a[e],s=0;if(i)return i.call(a);if(a&&typeof a.length=="number")return{next:function(){return a&&s>=a.length&&(a=void 0),{value:a&&a[s++],done:!a}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function mi(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=a[Symbol.asyncIterator],i;return e?e.call(a):(a=typeof Ky=="function"?Ky(a):a[Symbol.iterator](),i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i);function s(l){i[l]=a[l]&&function(d){return new Promise(function(u,h){d=a[l](d),o(u,h,d.done,d.value)})}}function o(l,d,u,h){Promise.resolve(h).then(function(m){l({value:m,done:u})},d)}}var _l={exports:{}},Yy;function hR(){if(Yy)return _l.exports;Yy=1;var a=typeof Reflect=="object"?Reflect:null,e=a&&typeof a.apply=="function"?a.apply:function(I,P,H){return Function.prototype.apply.call(I,P,H)},i;a&&typeof a.ownKeys=="function"?i=a.ownKeys:Object.getOwnPropertySymbols?i=function(I){return Object.getOwnPropertyNames(I).concat(Object.getOwnPropertySymbols(I))}:i=function(I){return Object.getOwnPropertyNames(I)};function s(D){console&&console.warn&&console.warn(D)}var o=Number.isNaN||function(I){return I!==I};function l(){l.init.call(this)}_l.exports=l,_l.exports.once=R,l.EventEmitter=l,l.prototype._events=void 0,l.prototype._eventsCount=0,l.prototype._maxListeners=void 0;var d=10;function u(D){if(typeof D!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof D)}Object.defineProperty(l,"defaultMaxListeners",{enumerable:!0,get:function(){return d},set:function(D){if(typeof D!="number"||D<0||o(D))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+D+".");d=D}}),l.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},l.prototype.setMaxListeners=function(I){if(typeof I!="number"||I<0||o(I))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+I+".");return this._maxListeners=I,this};function h(D){return D._maxListeners===void 0?l.defaultMaxListeners:D._maxListeners}l.prototype.getMaxListeners=function(){return h(this)},l.prototype.emit=function(I){for(var P=[],H=1;H<arguments.length;H++)P.push(arguments[H]);var Z=I==="error",ee=this._events;if(ee!==void 0)Z=Z&&ee.error===void 0;else if(!Z)return!1;if(Z){var te;if(P.length>0&&(te=P[0]),te instanceof Error)throw te;var re=new Error("Unhandled error."+(te?" ("+te.message+")":""));throw re.context=te,re}var ue=ee[I];if(ue===void 0)return!1;if(typeof ue=="function")e(ue,this,P);else for(var Ae=ue.length,Xe=x(ue,Ae),H=0;H<Ae;++H)e(Xe[H],this,P);return!0};function m(D,I,P,H){var Z,ee,te;if(u(P),ee=D._events,ee===void 0?(ee=D._events=Object.create(null),D._eventsCount=0):(ee.newListener!==void 0&&(D.emit("newListener",I,P.listener?P.listener:P),ee=D._events),te=ee[I]),te===void 0)te=ee[I]=P,++D._eventsCount;else if(typeof te=="function"?te=ee[I]=H?[P,te]:[te,P]:H?te.unshift(P):te.push(P),Z=h(D),Z>0&&te.length>Z&&!te.warned){te.warned=!0;var re=new Error("Possible EventEmitter memory leak detected. "+te.length+" "+String(I)+" listeners added. Use emitter.setMaxListeners() to increase limit");re.name="MaxListenersExceededWarning",re.emitter=D,re.type=I,re.count=te.length,s(re)}return D}l.prototype.addListener=function(I,P){return m(this,I,P,!1)},l.prototype.on=l.prototype.addListener,l.prototype.prependListener=function(I,P){return m(this,I,P,!0)};function g(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function y(D,I,P){var H={fired:!1,wrapFn:void 0,target:D,type:I,listener:P},Z=g.bind(H);return Z.listener=P,H.wrapFn=Z,Z}l.prototype.once=function(I,P){return u(P),this.on(I,y(this,I,P)),this},l.prototype.prependOnceListener=function(I,P){return u(P),this.prependListener(I,y(this,I,P)),this},l.prototype.removeListener=function(I,P){var H,Z,ee,te,re;if(u(P),Z=this._events,Z===void 0)return this;if(H=Z[I],H===void 0)return this;if(H===P||H.listener===P)--this._eventsCount===0?this._events=Object.create(null):(delete Z[I],Z.removeListener&&this.emit("removeListener",I,H.listener||P));else if(typeof H!="function"){for(ee=-1,te=H.length-1;te>=0;te--)if(H[te]===P||H[te].listener===P){re=H[te].listener,ee=te;break}if(ee<0)return this;ee===0?H.shift():E(H,ee),H.length===1&&(Z[I]=H[0]),Z.removeListener!==void 0&&this.emit("removeListener",I,re||P)}return this},l.prototype.off=l.prototype.removeListener,l.prototype.removeAllListeners=function(I){var P,H,Z;if(H=this._events,H===void 0)return this;if(H.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):H[I]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete H[I]),this;if(arguments.length===0){var ee=Object.keys(H),te;for(Z=0;Z<ee.length;++Z)te=ee[Z],te!=="removeListener"&&this.removeAllListeners(te);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(P=H[I],typeof P=="function")this.removeListener(I,P);else if(P!==void 0)for(Z=P.length-1;Z>=0;Z--)this.removeListener(I,P[Z]);return this};function S(D,I,P){var H=D._events;if(H===void 0)return[];var Z=H[I];return Z===void 0?[]:typeof Z=="function"?P?[Z.listener||Z]:[Z]:P?k(Z):x(Z,Z.length)}l.prototype.listeners=function(I){return S(this,I,!0)},l.prototype.rawListeners=function(I){return S(this,I,!1)},l.listenerCount=function(D,I){return typeof D.listenerCount=="function"?D.listenerCount(I):T.call(D,I)},l.prototype.listenerCount=T;function T(D){var I=this._events;if(I!==void 0){var P=I[D];if(typeof P=="function")return 1;if(P!==void 0)return P.length}return 0}l.prototype.eventNames=function(){return this._eventsCount>0?i(this._events):[]};function x(D,I){for(var P=new Array(I),H=0;H<I;++H)P[H]=D[H];return P}function E(D,I){for(;I+1<D.length;I++)D[I]=D[I+1];D.pop()}function k(D){for(var I=new Array(D.length),P=0;P<I.length;++P)I[P]=D[P].listener||D[P];return I}function R(D,I){return new Promise(function(P,H){function Z(te){D.removeListener(I,ee),H(te)}function ee(){typeof D.removeListener=="function"&&D.removeListener("error",Z),P([].slice.call(arguments))}L(D,I,ee,{once:!0}),I!=="error"&&O(D,Z,{once:!0})})}function O(D,I,P){typeof D.on=="function"&&L(D,"error",I,P)}function L(D,I,P,H){if(typeof D.on=="function")H.once?D.once(I,P):D.on(I,P);else if(typeof D.addEventListener=="function")D.addEventListener(I,function Z(ee){H.once&&D.removeEventListener(I,Z),P(ee)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof D)}return _l.exports}var Hn=hR();let vS=!0,yS=!0;function Br(a,e,i){const s=a.match(e);return s&&s.length>=i&&parseFloat(s[i],10)}function Oa(a,e,i){if(!a.RTCPeerConnection)return;const s=a.RTCPeerConnection.prototype,o=s.addEventListener;s.addEventListener=function(d,u){if(d!==e)return o.apply(this,arguments);const h=m=>{const g=i(m);g&&(u.handleEvent?u.handleEvent(g):u(g))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(u,h),o.apply(this,[d,h])};const l=s.removeEventListener;s.removeEventListener=function(d,u){if(d!==e||!this._eventMap||!this._eventMap[e])return l.apply(this,arguments);if(!this._eventMap[e].has(u))return l.apply(this,arguments);const h=this._eventMap[e].get(u);return this._eventMap[e].delete(u),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,l.apply(this,[d,h])},Object.defineProperty(s,"on"+e,{get(){return this["_on"+e]},set(d){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),d&&this.addEventListener(e,this["_on"+e]=d)},enumerable:!0,configurable:!0})}function fR(a){return typeof a!="boolean"?new Error("Argument type: "+typeof a+". Please use a boolean."):(vS=a,a?"adapter.js logging disabled":"adapter.js logging enabled")}function mR(a){return typeof a!="boolean"?new Error("Argument type: "+typeof a+". Please use a boolean."):(yS=!a,"adapter.js deprecation warnings "+(a?"disabled":"enabled"))}function bS(){if(typeof window=="object"){if(vS)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function pf(a,e){yS&&console.warn(a+" is deprecated, please use "+e+" instead.")}function pR(a){const e={browser:null,version:null};if(typeof a>"u"||!a.navigator||!a.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:i}=a;if(i.userAgentData&&i.userAgentData.brands){const s=i.userAgentData.brands.find(o=>o.brand==="Chromium");if(s)return{browser:"chrome",version:parseInt(s.version,10)}}if(i.mozGetUserMedia)e.browser="firefox",e.version=parseInt(Br(i.userAgent,/Firefox\/(\d+)\./,1));else if(i.webkitGetUserMedia||a.isSecureContext===!1&&a.webkitRTCPeerConnection)e.browser="chrome",e.version=parseInt(Br(i.userAgent,/Chrom(e|ium)\/(\d+)\./,2));else if(a.RTCPeerConnection&&i.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=parseInt(Br(i.userAgent,/AppleWebKit\/(\d+)\./,1)),e.supportsUnifiedPlan=a.RTCRtpTransceiver&&"currentDirection"in a.RTCRtpTransceiver.prototype,e._safariVersion=Br(i.userAgent,/Version\/(\d+(\.?\d+))/,1);else return e.browser="Not a supported browser.",e;return e}function Jy(a){return Object.prototype.toString.call(a)==="[object Object]"}function SS(a){return Jy(a)?Object.keys(a).reduce(function(e,i){const s=Jy(a[i]),o=s?SS(a[i]):a[i],l=s&&!Object.keys(o).length;return o===void 0||l?e:Object.assign(e,{[i]:o})},{}):a}function kh(a,e,i){!e||i.has(e.id)||(i.set(e.id,e),Object.keys(e).forEach(s=>{s.endsWith("Id")?kh(a,a.get(e[s]),i):s.endsWith("Ids")&&e[s].forEach(o=>{kh(a,a.get(o),i)})}))}function Qy(a,e,i){const s=i?"outbound-rtp":"inbound-rtp",o=new Map;if(e===null)return o;const l=[];return a.forEach(d=>{d.type==="track"&&d.trackIdentifier===e.id&&l.push(d)}),l.forEach(d=>{a.forEach(u=>{u.type===s&&u.trackId===d.id&&kh(a,u,o)})}),o}const Xy=bS;function CS(a,e){const i=a&&a.navigator;if(!i.mediaDevices)return;const s=function(u){if(typeof u!="object"||u.mandatory||u.optional)return u;const h={};return Object.keys(u).forEach(m=>{if(m==="require"||m==="advanced"||m==="mediaSource")return;const g=typeof u[m]=="object"?u[m]:{ideal:u[m]};g.exact!==void 0&&typeof g.exact=="number"&&(g.min=g.max=g.exact);const y=function(S,T){return S?S+T.charAt(0).toUpperCase()+T.slice(1):T==="deviceId"?"sourceId":T};if(g.ideal!==void 0){h.optional=h.optional||[];let S={};typeof g.ideal=="number"?(S[y("min",m)]=g.ideal,h.optional.push(S),S={},S[y("max",m)]=g.ideal,h.optional.push(S)):(S[y("",m)]=g.ideal,h.optional.push(S))}g.exact!==void 0&&typeof g.exact!="number"?(h.mandatory=h.mandatory||{},h.mandatory[y("",m)]=g.exact):["min","max"].forEach(S=>{g[S]!==void 0&&(h.mandatory=h.mandatory||{},h.mandatory[y(S,m)]=g[S])})}),u.advanced&&(h.optional=(h.optional||[]).concat(u.advanced)),h},o=function(u,h){if(e.version>=61)return h(u);if(u=JSON.parse(JSON.stringify(u)),u&&typeof u.audio=="object"){const m=function(g,y,S){y in g&&!(S in g)&&(g[S]=g[y],delete g[y])};u=JSON.parse(JSON.stringify(u)),m(u.audio,"autoGainControl","googAutoGainControl"),m(u.audio,"noiseSuppression","googNoiseSuppression"),u.audio=s(u.audio)}if(u&&typeof u.video=="object"){let m=u.video.facingMode;m=m&&(typeof m=="object"?m:{ideal:m});const g=e.version<66;if(m&&(m.exact==="user"||m.exact==="environment"||m.ideal==="user"||m.ideal==="environment")&&!(i.mediaDevices.getSupportedConstraints&&i.mediaDevices.getSupportedConstraints().facingMode&&!g)){delete u.video.facingMode;let y;if(m.exact==="environment"||m.ideal==="environment"?y=["back","rear"]:(m.exact==="user"||m.ideal==="user")&&(y=["front"]),y)return i.mediaDevices.enumerateDevices().then(S=>{S=S.filter(x=>x.kind==="videoinput");let T=S.find(x=>y.some(E=>x.label.toLowerCase().includes(E)));return!T&&S.length&&y.includes("back")&&(T=S[S.length-1]),T&&(u.video.deviceId=m.exact?{exact:T.deviceId}:{ideal:T.deviceId}),u.video=s(u.video),Xy("chrome: "+JSON.stringify(u)),h(u)})}u.video=s(u.video)}return Xy("chrome: "+JSON.stringify(u)),h(u)},l=function(u){return e.version>=64?u:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[u.name]||u.name,message:u.message,constraint:u.constraint||u.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},d=function(u,h,m){o(u,g=>{i.webkitGetUserMedia(g,h,y=>{m&&m(l(y))})})};if(i.getUserMedia=d.bind(i),i.mediaDevices.getUserMedia){const u=i.mediaDevices.getUserMedia.bind(i.mediaDevices);i.mediaDevices.getUserMedia=function(h){return o(h,m=>u(m).then(g=>{if(m.audio&&!g.getAudioTracks().length||m.video&&!g.getVideoTracks().length)throw g.getTracks().forEach(y=>{y.stop()}),new DOMException("","NotFoundError");return g},g=>Promise.reject(l(g))))}}}function TS(a){a.MediaStream=a.MediaStream||a.webkitMediaStream}function kS(a){if(typeof a=="object"&&a.RTCPeerConnection&&!("ontrack"in a.RTCPeerConnection.prototype)){Object.defineProperty(a.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(i){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=i)},enumerable:!0,configurable:!0});const e=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=s=>{s.stream.addEventListener("addtrack",o=>{let l;a.RTCPeerConnection.prototype.getReceivers?l=this.getReceivers().find(u=>u.track&&u.track.id===o.track.id):l={track:o.track};const d=new Event("track");d.track=o.track,d.receiver=l,d.transceiver={receiver:l},d.streams=[s.stream],this.dispatchEvent(d)}),s.stream.getTracks().forEach(o=>{let l;a.RTCPeerConnection.prototype.getReceivers?l=this.getReceivers().find(u=>u.track&&u.track.id===o.id):l={track:o};const d=new Event("track");d.track=o,d.receiver=l,d.transceiver={receiver:l},d.streams=[s.stream],this.dispatchEvent(d)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else Oa(a,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function ES(a){if(typeof a=="object"&&a.RTCPeerConnection&&!("getSenders"in a.RTCPeerConnection.prototype)&&"createDTMFSender"in a.RTCPeerConnection.prototype){const e=function(o,l){return{track:l,get dtmf(){return this._dtmf===void 0&&(l.kind==="audio"?this._dtmf=o.createDTMFSender(l):this._dtmf=null),this._dtmf},_pc:o}};if(!a.RTCPeerConnection.prototype.getSenders){a.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const o=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=function(u,h){let m=o.apply(this,arguments);return m||(m=e(this,u),this._senders.push(m)),m};const l=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(u){l.apply(this,arguments);const h=this._senders.indexOf(u);h!==-1&&this._senders.splice(h,1)}}const i=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(l){this._senders=this._senders||[],i.apply(this,[l]),l.getTracks().forEach(d=>{this._senders.push(e(this,d))})};const s=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(l){this._senders=this._senders||[],s.apply(this,[l]),l.getTracks().forEach(d=>{const u=this._senders.find(h=>h.track===d);u&&this._senders.splice(this._senders.indexOf(u),1)})}}else if(typeof a=="object"&&a.RTCPeerConnection&&"getSenders"in a.RTCPeerConnection.prototype&&"createDTMFSender"in a.RTCPeerConnection.prototype&&a.RTCRtpSender&&!("dtmf"in a.RTCRtpSender.prototype)){const e=a.RTCPeerConnection.prototype.getSenders;a.RTCPeerConnection.prototype.getSenders=function(){const s=e.apply(this,[]);return s.forEach(o=>o._pc=this),s},Object.defineProperty(a.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function _S(a){if(!(typeof a=="object"&&a.RTCPeerConnection&&a.RTCRtpSender&&a.RTCRtpReceiver))return;if(!("getStats"in a.RTCRtpSender.prototype)){const i=a.RTCPeerConnection.prototype.getSenders;i&&(a.RTCPeerConnection.prototype.getSenders=function(){const l=i.apply(this,[]);return l.forEach(d=>d._pc=this),l});const s=a.RTCPeerConnection.prototype.addTrack;s&&(a.RTCPeerConnection.prototype.addTrack=function(){const l=s.apply(this,arguments);return l._pc=this,l}),a.RTCRtpSender.prototype.getStats=function(){const l=this;return this._pc.getStats().then(d=>Qy(d,l.track,!0))}}if(!("getStats"in a.RTCRtpReceiver.prototype)){const i=a.RTCPeerConnection.prototype.getReceivers;i&&(a.RTCPeerConnection.prototype.getReceivers=function(){const o=i.apply(this,[]);return o.forEach(l=>l._pc=this),o}),Oa(a,"track",s=>(s.receiver._pc=s.srcElement,s)),a.RTCRtpReceiver.prototype.getStats=function(){const o=this;return this._pc.getStats().then(l=>Qy(l,o.track,!1))}}if(!("getStats"in a.RTCRtpSender.prototype&&"getStats"in a.RTCRtpReceiver.prototype))return;const e=a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof a.MediaStreamTrack){const s=arguments[0];let o,l,d;return this.getSenders().forEach(u=>{u.track===s&&(o?d=!0:o=u)}),this.getReceivers().forEach(u=>(u.track===s&&(l?d=!0:l=u),u.track===s)),d||o&&l?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):o?o.getStats():l?l.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function wS(a){a.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(d=>this._shimmedLocalStreams[d][0])};const e=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=function(d,u){if(!u)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const h=e.apply(this,arguments);return this._shimmedLocalStreams[u.id]?this._shimmedLocalStreams[u.id].indexOf(h)===-1&&this._shimmedLocalStreams[u.id].push(h):this._shimmedLocalStreams[u.id]=[u,h],h};const i=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(d){this._shimmedLocalStreams=this._shimmedLocalStreams||{},d.getTracks().forEach(m=>{if(this.getSenders().find(y=>y.track===m))throw new DOMException("Track already exists.","InvalidAccessError")});const u=this.getSenders();i.apply(this,arguments);const h=this.getSenders().filter(m=>u.indexOf(m)===-1);this._shimmedLocalStreams[d.id]=[d].concat(h)};const s=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(d){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[d.id],s.apply(this,arguments)};const o=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(d){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},d&&Object.keys(this._shimmedLocalStreams).forEach(u=>{const h=this._shimmedLocalStreams[u].indexOf(d);h!==-1&&this._shimmedLocalStreams[u].splice(h,1),this._shimmedLocalStreams[u].length===1&&delete this._shimmedLocalStreams[u]}),o.apply(this,arguments)}}function xS(a,e){if(!a.RTCPeerConnection)return;if(a.RTCPeerConnection.prototype.addTrack&&e.version>=65)return wS(a);const i=a.RTCPeerConnection.prototype.getLocalStreams;a.RTCPeerConnection.prototype.getLocalStreams=function(){const g=i.apply(this);return this._reverseStreams=this._reverseStreams||{},g.map(y=>this._reverseStreams[y.id])};const s=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(g){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},g.getTracks().forEach(y=>{if(this.getSenders().find(T=>T.track===y))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[g.id]){const y=new a.MediaStream(g.getTracks());this._streams[g.id]=y,this._reverseStreams[y.id]=g,g=y}s.apply(this,[g])};const o=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(g){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},o.apply(this,[this._streams[g.id]||g]),delete this._reverseStreams[this._streams[g.id]?this._streams[g.id].id:g.id],delete this._streams[g.id]},a.RTCPeerConnection.prototype.addTrack=function(g,y){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const S=[].slice.call(arguments,1);if(S.length!==1||!S[0].getTracks().find(E=>E===g))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(E=>E.track===g))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const x=this._streams[y.id];if(x)x.addTrack(g),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const E=new a.MediaStream([g]);this._streams[y.id]=E,this._reverseStreams[E.id]=y,this.addStream(E)}return this.getSenders().find(E=>E.track===g)};function l(m,g){let y=g.sdp;return Object.keys(m._reverseStreams||[]).forEach(S=>{const T=m._reverseStreams[S],x=m._streams[T.id];y=y.replace(new RegExp(x.id,"g"),T.id)}),new RTCSessionDescription({type:g.type,sdp:y})}function d(m,g){let y=g.sdp;return Object.keys(m._reverseStreams||[]).forEach(S=>{const T=m._reverseStreams[S],x=m._streams[T.id];y=y.replace(new RegExp(T.id,"g"),x.id)}),new RTCSessionDescription({type:g.type,sdp:y})}["createOffer","createAnswer"].forEach(function(m){const g=a.RTCPeerConnection.prototype[m],y={[m](){const S=arguments;return arguments.length&&typeof arguments[0]=="function"?g.apply(this,[x=>{const E=l(this,x);S[0].apply(null,[E])},x=>{S[1]&&S[1].apply(null,x)},arguments[2]]):g.apply(this,arguments).then(x=>l(this,x))}};a.RTCPeerConnection.prototype[m]=y[m]});const u=a.RTCPeerConnection.prototype.setLocalDescription;a.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?u.apply(this,arguments):(arguments[0]=d(this,arguments[0]),u.apply(this,arguments))};const h=Object.getOwnPropertyDescriptor(a.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(a.RTCPeerConnection.prototype,"localDescription",{get(){const m=h.get.apply(this);return m.type===""?m:l(this,m)}}),a.RTCPeerConnection.prototype.removeTrack=function(g){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!g._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(g._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let S;Object.keys(this._streams).forEach(T=>{this._streams[T].getTracks().find(E=>g.track===E)&&(S=this._streams[T])}),S&&(S.getTracks().length===1?this.removeStream(this._reverseStreams[S.id]):S.removeTrack(g.track),this.dispatchEvent(new Event("negotiationneeded")))}}function Eh(a,e){!a.RTCPeerConnection&&a.webkitRTCPeerConnection&&(a.RTCPeerConnection=a.webkitRTCPeerConnection),a.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(i){const s=a.RTCPeerConnection.prototype[i],o={[i](){return arguments[0]=new(i==="addIceCandidate"?a.RTCIceCandidate:a.RTCSessionDescription)(arguments[0]),s.apply(this,arguments)}};a.RTCPeerConnection.prototype[i]=o[i]})}function RS(a,e){Oa(a,"negotiationneeded",i=>{const s=i.target;if(!((e.version<72||s.getConfiguration&&s.getConfiguration().sdpSemantics==="plan-b")&&s.signalingState!=="stable"))return i})}var Wy=Object.freeze({__proto__:null,fixNegotiationNeeded:RS,shimAddTrackRemoveTrack:xS,shimAddTrackRemoveTrackWithNative:wS,shimGetSendersWithDtmf:ES,shimGetUserMedia:CS,shimMediaStream:TS,shimOnTrack:kS,shimPeerConnection:Eh,shimSenderReceiverGetStats:_S});function MS(a,e){const i=a&&a.navigator,s=a&&a.MediaStreamTrack;if(i.getUserMedia=function(o,l,d){pf("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),i.mediaDevices.getUserMedia(o).then(l,d)},!(e.version>55&&"autoGainControl"in i.mediaDevices.getSupportedConstraints())){const o=function(d,u,h){u in d&&!(h in d)&&(d[h]=d[u],delete d[u])},l=i.mediaDevices.getUserMedia.bind(i.mediaDevices);if(i.mediaDevices.getUserMedia=function(d){return typeof d=="object"&&typeof d.audio=="object"&&(d=JSON.parse(JSON.stringify(d)),o(d.audio,"autoGainControl","mozAutoGainControl"),o(d.audio,"noiseSuppression","mozNoiseSuppression")),l(d)},s&&s.prototype.getSettings){const d=s.prototype.getSettings;s.prototype.getSettings=function(){const u=d.apply(this,arguments);return o(u,"mozAutoGainControl","autoGainControl"),o(u,"mozNoiseSuppression","noiseSuppression"),u}}if(s&&s.prototype.applyConstraints){const d=s.prototype.applyConstraints;s.prototype.applyConstraints=function(u){return this.kind==="audio"&&typeof u=="object"&&(u=JSON.parse(JSON.stringify(u)),o(u,"autoGainControl","mozAutoGainControl"),o(u,"noiseSuppression","mozNoiseSuppression")),d.apply(this,[u])}}}}function gR(a,e){a.navigator.mediaDevices&&"getDisplayMedia"in a.navigator.mediaDevices||a.navigator.mediaDevices&&(a.navigator.mediaDevices.getDisplayMedia=function(s){if(!(s&&s.video)){const o=new DOMException("getDisplayMedia without video constraints is undefined");return o.name="NotFoundError",o.code=8,Promise.reject(o)}return s.video===!0?s.video={mediaSource:e}:s.video.mediaSource=e,a.navigator.mediaDevices.getUserMedia(s)})}function AS(a){typeof a=="object"&&a.RTCTrackEvent&&"receiver"in a.RTCTrackEvent.prototype&&!("transceiver"in a.RTCTrackEvent.prototype)&&Object.defineProperty(a.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function _h(a,e){if(typeof a!="object"||!(a.RTCPeerConnection||a.mozRTCPeerConnection))return;!a.RTCPeerConnection&&a.mozRTCPeerConnection&&(a.RTCPeerConnection=a.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(o){const l=a.RTCPeerConnection.prototype[o],d={[o](){return arguments[0]=new(o==="addIceCandidate"?a.RTCIceCandidate:a.RTCSessionDescription)(arguments[0]),l.apply(this,arguments)}};a.RTCPeerConnection.prototype[o]=d[o]});const i={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},s=a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(){const[l,d,u]=arguments;return s.apply(this,[l||null]).then(h=>{if(e.version<53&&!d)try{h.forEach(m=>{m.type=i[m.type]||m.type})}catch(m){if(m.name!=="TypeError")throw m;h.forEach((g,y)=>{h.set(y,Object.assign({},g,{type:i[g.type]||g.type}))})}return h}).then(d,u)}}function NS(a){if(!(typeof a=="object"&&a.RTCPeerConnection&&a.RTCRtpSender)||a.RTCRtpSender&&"getStats"in a.RTCRtpSender.prototype)return;const e=a.RTCPeerConnection.prototype.getSenders;e&&(a.RTCPeerConnection.prototype.getSenders=function(){const o=e.apply(this,[]);return o.forEach(l=>l._pc=this),o});const i=a.RTCPeerConnection.prototype.addTrack;i&&(a.RTCPeerConnection.prototype.addTrack=function(){const o=i.apply(this,arguments);return o._pc=this,o}),a.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function DS(a){if(!(typeof a=="object"&&a.RTCPeerConnection&&a.RTCRtpSender)||a.RTCRtpSender&&"getStats"in a.RTCRtpReceiver.prototype)return;const e=a.RTCPeerConnection.prototype.getReceivers;e&&(a.RTCPeerConnection.prototype.getReceivers=function(){const s=e.apply(this,[]);return s.forEach(o=>o._pc=this),s}),Oa(a,"track",i=>(i.receiver._pc=i.srcElement,i)),a.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function OS(a){!a.RTCPeerConnection||"removeStream"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.removeStream=function(i){pf("removeStream","removeTrack"),this.getSenders().forEach(s=>{s.track&&i.getTracks().includes(s.track)&&this.removeTrack(s)})})}function PS(a){a.DataChannel&&!a.RTCDataChannel&&(a.RTCDataChannel=a.DataChannel)}function jS(a){if(!(typeof a=="object"&&a.RTCPeerConnection))return;const e=a.RTCPeerConnection.prototype.addTransceiver;e&&(a.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let s=arguments[1]&&arguments[1].sendEncodings;s===void 0&&(s=[]),s=[...s];const o=s.length>0;o&&s.forEach(d=>{if("rid"in d&&!/^[a-z0-9]{0,16}$/i.test(d.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in d&&!(parseFloat(d.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in d&&!(parseFloat(d.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const l=e.apply(this,arguments);if(o){const{sender:d}=l,u=d.getParameters();(!("encodings"in u)||u.encodings.length===1&&Object.keys(u.encodings[0]).length===0)&&(u.encodings=s,d.sendEncodings=s,this.setParametersPromises.push(d.setParameters(u).then(()=>{delete d.sendEncodings}).catch(()=>{delete d.sendEncodings})))}return l})}function IS(a){if(!(typeof a=="object"&&a.RTCRtpSender))return;const e=a.RTCRtpSender.prototype.getParameters;e&&(a.RTCRtpSender.prototype.getParameters=function(){const s=e.apply(this,arguments);return"encodings"in s||(s.encodings=[].concat(this.sendEncodings||[{}])),s})}function LS(a){if(!(typeof a=="object"&&a.RTCPeerConnection))return;const e=a.RTCPeerConnection.prototype.createOffer;a.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function US(a){if(!(typeof a=="object"&&a.RTCPeerConnection))return;const e=a.RTCPeerConnection.prototype.createAnswer;a.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}var Zy=Object.freeze({__proto__:null,shimAddTransceiver:jS,shimCreateAnswer:US,shimCreateOffer:LS,shimGetDisplayMedia:gR,shimGetParameters:IS,shimGetUserMedia:MS,shimOnTrack:AS,shimPeerConnection:_h,shimRTCDataChannel:PS,shimReceiverGetStats:DS,shimRemoveStream:OS,shimSenderGetStats:NS});function BS(a){if(!(typeof a!="object"||!a.RTCPeerConnection)){if("getLocalStreams"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in a.RTCPeerConnection.prototype)){const e=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addStream=function(s){this._localStreams||(this._localStreams=[]),this._localStreams.includes(s)||this._localStreams.push(s),s.getAudioTracks().forEach(o=>e.call(this,o,s)),s.getVideoTracks().forEach(o=>e.call(this,o,s))},a.RTCPeerConnection.prototype.addTrack=function(s){for(var o=arguments.length,l=new Array(o>1?o-1:0),d=1;d<o;d++)l[d-1]=arguments[d];return l&&l.forEach(u=>{this._localStreams?this._localStreams.includes(u)||this._localStreams.push(u):this._localStreams=[u]}),e.apply(this,arguments)}}"removeStream"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.removeStream=function(i){this._localStreams||(this._localStreams=[]);const s=this._localStreams.indexOf(i);if(s===-1)return;this._localStreams.splice(s,1);const o=i.getTracks();this.getSenders().forEach(l=>{o.includes(l.track)&&this.removeTrack(l)})})}}function qS(a){if(!(typeof a!="object"||!a.RTCPeerConnection)&&("getRemoteStreams"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in a.RTCPeerConnection.prototype))){Object.defineProperty(a.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(i){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=i),this.addEventListener("track",this._onaddstreampoly=s=>{s.streams.forEach(o=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(o))return;this._remoteStreams.push(o);const l=new Event("addstream");l.stream=o,this.dispatchEvent(l)})})}});const e=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){const s=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(o){o.streams.forEach(l=>{if(s._remoteStreams||(s._remoteStreams=[]),s._remoteStreams.indexOf(l)>=0)return;s._remoteStreams.push(l);const d=new Event("addstream");d.stream=l,s.dispatchEvent(d)})}),e.apply(s,arguments)}}}function zS(a){if(typeof a!="object"||!a.RTCPeerConnection)return;const e=a.RTCPeerConnection.prototype,i=e.createOffer,s=e.createAnswer,o=e.setLocalDescription,l=e.setRemoteDescription,d=e.addIceCandidate;e.createOffer=function(m,g){const y=arguments.length>=2?arguments[2]:arguments[0],S=i.apply(this,[y]);return g?(S.then(m,g),Promise.resolve()):S},e.createAnswer=function(m,g){const y=arguments.length>=2?arguments[2]:arguments[0],S=s.apply(this,[y]);return g?(S.then(m,g),Promise.resolve()):S};let u=function(h,m,g){const y=o.apply(this,[h]);return g?(y.then(m,g),Promise.resolve()):y};e.setLocalDescription=u,u=function(h,m,g){const y=l.apply(this,[h]);return g?(y.then(m,g),Promise.resolve()):y},e.setRemoteDescription=u,u=function(h,m,g){const y=d.apply(this,[h]);return g?(y.then(m,g),Promise.resolve()):y},e.addIceCandidate=u}function FS(a){const e=a&&a.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const i=e.mediaDevices,s=i.getUserMedia.bind(i);e.mediaDevices.getUserMedia=o=>s(HS(o))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(s,o,l){e.mediaDevices.getUserMedia(s).then(o,l)}).bind(e))}function HS(a){return a&&a.video!==void 0?Object.assign({},a,{video:SS(a.video)}):a}function VS(a){if(!a.RTCPeerConnection)return;const e=a.RTCPeerConnection;a.RTCPeerConnection=function(s,o){if(s&&s.iceServers){const l=[];for(let d=0;d<s.iceServers.length;d++){let u=s.iceServers[d];u.urls===void 0&&u.url?(pf("RTCIceServer.url","RTCIceServer.urls"),u=JSON.parse(JSON.stringify(u)),u.urls=u.url,delete u.url,l.push(u)):l.push(s.iceServers[d])}s.iceServers=l}return new e(s,o)},a.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(a.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function GS(a){typeof a=="object"&&a.RTCTrackEvent&&"receiver"in a.RTCTrackEvent.prototype&&!("transceiver"in a.RTCTrackEvent.prototype)&&Object.defineProperty(a.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function KS(a){const e=a.RTCPeerConnection.prototype.createOffer;a.RTCPeerConnection.prototype.createOffer=function(s){if(s){typeof s.offerToReceiveAudio<"u"&&(s.offerToReceiveAudio=!!s.offerToReceiveAudio);const o=this.getTransceivers().find(d=>d.receiver.track.kind==="audio");s.offerToReceiveAudio===!1&&o?o.direction==="sendrecv"?o.setDirection?o.setDirection("sendonly"):o.direction="sendonly":o.direction==="recvonly"&&(o.setDirection?o.setDirection("inactive"):o.direction="inactive"):s.offerToReceiveAudio===!0&&!o&&this.addTransceiver("audio",{direction:"recvonly"}),typeof s.offerToReceiveVideo<"u"&&(s.offerToReceiveVideo=!!s.offerToReceiveVideo);const l=this.getTransceivers().find(d=>d.receiver.track.kind==="video");s.offerToReceiveVideo===!1&&l?l.direction==="sendrecv"?l.setDirection?l.setDirection("sendonly"):l.direction="sendonly":l.direction==="recvonly"&&(l.setDirection?l.setDirection("inactive"):l.direction="inactive"):s.offerToReceiveVideo===!0&&!l&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function YS(a){typeof a!="object"||a.AudioContext||(a.AudioContext=a.webkitAudioContext)}var $y=Object.freeze({__proto__:null,shimAudioContext:YS,shimCallbacksAPI:zS,shimConstraints:HS,shimCreateOfferLegacy:KS,shimGetUserMedia:FS,shimLocalStreamsAPI:BS,shimRTCIceServerUrls:VS,shimRemoteStreamsAPI:qS,shimTrackEventTransceiver:GS}),Zd={exports:{}},e0;function vR(){return e0||(e0=1,(function(a){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(i){return i.trim().split(`
`).map(s=>s.trim())},e.splitSections=function(i){return i.split(`
m=`).map((o,l)=>(l>0?"m="+o:o).trim()+`\r
`)},e.getDescription=function(i){const s=e.splitSections(i);return s&&s[0]},e.getMediaSections=function(i){const s=e.splitSections(i);return s.shift(),s},e.matchPrefix=function(i,s){return e.splitLines(i).filter(o=>o.indexOf(s)===0)},e.parseCandidate=function(i){let s;i.indexOf("a=candidate:")===0?s=i.substring(12).split(" "):s=i.substring(10).split(" ");const o={foundation:s[0],component:{1:"rtp",2:"rtcp"}[s[1]]||s[1],protocol:s[2].toLowerCase(),priority:parseInt(s[3],10),ip:s[4],address:s[4],port:parseInt(s[5],10),type:s[7]};for(let l=8;l<s.length;l+=2)switch(s[l]){case"raddr":o.relatedAddress=s[l+1];break;case"rport":o.relatedPort=parseInt(s[l+1],10);break;case"tcptype":o.tcpType=s[l+1];break;case"ufrag":o.ufrag=s[l+1],o.usernameFragment=s[l+1];break;default:o[s[l]]===void 0&&(o[s[l]]=s[l+1]);break}return o},e.writeCandidate=function(i){const s=[];s.push(i.foundation);const o=i.component;o==="rtp"?s.push(1):o==="rtcp"?s.push(2):s.push(o),s.push(i.protocol.toUpperCase()),s.push(i.priority),s.push(i.address||i.ip),s.push(i.port);const l=i.type;return s.push("typ"),s.push(l),l!=="host"&&i.relatedAddress&&i.relatedPort&&(s.push("raddr"),s.push(i.relatedAddress),s.push("rport"),s.push(i.relatedPort)),i.tcpType&&i.protocol.toLowerCase()==="tcp"&&(s.push("tcptype"),s.push(i.tcpType)),(i.usernameFragment||i.ufrag)&&(s.push("ufrag"),s.push(i.usernameFragment||i.ufrag)),"candidate:"+s.join(" ")},e.parseIceOptions=function(i){return i.substring(14).split(" ")},e.parseRtpMap=function(i){let s=i.substring(9).split(" ");const o={payloadType:parseInt(s.shift(),10)};return s=s[0].split("/"),o.name=s[0],o.clockRate=parseInt(s[1],10),o.channels=s.length===3?parseInt(s[2],10):1,o.numChannels=o.channels,o},e.writeRtpMap=function(i){let s=i.payloadType;i.preferredPayloadType!==void 0&&(s=i.preferredPayloadType);const o=i.channels||i.numChannels||1;return"a=rtpmap:"+s+" "+i.name+"/"+i.clockRate+(o!==1?"/"+o:"")+`\r
`},e.parseExtmap=function(i){const s=i.substring(9).split(" ");return{id:parseInt(s[0],10),direction:s[0].indexOf("/")>0?s[0].split("/")[1]:"sendrecv",uri:s[1],attributes:s.slice(2).join(" ")}},e.writeExtmap=function(i){return"a=extmap:"+(i.id||i.preferredId)+(i.direction&&i.direction!=="sendrecv"?"/"+i.direction:"")+" "+i.uri+(i.attributes?" "+i.attributes:"")+`\r
`},e.parseFmtp=function(i){const s={};let o;const l=i.substring(i.indexOf(" ")+1).split(";");for(let d=0;d<l.length;d++)o=l[d].trim().split("="),s[o[0].trim()]=o[1];return s},e.writeFmtp=function(i){let s="",o=i.payloadType;if(i.preferredPayloadType!==void 0&&(o=i.preferredPayloadType),i.parameters&&Object.keys(i.parameters).length){const l=[];Object.keys(i.parameters).forEach(d=>{i.parameters[d]!==void 0?l.push(d+"="+i.parameters[d]):l.push(d)}),s+="a=fmtp:"+o+" "+l.join(";")+`\r
`}return s},e.parseRtcpFb=function(i){const s=i.substring(i.indexOf(" ")+1).split(" ");return{type:s.shift(),parameter:s.join(" ")}},e.writeRtcpFb=function(i){let s="",o=i.payloadType;return i.preferredPayloadType!==void 0&&(o=i.preferredPayloadType),i.rtcpFeedback&&i.rtcpFeedback.length&&i.rtcpFeedback.forEach(l=>{s+="a=rtcp-fb:"+o+" "+l.type+(l.parameter&&l.parameter.length?" "+l.parameter:"")+`\r
`}),s},e.parseSsrcMedia=function(i){const s=i.indexOf(" "),o={ssrc:parseInt(i.substring(7,s),10)},l=i.indexOf(":",s);return l>-1?(o.attribute=i.substring(s+1,l),o.value=i.substring(l+1)):o.attribute=i.substring(s+1),o},e.parseSsrcGroup=function(i){const s=i.substring(13).split(" ");return{semantics:s.shift(),ssrcs:s.map(o=>parseInt(o,10))}},e.getMid=function(i){const s=e.matchPrefix(i,"a=mid:")[0];if(s)return s.substring(6)},e.parseFingerprint=function(i){const s=i.substring(14).split(" ");return{algorithm:s[0].toLowerCase(),value:s[1].toUpperCase()}},e.getDtlsParameters=function(i,s){return{role:"auto",fingerprints:e.matchPrefix(i+s,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(i,s){let o="a=setup:"+s+`\r
`;return i.fingerprints.forEach(l=>{o+="a=fingerprint:"+l.algorithm+" "+l.value+`\r
`}),o},e.parseCryptoLine=function(i){const s=i.substring(9).split(" ");return{tag:parseInt(s[0],10),cryptoSuite:s[1],keyParams:s[2],sessionParams:s.slice(3)}},e.writeCryptoLine=function(i){return"a=crypto:"+i.tag+" "+i.cryptoSuite+" "+(typeof i.keyParams=="object"?e.writeCryptoKeyParams(i.keyParams):i.keyParams)+(i.sessionParams?" "+i.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(i){if(i.indexOf("inline:")!==0)return null;const s=i.substring(7).split("|");return{keyMethod:"inline",keySalt:s[0],lifeTime:s[1],mkiValue:s[2]?s[2].split(":")[0]:void 0,mkiLength:s[2]?s[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(i){return i.keyMethod+":"+i.keySalt+(i.lifeTime?"|"+i.lifeTime:"")+(i.mkiValue&&i.mkiLength?"|"+i.mkiValue+":"+i.mkiLength:"")},e.getCryptoParameters=function(i,s){return e.matchPrefix(i+s,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(i,s){const o=e.matchPrefix(i+s,"a=ice-ufrag:")[0],l=e.matchPrefix(i+s,"a=ice-pwd:")[0];return o&&l?{usernameFragment:o.substring(12),password:l.substring(10)}:null},e.writeIceParameters=function(i){let s="a=ice-ufrag:"+i.usernameFragment+`\r
a=ice-pwd:`+i.password+`\r
`;return i.iceLite&&(s+=`a=ice-lite\r
`),s},e.parseRtpParameters=function(i){const s={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},l=e.splitLines(i)[0].split(" ");s.profile=l[2];for(let u=3;u<l.length;u++){const h=l[u],m=e.matchPrefix(i,"a=rtpmap:"+h+" ")[0];if(m){const g=e.parseRtpMap(m),y=e.matchPrefix(i,"a=fmtp:"+h+" ");switch(g.parameters=y.length?e.parseFmtp(y[0]):{},g.rtcpFeedback=e.matchPrefix(i,"a=rtcp-fb:"+h+" ").map(e.parseRtcpFb),s.codecs.push(g),g.name.toUpperCase()){case"RED":case"ULPFEC":s.fecMechanisms.push(g.name.toUpperCase());break}}}e.matchPrefix(i,"a=extmap:").forEach(u=>{s.headerExtensions.push(e.parseExtmap(u))});const d=e.matchPrefix(i,"a=rtcp-fb:* ").map(e.parseRtcpFb);return s.codecs.forEach(u=>{d.forEach(h=>{u.rtcpFeedback.find(g=>g.type===h.type&&g.parameter===h.parameter)||u.rtcpFeedback.push(h)})}),s},e.writeRtpDescription=function(i,s){let o="";o+="m="+i+" ",o+=s.codecs.length>0?"9":"0",o+=" "+(s.profile||"UDP/TLS/RTP/SAVPF")+" ",o+=s.codecs.map(d=>d.preferredPayloadType!==void 0?d.preferredPayloadType:d.payloadType).join(" ")+`\r
`,o+=`c=IN IP4 0.0.0.0\r
`,o+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,s.codecs.forEach(d=>{o+=e.writeRtpMap(d),o+=e.writeFmtp(d),o+=e.writeRtcpFb(d)});let l=0;return s.codecs.forEach(d=>{d.maxptime>l&&(l=d.maxptime)}),l>0&&(o+="a=maxptime:"+l+`\r
`),s.headerExtensions&&s.headerExtensions.forEach(d=>{o+=e.writeExtmap(d)}),o},e.parseRtpEncodingParameters=function(i){const s=[],o=e.parseRtpParameters(i),l=o.fecMechanisms.indexOf("RED")!==-1,d=o.fecMechanisms.indexOf("ULPFEC")!==-1,u=e.matchPrefix(i,"a=ssrc:").map(S=>e.parseSsrcMedia(S)).filter(S=>S.attribute==="cname"),h=u.length>0&&u[0].ssrc;let m;const g=e.matchPrefix(i,"a=ssrc-group:FID").map(S=>S.substring(17).split(" ").map(x=>parseInt(x,10)));g.length>0&&g[0].length>1&&g[0][0]===h&&(m=g[0][1]),o.codecs.forEach(S=>{if(S.name.toUpperCase()==="RTX"&&S.parameters.apt){let T={ssrc:h,codecPayloadType:parseInt(S.parameters.apt,10)};h&&m&&(T.rtx={ssrc:m}),s.push(T),l&&(T=JSON.parse(JSON.stringify(T)),T.fec={ssrc:h,mechanism:d?"red+ulpfec":"red"},s.push(T))}}),s.length===0&&h&&s.push({ssrc:h});let y=e.matchPrefix(i,"b=");return y.length&&(y[0].indexOf("b=TIAS:")===0?y=parseInt(y[0].substring(7),10):y[0].indexOf("b=AS:")===0?y=parseInt(y[0].substring(5),10)*1e3*.95-2e3*8:y=void 0,s.forEach(S=>{S.maxBitrate=y})),s},e.parseRtcpParameters=function(i){const s={},o=e.matchPrefix(i,"a=ssrc:").map(u=>e.parseSsrcMedia(u)).filter(u=>u.attribute==="cname")[0];o&&(s.cname=o.value,s.ssrc=o.ssrc);const l=e.matchPrefix(i,"a=rtcp-rsize");s.reducedSize=l.length>0,s.compound=l.length===0;const d=e.matchPrefix(i,"a=rtcp-mux");return s.mux=d.length>0,s},e.writeRtcpParameters=function(i){let s="";return i.reducedSize&&(s+=`a=rtcp-rsize\r
`),i.mux&&(s+=`a=rtcp-mux\r
`),i.ssrc!==void 0&&i.cname&&(s+="a=ssrc:"+i.ssrc+" cname:"+i.cname+`\r
`),s},e.parseMsid=function(i){let s;const o=e.matchPrefix(i,"a=msid:");if(o.length===1)return s=o[0].substring(7).split(" "),{stream:s[0],track:s[1]};const l=e.matchPrefix(i,"a=ssrc:").map(d=>e.parseSsrcMedia(d)).filter(d=>d.attribute==="msid");if(l.length>0)return s=l[0].value.split(" "),{stream:s[0],track:s[1]}},e.parseSctpDescription=function(i){const s=e.parseMLine(i),o=e.matchPrefix(i,"a=max-message-size:");let l;o.length>0&&(l=parseInt(o[0].substring(19),10)),isNaN(l)&&(l=65536);const d=e.matchPrefix(i,"a=sctp-port:");if(d.length>0)return{port:parseInt(d[0].substring(12),10),protocol:s.fmt,maxMessageSize:l};const u=e.matchPrefix(i,"a=sctpmap:");if(u.length>0){const h=u[0].substring(10).split(" ");return{port:parseInt(h[0],10),protocol:h[1],maxMessageSize:l}}},e.writeSctpDescription=function(i,s){let o=[];return i.protocol!=="DTLS/SCTP"?o=["m="+i.kind+" 9 "+i.protocol+" "+s.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+s.port+`\r
`]:o=["m="+i.kind+" 9 "+i.protocol+" "+s.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+s.port+" "+s.protocol+` 65535\r
`],s.maxMessageSize!==void 0&&o.push("a=max-message-size:"+s.maxMessageSize+`\r
`),o.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(i,s,o){let l;const d=s!==void 0?s:2;return i?l=i:l=e.generateSessionId(),`v=0\r
o=`+(o||"thisisadapterortc")+" "+l+" "+d+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(i,s){const o=e.splitLines(i);for(let l=0;l<o.length;l++)switch(o[l]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return o[l].substring(2)}return s?e.getDirection(s):"sendrecv"},e.getKind=function(i){return e.splitLines(i)[0].split(" ")[0].substring(2)},e.isRejected=function(i){return i.split(" ",2)[1]==="0"},e.parseMLine=function(i){const o=e.splitLines(i)[0].substring(2).split(" ");return{kind:o[0],port:parseInt(o[1],10),protocol:o[2],fmt:o.slice(3).join(" ")}},e.parseOLine=function(i){const o=e.matchPrefix(i,"o=")[0].substring(2).split(" ");return{username:o[0],sessionId:o[1],sessionVersion:parseInt(o[2],10),netType:o[3],addressType:o[4],address:o[5]}},e.isValidSDP=function(i){if(typeof i!="string"||i.length===0)return!1;const s=e.splitLines(i);for(let o=0;o<s.length;o++)if(s[o].length<2||s[o].charAt(1)!=="=")return!1;return!0},a.exports=e})(Zd)),Zd.exports}var JS=vR(),ws=sR(JS),yR=Cw({__proto__:null,default:ws},[JS]);function Ll(a){if(!a.RTCIceCandidate||a.RTCIceCandidate&&"foundation"in a.RTCIceCandidate.prototype)return;const e=a.RTCIceCandidate;a.RTCIceCandidate=function(s){if(typeof s=="object"&&s.candidate&&s.candidate.indexOf("a=")===0&&(s=JSON.parse(JSON.stringify(s)),s.candidate=s.candidate.substring(2)),s.candidate&&s.candidate.length){const o=new e(s),l=ws.parseCandidate(s.candidate);for(const d in l)d in o||Object.defineProperty(o,d,{value:l[d]});return o.toJSON=function(){return{candidate:o.candidate,sdpMid:o.sdpMid,sdpMLineIndex:o.sdpMLineIndex,usernameFragment:o.usernameFragment}},o}return new e(s)},a.RTCIceCandidate.prototype=e.prototype,Oa(a,"icecandidate",i=>(i.candidate&&Object.defineProperty(i,"candidate",{value:new a.RTCIceCandidate(i.candidate),writable:"false"}),i))}function wh(a){!a.RTCIceCandidate||a.RTCIceCandidate&&"relayProtocol"in a.RTCIceCandidate.prototype||Oa(a,"icecandidate",e=>{if(e.candidate){const i=ws.parseCandidate(e.candidate.candidate);i.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[i.priority>>24])}return e})}function Ul(a,e){if(!a.RTCPeerConnection)return;"sctp"in a.RTCPeerConnection.prototype||Object.defineProperty(a.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const i=function(u){if(!u||!u.sdp)return!1;const h=ws.splitSections(u.sdp);return h.shift(),h.some(m=>{const g=ws.parseMLine(m);return g&&g.kind==="application"&&g.protocol.indexOf("SCTP")!==-1})},s=function(u){const h=u.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(h===null||h.length<2)return-1;const m=parseInt(h[1],10);return m!==m?-1:m},o=function(u){let h=65536;return e.browser==="firefox"&&(e.version<57?u===-1?h=16384:h=2147483637:e.version<60?h=e.version===57?65535:65536:h=2147483637),h},l=function(u,h){let m=65536;e.browser==="firefox"&&e.version===57&&(m=65535);const g=ws.matchPrefix(u.sdp,"a=max-message-size:");return g.length>0?m=parseInt(g[0].substring(19),10):e.browser==="firefox"&&h!==-1&&(m=2147483637),m},d=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:h}=this.getConfiguration();h==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(i(arguments[0])){const h=s(arguments[0]),m=o(h),g=l(arguments[0],h);let y;m===0&&g===0?y=Number.POSITIVE_INFINITY:m===0||g===0?y=Math.max(m,g):y=Math.min(m,g);const S={};Object.defineProperty(S,"maxMessageSize",{get(){return y}}),this._sctp=S}return d.apply(this,arguments)}}function Bl(a){if(!(a.RTCPeerConnection&&"createDataChannel"in a.RTCPeerConnection.prototype))return;function e(s,o){const l=s.send;s.send=function(){const u=arguments[0],h=u.length||u.size||u.byteLength;if(s.readyState==="open"&&o.sctp&&h>o.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+o.sctp.maxMessageSize+" bytes)");return l.apply(s,arguments)}}const i=a.RTCPeerConnection.prototype.createDataChannel;a.RTCPeerConnection.prototype.createDataChannel=function(){const o=i.apply(this,arguments);return e(o,this),o},Oa(a,"datachannel",s=>(e(s.channel,s.target),s))}function xh(a){if(!a.RTCPeerConnection||"connectionState"in a.RTCPeerConnection.prototype)return;const e=a.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(i){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),i&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=i)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(i=>{const s=e[i];e[i]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=o=>{const l=o.target;if(l._lastConnectionState!==l.connectionState){l._lastConnectionState=l.connectionState;const d=new Event("connectionstatechange",o);l.dispatchEvent(d)}return o},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),s.apply(this,arguments)}})}function Rh(a,e){if(!a.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e._safariVersion>=13.1)return;const i=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(o){if(o&&o.sdp&&o.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const l=o.sdp.split(`
`).filter(d=>d.trim()!=="a=extmap-allow-mixed").join(`
`);a.RTCSessionDescription&&o instanceof a.RTCSessionDescription?arguments[0]=new a.RTCSessionDescription({type:o.type,sdp:l}):o.sdp=l}return i.apply(this,arguments)}}function ql(a,e){if(!(a.RTCPeerConnection&&a.RTCPeerConnection.prototype))return;const i=a.RTCPeerConnection.prototype.addIceCandidate;!i||i.length===0||(a.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():i.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function zl(a,e){if(!(a.RTCPeerConnection&&a.RTCPeerConnection.prototype))return;const i=a.RTCPeerConnection.prototype.setLocalDescription;!i||i.length===0||(a.RTCPeerConnection.prototype.setLocalDescription=function(){let o=arguments[0]||{};if(typeof o!="object"||o.type&&o.sdp)return i.apply(this,arguments);if(o={type:o.type,sdp:o.sdp},!o.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":o.type="offer";break;default:o.type="answer";break}return o.sdp||o.type!=="offer"&&o.type!=="answer"?i.apply(this,[o]):(o.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(d=>i.apply(this,[d]))})}var bR=Object.freeze({__proto__:null,removeExtmapAllowMixed:Rh,shimAddIceCandidateNullOrEmpty:ql,shimConnectionState:xh,shimMaxMessageSize:Ul,shimParameterlessSetLocalDescription:zl,shimRTCIceCandidate:Ll,shimRTCIceCandidateRelayProtocol:wh,shimSendThrowTypeError:Bl});function SR(){let{window:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const i=bS,s=pR(a),o={browserDetails:s,commonShim:bR,extractVersion:Br,disableLog:fR,disableWarnings:mR,sdp:yR};switch(s.browser){case"chrome":if(!Wy||!Eh||!e.shimChrome)return i("Chrome shim is not included in this adapter release."),o;if(s.version===null)return i("Chrome shim can not determine version, not shimming."),o;i("adapter.js shimming chrome."),o.browserShim=Wy,ql(a,s),zl(a),CS(a,s),TS(a),Eh(a,s),kS(a),xS(a,s),ES(a),_S(a),RS(a,s),Ll(a),wh(a),xh(a),Ul(a,s),Bl(a),Rh(a,s);break;case"firefox":if(!Zy||!_h||!e.shimFirefox)return i("Firefox shim is not included in this adapter release."),o;i("adapter.js shimming firefox."),o.browserShim=Zy,ql(a,s),zl(a),MS(a,s),_h(a,s),AS(a),OS(a),NS(a),DS(a),PS(a),jS(a),IS(a),LS(a),US(a),Ll(a),xh(a),Ul(a,s),Bl(a);break;case"safari":if(!$y||!e.shimSafari)return i("Safari shim is not included in this adapter release."),o;i("adapter.js shimming safari."),o.browserShim=$y,ql(a,s),zl(a),VS(a),KS(a),zS(a),BS(a),qS(a),GS(a),FS(a),YS(a),Ll(a),wh(a),Ul(a,s),Bl(a),Rh(a,s);break;default:i("Unsupported browser!");break}return o}SR({window:typeof window>"u"?void 0:window});var Mh,QS;class Nt extends(QS=Promise){constructor(e){super(e)}catch(e){return super.catch(e)}static reject(e){return super.reject(e)}static all(e){return super.all(e)}static race(e){return super.race(e)}}Mh=Nt;Nt.resolve=a=>Reflect.get(QS,"resolve",Mh).call(Mh,a);const CR=/version\/(\d+(\.?_?\d+)+)/i;let $d;function Yt(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(typeof navigator>"u")return;const i=navigator.userAgent.toLowerCase();if($d===void 0||e){const s=TR.find(o=>{let{test:l}=o;return l.test(i)});$d=s?.describe(i)}return $d}const TR=[{test:/firefox|iceweasel|fxios/i,describe(a){return{name:"Firefox",version:Fl(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,a),os:a.toLowerCase().includes("fxios")?"iOS":void 0,osVersion:eh(a)}}},{test:/chrom|crios|crmo/i,describe(a){return{name:"Chrome",version:Fl(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,a),os:a.toLowerCase().includes("crios")?"iOS":void 0,osVersion:eh(a)}}},{test:/safari|applewebkit/i,describe(a){return{name:"Safari",version:Fl(CR,a),os:a.includes("mobile/")?"iOS":"macOS",osVersion:eh(a)}}}];function Fl(a,e){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const s=e.match(a);return s&&s.length>=i&&s[i]||""}function eh(a){return a.includes("mac os")?Fl(/\(.+?(\d+_\d+(:?_\d+)?)/,a,1).replace(/_/g,"."):void 0}var kR="2.17.2";const ER=kR,_R=16;class ta extends Error{constructor(e,i,s){super(i||"an error has occurred"),this.name="LiveKitError",this.code=e,typeof s?.cause<"u"&&(this.cause=s?.cause)}}class gf extends ta{}var Qe;(function(a){a[a.NotAllowed=0]="NotAllowed",a[a.ServerUnreachable=1]="ServerUnreachable",a[a.InternalError=2]="InternalError",a[a.Cancelled=3]="Cancelled",a[a.LeaveRequest=4]="LeaveRequest",a[a.Timeout=5]="Timeout",a[a.WebSocket=6]="WebSocket",a[a.ServiceNotFound=7]="ServiceNotFound"})(Qe||(Qe={}));class me extends gf{constructor(e,i,s,o){super(1,e),this.name="ConnectionError",this.status=s,this.reason=i,this.context=o,this.reasonName=Qe[i]}static notAllowed(e,i,s){return new me(e,Qe.NotAllowed,i,s)}static timeout(e){return new me(e,Qe.Timeout)}static leaveRequest(e,i){return new me(e,Qe.LeaveRequest,void 0,i)}static internal(e,i){return new me(e,Qe.InternalError,void 0,i)}static cancelled(e){return new me(e,Qe.Cancelled)}static serverUnreachable(e,i){return new me(e,Qe.ServerUnreachable,i)}static websocket(e,i,s){return new me(e,Qe.WebSocket,i,s)}static serviceNotFound(e,i){return new me(e,Qe.ServiceNotFound,void 0,i)}}class vf extends ta{constructor(e){super(21,e??"device is unsupported"),this.name="DeviceUnsupportedError"}}class pi extends ta{constructor(e){super(20,e??"track is invalid"),this.name="TrackInvalidError"}}class wR extends ta{constructor(e){super(10,e??"unsupported server"),this.name="UnsupportedServer"}}class ut extends ta{constructor(e){super(12,e??"unexpected connection state"),this.name="UnexpectedConnectionState"}}class _a extends ta{constructor(e){super(13,e??"unable to negotiate"),this.name="NegotiationError"}}class t0 extends ta{constructor(e,i){super(15,e),this.name="PublishTrackError",this.status=i}}class n0 extends gf{constructor(e,i){super(15,e),this.name="SignalRequestError",this.reason=i,this.reasonName=typeof i=="string"?i:mf[i]}}var Pt;(function(a){a[a.AlreadyOpened=0]="AlreadyOpened",a[a.AbnormalEnd=1]="AbnormalEnd",a[a.DecodeFailed=2]="DecodeFailed",a[a.LengthExceeded=3]="LengthExceeded",a[a.Incomplete=4]="Incomplete",a[a.HandlerAlreadyRegistered=7]="HandlerAlreadyRegistered",a[a.EncryptionTypeMismatch=8]="EncryptionTypeMismatch"})(Pt||(Pt={}));class vn extends gf{constructor(e,i){super(16,e),this.name="DataStreamError",this.reason=i,this.reasonName=Pt[i]}}class Ss extends ta{constructor(e){super(18,e),this.name="SignalReconnectError"}}var tc;(function(a){a.PermissionDenied="PermissionDenied",a.NotFound="NotFound",a.DeviceInUse="DeviceInUse",a.Other="Other"})(tc||(tc={}));(function(a){function e(i){if(i&&"name"in i)return i.name==="NotFoundError"||i.name==="DevicesNotFoundError"?a.NotFound:i.name==="NotAllowedError"||i.name==="PermissionDeniedError"?a.PermissionDenied:i.name==="NotReadableError"||i.name==="TrackStartError"?a.DeviceInUse:a.Other}a.getFailure=e})(tc||(tc={}));class Rt{}Rt.setTimeout=function(){return setTimeout(...arguments)};Rt.setInterval=function(){return setInterval(...arguments)};Rt.clearTimeout=function(){return clearTimeout(...arguments)};Rt.clearInterval=function(){return clearInterval(...arguments)};var W;(function(a){a.Connected="connected",a.Reconnecting="reconnecting",a.SignalReconnecting="signalReconnecting",a.Reconnected="reconnected",a.Disconnected="disconnected",a.ConnectionStateChanged="connectionStateChanged",a.Moved="moved",a.MediaDevicesChanged="mediaDevicesChanged",a.ParticipantConnected="participantConnected",a.ParticipantDisconnected="participantDisconnected",a.TrackPublished="trackPublished",a.TrackSubscribed="trackSubscribed",a.TrackSubscriptionFailed="trackSubscriptionFailed",a.TrackUnpublished="trackUnpublished",a.TrackUnsubscribed="trackUnsubscribed",a.TrackMuted="trackMuted",a.TrackUnmuted="trackUnmuted",a.LocalTrackPublished="localTrackPublished",a.LocalTrackUnpublished="localTrackUnpublished",a.LocalAudioSilenceDetected="localAudioSilenceDetected",a.ActiveSpeakersChanged="activeSpeakersChanged",a.ParticipantMetadataChanged="participantMetadataChanged",a.ParticipantNameChanged="participantNameChanged",a.ParticipantAttributesChanged="participantAttributesChanged",a.ParticipantActive="participantActive",a.RoomMetadataChanged="roomMetadataChanged",a.DataReceived="dataReceived",a.SipDTMFReceived="sipDTMFReceived",a.TranscriptionReceived="transcriptionReceived",a.ConnectionQualityChanged="connectionQualityChanged",a.TrackStreamStateChanged="trackStreamStateChanged",a.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",a.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",a.AudioPlaybackStatusChanged="audioPlaybackChanged",a.VideoPlaybackStatusChanged="videoPlaybackChanged",a.MediaDevicesError="mediaDevicesError",a.ParticipantPermissionsChanged="participantPermissionsChanged",a.SignalConnected="signalConnected",a.RecordingStatusChanged="recordingStatusChanged",a.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",a.EncryptionError="encryptionError",a.DCBufferStatusChanged="dcBufferStatusChanged",a.ActiveDeviceChanged="activeDeviceChanged",a.ChatMessage="chatMessage",a.LocalTrackSubscribed="localTrackSubscribed",a.MetricsReceived="metricsReceived"})(W||(W={}));var ae;(function(a){a.TrackPublished="trackPublished",a.TrackSubscribed="trackSubscribed",a.TrackSubscriptionFailed="trackSubscriptionFailed",a.TrackUnpublished="trackUnpublished",a.TrackUnsubscribed="trackUnsubscribed",a.TrackMuted="trackMuted",a.TrackUnmuted="trackUnmuted",a.LocalTrackPublished="localTrackPublished",a.LocalTrackUnpublished="localTrackUnpublished",a.LocalTrackCpuConstrained="localTrackCpuConstrained",a.LocalSenderCreated="localSenderCreated",a.ParticipantMetadataChanged="participantMetadataChanged",a.ParticipantNameChanged="participantNameChanged",a.DataReceived="dataReceived",a.SipDTMFReceived="sipDTMFReceived",a.TranscriptionReceived="transcriptionReceived",a.IsSpeakingChanged="isSpeakingChanged",a.ConnectionQualityChanged="connectionQualityChanged",a.TrackStreamStateChanged="trackStreamStateChanged",a.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",a.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",a.TrackCpuConstrained="trackCpuConstrained",a.MediaDevicesError="mediaDevicesError",a.AudioStreamAcquired="audioStreamAcquired",a.ParticipantPermissionsChanged="participantPermissionsChanged",a.PCTrackAdded="pcTrackAdded",a.AttributesChanged="attributesChanged",a.LocalTrackSubscribed="localTrackSubscribed",a.ChatMessage="chatMessage",a.Active="active"})(ae||(ae={}));var ie;(function(a){a.TransportsCreated="transportsCreated",a.Connected="connected",a.Disconnected="disconnected",a.Resuming="resuming",a.Resumed="resumed",a.Restarting="restarting",a.Restarted="restarted",a.SignalResumed="signalResumed",a.SignalRestarted="signalRestarted",a.Closing="closing",a.MediaTrackAdded="mediaTrackAdded",a.ActiveSpeakersUpdate="activeSpeakersUpdate",a.DataPacketReceived="dataPacketReceived",a.RTPVideoMapUpdate="rtpVideoMapUpdate",a.DCBufferStatusChanged="dcBufferStatusChanged",a.ParticipantUpdate="participantUpdate",a.RoomUpdate="roomUpdate",a.SpeakersChanged="speakersChanged",a.StreamStateChanged="streamStateChanged",a.ConnectionQualityUpdate="connectionQualityUpdate",a.SubscriptionError="subscriptionError",a.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",a.RemoteMute="remoteMute",a.SubscribedQualityUpdate="subscribedQualityUpdate",a.LocalTrackUnpublished="localTrackUnpublished",a.LocalTrackSubscribed="localTrackSubscribed",a.Offline="offline",a.SignalRequestResponse="signalRequestResponse",a.SignalConnected="signalConnected",a.RoomMoved="roomMoved"})(ie||(ie={}));var $;(function(a){a.Message="message",a.Muted="muted",a.Unmuted="unmuted",a.Restarted="restarted",a.Ended="ended",a.Subscribed="subscribed",a.Unsubscribed="unsubscribed",a.CpuConstrained="cpuConstrained",a.UpdateSettings="updateSettings",a.UpdateSubscription="updateSubscription",a.AudioPlaybackStarted="audioPlaybackStarted",a.AudioPlaybackFailed="audioPlaybackFailed",a.AudioSilenceDetected="audioSilenceDetected",a.VisibilityChanged="visibilityChanged",a.VideoDimensionsChanged="videoDimensionsChanged",a.VideoPlaybackStarted="videoPlaybackStarted",a.VideoPlaybackFailed="videoPlaybackFailed",a.ElementAttached="elementAttached",a.ElementDetached="elementDetached",a.UpstreamPaused="upstreamPaused",a.UpstreamResumed="upstreamResumed",a.SubscriptionPermissionChanged="subscriptionPermissionChanged",a.SubscriptionStatusChanged="subscriptionStatusChanged",a.SubscriptionFailed="subscriptionFailed",a.TrackProcessorUpdate="trackProcessorUpdate",a.AudioTrackFeatureUpdate="audioTrackFeatureUpdate",a.TranscriptionReceived="transcriptionReceived",a.TimeSyncUpdate="timeSyncUpdate",a.PreConnectBufferFlushed="preConnectBufferFlushed"})($||($={}));function xR(a){return typeof a>"u"?a:typeof structuredClone=="function"?typeof a=="object"&&a!==null?structuredClone(Object.assign({},a)):structuredClone(a):JSON.parse(JSON.stringify(a))}class Ke{constructor(e,i,s,o,l){if(typeof e=="object")this.width=e.width,this.height=e.height,this.aspectRatio=e.aspectRatio,this.encoding={maxBitrate:e.maxBitrate,maxFramerate:e.maxFramerate,priority:e.priority};else if(i!==void 0&&s!==void 0)this.width=e,this.height=i,this.aspectRatio=e/i,this.encoding={maxBitrate:s,maxFramerate:o,priority:l};else throw new TypeError("Unsupported options: provide at least width, height and maxBitrate")}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.aspectRatio}}}const RR=["vp8","h264"],MR=["vp8","h264","vp9","av1","h265"];function AR(a){return!!RR.find(e=>e===a)}const NR=AR;var i0;(function(a){a[a.PREFER_REGRESSION=0]="PREFER_REGRESSION",a[a.SIMULCAST=1]="SIMULCAST",a[a.REGRESSION=2]="REGRESSION"})(i0||(i0={}));var Ah;(function(a){a.telephone={maxBitrate:12e3},a.speech={maxBitrate:24e3},a.music={maxBitrate:48e3},a.musicStereo={maxBitrate:64e3},a.musicHighQuality={maxBitrate:96e3},a.musicHighQualityStereo={maxBitrate:128e3}})(Ah||(Ah={}));const Wr={h90:new Ke(160,90,9e4,20),h180:new Ke(320,180,16e4,20),h216:new Ke(384,216,18e4,20),h360:new Ke(640,360,45e4,20),h540:new Ke(960,540,8e5,25),h720:new Ke(1280,720,17e5,30),h1080:new Ke(1920,1080,3e6,30),h1440:new Ke(2560,1440,5e6,30),h2160:new Ke(3840,2160,8e6,30)},Nh={h120:new Ke(160,120,7e4,20),h180:new Ke(240,180,125e3,20),h240:new Ke(320,240,14e4,20),h360:new Ke(480,360,33e4,20),h480:new Ke(640,480,5e5,20),h540:new Ke(720,540,6e5,25),h720:new Ke(960,720,13e5,30),h1080:new Ke(1440,1080,23e5,30),h1440:new Ke(1920,1440,38e5,30)},yf={h360fps3:new Ke(640,360,2e5,3,"medium"),h360fps15:new Ke(640,360,4e5,15,"medium"),h720fps5:new Ke(1280,720,8e5,5,"medium"),h720fps15:new Ke(1280,720,15e5,15,"medium"),h720fps30:new Ke(1280,720,2e6,30,"medium"),h1080fps15:new Ke(1920,1080,25e5,15,"medium"),h1080fps30:new Ke(1920,1080,5e6,30,"medium"),original:new Ke(0,0,7e6,30,"medium")};function XS(a,e,i){var s,o,l,d;const{optionsWithoutProcessor:u,audioProcessor:h,videoProcessor:m}=$S(a??{}),g=e?.processor,y=i?.processor,S=u??{};return S.audio===!0&&(S.audio={}),S.video===!0&&(S.video={}),S.audio&&(Dh(S.audio,e),(s=(l=S.audio).deviceId)!==null&&s!==void 0||(l.deviceId={ideal:"default"}),(h||g)&&(S.audio.processor=h??g)),S.video&&(Dh(S.video,i),(o=(d=S.video).deviceId)!==null&&o!==void 0||(d.deviceId={ideal:"default"}),(m||y)&&(S.video.processor=m??y)),S}function Dh(a,e){return Object.keys(e).forEach(i=>{a[i]===void 0&&(a[i]=e[i])}),a}function bf(a){var e,i,s,o;const l={};if(a.video)if(typeof a.video=="object"){const d={},u=d,h=a.video;Object.keys(h).forEach(m=>{m==="resolution"?Dh(u,h.resolution):u[m]=h[m]}),l.video=d,(e=(s=l.video).deviceId)!==null&&e!==void 0||(s.deviceId={ideal:"default"})}else l.video=a.video?{deviceId:{ideal:"default"}}:!1;else l.video=!1;return a.audio?typeof a.audio=="object"?(l.audio=a.audio,(i=(o=l.audio).deviceId)!==null&&i!==void 0||(o.deviceId={ideal:"default"})):l.audio={deviceId:{ideal:"default"}}:l.audio=!1,l}function WS(a){return _(this,arguments,void 0,function(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200;return(function*(){const s=ZS();if(s){const o=s.createAnalyser();o.fftSize=2048;const l=o.frequencyBinCount,d=new Uint8Array(l);s.createMediaStreamSource(new MediaStream([e.mediaStreamTrack])).connect(o),yield Mt(i),o.getByteTimeDomainData(d);const h=d.some(m=>m!==128&&m!==0);return s.close(),!h}return!1})()})}function ZS(){var a;const e=typeof window<"u"&&(window.AudioContext||window.webkitAudioContext);if(e){const i=new e({latencyHint:"interactive"});if(i.state==="suspended"&&typeof window<"u"&&(!((a=window.document)===null||a===void 0)&&a.body)){const s=()=>_(this,void 0,void 0,function*(){var o;try{i.state==="suspended"&&(yield i.resume())}catch(l){console.warn("Error trying to auto-resume audio context",l)}finally{(o=window.document.body)===null||o===void 0||o.removeEventListener("click",s)}});i.addEventListener("statechange",()=>{var o;i.state==="closed"&&((o=window.document.body)===null||o===void 0||o.removeEventListener("click",s))}),window.document.body.addEventListener("click",s)}return i}}function DR(a){return a==="audioinput"?Q.Source.Microphone:a==="videoinput"?Q.Source.Camera:Q.Source.Unknown}function Oh(a){return a===Q.Source.Microphone?"audioinput":a===Q.Source.Camera?"videoinput":void 0}function OR(a){var e,i;let s=(e=a.video)!==null&&e!==void 0?e:!0;return a.resolution&&a.resolution.width>0&&a.resolution.height>0&&(s=typeof s=="boolean"?{}:s,Aa()?s=Object.assign(Object.assign({},s),{width:{max:a.resolution.width},height:{max:a.resolution.height},frameRate:a.resolution.frameRate}):s=Object.assign(Object.assign({},s),{width:{ideal:a.resolution.width},height:{ideal:a.resolution.height},frameRate:a.resolution.frameRate})),{audio:(i=a.audio)!==null&&i!==void 0?i:!1,video:s,controller:a.controller,selfBrowserSurface:a.selfBrowserSurface,surfaceSwitching:a.surfaceSwitching,systemAudio:a.systemAudio,preferCurrentTab:a.preferCurrentTab}}function Fr(a){return a.split("/")[1].toLowerCase()}function PR(a){const e=[];return a.forEach(i=>{i.track!==void 0&&e.push(new cf({cid:i.track.mediaStreamID,track:i.trackInfo}))}),e}function Ee(a){return"mediaStreamTrack"in a?{trackID:a.sid,source:a.source,muted:a.isMuted,enabled:a.mediaStreamTrack.enabled,kind:a.kind,streamID:a.mediaStreamID,streamTrackID:a.mediaStreamTrack.id}:{trackID:a.trackSid,enabled:a.isEnabled,muted:a.isMuted,trackInfo:Object.assign({mimeType:a.mimeType,name:a.trackName,encrypted:a.isEncrypted,kind:a.kind,source:a.source},a.track?Ee(a.track):{})}}function jR(){return typeof RTCRtpReceiver<"u"&&"getSynchronizationSources"in RTCRtpReceiver}function IR(a,e){var i;a===void 0&&(a={}),e===void 0&&(e={});const s=[...Object.keys(e),...Object.keys(a)],o={};for(const l of s)a[l]!==e[l]&&(o[l]=(i=e[l])!==null&&i!==void 0?i:"");return o}function $S(a){const e=Object.assign({},a);let i,s;return typeof e.audio=="object"&&e.audio.processor&&(i=e.audio.processor,e.audio=Object.assign(Object.assign({},e.audio),{processor:void 0})),typeof e.video=="object"&&e.video.processor&&(s=e.video.processor,e.video=Object.assign(Object.assign({},e.video),{processor:void 0})),{audioProcessor:i,videoProcessor:s,optionsWithoutProcessor:xR(e)}}function LR(a){switch(a){case vt.CAMERA:return Q.Source.Camera;case vt.MICROPHONE:return Q.Source.Microphone;case vt.SCREEN_SHARE:return Q.Source.ScreenShare;case vt.SCREEN_SHARE_AUDIO:return Q.Source.ScreenShareAudio;default:return Q.Source.Unknown}}function a0(a,e){return a.width*a.height<e.width*e.height}function UR(a,e){var i;return(i=a.layers)===null||i===void 0?void 0:i.find(s=>s.quality===e)}const BR=5e3,Pr=[];var sn;(function(a){a[a.LOW=0]="LOW",a[a.MEDIUM=1]="MEDIUM",a[a.HIGH=2]="HIGH"})(sn||(sn={}));class Q extends Hn.EventEmitter{get streamState(){return this._streamState}setStreamState(e){this._streamState=e}constructor(e,i){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var o;super(),this.attachedElements=[],this.isMuted=!1,this._streamState=Q.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.log=Se,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),document.visibilityState==="hidden"?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),BR):this.handleAppVisibilityChanged()},this.log=Bn((o=s.loggerName)!==null&&o!==void 0?o:bn.Track),this.loggerContextCb=s.loggerContextCb,this.setMaxListeners(100),this.kind=i,this._mediaStreamTrack=e,this._mediaStreamID=e.id,this.source=Q.Source.Unknown}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),Ee(this))}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(e){let i="audio";this.kind===Q.Kind.Video&&(i="video"),this.attachedElements.length===0&&this.kind===Q.Kind.Video&&this.addAppVisibilityListener(),e||(i==="audio"&&(Pr.forEach(l=>{l.parentElement===null&&!e&&(e=l)}),e&&Pr.splice(Pr.indexOf(e),1)),e||(e=document.createElement(i))),this.attachedElements.includes(e)||this.attachedElements.push(e),Ts(this.mediaStreamTrack,e);const s=e.srcObject.getTracks(),o=s.some(l=>l.kind==="audio");return e.play().then(()=>{this.emit(o?$.AudioPlaybackStarted:$.VideoPlaybackStarted)}).catch(l=>{l.name==="NotAllowedError"?this.emit(o?$.AudioPlaybackFailed:$.VideoPlaybackFailed,l):l.name==="AbortError"?Se.debug("".concat(o?"audio":"video"," playback aborted, likely due to new play request")):Se.warn("could not playback ".concat(o?"audio":"video"),l),o&&e&&s.some(d=>d.kind==="video")&&l.name==="NotAllowedError"&&(e.muted=!0,e.play().catch(()=>{}))}),this.emit($.ElementAttached,e),e}detach(e){try{if(e){xs(this.mediaStreamTrack,e);const s=this.attachedElements.indexOf(e);return s>=0&&(this.attachedElements.splice(s,1),this.recycleElement(e),this.emit($.ElementDetached,e)),e}const i=[];return this.attachedElements.forEach(s=>{xs(this.mediaStreamTrack,s),i.push(s),this.recycleElement(s),this.emit($.ElementDetached,s)}),this.attachedElements=[],i}finally{this.attachedElements.length===0&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval),this.timeSyncHandle&&cancelAnimationFrame(this.timeSyncHandle)}updateLoggerOptions(e){e.loggerName&&(this.log=Bn(e.loggerName)),e.loggerContextCb&&(this.loggerContextCb=e.loggerContextCb)}recycleElement(e){if(e instanceof HTMLAudioElement){let i=!0;e.pause(),Pr.forEach(s=>{s.parentElement||(i=!1)}),i&&Pr.push(e)}}handleAppVisibilityChanged(){return _(this,void 0,void 0,function*(){this.isInBackground=document.visibilityState==="hidden",!this.isInBackground&&this.kind===Q.Kind.Video&&setTimeout(()=>this.attachedElements.forEach(e=>e.play().catch(()=>{})),0)})}addAppVisibilityListener(){Kt()?(this.isInBackground=document.visibilityState==="hidden",document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){Kt()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function Ts(a,e){let i;e.srcObject instanceof MediaStream?i=e.srcObject:i=new MediaStream;let s;a.kind==="audio"?s=i.getAudioTracks():s=i.getVideoTracks(),s.includes(a)||(s.forEach(o=>{i.removeTrack(o)}),i.addTrack(a)),(!Aa()||!(e instanceof HTMLVideoElement))&&(e.autoplay=!0),e.muted=i.getAudioTracks().length===0,e instanceof HTMLVideoElement&&(e.playsInline=!0),e.srcObject!==i&&(e.srcObject=i,(Aa()||Ma())&&e instanceof HTMLVideoElement&&setTimeout(()=>{e.srcObject=i,e.play().catch(()=>{})},0))}function xs(a,e){if(e.srcObject instanceof MediaStream){const i=e.srcObject;i.removeTrack(a),i.getTracks().length>0?e.srcObject=i:e.srcObject=null}}(function(a){let e;(function(m){m.Audio="audio",m.Video="video",m.Unknown="unknown"})(e=a.Kind||(a.Kind={}));let i;(function(m){m.Camera="camera",m.Microphone="microphone",m.ScreenShare="screen_share",m.ScreenShareAudio="screen_share_audio",m.Unknown="unknown"})(i=a.Source||(a.Source={}));let s;(function(m){m.Active="active",m.Paused="paused",m.Unknown="unknown"})(s=a.StreamState||(a.StreamState={}));function o(m){switch(m){case e.Audio:return wn.AUDIO;case e.Video:return wn.VIDEO;default:return wn.DATA}}a.kindToProto=o;function l(m){switch(m){case wn.AUDIO:return e.Audio;case wn.VIDEO:return e.Video;default:return e.Unknown}}a.kindFromProto=l;function d(m){switch(m){case i.Camera:return vt.CAMERA;case i.Microphone:return vt.MICROPHONE;case i.ScreenShare:return vt.SCREEN_SHARE;case i.ScreenShareAudio:return vt.SCREEN_SHARE_AUDIO;default:return vt.UNKNOWN}}a.sourceToProto=d;function u(m){switch(m){case vt.CAMERA:return i.Camera;case vt.MICROPHONE:return i.Microphone;case vt.SCREEN_SHARE:return i.ScreenShare;case vt.SCREEN_SHARE_AUDIO:return i.ScreenShareAudio;default:return i.Unknown}}a.sourceFromProto=u;function h(m){switch(m){case Sh.ACTIVE:return s.Active;case Sh.PAUSED:return s.Paused;default:return s.Unknown}}a.streamStateFromProto=h})(Q||(Q={}));const qR="|",s0="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function zR(a){const e=a.split(qR);return e.length>1?[e[0],a.substr(e[0].length+1)]:[a,""]}function Mt(a){return new Nt(e=>Rt.setTimeout(e,a))}function Ph(){return"addTransceiver"in RTCPeerConnection.prototype}function jh(){return"addTrack"in RTCPeerConnection.prototype}function FR(){if(!("getCapabilities"in RTCRtpSender)||Aa()||Ma())return!1;const a=RTCRtpSender.getCapabilities("video");let e=!1;if(a){for(const i of a.codecs)if(i.mimeType.toLowerCase()==="video/av1"){e=!0;break}}return e}function HR(){if(!("getCapabilities"in RTCRtpSender)||Ma())return!1;if(Aa()){const i=Yt();if(i?.version&&zn(i.version,"16")<0||i?.os==="iOS"&&i?.osVersion&&zn(i.osVersion,"16")<0)return!1}const a=RTCRtpSender.getCapabilities("video");let e=!1;if(a){for(const i of a.codecs)if(i.mimeType.toLowerCase()==="video/vp9"){e=!0;break}}return e}function Rn(a){return a==="av1"||a==="vp9"}function Ih(a){return!document||Zr()?!1:(a||(a=document.createElement("audio")),"setSinkId"in a)}function VR(){return typeof RTCPeerConnection>"u"?!1:Ph()||jh()}function Ma(){var a;return((a=Yt())===null||a===void 0?void 0:a.name)==="Firefox"}function r0(){const a=Yt();return!!a&&a.name==="Chrome"&&a.os!=="iOS"}function Aa(){var a;return((a=Yt())===null||a===void 0?void 0:a.name)==="Safari"}function Zr(){const a=Yt();return a?.name==="Safari"||a?.os==="iOS"}function GR(){const a=Yt();return a?.name==="Safari"&&a.version.startsWith("17.")||a?.os==="iOS"&&!!a?.osVersion&&zn(a.osVersion,"17")>=0}function KR(a){return a||(a=Yt()),a?.name==="Safari"&&zn(a.version,"18.3")>0||a?.os==="iOS"&&!!a?.osVersion&&zn(a.osVersion,"18.3")>0}function eC(){var a,e;return Kt()?(e=(a=navigator.userAgentData)===null||a===void 0?void 0:a.mobile)!==null&&e!==void 0?e:/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent):!1}function YR(){const a=Yt(),e="17.2";if(a)return a.name!=="Safari"&&a.os!=="iOS"||a.os==="iOS"&&a.osVersion&&zn(a.osVersion,e)>=0?!0:a.name==="Safari"&&zn(a.version,e)>=0}function Kt(){return typeof document<"u"}function qn(){return navigator.product=="ReactNative"}function Ds(a){return a.hostname.endsWith(".livekit.cloud")||a.hostname.endsWith(".livekit.run")}function th(a){return Ds(a)?a.hostname.split(".")[0]:null}function tC(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function nC(){if(!qn())return;let a=tC();if(a)return a.platform}function o0(){if(Kt())return window.devicePixelRatio;if(qn()){let a=tC();if(a)return a.devicePixelRatio}return 1}function zn(a,e){const i=a.split("."),s=e.split("."),o=Math.min(i.length,s.length);for(let l=0;l<o;++l){const d=parseInt(i[l],10),u=parseInt(s[l],10);if(d>u)return 1;if(d<u)return-1;if(l===o-1&&d===u)return 0}return a===""&&e!==""?-1:e===""?1:i.length==s.length?0:i.length<s.length?-1:1}function JR(a){for(const e of a)e.target.handleResize(e)}function QR(a){for(const e of a)e.target.handleVisibilityChanged(e)}let nh=null;const l0=()=>(nh||(nh=new ResizeObserver(JR)),nh);let ih=null;const c0=()=>(ih||(ih=new IntersectionObserver(QR,{root:null,rootMargin:"0px"})),ih);function XR(){var a;const e=new Zb({sdk:$b.JS,protocol:_R,version:ER});return qn()&&(e.os=(a=nC())!==null&&a!==void 0?a:""),e}function u0(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=document.createElement("canvas");o.width=a,o.height=e;const l=o.getContext("2d");l?.fillRect(0,0,o.width,o.height),s&&l&&(l.beginPath(),l.arc(a/2,e/2,50,0,Math.PI*2,!0),l.closePath(),l.fillStyle="grey",l.fill());const d=o.captureStream(),[u]=d.getTracks();if(!u)throw Error("Could not get empty media stream video track");return u.enabled=i,u}let jr;function ah(){if(!jr){const a=new AudioContext,e=a.createOscillator(),i=a.createGain();i.gain.setValueAtTime(0,0);const s=a.createMediaStreamDestination();if(e.connect(i),i.connect(s),e.start(),[jr]=s.stream.getAudioTracks(),!jr)throw Error("Could not get empty media stream audio track");jr.enabled=!1}return jr.clone()}class yn{get isResolved(){return this._isResolved}constructor(e,i){this._isResolved=!1,this.onFinally=i,this.promise=new Promise((s,o)=>_(this,void 0,void 0,function*(){this.resolve=s,this.reject=o,e&&(yield e(s,o))})).finally(()=>{var s;this._isResolved=!0,(s=this.onFinally)===null||s===void 0||s.call(this)})}}function WR(a){return MR.includes(a)}function wa(a){if(typeof a=="string"||typeof a=="number")return a;if(Array.isArray(a))return a[0];if(a.exact!==void 0)return Array.isArray(a.exact)?a.exact[0]:a.exact;if(a.ideal!==void 0)return Array.isArray(a.ideal)?a.ideal[0]:a.ideal;throw Error("could not unwrap constraint")}function ZR(a){return a.startsWith("http")?a.replace(/^(http)/,"ws"):a}function $r(a){return a.startsWith("ws")?a.replace(/^(ws)/,"http"):a}function $R(a,e){return a.segments.map(i=>{let{id:s,text:o,language:l,startTime:d,endTime:u,final:h}=i;var m;const g=(m=e.get(s))!==null&&m!==void 0?m:Date.now(),y=Date.now();return h?e.delete(s):e.set(s,g),{id:s,text:o,startTime:Number.parseInt(d.toString()),endTime:Number.parseInt(u.toString()),final:h,language:l,firstReceivedTime:g,lastReceivedTime:y}})}function eM(a){const{id:e,timestamp:i,message:s,editTimestamp:o}=a;return{id:e,timestamp:Number.parseInt(i.toString()),editTimestamp:o?Number.parseInt(o.toString()):void 0,message:s}}function d0(a){switch(a.reason){case Qe.LeaveRequest:return a.context;case Qe.Cancelled:return Mn.CLIENT_INITIATED;case Qe.NotAllowed:return Mn.USER_REJECTED;case Qe.ServerUnreachable:return Mn.JOIN_FAILURE;default:return Mn.UNKNOWN_REASON}}function Hl(a){return a!==void 0?Number(a):void 0}function Ea(a){return a!==void 0?BigInt(a):void 0}function Rs(a){return!!a&&!(a instanceof MediaStreamTrack)&&a.isLocal}function Un(a){return!!a&&a.kind==Q.Kind.Audio}function na(a){return!!a&&a.kind==Q.Kind.Video}function Ki(a){return Rs(a)&&na(a)}function ci(a){return Rs(a)&&Un(a)}function Lh(a){return!!a&&!a.isLocal}function tM(a){return!!a&&!a.isLocal}function sh(a){return Lh(a)&&na(a)}function nM(a){return a.isLocal}function iM(a,e){const i=[];let s=new TextEncoder().encode(a);for(;s.length>e;){let o=e;for(;o>0;){const l=s[o];if(l!==void 0&&(l&192)!==128)break;o--}i.push(s.slice(0,o)),s=s.slice(o)}return s.length>0&&i.push(s),i}function aM(a){var e;const i=a.get("Cache-Control");if(i){const s=(e=i.match(/(?:^|[,\s])max-age=(\d+)/))===null||e===void 0?void 0:e[1];if(s)return parseInt(s,10)}}function sM(a,e){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=rM(a,e);return i?s:Sf(s,"v1")}function rM(a,e){const i=new URL(ZR(a));return e.forEach((s,o)=>{i.searchParams.set(o,s)}),Sf(i,"rtc")}function oM(a){const e=new URL($r(a));return Sf(e,"validate")}function iC(a){return a.endsWith("/")?a:"".concat(a,"/")}function Sf(a,e){return a.pathname="".concat(iC(a.pathname)).concat(e),a}function h0(a){if(typeof a=="string")return Vy.fromJson(JSON.parse(a),{ignoreUnknownFields:!0});if(a instanceof ArrayBuffer)return Vy.fromBinary(new Uint8Array(a));throw new Error("could not decode websocket message: ".concat(typeof a))}function lM(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Unknown reason";if(!(a instanceof AbortSignal))return e;const i=a.reason;switch(typeof i){case"string":return i;case"object":return i instanceof Error?i.message:e;default:return"toString"in i?i.toString():e}}const cM=10,Ir="lk_e2ee",uM="LKFrameEncryptionKey",dM={sharedKey:!1,ratchetSalt:uM,ratchetWindowSize:8,failureTolerance:cM,keyringSize:16};var Wi;(function(a){a.SetKey="setKey",a.RatchetRequest="ratchetRequest",a.KeyRatcheted="keyRatcheted"})(Wi||(Wi={}));var f0;(function(a){a.KeyRatcheted="keyRatcheted"})(f0||(f0={}));var Qi;(function(a){a.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",a.EncryptionError="encryptionError"})(Qi||(Qi={}));var m0;(function(a){a.Error="cryptorError"})(m0||(m0={}));function hM(){return fM()||Uh()}function Uh(){return typeof window.RTCRtpScriptTransform<"u"}function fM(){return typeof window.RTCRtpSender<"u"&&typeof window.RTCRtpSender.prototype.createEncodedStreams<"u"}function mM(a){var e,i,s,o,l;if(((e=a.value)===null||e===void 0?void 0:e.case)!=="sipDtmf"&&((i=a.value)===null||i===void 0?void 0:i.case)!=="metrics"&&((s=a.value)===null||s===void 0?void 0:s.case)!=="speaker"&&((o=a.value)===null||o===void 0?void 0:o.case)!=="transcription"&&((l=a.value)===null||l===void 0?void 0:l.case)!=="encryptedPacket")return new Gb({value:a.value})}class aN extends Hn.EventEmitter{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this.onKeyRatcheted=(i,s,o)=>{Se.debug("key ratcheted event received",{ratchetResult:i,participantId:s,keyIndex:o})},this.keyInfoMap=new Map,this.options=Object.assign(Object.assign({},dM),e),this.on(Wi.KeyRatcheted,this.onKeyRatcheted)}onSetEncryptionKey(e,i,s){const o={key:e,participantIdentity:i,keyIndex:s};if(!this.options.sharedKey&&!i)throw new Error("participant identity needs to be passed for encryption key if sharedKey option is false");this.keyInfoMap.set("".concat(i??"shared","-").concat(s??0),o),this.emit(Wi.SetKey,o)}getKeys(){return Array.from(this.keyInfoMap.values())}getOptions(){return this.options}ratchetKey(e,i){this.emit(Wi.RatchetRequest,e,i)}}var p0;(function(a){a[a.InvalidKey=0]="InvalidKey",a[a.MissingKey=1]="MissingKey",a[a.InternalError=2]="InternalError"})(p0||(p0={}));class pM extends Hn.EventEmitter{constructor(e,i){super(),this.decryptDataRequests=new Map,this.encryptDataRequests=new Map,this.onWorkerMessage=s=>{var o,l;const{kind:d,data:u}=s.data;switch(d){case"error":if(Se.error(u.error.message),u.uuid){const g=this.decryptDataRequests.get(u.uuid);if(g?.reject){g.reject(u.error);break}const y=this.encryptDataRequests.get(u.uuid);if(y?.reject){y.reject(u.error);break}}this.emit(Qi.EncryptionError,u.error,u.participantIdentity);break;case"initAck":u.enabled&&this.keyProvider.getKeys().forEach(g=>{this.postKey(g)});break;case"enable":if(u.enabled&&this.keyProvider.getKeys().forEach(g=>{this.postKey(g)}),this.encryptionEnabled!==u.enabled&&u.participantIdentity===((o=this.room)===null||o===void 0?void 0:o.localParticipant.identity))this.emit(Qi.ParticipantEncryptionStatusChanged,u.enabled,this.room.localParticipant),this.encryptionEnabled=u.enabled;else if(u.participantIdentity){const g=(l=this.room)===null||l===void 0?void 0:l.getParticipantByIdentity(u.participantIdentity);if(!g)throw TypeError("couldn't set encryption status, participant not found".concat(u.participantIdentity));this.emit(Qi.ParticipantEncryptionStatusChanged,u.enabled,g)}break;case"ratchetKey":this.keyProvider.emit(Wi.KeyRatcheted,u.ratchetResult,u.participantIdentity,u.keyIndex);break;case"decryptDataResponse":const h=this.decryptDataRequests.get(u.uuid);h?.resolve&&h.resolve(u);break;case"encryptDataResponse":const m=this.encryptDataRequests.get(u.uuid);m?.resolve&&m.resolve(u);break}},this.onWorkerError=s=>{Se.error("e2ee worker encountered an error:",{error:s.error}),this.emit(Qi.EncryptionError,s.error,void 0)},this.keyProvider=e.keyProvider,this.worker=e.worker,this.encryptionEnabled=!1,this.dataChannelEncryptionEnabled=i}get isEnabled(){return this.encryptionEnabled}get isDataChannelEncryptionEnabled(){return this.isEnabled&&this.dataChannelEncryptionEnabled}setup(e){if(!hM())throw new vf("tried to setup end-to-end encryption on an unsupported browser");if(Se.info("setting up e2ee"),e!==this.room){this.room=e,this.setupEventListeners(e,this.keyProvider);const i={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions(),loglevel:lR.getLevel()}};this.worker&&(Se.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(i))}}setParticipantCryptorEnabled(e,i){Se.debug("set e2ee to ".concat(e," for participant ").concat(i)),this.postEnable(e,i)}setSifTrailer(e){!e||e.length===0?Se.warn("ignoring server sent trailer as it's empty"):this.postSifTrailer(e)}setupEngine(e){e.on(ie.RTPVideoMapUpdate,i=>{this.postRTPMap(i)})}setupEventListeners(e,i){e.on(W.TrackPublished,(s,o)=>this.setParticipantCryptorEnabled(s.trackInfo.encryption!==ht.NONE,o.identity)),e.on(W.ConnectionStateChanged,s=>{s===Ie.Connected&&e.remoteParticipants.forEach(o=>{o.trackPublications.forEach(l=>{this.setParticipantCryptorEnabled(l.trackInfo.encryption!==ht.NONE,o.identity)})})}).on(W.TrackUnsubscribed,(s,o,l)=>{var d;const u={kind:"removeTransform",data:{participantIdentity:l.identity,trackId:s.mediaStreamID}};(d=this.worker)===null||d===void 0||d.postMessage(u)}).on(W.TrackSubscribed,(s,o,l)=>{this.setupE2EEReceiver(s,l.identity,o.trackInfo)}).on(W.SignalConnected,()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");i.getKeys().forEach(s=>{this.postKey(s)}),this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity)}),e.localParticipant.on(ae.LocalSenderCreated,(s,o)=>_(this,void 0,void 0,function*(){this.setupE2EESender(o,s)})),e.localParticipant.on(ae.LocalTrackPublished,s=>{if(!na(s.track)||!Zr())return;const o={kind:"updateCodec",data:{trackId:s.track.mediaStreamID,codec:Fr(s.trackInfo.codecs[0].mimeType),participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(o)}),i.on(Wi.SetKey,s=>this.postKey(s)).on(Wi.RatchetRequest,(s,o)=>this.postRatchetRequest(s,o))}encryptData(e){return _(this,void 0,void 0,function*(){if(!this.worker)throw Error("could not encrypt data, worker is missing");const i=crypto.randomUUID(),s={kind:"encryptDataRequest",data:{uuid:i,payload:e,participantIdentity:this.room.localParticipant.identity}},o=new yn;return o.onFinally=()=>{this.encryptDataRequests.delete(i)},this.encryptDataRequests.set(i,o),this.worker.postMessage(s),o.promise})}handleEncryptedData(e,i,s,o){if(!this.worker)throw Error("could not handle encrypted data, worker is missing");const l=crypto.randomUUID(),d={kind:"decryptDataRequest",data:{uuid:l,payload:e,iv:i,participantIdentity:s,keyIndex:o}},u=new yn;return u.onFinally=()=>{this.decryptDataRequests.delete(l)},this.decryptDataRequests.set(l,u),this.worker.postMessage(d),u.promise}postRatchetRequest(e,i){if(!this.worker)throw Error("could not ratchet key, worker is missing");const s={kind:"ratchetRequest",data:{participantIdentity:e,keyIndex:i}};this.worker.postMessage(s)}postKey(e){let{key:i,participantIdentity:s,keyIndex:o}=e;var l;if(!this.worker)throw Error("could not set key, worker is missing");const d={kind:"setKey",data:{participantIdentity:s,isPublisher:s===((l=this.room)===null||l===void 0?void 0:l.localParticipant.identity),key:i,keyIndex:o}};this.worker.postMessage(d)}postEnable(e,i){if(this.worker){const s={kind:"enable",data:{enabled:e,participantIdentity:i}};this.worker.postMessage(s)}else throw new ReferenceError("failed to enable e2ee, worker is not ready")}postRTPMap(e){var i;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(!((i=this.room)===null||i===void 0)&&i.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const s={kind:"setRTPMap",data:{map:e,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(s)}postSifTrailer(e){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const i={kind:"setSifTrailer",data:{trailer:e}};this.worker.postMessage(i)}setupE2EEReceiver(e,i,s){if(e.receiver){if(!s?.mimeType||s.mimeType==="")throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(e.receiver,e.mediaStreamID,i,e.kind==="video"?Fr(s.mimeType):void 0)}}setupE2EESender(e,i){if(!Rs(e)||!i){i||Se.warn("early return because sender is not ready");return}this.handleSender(i,e.mediaStreamID,void 0)}handleReceiver(e,i,s,o){return _(this,void 0,void 0,function*(){if(this.worker){if(Uh()&&!r0()){const l={kind:"decode",participantIdentity:s,trackId:i,codec:o};e.transform=new RTCRtpScriptTransform(this.worker,l)}else{if(Ir in e&&o){const h={kind:"updateCodec",data:{trackId:i,codec:o,participantIdentity:s}};this.worker.postMessage(h);return}let l=e.writableStream,d=e.readableStream;if(!l||!d){const h=e.createEncodedStreams();e.writableStream=h.writable,l=h.writable,e.readableStream=h.readable,d=h.readable}const u={kind:"decode",data:{readableStream:d,writableStream:l,trackId:i,codec:o,participantIdentity:s,isReuse:Ir in e}};this.worker.postMessage(u,[d,l])}e[Ir]=!0}})}handleSender(e,i,s){var o;if(!(Ir in e||!this.worker)){if(!(!((o=this.room)===null||o===void 0)&&o.localParticipant.identity)||this.room.localParticipant.identity==="")throw TypeError("local identity needs to be known in order to set up encrypted sender");if(Uh()&&!r0()){Se.info("initialize script transform");const l={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:i,codec:s};e.transform=new RTCRtpScriptTransform(this.worker,l)}else{Se.info("initialize encoded streams");const l=e.createEncodedStreams(),d={kind:"encode",data:{readableStream:l.readable,writableStream:l.writable,codec:s,trackId:i,participantIdentity:this.room.localParticipant.identity,isReuse:!1}};this.worker.postMessage(d,[l.readable,l.writable])}e[Ir]=!0}}}const gM=500,vM=15e3;class Ms{constructor(){this.failedConnectionAttempts=new Map,this.backOffPromises=new Map}static getInstance(){return this._instance||(this._instance=new Ms),this._instance}addFailedConnectionAttempt(e){var i;const s=new URL(e),o=th(s);if(!o)return;let l=(i=this.failedConnectionAttempts.get(o))!==null&&i!==void 0?i:0;this.failedConnectionAttempts.set(o,l+1),this.backOffPromises.set(o,Mt(Math.min(gM*Math.pow(2,l),vM)))}getBackOffPromise(e){const i=new URL(e),s=i&&th(i);return s&&this.backOffPromises.get(s)||Promise.resolve()}resetFailedConnectionAttempts(e){const i=new URL(e),s=i&&th(i);s&&(this.failedConnectionAttempts.set(s,0),this.backOffPromises.set(s,Promise.resolve()))}resetAll(){this.backOffPromises.clear(),this.failedConnectionAttempts.clear()}}Ms._instance=null;const rh="default";class Tt{constructor(){this._previousDevices=[]}static getInstance(){return this.instance===void 0&&(this.instance=new Tt),this.instance}get previousDevices(){return this._previousDevices}getDevices(e){return _(this,arguments,void 0,function(i){var s=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return(function*(){var l;if(((l=Tt.userMediaPromiseMap)===null||l===void 0?void 0:l.size)>0){Se.debug("awaiting getUserMedia promise");try{i?yield Tt.userMediaPromiseMap.get(i):yield Promise.all(Tt.userMediaPromiseMap.values())}catch{Se.warn("error waiting for media permissons")}}let d=yield navigator.mediaDevices.enumerateDevices();if(o&&!(Aa()&&s.hasDeviceInUse(i))&&(d.filter(h=>h.kind===i).length===0||d.some(h=>{const m=h.label==="",g=i?h.kind===i:!0;return m&&g}))){const h={video:i!=="audioinput"&&i!=="audiooutput",audio:i!=="videoinput"&&{deviceId:{ideal:"default"}}},m=yield navigator.mediaDevices.getUserMedia(h);d=yield navigator.mediaDevices.enumerateDevices(),m.getTracks().forEach(g=>{g.stop()})}return s._previousDevices=d,i&&(d=d.filter(u=>u.kind===i)),d})()})}normalizeDeviceId(e,i,s){return _(this,void 0,void 0,function*(){if(i!==rh)return i;const o=yield this.getDevices(e),l=o.find(u=>u.deviceId===rh);if(!l){Se.warn("could not reliably determine default device");return}const d=o.find(u=>u.deviceId!==rh&&u.groupId===(s??l.groupId));if(!d){Se.warn("could not reliably determine default device");return}return d?.deviceId})}hasDeviceInUse(e){return e?Tt.userMediaPromiseMap.has(e):Tt.userMediaPromiseMap.size>0}}Tt.mediaDeviceKinds=["audioinput","audiooutput","videoinput"];Tt.userMediaPromiseMap=new Map;var Hr;(function(a){a[a.WAITING=0]="WAITING",a[a.RUNNING=1]="RUNNING",a[a.COMPLETED=2]="COMPLETED"})(Hr||(Hr={}));class yM{constructor(){this.pendingTasks=new Map,this.taskMutex=new It,this.nextTaskIndex=0}run(e){return _(this,void 0,void 0,function*(){const i={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:Hr.WAITING};this.pendingTasks.set(i.id,i);const s=yield this.taskMutex.lock();try{return i.executedAt=Date.now(),i.status=Hr.RUNNING,yield e()}finally{i.status=Hr.COMPLETED,this.pendingTasks.delete(i.id),s()}})}flush(){return _(this,void 0,void 0,function*(){return this.run(()=>_(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}class bM{get readyState(){return this.ws.readyState}constructor(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var s,o;if(!((s=i.signal)===null||s===void 0)&&s.aborted)throw new DOMException("This operation was aborted","AbortError");this.url=e;const l=new WebSocket(e,(o=i.protocols)!==null&&o!==void 0?o:[]);l.binaryType="arraybuffer",this.ws=l;const d=function(){let{closeCode:u,reason:h}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return l.close(u,h)};this.opened=new Nt((u,h)=>{const m=()=>{h(me.websocket("Encountered websocket error during connection establishment"))};l.onopen=()=>{u({readable:new ReadableStream({start(g){l.onmessage=y=>{let{data:S}=y;return g.enqueue(S)},l.onerror=y=>g.error(y)},cancel:d}),writable:new WritableStream({write(g){l.send(g)},abort(){l.close()},close:d}),protocol:l.protocol,extensions:l.extensions}),l.removeEventListener("error",m)},l.addEventListener("error",m)}),this.closed=new Nt((u,h)=>{const m=()=>_(this,void 0,void 0,function*(){const g=new Nt(S=>{l.readyState!==WebSocket.CLOSED&&l.addEventListener("close",T=>{S(T)},{once:!0})}),y=yield Nt.race([Mt(250),g]);y?u(y):h(me.websocket("Encountered unspecified websocket error without a timely close event"))});l.onclose=g=>{let{code:y,reason:S}=g;u({closeCode:y,reason:S}),l.removeEventListener("error",m)},l.addEventListener("error",m)}),i.signal&&(i.signal.onabort=()=>l.close()),this.close=d}}const SM=["syncState","trickle","offer","answer","simulate","leave"];function CM(a){const e=SM.indexOf(a.case)>=0;return Se.trace("request allowed to bypass queue:",{canPass:e,req:a}),e}var Je;(function(a){a[a.CONNECTING=0]="CONNECTING",a[a.CONNECTED=1]="CONNECTED",a[a.RECONNECTING=2]="RECONNECTING",a[a.DISCONNECTING=3]="DISCONNECTING",a[a.DISCONNECTED=4]="DISCONNECTED"})(Je||(Je={}));const TM=250;class Cf{get currentState(){return this.state}get isDisconnected(){return this.state===Je.DISCONNECTING||this.state===Je.DISCONNECTED}get isEstablishingConnection(){return this.state===Je.CONNECTING||this.state===Je.RECONNECTING}getNextRequestId(){return this._requestId+=1,this._requestId}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var s;this.rtt=0,this.state=Je.DISCONNECTED,this.log=Se,this._requestId=0,this.useV0SignalPath=!1,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0,this.onMediaSectionsRequirement=void 0},this.log=Bn((s=i.loggerName)!==null&&s!==void 0?s:bn.Signal),this.loggerContextCb=i.loggerContextCb,this.useJSON=e,this.requestQueue=new yM,this.queuedRequests=[],this.closingLock=new It,this.connectionLock=new It,this.state=Je.DISCONNECTED}get logContext(){var e,i;return(i=(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this))!==null&&i!==void 0?i:{}}join(e,i,s,o){return _(this,arguments,void 0,function(l,d,u,h){var m=this;let g=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;return(function*(){return m.state=Je.CONNECTING,m.options=u,yield m.connect(l,d,u,h,g)})()})}reconnect(e,i,s,o){return _(this,void 0,void 0,function*(){if(!this.options){this.log.warn("attempted to reconnect without signal options being set, ignoring",this.logContext);return}return this.state=Je.RECONNECTING,this.clearPingInterval(),yield this.connect(e,i,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:s,reconnectReason:o}),void 0,this.useV0SignalPath)})}connect(e,i,s,o){return _(this,arguments,void 0,function(l,d,u,h){var m=this;let g=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;return(function*(){const y=yield m.connectionLock.lock();m.connectOptions=u,m.useV0SignalPath=g;const S=XR(),T=g?kM(d,S,u):EM(d,S,u),x=sM(l,T,g).toString(),E=oM(x).toString();return new Promise((k,R)=>_(m,void 0,void 0,function*(){var O,L;try{let D=!1;const I=te=>_(this,void 0,void 0,function*(){if(D)return;D=!0;const re=te instanceof Event?te.currentTarget:te,ue=lM(re,"Abort handler called");this.streamWriter&&!this.isDisconnected?this.sendLeave().then(()=>this.close(ue)).catch(Ae=>{this.log.error(Ae),this.close()}):this.close(),P(),R(me.cancelled(ue))});h?.addEventListener("abort",I);const P=()=>{clearTimeout(H),h?.removeEventListener("abort",I)},H=setTimeout(()=>{I(me.timeout("room connection has timed out (signal)"))},u.websocketTimeout),Z=(te,re)=>{this.handleSignalConnected(te,H,re)},ee=new URL(x);ee.searchParams.has("access_token")&&ee.searchParams.set("access_token","<redacted>"),this.log.debug("connecting to ".concat(ee),Object.assign({reconnect:u.reconnect,reconnectReason:u.reconnectReason},this.logContext)),this.ws&&(yield this.close(!1)),this.ws=new bM(x);try{this.ws.closed.then(F=>{var ne;this.isEstablishingConnection&&R(me.internal("Websocket got closed during a (re)connection attempt: ".concat(F.reason))),F.closeCode!==1e3&&(this.log.warn("websocket closed",Object.assign(Object.assign({},this.logContext),{reason:F.reason,code:F.closeCode,wasClean:F.closeCode===1e3,state:this.state})),this.state===Je.CONNECTED&&this.handleOnClose((ne=F.reason)!==null&&ne!==void 0?ne:"Unexpected WS error"))}).catch(F=>{this.isEstablishingConnection&&R(me.internal("Websocket error during a (re)connection attempt: ".concat(F)))});const te=yield this.ws.opened.catch(F=>_(this,void 0,void 0,function*(){if(this.state!==Je.CONNECTED){this.state=Je.DISCONNECTED,clearTimeout(H);const ne=yield this.handleConnectionError(F,E);R(ne);return}this.handleWSError(F),R(F)}));if(clearTimeout(H),!te)return;const re=te.readable.getReader();this.streamWriter=te.writable.getWriter();const ue=yield re.read();if(re.releaseLock(),!ue.value)throw me.internal("no message received as first message");const Ae=h0(ue.value),Xe=this.validateFirstMessage(Ae,(O=u.reconnect)!==null&&O!==void 0?O:!1);if(!Xe.isValid){R(Xe.error);return}((L=Ae.message)===null||L===void 0?void 0:L.case)==="join"&&(this.pingTimeoutDuration=Ae.message.value.pingTimeout,this.pingIntervalDuration=Ae.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&this.log.debug("ping config",Object.assign(Object.assign({},this.logContext),{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration})));const Fe=Xe.shouldProcessFirstMessage?Ae:void 0;Z(te,Fe),k(Xe.response)}catch(te){R(te)}finally{P()}}finally{y()}}))})()})}startReadingLoop(e,i){return _(this,void 0,void 0,function*(){for(i&&this.handleSignalResponse(i);;){this.signalLatency&&(yield Mt(this.signalLatency));const{done:s,value:o}=yield e.read();if(s)break;const l=h0(o);this.handleSignalResponse(l)}})}close(){return _(this,arguments,void 0,function(){var e=this;let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Close method called on signal client";return(function*(){if([Je.DISCONNECTING||Je.DISCONNECTED].includes(e.state)){e.log.debug("ignoring signal close as it's already in disconnecting state");return}const o=yield e.closingLock.lock();try{if(e.clearPingInterval(),i&&(e.state=Je.DISCONNECTING),e.ws){e.ws.close({closeCode:1e3,reason:s});const l=e.ws.closed;e.ws=void 0,e.streamWriter=void 0,yield Promise.race([l,Mt(TM)])}}catch(l){e.log.debug("websocket error while closing",Object.assign(Object.assign({},e.logContext),{error:l}))}finally{i&&(e.state=Je.DISCONNECTED),o()}})()})}sendOffer(e,i){this.log.debug("sending offer",Object.assign(Object.assign({},this.logContext),{offerSdp:e.sdp})),this.sendRequest({case:"offer",value:ks(e,i)})}sendAnswer(e,i){return this.log.debug("sending answer",Object.assign(Object.assign({},this.logContext),{answerSdp:e.sdp})),this.sendRequest({case:"answer",value:ks(e,i)})}sendIceCandidate(e,i){return this.log.debug("sending ice candidate",Object.assign(Object.assign({},this.logContext),{candidate:e})),this.sendRequest({case:"trickle",value:new fc({candidateInit:JSON.stringify(e),target:i})})}sendMuteTrack(e,i){return this.sendRequest({case:"mute",value:new mc({sid:e,muted:i})})}sendAddTrack(e){return this.sendRequest({case:"addTrack",value:e})}sendUpdateLocalMetadata(e,i){return _(this,arguments,void 0,function(s,o){var l=this;let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return(function*(){const u=l.getNextRequestId();return yield l.sendRequest({case:"updateMetadata",value:new df({requestId:u,metadata:s,name:o,attributes:d})}),u})()})}sendUpdateTrackSettings(e){this.sendRequest({case:"trackSetting",value:e})}sendUpdateSubscription(e){return this.sendRequest({case:"subscription",value:e})}sendSyncState(e){return this.sendRequest({case:"syncState",value:e})}sendUpdateVideoLayers(e,i){return this.sendRequest({case:"updateLayers",value:new cS({trackSid:e,layers:i})})}sendUpdateSubscriptionPermissions(e,i){return this.sendRequest({case:"subscriptionPermission",value:new hS({allParticipants:e,trackPermissions:i})})}sendSimulateScenario(e){return this.sendRequest({case:"simulate",value:e})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:et.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new pS({timestamp:et.parse(Date.now()),rtt:et.parse(this.rtt)})})])}sendUpdateLocalAudioTrack(e,i){return this.sendRequest({case:"updateAudioTrack",value:new uf({trackSid:e,features:i})})}sendLeave(){return this.sendRequest({case:"leave",value:new gc({reason:Mn.CLIENT_INITIATED,action:_s.DISCONNECT})})}sendRequest(e){return _(this,arguments,void 0,function(i){var s=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return(function*(){if(!o&&!CM(i)&&s.state===Je.RECONNECTING){s.queuedRequests.push(()=>_(s,void 0,void 0,function*(){yield this.sendRequest(i,!0)}));return}if(o||(yield s.requestQueue.flush()),s.signalLatency&&(yield Mt(s.signalLatency)),s.isDisconnected){s.log.debug("skipping signal request (type: ".concat(i.case,") - SignalClient disconnected"));return}if(!s.streamWriter){s.log.error("cannot send signal request before connected, type: ".concat(i?.case),s.logContext);return}const d=new Rx({message:i});try{s.useJSON?yield s.streamWriter.write(d.toJsonString()):yield s.streamWriter.write(d.toBinary())}catch(u){s.log.error("error sending signal message",Object.assign(Object.assign({},s.logContext),{error:u}))}})()})}handleSignalResponse(e){var i,s;const o=e.message;if(o==null){this.log.debug("received unsupported message",this.logContext);return}let l=!1;if(o.case==="answer"){const d=g0(o.value);this.onAnswer&&this.onAnswer(d,o.value.id,o.value.midToTrackId)}else if(o.case==="offer"){const d=g0(o.value);this.onOffer&&this.onOffer(d,o.value.id,o.value.midToTrackId)}else if(o.case==="trickle"){const d=JSON.parse(o.value.candidateInit);this.onTrickle&&this.onTrickle(d,o.value.target)}else o.case==="update"?this.onParticipantUpdate&&this.onParticipantUpdate((i=o.value.participants)!==null&&i!==void 0?i:[]):o.case==="trackPublished"?this.onLocalTrackPublished&&this.onLocalTrackPublished(o.value):o.case==="speakersChanged"?this.onSpeakersChanged&&this.onSpeakersChanged((s=o.value.speakers)!==null&&s!==void 0?s:[]):o.case==="leave"?this.onLeave&&this.onLeave(o.value):o.case==="mute"?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(o.value.sid,o.value.muted):o.case==="roomUpdate"?this.onRoomUpdate&&o.value.room&&this.onRoomUpdate(o.value.room):o.case==="connectionQuality"?this.onConnectionQuality&&this.onConnectionQuality(o.value):o.case==="streamStateUpdate"?this.onStreamStateUpdate&&this.onStreamStateUpdate(o.value):o.case==="subscribedQualityUpdate"?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(o.value):o.case==="subscriptionPermissionUpdate"?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(o.value):o.case==="refreshToken"?this.onTokenRefresh&&this.onTokenRefresh(o.value):o.case==="trackUnpublished"?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(o.value):o.case==="subscriptionResponse"?this.onSubscriptionError&&this.onSubscriptionError(o.value):o.case==="pong"||(o.case==="pongResp"?(this.rtt=Date.now()-Number.parseInt(o.value.lastPingTimestamp.toString()),this.resetPingTimeout(),l=!0):o.case==="requestResponse"?this.onRequestResponse&&this.onRequestResponse(o.value):o.case==="trackSubscribed"?this.onLocalTrackSubscribed&&this.onLocalTrackSubscribed(o.value.trackSid):o.case==="roomMoved"?(this.onTokenRefresh&&this.onTokenRefresh(o.value.token),this.onRoomMoved&&this.onRoomMoved(o.value)):o.case==="mediaSectionsRequirement"?this.onMediaSectionsRequirement&&this.onMediaSectionsRequirement(o.value):this.log.debug("unsupported message",Object.assign(Object.assign({},this.logContext),{msgCase:o.case})));l||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){const e=this.queuedRequests.shift();e&&this.requestQueue.run(e)}}handleOnClose(e){return _(this,void 0,void 0,function*(){if(this.state===Je.DISCONNECTED)return;const i=this.onClose;yield this.close(void 0,e),this.log.debug("websocket connection closed: ".concat(e),Object.assign(Object.assign({},this.logContext),{reason:e})),i&&i(e)})}handleWSError(e){this.log.error("websocket error",Object.assign(Object.assign({},this.logContext),{error:e}))}resetPingTimeout(){if(this.clearPingTimeout(),!this.pingTimeoutDuration){this.log.warn("ping timeout duration not set",this.logContext);return}this.pingTimeout=Rt.setTimeout(()=>{this.log.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-this.pingTimeoutDuration*1e3).toUTCString()),this.logContext),this.handleOnClose("ping timeout")},this.pingTimeoutDuration*1e3)}clearPingTimeout(){this.pingTimeout&&Rt.clearTimeout(this.pingTimeout)}startPingInterval(){if(this.clearPingInterval(),this.resetPingTimeout(),!this.pingIntervalDuration){this.log.warn("ping interval duration not set",this.logContext);return}this.log.debug("start ping interval",this.logContext),this.pingInterval=Rt.setInterval(()=>{this.sendPing()},this.pingIntervalDuration*1e3)}clearPingInterval(){this.log.debug("clearing ping interval",this.logContext),this.clearPingTimeout(),this.pingInterval&&Rt.clearInterval(this.pingInterval)}handleSignalConnected(e,i,s){this.state=Je.CONNECTED,clearTimeout(i),this.startPingInterval(),this.startReadingLoop(e.readable.getReader(),s)}validateFirstMessage(e,i){var s,o,l,d,u;return((s=e.message)===null||s===void 0?void 0:s.case)==="join"?{isValid:!0,response:e.message.value}:this.state===Je.RECONNECTING&&((o=e.message)===null||o===void 0?void 0:o.case)!=="leave"?((l=e.message)===null||l===void 0?void 0:l.case)==="reconnect"?{isValid:!0,response:e.message.value}:(this.log.debug("declaring signal reconnected without reconnect response received",this.logContext),{isValid:!0,response:void 0,shouldProcessFirstMessage:!0}):this.isEstablishingConnection&&((d=e.message)===null||d===void 0?void 0:d.case)==="leave"?{isValid:!1,error:me.leaveRequest("Received leave request while trying to (re)connect",e.message.value.reason)}:i?{isValid:!1,error:me.internal("Unexpected first message")}:{isValid:!1,error:me.internal("did not receive join response, got ".concat((u=e.message)===null||u===void 0?void 0:u.case," instead"))}}handleConnectionError(e,i){return _(this,void 0,void 0,function*(){try{const s=yield fetch(i);switch(s.status){case 404:return me.serviceNotFound("v1 RTC path not found. Consider upgrading your LiveKit server version","v0-rtc");case 401:case 403:const o=yield s.text();return me.notAllowed(o,s.status);default:break}return e instanceof me?e:me.internal("Encountered unknown websocket error during connection: ".concat(e),{status:s.status,statusText:s.statusText})}catch(s){return s instanceof me?s:me.serverUnreachable(s instanceof Error?s.message:"server was not reachable")}})}}function g0(a){const e={type:"offer",sdp:a.sdp};switch(a.type){case"answer":case"offer":case"pranswer":case"rollback":e.type=a.type;break}return e}function ks(a,e){return new $i({sdp:a.sdp,type:a.type,id:e})}function kM(a,e,i){var s;const o=new URLSearchParams;return o.set("access_token",a),i.reconnect&&(o.set("reconnect","1"),i.sid&&o.set("sid",i.sid)),o.set("auto_subscribe",i.autoSubscribe?"1":"0"),o.set("sdk",qn()?"reactnative":"js"),o.set("version",e.version),o.set("protocol",e.protocol.toString()),e.deviceModel&&o.set("device_model",e.deviceModel),e.os&&o.set("os",e.os),e.osVersion&&o.set("os_version",e.osVersion),e.browser&&o.set("browser",e.browser),e.browserVersion&&o.set("browser_version",e.browserVersion),i.adaptiveStream&&o.set("adaptive_stream","1"),i.reconnectReason&&o.set("reconnect_reason",i.reconnectReason.toString()),!((s=navigator.connection)===null||s===void 0)&&s.type&&o.set("network",navigator.connection.type),o}function EM(a,e,i){const s=new URLSearchParams;s.set("access_token",a);const o=new tR({clientInfo:e,connectionSettings:new gS({autoSubscribe:!!i.autoSubscribe,adaptiveStream:!!i.adaptiveStream}),reconnect:!!i.reconnect,participantSid:i.sid?i.sid:void 0});i.reconnectReason&&(o.reconnectReason=i.reconnectReason);const l=new nR({joinRequest:o.toBinary()});return s.set("join_request",btoa(new TextDecoder("utf-8").decode(l.toBinary()))),s}class v0{constructor(){this.buffer=[],this._totalSize=0}push(e){this.buffer.push(e),this._totalSize+=e.data.byteLength}pop(){const e=this.buffer.shift();return e&&(this._totalSize-=e.data.byteLength),e}getAll(){return this.buffer.slice()}popToSequence(e){for(;this.buffer.length>0&&this.buffer[0].sequence<=e;)this.pop()}alignBufferedAmount(e){for(;this.buffer.length>0;){const i=this.buffer[0];if(this._totalSize-i.data.byteLength<=e)break;this.pop()}}get length(){return this.buffer.length}}class _M{constructor(e){this._map=new Map,this._lastCleanup=0,this.ttl=e}set(e,i){const s=Date.now();s-this._lastCleanup>this.ttl/2&&this.cleanup();const o=s+this.ttl;return this._map.set(e,{value:i,expiresAt:o}),this}get(e){const i=this._map.get(e);if(i){if(i.expiresAt<Date.now()){this._map.delete(e);return}return i.value}}has(e){const i=this._map.get(e);return i?i.expiresAt<Date.now()?(this._map.delete(e),!1):!0:!1}delete(e){return this._map.delete(e)}clear(){this._map.clear()}cleanup(){const e=Date.now();for(const[i,s]of this._map.entries())s.expiresAt<e&&this._map.delete(i);this._lastCleanup=e}get size(){return this.cleanup(),this._map.size}forEach(e){this.cleanup();for(const[i,s]of this._map.entries())s.expiresAt>=Date.now()&&e(s.value,i,this.asValueMap())}map(e){this.cleanup();const i=[],s=this.asValueMap();for(const[o,l]of s.entries())i.push(e(l,o,s));return i}asValueMap(){const e=new Map;for(const[i,s]of this._map.entries())s.expiresAt>=Date.now()&&e.set(i,s.value);return e}}var En={},oh={},lh={exports:{}},y0;function Tf(){if(y0)return lh.exports;y0=1;var a=lh.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return e.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return e.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return e.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var i="candidate:%s %d %s %d %s %d typ %s";return i+=e.raddr!=null?" raddr %s rport %d":"%v%v",i+=e.tcptype!=null?" tcptype %s":"%v",e.generation!=null&&(i+=" generation %d"),i+=e["network-id"]!=null?" network-id %d":"%v",i+=e["network-cost"]!=null?" network-cost %d":"%v",i}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var i="ssrc:%d";return e.attribute!=null&&(i+=" %s",e.value!=null&&(i+=":%s")),i}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return e.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(e.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var i="mediaclk:";return i+=e.id!=null?"id=%s %s":"%v%s",i+=e.mediaClockValue!=null?"=%s":"",i+=e.rateNumerator!=null?" rate=%s":"",i+=e.rateDenominator!=null?"/%s":"",i}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};return Object.keys(a).forEach(function(e){var i=a[e];i.forEach(function(s){s.reg||(s.reg=/(.*)/),s.format||(s.format="%s")})}),lh.exports}var b0;function wM(){return b0||(b0=1,(function(a){var e=function(u){return String(Number(u))===u?Number(u):u},i=function(u,h,m,g){if(g&&!m)h[g]=e(u[1]);else for(var y=0;y<m.length;y+=1)u[y+1]!=null&&(h[m[y]]=e(u[y+1]))},s=function(u,h,m){var g=u.name&&u.names;u.push&&!h[u.push]?h[u.push]=[]:g&&!h[u.name]&&(h[u.name]={});var y=u.push?{}:g?h[u.name]:h;i(m.match(u.reg),y,u.names,u.name),u.push&&h[u.push].push(y)},o=Tf(),l=RegExp.prototype.test.bind(/^([a-z])=(.*)/);a.parse=function(u){var h={},m=[],g=h;return u.split(/(\r\n|\r|\n)/).filter(l).forEach(function(y){var S=y[0],T=y.slice(2);S==="m"&&(m.push({rtp:[],fmtp:[]}),g=m[m.length-1]);for(var x=0;x<(o[S]||[]).length;x+=1){var E=o[S][x];if(E.reg.test(T))return s(E,g,T)}}),h.media=m,h};var d=function(u,h){var m=h.split(/=(.+)/,2);return m.length===2?u[m[0]]=e(m[1]):m.length===1&&h.length>1&&(u[m[0]]=void 0),u};a.parseParams=function(u){return u.split(/;\s?/).reduce(d,{})},a.parseFmtpConfig=a.parseParams,a.parsePayloads=function(u){return u.toString().split(" ").map(Number)},a.parseRemoteCandidates=function(u){for(var h=[],m=u.split(" ").map(e),g=0;g<m.length;g+=3)h.push({component:m[g],ip:m[g+1],port:m[g+2]});return h},a.parseImageAttributes=function(u){return u.split(" ").map(function(h){return h.substring(1,h.length-1).split(",").reduce(d,{})})},a.parseSimulcastStreamList=function(u){return u.split(";").map(function(h){return h.split(",").map(function(m){var g,y=!1;return m[0]!=="~"?g=e(m):(g=e(m.substring(1,m.length)),y=!0),{scid:g,paused:y}})})}})(oh)),oh}var ch,S0;function xM(){if(S0)return ch;S0=1;var a=Tf(),e=/%[sdv%]/g,i=function(d){var u=1,h=arguments,m=h.length;return d.replace(e,function(g){if(u>=m)return g;var y=h[u];switch(u+=1,g){case"%%":return"%";case"%s":return String(y);case"%d":return Number(y);case"%v":return""}})},s=function(d,u,h){var m=u.format instanceof Function?u.format(u.push?h:h[u.name]):u.format,g=[d+"="+m];if(u.names)for(var y=0;y<u.names.length;y+=1){var S=u.names[y];u.name?g.push(h[u.name][S]):g.push(h[u.names[y]])}else g.push(h[u.name]);return i.apply(null,g)},o=["v","o","s","i","u","e","p","c","b","t","r","z","a"],l=["i","c","b","a"];return ch=function(d,u){u=u||{},d.version==null&&(d.version=0),d.name==null&&(d.name=" "),d.media.forEach(function(y){y.payloads==null&&(y.payloads="")});var h=u.outerOrder||o,m=u.innerOrder||l,g=[];return h.forEach(function(y){a[y].forEach(function(S){S.name in d&&d[S.name]!=null?g.push(s(y,S,d)):S.push in d&&d[S.push]!=null&&d[S.push].forEach(function(T){g.push(s(y,S,T))})})}),d.media.forEach(function(y){g.push(s("m",a.m[0],y)),m.forEach(function(S){a[S].forEach(function(T){T.name in y&&y[T.name]!=null?g.push(s(S,T,y)):T.push in y&&y[T.push]!=null&&y[T.push].forEach(function(x){g.push(s(S,T,x))})})})}),g.join(`\r
`)+`\r
`},ch}var C0;function RM(){if(C0)return En;C0=1;var a=wM(),e=xM(),i=Tf();return En.grammar=i,En.write=e,En.parse=a.parse,En.parseParams=a.parseParams,En.parseFmtpConfig=a.parseFmtpConfig,En.parsePayloads=a.parsePayloads,En.parseRemoteCandidates=a.parseRemoteCandidates,En.parseImageAttributes=a.parseImageAttributes,En.parseSimulcastStreamList=a.parseSimulcastStreamList,En}var Yi=RM();function kf(a,e,i){var s,o,l;e===void 0&&(e=50),i===void 0&&(i={});var d=(s=i.isImmediate)!=null&&s,u=(o=i.callback)!=null&&o,h=i.maxWait,m=Date.now(),g=[];function y(){if(h!==void 0){var T=Date.now()-m;if(T+e>=h)return h-T}return e}var S=function(){var T=[].slice.call(arguments),x=this;return new Promise(function(E,k){var R=d&&l===void 0;if(l!==void 0&&clearTimeout(l),l=setTimeout(function(){if(l=void 0,m=Date.now(),!d){var L=a.apply(x,T);u&&u(L),g.forEach(function(D){return(0,D.resolve)(L)}),g=[]}},y()),R){var O=a.apply(x,T);return u&&u(O),E(O)}g.push({resolve:E,reject:k})})};return S.cancel=function(T){l!==void 0&&clearTimeout(l),g.forEach(function(x){return(0,x.reject)(T)}),g=[]},S}const MM=.7,AM=20,xa={NegotiationStarted:"negotiationStarted",NegotiationComplete:"negotiationComplete",RTPVideoPayloadTypes:"rtpVideoPayloadTypes"};class T0 extends Hn.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var s;super(),this.log=Se,this.ddExtID=0,this.latestOfferId=0,this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=kf(o=>_(this,void 0,void 0,function*(){this.emit(xa.NegotiationStarted);try{yield this.createAndSendOffer()}catch(l){if(o)o(l);else throw l}}),AM),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.log=Bn((s=i.loggerName)!==null&&s!==void 0?s:bn.PCTransport),this.loggerOptions=i,this.config=e,this._pc=this.createPC(),this.offerLock=new It}createPC(){const e=new RTCPeerConnection(this.config);return e.onicecandidate=i=>{var s;i.candidate&&((s=this.onIceCandidate)===null||s===void 0||s.call(this,i.candidate))},e.onicecandidateerror=i=>{var s;(s=this.onIceCandidateError)===null||s===void 0||s.call(this,i)},e.oniceconnectionstatechange=()=>{var i;(i=this.onIceConnectionStateChange)===null||i===void 0||i.call(this,e.iceConnectionState)},e.onsignalingstatechange=()=>{var i;(i=this.onSignalingStatechange)===null||i===void 0||i.call(this,e.signalingState)},e.onconnectionstatechange=()=>{var i;(i=this.onConnectionStateChange)===null||i===void 0||i.call(this,e.connectionState)},e.ondatachannel=i=>{var s;(s=this.onDataChannel)===null||s===void 0||s.call(this,i)},e.ontrack=i=>{var s;(s=this.onTrack)===null||s===void 0||s.call(this,i)},e}get logContext(){var e,i;return Object.assign({},(i=(e=this.loggerOptions).loggerContextCb)===null||i===void 0?void 0:i.call(e))}get isICEConnected(){return this._pc!==null&&(this.pc.iceConnectionState==="connected"||this.pc.iceConnectionState==="completed")}addIceCandidate(e){return _(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)})}setRemoteDescription(e,i){return _(this,void 0,void 0,function*(){var s;if(e.type==="answer"&&this.latestOfferId>0&&i>0&&i!==this.latestOfferId)return this.log.warn("ignoring answer for old offer",Object.assign(Object.assign({},this.logContext),{offerId:i,latestOfferId:this.latestOfferId})),!1;let o;if(e.type==="offer"){let{stereoMids:l,nackMids:d}=NM(e);this.remoteStereoMids=l,this.remoteNackMids=d}else if(e.type==="answer"){const l=Yi.parse((s=e.sdp)!==null&&s!==void 0?s:"");l.media.forEach(d=>{const u=Ef(d.mid);d.type==="audio"&&this.trackBitrates.some(h=>{if(!h.transceiver||u!=h.transceiver.mid)return!1;let m=0;if(d.rtp.some(y=>y.codec.toUpperCase()===h.codec.toUpperCase()?(m=y.payload,!0):!1),m===0)return!0;let g=!1;for(const y of d.fmtp)if(y.payload===m){y.config=y.config.split(";").filter(S=>!S.includes("maxaveragebitrate")).join(";"),h.maxbr>0&&(y.config+=";maxaveragebitrate=".concat(h.maxbr*1e3)),g=!0;break}return g||h.maxbr>0&&d.fmtp.push({payload:m,config:"maxaveragebitrate=".concat(h.maxbr*1e3)}),!0})}),o=Yi.write(l)}return yield this.setMungedSDP(e,o,!0),this.pendingCandidates.forEach(l=>{this.pc.addIceCandidate(l)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate?(this.renegotiate=!1,yield this.createAndSendOffer()):e.type==="answer"&&(this.emit(xa.NegotiationComplete),e.sdp&&Yi.parse(e.sdp).media.forEach(d=>{d.type==="video"&&this.emit(xa.RTPVideoPayloadTypes,d.rtp)})),!0})}createAndSendOffer(e){return _(this,void 0,void 0,function*(){var i;const s=yield this.offerLock.lock();try{if(this.onOffer===void 0)return;if(e?.iceRestart&&(this.log.debug("restarting ICE",this.logContext),this.restartingIce=!0),this._pc&&this._pc.signalingState==="have-local-offer"){const u=this._pc.remoteDescription;if(e?.iceRestart&&u)yield this._pc.setRemoteDescription(u);else{this.renegotiate=!0,this.log.debug("requesting renegotiation",Object.assign({},this.logContext));return}}else if(!this._pc||this._pc.signalingState==="closed"){this.log.warn("could not createOffer with closed peer connection",this.logContext);return}this.log.debug("starting to negotiate",this.logContext);const o=this.latestOfferId+1;this.latestOfferId=o;const l=yield this.pc.createOffer(e);this.log.debug("original offer",Object.assign({sdp:l.sdp},this.logContext));const d=Yi.parse((i=l.sdp)!==null&&i!==void 0?i:"");if(d.media.forEach(u=>{E0(u),u.type==="audio"?k0(u,["all"],[]):u.type==="video"&&this.trackBitrates.some(h=>{if(!u.msid||!h.cid||!u.msid.includes(h.cid))return!1;let m=0;if(u.rtp.some(y=>y.codec.toUpperCase()===h.codec.toUpperCase()?(m=y.payload,!0):!1),m===0||(Rn(h.codec)&&!Aa()&&this.ensureVideoDDExtensionForSVC(u,d),!Rn(h.codec)))return!0;const g=Math.round(h.maxbr*MM);for(const y of u.fmtp)if(y.payload===m){y.config.includes("x-google-start-bitrate")||(y.config+=";x-google-start-bitrate=".concat(g));break}return!0})}),this.latestOfferId>o){this.log.warn("latestOfferId mismatch",Object.assign(Object.assign({},this.logContext),{latestOfferId:this.latestOfferId,offerId:o}));return}yield this.setMungedSDP(l,Yi.write(d)),this.onOffer(l,this.latestOfferId)}finally{s()}})}createAndSetAnswer(){return _(this,void 0,void 0,function*(){var e;const i=yield this.pc.createAnswer(),s=Yi.parse((e=i.sdp)!==null&&e!==void 0?e:"");return s.media.forEach(o=>{E0(o),o.type==="audio"&&k0(o,this.remoteStereoMids,this.remoteNackMids)}),yield this.setMungedSDP(i,Yi.write(s)),i})}createDataChannel(e,i){return this.pc.createDataChannel(e,i)}addTransceiver(e,i){return this.pc.addTransceiver(e,i)}addTransceiverOfKind(e,i){return this.pc.addTransceiver(e,i)}addTrack(e){if(!this._pc)throw new ut("PC closed, cannot add track");return this._pc.addTrack(e)}setTrackCodecBitrate(e){this.trackBitrates.push(e)}setConfiguration(e){var i;if(!this._pc)throw new ut("PC closed, cannot configure");return(i=this._pc)===null||i===void 0?void 0:i.setConfiguration(e)}canRemoveTrack(){var e;return!!(!((e=this._pc)===null||e===void 0)&&e.removeTrack)}removeTrack(e){var i;return(i=this._pc)===null||i===void 0?void 0:i.removeTrack(e)}getConnectionState(){var e,i;return(i=(e=this._pc)===null||e===void 0?void 0:e.connectionState)!==null&&i!==void 0?i:"closed"}getICEConnectionState(){var e,i;return(i=(e=this._pc)===null||e===void 0?void 0:e.iceConnectionState)!==null&&i!==void 0?i:"closed"}getSignallingState(){var e,i;return(i=(e=this._pc)===null||e===void 0?void 0:e.signalingState)!==null&&i!==void 0?i:"closed"}getTransceivers(){var e,i;return(i=(e=this._pc)===null||e===void 0?void 0:e.getTransceivers())!==null&&i!==void 0?i:[]}getSenders(){var e,i;return(i=(e=this._pc)===null||e===void 0?void 0:e.getSenders())!==null&&i!==void 0?i:[]}getLocalDescription(){var e;return(e=this._pc)===null||e===void 0?void 0:e.localDescription}getRemoteDescription(){var e;return(e=this.pc)===null||e===void 0?void 0:e.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){return _(this,void 0,void 0,function*(){var e;if(!this._pc)return;let i="";const s=new Map,o=new Map;if((yield this._pc.getStats()).forEach(u=>{switch(u.type){case"transport":i=u.selectedCandidatePairId;break;case"candidate-pair":i===""&&u.selected&&(i=u.id),s.set(u.id,u);break;case"remote-candidate":o.set(u.id,"".concat(u.address,":").concat(u.port));break}}),i==="")return;const d=(e=s.get(i))===null||e===void 0?void 0:e.remoteCandidateId;if(d!==void 0)return o.get(d)})}setMungedSDP(e,i,s){return _(this,void 0,void 0,function*(){if(i){const o=e.sdp;e.sdp=i;try{this.log.debug("setting munged ".concat(s?"remote":"local"," description"),this.logContext),s?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e);return}catch(l){this.log.warn("not able to set ".concat(e.type,", falling back to unmodified sdp"),Object.assign(Object.assign({},this.logContext),{error:l,sdp:i})),e.sdp=o}}try{s?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e)}catch(o){let l="unknown error";o instanceof Error?l=o.message:typeof o=="string"&&(l=o);const d={error:l,sdp:e.sdp};throw!s&&this.pc.remoteDescription&&(d.remoteSdp=this.pc.remoteDescription),this.log.error("unable to set ".concat(e.type),Object.assign(Object.assign({},this.logContext),{fields:d})),new _a(l)}})}ensureVideoDDExtensionForSVC(e,i){var s,o;if(!((s=e.ext)===null||s===void 0?void 0:s.some(d=>d.uri===s0))){if(this.ddExtID===0){let d=0;i.media.forEach(u=>{var h;u.type==="video"&&((h=u.ext)===null||h===void 0||h.forEach(m=>{m.value>d&&(d=m.value)}))}),this.ddExtID=d+1}(o=e.ext)===null||o===void 0||o.push({value:this.ddExtID,uri:s0})}}}function k0(a,e,i){const s=Ef(a.mid);let o=0;a.rtp.some(l=>l.codec==="opus"?(o=l.payload,!0):!1),o>0&&(a.rtcpFb||(a.rtcpFb=[]),i.includes(s)&&!a.rtcpFb.some(l=>l.payload===o&&l.type==="nack")&&a.rtcpFb.push({payload:o,type:"nack"}),(e.includes(s)||e.length===1&&e[0]==="all")&&a.fmtp.some(l=>l.payload===o?(l.config.includes("stereo=1")||(l.config+=";stereo=1"),!0):!1))}function NM(a){var e;const i=[],s=[],o=Yi.parse((e=a.sdp)!==null&&e!==void 0?e:"");let l=0;return o.media.forEach(d=>{var u;const h=Ef(d.mid);d.type==="audio"&&(d.rtp.some(m=>m.codec==="opus"?(l=m.payload,!0):!1),!((u=d.rtcpFb)===null||u===void 0)&&u.some(m=>m.payload===l&&m.type==="nack")&&s.push(h),d.fmtp.some(m=>m.payload===l?(m.config.includes("sprop-stereo=1")&&i.push(h),!0):!1))}),{stereoMids:i,nackMids:s}}function E0(a){if(a.connection){const e=a.connection.ip.indexOf(":")>=0;(a.connection.version===4&&e||a.connection.version===6&&!e)&&(a.connection.ip="0.0.0.0",a.connection.version=4)}}function Ef(a){return typeof a=="number"?a.toFixed(0):a}const Bh="vp8",DM={audioPreset:Ah.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:yf.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:Bh,backupCodec:!0,preConnectBuffer:!1},aC={deviceId:{ideal:"default"},autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0,voiceIsolation:!0},sC={deviceId:{ideal:"default"},resolution:Wr.h720.resolution},OM={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new uR,disconnectOnPageLeave:!0,webAudioMix:!1,singlePeerConnection:!0},_f={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};var tt;(function(a){a[a.NEW=0]="NEW",a[a.CONNECTING=1]="CONNECTING",a[a.CONNECTED=2]="CONNECTED",a[a.FAILED=3]="FAILED",a[a.CLOSING=4]="CLOSING",a[a.CLOSED=5]="CLOSED"})(tt||(tt={}));class PM{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}get mode(){return this._mode}constructor(e,i,s){var o;this.peerConnectionTimeout=_f.peerConnectionTimeout,this.log=Se,this.updateState=()=>{var l,d;const u=this.state,h=this.requiredTransports.map(m=>m.getConnectionState());h.every(m=>m==="connected")?this.state=tt.CONNECTED:h.some(m=>m==="failed")?this.state=tt.FAILED:h.some(m=>m==="connecting")?this.state=tt.CONNECTING:h.every(m=>m==="closed")?this.state=tt.CLOSED:h.some(m=>m==="closed")?this.state=tt.CLOSING:h.every(m=>m==="new")&&(this.state=tt.NEW),u!==this.state&&(this.log.debug("pc state change: from ".concat(tt[u]," to ").concat(tt[this.state]),this.logContext),(l=this.onStateChange)===null||l===void 0||l.call(this,this.state,this.publisher.getConnectionState(),(d=this.subscriber)===null||d===void 0?void 0:d.getConnectionState()))},this.log=Bn((o=s.loggerName)!==null&&o!==void 0?o:bn.PCManager),this.loggerOptions=s,this.isPublisherConnectionRequired=i!=="subscriber-primary",this.isSubscriberConnectionRequired=i==="subscriber-primary",this.publisher=new T0(e,s),this._mode=i,i!=="publisher-only"&&(this.subscriber=new T0(e,s),this.subscriber.onConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.subscriber.onIceCandidate=l=>{var d;(d=this.onIceCandidate)===null||d===void 0||d.call(this,l,xn.SUBSCRIBER)},this.subscriber.onDataChannel=l=>{var d;(d=this.onDataChannel)===null||d===void 0||d.call(this,l)},this.subscriber.onTrack=l=>{var d;(d=this.onTrack)===null||d===void 0||d.call(this,l)}),this.publisher.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=l=>{var d;(d=this.onIceCandidate)===null||d===void 0||d.call(this,l,xn.PUBLISHER)},this.publisher.onTrack=l=>{var d;(d=this.onTrack)===null||d===void 0||d.call(this,l)},this.publisher.onOffer=(l,d)=>{var u;(u=this.onPublisherOffer)===null||u===void 0||u.call(this,l,d)},this.state=tt.NEW,this.connectionLock=new It,this.remoteOfferLock=new It}get logContext(){var e,i;return Object.assign({},(i=(e=this.loggerOptions).loggerContextCb)===null||i===void 0?void 0:i.call(e))}requirePublisher(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isPublisherConnectionRequired=e,this.updateState()}createAndSendPublisherOffer(e){return this.publisher.createAndSendOffer(e)}setPublisherAnswer(e,i){return this.publisher.setRemoteDescription(e,i)}removeTrack(e){return this.publisher.removeTrack(e)}close(){return _(this,void 0,void 0,function*(){var e;if(this.publisher&&this.publisher.getSignallingState()!=="closed"){const i=this.publisher;for(const s of i.getSenders())try{i.canRemoveTrack()&&i.removeTrack(s)}catch(o){this.log.warn("could not removeTrack",Object.assign(Object.assign({},this.logContext),{error:o}))}}yield Promise.all([this.publisher.close(),(e=this.subscriber)===null||e===void 0?void 0:e.close()]),this.updateState()})}triggerIceRestart(){return _(this,void 0,void 0,function*(){this.subscriber&&(this.subscriber.restartingIce=!0),this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))})}addIceCandidate(e,i){return _(this,void 0,void 0,function*(){var s;i===xn.PUBLISHER?yield this.publisher.addIceCandidate(e):yield(s=this.subscriber)===null||s===void 0?void 0:s.addIceCandidate(e)})}createSubscriberAnswerFromOffer(e,i){return _(this,void 0,void 0,function*(){var s,o,l;this.log.debug("received server offer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,signalingState:(s=this.subscriber)===null||s===void 0?void 0:s.getSignallingState().toString()}));const d=yield this.remoteOfferLock.lock();try{return(yield(o=this.subscriber)===null||o===void 0?void 0:o.setRemoteDescription(e,i))?yield(l=this.subscriber)===null||l===void 0?void 0:l.createAndSetAnswer():void 0}finally{d()}})}updateConfiguration(e,i){var s;this.publisher.setConfiguration(e),(s=this.subscriber)===null||s===void 0||s.setConfiguration(e),i&&this.triggerIceRestart()}ensurePCTransportConnection(e,i){return _(this,void 0,void 0,function*(){var s;const o=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&this.publisher.getConnectionState()!=="connected"&&this.publisher.getConnectionState()!=="connecting"&&(this.log.debug("negotiation required, start negotiating",this.logContext),this.publisher.negotiate()),yield Promise.all((s=this.requiredTransports)===null||s===void 0?void 0:s.map(l=>this.ensureTransportConnected(l,e,i)))}finally{o()}})}negotiate(e){return _(this,void 0,void 0,function*(){return new Nt((i,s)=>_(this,void 0,void 0,function*(){let o=setTimeout(()=>{s(new _a("negotiation timed out"))},this.peerConnectionTimeout);const l=()=>{clearTimeout(o),this.publisher.off(xa.NegotiationStarted,u),e.signal.removeEventListener("abort",d)},d=()=>{l(),s(new _a("negotiation aborted"))},u=()=>{e.signal.aborted||(clearTimeout(o),o=setTimeout(()=>{l(),s(new _a("negotiation timed out"))},this.peerConnectionTimeout))};e.signal.addEventListener("abort",d),this.publisher.on(xa.NegotiationStarted,u),this.publisher.once(xa.NegotiationComplete,()=>{l(),i()}),yield this.publisher.negotiate(h=>{l(),h instanceof Error?s(h):s(new Error(String(h)))})}))})}addPublisherTransceiver(e,i){return this.publisher.addTransceiver(e,i)}addPublisherTransceiverOfKind(e,i){return this.publisher.addTransceiverOfKind(e,i)}getMidForReceiver(e){const s=(this.subscriber?this.subscriber.getTransceivers():this.publisher.getTransceivers()).find(o=>o.receiver===e);return s?.mid}addPublisherTrack(e){return this.publisher.addTrack(e)}createPublisherDataChannel(e,i){return this.publisher.createDataChannel(e,i)}getConnectedAddress(e){return e===xn.PUBLISHER?this.publisher.getConnectedAddress():e===xn.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){const e=[];return this.isPublisherConnectionRequired&&e.push(this.publisher),this.isSubscriberConnectionRequired&&this.subscriber&&e.push(this.subscriber),e}ensureTransportConnected(e,i){return _(this,arguments,void 0,function(s,o){var l=this;let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.peerConnectionTimeout;return(function*(){if(s.getConnectionState()!=="connected")return new Promise((h,m)=>_(l,void 0,void 0,function*(){const g=()=>{this.log.warn("abort transport connection",this.logContext),Rt.clearTimeout(y),m(me.cancelled("room connection has been cancelled"))};o?.signal.aborted&&g(),o?.signal.addEventListener("abort",g);const y=Rt.setTimeout(()=>{o?.signal.removeEventListener("abort",g),m(me.internal("could not establish pc connection"))},d);for(;this.state!==tt.CONNECTED;)if(yield Mt(50),o?.signal.aborted){m(me.cancelled("room connection has been cancelled"));return}Rt.clearTimeout(y),o?.signal.removeEventListener("abort",g),h()}))})()})}}const rC=5e3,jM=3e4;class Ne{static fetchRegionSettings(e,i,s){return _(this,void 0,void 0,function*(){const o=yield Ne.fetchLock.lock();try{const l=yield fetch("".concat(IM(e),"/regions"),{headers:{authorization:"Bearer ".concat(i)},signal:s});if(l.ok){const d=aM(l.headers),u=d?d*1e3:rC;return{regionSettings:yield l.json(),updatedAtInMs:Date.now(),maxAgeInMs:u}}else throw l.status===401?me.notAllowed("Could not fetch region settings: ".concat(l.statusText),l.status):me.internal("Could not fetch region settings: ".concat(l.statusText))}catch(l){throw l instanceof me?l:s?.aborted?me.cancelled("Region fetching was aborted"):me.serverUnreachable("Could not fetch region settings, ".concat(l instanceof Error?"".concat(l.name,": ").concat(l.message):l))}finally{o()}})}static scheduleRefetch(e,i,s){return _(this,void 0,void 0,function*(){const o=Ne.settingsTimeouts.get(e.hostname);clearTimeout(o),Ne.settingsTimeouts.set(e.hostname,setTimeout(()=>_(this,void 0,void 0,function*(){try{const l=yield Ne.fetchRegionSettings(e,i);Ne.updateCachedRegionSettings(e,i,l)}catch(l){if(l instanceof me&&l.reason===Qe.NotAllowed){Se.debug("token is not valid, cancelling auto region refresh");return}Se.debug("auto refetching of region settings failed",{error:l}),Ne.scheduleRefetch(e,i,s)}}),s))})}static updateCachedRegionSettings(e,i,s){Ne.cache.set(e.hostname,s),Ne.scheduleRefetch(e,i,s.maxAgeInMs)}static stopRefetch(e){const i=Ne.settingsTimeouts.get(e);i&&(clearTimeout(i),Ne.settingsTimeouts.delete(e))}static scheduleCleanup(e){let i=Ne.connectionTrackers.get(e);i&&(i.cleanupTimeout&&clearTimeout(i.cleanupTimeout),i.cleanupTimeout=setTimeout(()=>{const s=Ne.connectionTrackers.get(e);s&&s.connectionCount===0&&(Se.debug("stopping region refetch after disconnect delay",{hostname:e}),Ne.stopRefetch(e)),s&&(s.cleanupTimeout=void 0)},jM))}static cancelCleanup(e){const i=Ne.connectionTrackers.get(e);i?.cleanupTimeout&&(clearTimeout(i.cleanupTimeout),i.cleanupTimeout=void 0)}notifyConnected(){const e=this.serverUrl.hostname;let i=Ne.connectionTrackers.get(e);i||(i={connectionCount:0},Ne.connectionTrackers.set(e,i)),i.connectionCount++,Ne.cancelCleanup(e)}notifyDisconnected(){const e=this.serverUrl.hostname,i=Ne.connectionTrackers.get(e);i&&(i.connectionCount=Math.max(0,i.connectionCount-1),i.connectionCount===0&&Ne.scheduleCleanup(e))}constructor(e,i){this.attemptedRegions=[],this.serverUrl=new URL(e),this.token=i}updateToken(e){this.token=e}isCloud(){return Ds(this.serverUrl)}getServerUrl(){return this.serverUrl}fetchRegionSettings(e){return _(this,void 0,void 0,function*(){return Ne.fetchRegionSettings(this.serverUrl,this.token,e)})}getNextBestRegionUrl(e){return _(this,void 0,void 0,function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");let i=Ne.cache.get(this.serverUrl.hostname);(!i||Date.now()-i.updatedAtInMs>i.maxAgeInMs)&&(i=yield this.fetchRegionSettings(e),Ne.updateCachedRegionSettings(this.serverUrl,this.token,i));const s=i.regionSettings.regions.filter(o=>!this.attemptedRegions.find(l=>l.url===o.url));if(s.length>0){const o=s[0];return this.attemptedRegions.push(o),Se.debug("next region: ".concat(o.region)),o.url}else return null})}resetAttempts(){this.attemptedRegions=[]}setServerReportedRegions(e){Ne.updateCachedRegionSettings(this.serverUrl,this.token,e)}}Ne.cache=new Map;Ne.settingsTimeouts=new Map;Ne.connectionTrackers=new Map;Ne.fetchLock=new It;function IM(a){return"".concat(a.protocol.replace("ws","http"),"//").concat(a.host,"/settings")}class rt extends Error{constructor(e,i,s){super(i),this.code=e,this.message=_0(i,rt.MAX_MESSAGE_BYTES),this.data=s?_0(s,rt.MAX_DATA_BYTES):void 0}static fromProto(e){return new rt(e.code,e.message,e.data)}toProto(){return new Jb({code:this.code,message:this.message,data:this.data})}static builtIn(e,i){return new rt(rt.ErrorCode[e],rt.ErrorMessage[e],i)}}rt.MAX_MESSAGE_BYTES=256;rt.MAX_DATA_BYTES=15360;rt.ErrorCode={APPLICATION_ERROR:1500,CONNECTION_TIMEOUT:1501,RESPONSE_TIMEOUT:1502,RECIPIENT_DISCONNECTED:1503,RESPONSE_PAYLOAD_TOO_LARGE:1504,SEND_FAILED:1505,UNSUPPORTED_METHOD:1400,RECIPIENT_NOT_FOUND:1401,REQUEST_PAYLOAD_TOO_LARGE:1402,UNSUPPORTED_SERVER:1403,UNSUPPORTED_VERSION:1404};rt.ErrorMessage={APPLICATION_ERROR:"Application error in method handler",CONNECTION_TIMEOUT:"Connection timeout",RESPONSE_TIMEOUT:"Response timeout",RECIPIENT_DISCONNECTED:"Recipient disconnected",RESPONSE_PAYLOAD_TOO_LARGE:"Response payload too large",SEND_FAILED:"Failed to send",UNSUPPORTED_METHOD:"Method not supported at destination",RECIPIENT_NOT_FOUND:"Recipient not found",REQUEST_PAYLOAD_TOO_LARGE:"Request payload too large",UNSUPPORTED_SERVER:"RPC not supported by server",UNSUPPORTED_VERSION:"Unsupported RPC version"};const oC=15360;function wf(a){return new TextEncoder().encode(a).length}function _0(a,e){if(wf(a)<=e)return a;let i=0,s=a.length;const o=new TextEncoder;for(;i<s;){const l=Math.floor((i+s+1)/2);o.encode(a.slice(0,l)).length<=e?i=l:s=l-1}return a.slice(0,i)}const xf=2e3;function yc(a,e){if(!e)return 0;let i,s;return"bytesReceived"in a?(i=a.bytesReceived,s=e.bytesReceived):"bytesSent"in a&&(i=a.bytesSent,s=e.bytesSent),i===void 0||s===void 0||a.timestamp===void 0||e.timestamp===void 0?0:(i-s)*8*1e3/(a.timestamp-e.timestamp)}const Rf=typeof MediaRecorder<"u";class LM{constructor(){throw new Error("MediaRecorder is not available in this environment")}}const UM=Rf?MediaRecorder:LM;class BM extends UM{constructor(e,i){if(!Rf)throw new Error("MediaRecorder is not available in this environment");super(new MediaStream([e.mediaStreamTrack]),i);let s,o;const l=()=>o===void 0,d=()=>{this.removeEventListener("dataavailable",s),this.removeEventListener("stop",d),this.removeEventListener("error",u),o?.close(),o=void 0},u=h=>{o?.error(h),this.removeEventListener("dataavailable",s),this.removeEventListener("stop",d),this.removeEventListener("error",u),o=void 0};this.byteStream=new ReadableStream({start:h=>{o=h,s=m=>_(this,void 0,void 0,function*(){let g;if(m.data.arrayBuffer){const y=yield m.data.arrayBuffer();g=new Uint8Array(y)}else if(m.data.byteArray)g=m.data.byteArray;else throw new Error("no data available!");l()||h.enqueue(g)}),this.addEventListener("dataavailable",s)},cancel:()=>{d()}}),this.addEventListener("stop",d),this.addEventListener("error",u)}}function qM(){return Rf}const zM=1e3,FM=1e4;class lC extends Q{get sender(){return this._sender}set sender(e){this._sender=e}get constraints(){return this._constraints}get hasPreConnectBuffer(){return!!this.localTrackRecorder}constructor(e,i,s){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,l=arguments.length>4?arguments[4]:void 0;super(e,i,l),this.manuallyStopped=!1,this.pendingDeviceChange=!1,this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch(()=>this.log.debug("track mute bounce got cancelled by an unmute event",this.logContext)),this.debouncedTrackMuteHandler=kf(()=>_(this,void 0,void 0,function*(){yield this.pauseUpstream()}),5e3),this.handleTrackUnmuteEvent=()=>_(this,void 0,void 0,function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()}),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit($.Ended,this)},this.reacquireTrack=!1,this.providedByUser=o,this.muteLock=new It,this.pauseUpstreamLock=new It,this.trackChangeLock=new It,this.trackChangeLock.lock().then(d=>_(this,void 0,void 0,function*(){try{yield this.setMediaStreamTrack(e,!0)}finally{d()}})),this._constraints=e.getConstraints(),s&&(this._constraints=s)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==Q.Kind.Video)return;const{width:e,height:i}=this._mediaStreamTrack.getSettings();if(e&&i)return{width:e,height:i}}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var e,i;return(i=(e=this.processor)===null||e===void 0?void 0:e.processedTrack)!==null&&i!==void 0?i:this._mediaStreamTrack}get isLocal(){return!0}getSourceTrackSettings(){return this._mediaStreamTrack.getSettings()}setMediaStreamTrack(e,i){return _(this,void 0,void 0,function*(){var s;if(e===this._mediaStreamTrack&&!i)return;this._mediaStreamTrack&&(this.attachedElements.forEach(l=>{xs(this._mediaStreamTrack,l)}),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent)),this.mediaStream=new MediaStream([e]),e&&(e.addEventListener("ended",this.handleEnded),e.addEventListener("mute",this.handleTrackMuteEvent),e.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=e.getConstraints());let o;if(this.processor&&e){if(this.log.debug("restarting processor",this.logContext),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");this.processorElement&&(Ts(e,this.processorElement),this.processorElement.muted=!0),yield this.processor.restart({track:e,kind:this.kind,element:this.processorElement}),o=this.processor.processedTrack}this.sender&&((s=this.sender.transport)===null||s===void 0?void 0:s.state)!=="closed"&&(yield this.sender.replaceTrack(o??e)),!this.providedByUser&&this._mediaStreamTrack!==e&&this._mediaStreamTrack.stop(),this._mediaStreamTrack=e,e&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach(l=>{Ts(o??e,l)}))})}waitForDimensions(){return _(this,arguments,void 0,function(){var e=this;let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:zM;return(function*(){var s;if(e.kind===Q.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");((s=Yt())===null||s===void 0?void 0:s.os)==="iOS"&&(yield Mt(10));const o=Date.now();for(;Date.now()-o<i;){const l=e.dimensions;if(l)return l;yield Mt(50)}throw new pi("unable to get track dimensions after timeout")})()})}setDeviceId(e){return _(this,void 0,void 0,function*(){return this._constraints.deviceId===e&&this._mediaStreamTrack.getSettings().deviceId===wa(e)?!0:(this._constraints.deviceId=e,this.isMuted?(this.pendingDeviceChange=!0,!0):(yield this.restartTrack(),wa(e)===this._mediaStreamTrack.getSettings().deviceId))})}getDeviceId(){return _(this,arguments,void 0,function(){var e=this;let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return(function*(){if(e.source===Q.Source.ScreenShare)return;const{deviceId:s,groupId:o}=e._mediaStreamTrack.getSettings(),l=e.kind===Q.Kind.Audio?"audioinput":"videoinput";return i?Tt.getInstance().normalizeDeviceId(l,s,o):s})()})}mute(){return _(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return _(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}replaceTrack(e,i){return _(this,void 0,void 0,function*(){const s=yield this.trackChangeLock.lock();try{if(!this.sender)throw new pi("unable to replace an unpublished track");let o,l;return typeof i=="boolean"?o=i:i!==void 0&&(o=i.userProvidedTrack,l=i.stopProcessor),this.providedByUser=o??!0,this.log.debug("replace MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(e),l&&this.processor&&(yield this.internalStopProcessor()),this}finally{s()}})}restart(e){return _(this,void 0,void 0,function*(){this.manuallyStopped=!1;const i=yield this.trackChangeLock.lock();try{e||(e=this._constraints);const{deviceId:s,facingMode:o}=e,l=dR(e,["deviceId","facingMode"]);this.log.debug("restarting track with constraints",Object.assign(Object.assign({},this.logContext),{constraints:e}));const d={audio:!1,video:!1};this.kind===Q.Kind.Video?d.video=s||o?{deviceId:s,facingMode:o}:!0:d.audio=s?Object.assign({deviceId:s},l):!0,this.attachedElements.forEach(m=>{xs(this.mediaStreamTrack,m)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const h=(yield navigator.mediaDevices.getUserMedia(d)).getTracks()[0];return this.kind===Q.Kind.Video&&(yield h.applyConstraints(l)),h.addEventListener("ended",this.handleEnded),this.log.debug("re-acquired MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(h),this._constraints=e,this.pendingDeviceChange=!1,this.emit($.Restarted,this),this.manuallyStopped&&(this.log.warn("track was stopped during a restart, stopping restarted track",this.logContext),this.stop()),this}finally{i()}})}setTrackMuted(e){this.log.debug("setting ".concat(this.kind," track ").concat(e?"muted":"unmuted"),this.logContext),!(this.isMuted===e&&this._mediaStreamTrack.enabled!==e)&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?$.Muted:$.Unmuted,this))}get needsReAcquisition(){return this._mediaStreamTrack.readyState!=="live"||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return _(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),eC()&&(this.log.debug("visibility changed, is in Background: ".concat(this.isInBackground),this.logContext),!this.isInBackground&&this.needsReAcquisition&&!this.isUserProvided&&!this.isMuted&&(this.log.debug("track needs to be reacquired, restarting ".concat(this.source),this.logContext),yield this.restart(),this.reacquireTrack=!1))})}stop(){var e;this.manuallyStopped=!0,super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),(e=this.processor)===null||e===void 0||e.destroy(),this.processor=void 0}pauseUpstream(){return _(this,void 0,void 0,function*(){var e;const i=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!0)return;if(!this.sender){this.log.warn("unable to pause upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!0,this.emit($.UpstreamPaused,this);const s=Yt();if(s?.name==="Safari"&&zn(s.version,"12.0")<0)throw new vf("pauseUpstream is not supported on Safari < 12.");((e=this.sender.transport)===null||e===void 0?void 0:e.state)!=="closed"&&(yield this.sender.replaceTrack(null))}finally{i()}})}resumeUpstream(){return _(this,void 0,void 0,function*(){var e;const i=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!1)return;if(!this.sender){this.log.warn("unable to resume upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!1,this.emit($.UpstreamResumed,this),((e=this.sender.transport)===null||e===void 0?void 0:e.state)!=="closed"&&(yield this.sender.replaceTrack(this.mediaStreamTrack))}finally{i()}})}getRTCStatsReport(){return _(this,void 0,void 0,function*(){var e;return!((e=this.sender)===null||e===void 0)&&e.getStats?yield this.sender.getStats():void 0})}setProcessor(e){return _(this,arguments,void 0,function(i){var s=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return(function*(){var l;const d=yield s.trackChangeLock.lock();try{s.log.debug("setting up processor",s.logContext);const u=document.createElement(s.kind),h={kind:s.kind,track:s._mediaStreamTrack,element:u,audioContext:s.audioContext};if(yield i.init(h),s.log.debug("processor initialized",s.logContext),s.processor&&(yield s.internalStopProcessor()),s.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");if(Ts(s._mediaStreamTrack,u),u.muted=!0,u.play().catch(m=>{m instanceof DOMException&&m.name==="AbortError"?(s.log.warn("failed to play processor element, retrying",Object.assign(Object.assign({},s.logContext),{error:m})),setTimeout(()=>{u.play().catch(g=>{s.log.error("failed to play processor element",Object.assign(Object.assign({},s.logContext),{err:g}))})},100)):s.log.error("failed to play processor element",Object.assign(Object.assign({},s.logContext),{error:m}))}),s.processor=i,s.processorElement=u,s.processor.processedTrack){for(const m of s.attachedElements)m!==s.processorElement&&o&&(xs(s._mediaStreamTrack,m),Ts(s.processor.processedTrack,m));yield(l=s.sender)===null||l===void 0?void 0:l.replaceTrack(s.processor.processedTrack)}s.emit($.TrackProcessorUpdate,s.processor)}finally{d()}})()})}getProcessor(){return this.processor}stopProcessor(){return _(this,arguments,void 0,function(){var e=this;let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return(function*(){const s=yield e.trackChangeLock.lock();try{yield e.internalStopProcessor(i)}finally{s()}})()})}internalStopProcessor(){return _(this,arguments,void 0,function(){var e=this;let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return(function*(){var s,o;e.processor&&(e.log.debug("stopping processor",e.logContext),(s=e.processor.processedTrack)===null||s===void 0||s.stop(),yield e.processor.destroy(),e.processor=void 0,i||((o=e.processorElement)===null||o===void 0||o.remove(),e.processorElement=void 0),yield e._mediaStreamTrack.applyConstraints(e._constraints),yield e.setMediaStreamTrack(e._mediaStreamTrack,!0),e.emit($.TrackProcessorUpdate))})()})}startPreConnectBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100;if(!qM()){this.log.warn("MediaRecorder is not available, cannot start preconnect buffer",this.logContext);return}if(this.localTrackRecorder){this.log.warn("preconnect buffer already started");return}else{let i="audio/webm;codecs=opus";MediaRecorder.isTypeSupported(i)||(i="video/mp4"),this.localTrackRecorder=new BM(this,{mimeType:i})}this.localTrackRecorder.start(e),this.autoStopPreConnectBuffer=setTimeout(()=>{this.log.warn("preconnect buffer timed out, stopping recording automatically",this.logContext),this.stopPreConnectBuffer()},FM)}stopPreConnectBuffer(){clearTimeout(this.autoStopPreConnectBuffer),this.localTrackRecorder&&(this.localTrackRecorder.stop(),this.localTrackRecorder=void 0)}getPreConnectBuffer(){var e;return(e=this.localTrackRecorder)===null||e===void 0?void 0:e.byteStream}getPreConnectBufferMimeType(){var e;return(e=this.localTrackRecorder)===null||e===void 0?void 0:e.mimeType}}class nc extends lC{get enhancedNoiseCancellation(){return this.isKrispNoiseFilterEnabled}constructor(e,i){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=arguments.length>3?arguments[3]:void 0,l=arguments.length>4?arguments[4]:void 0;super(e,Q.Kind.Audio,i,s,l),this.stopOnMute=!1,this.isKrispNoiseFilterEnabled=!1,this.monitorSender=()=>_(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let d;try{d=yield this.getSenderStats()}catch(u){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:u}));return}d&&this.prevStats&&(this._currentBitrate=yc(d,this.prevStats)),this.prevStats=d}),this.handleKrispNoiseFilterEnable=()=>{this.isKrispNoiseFilterEnabled=!0,this.log.debug("Krisp noise filter enabled",this.logContext),this.emit($.AudioTrackFeatureUpdate,this,Ct.TF_ENHANCED_NOISE_CANCELLATION,!0)},this.handleKrispNoiseFilterDisable=()=>{this.isKrispNoiseFilterEnabled=!1,this.log.debug("Krisp noise filter disabled",this.logContext),this.emit($.AudioTrackFeatureUpdate,this,Ct.TF_ENHANCED_NOISE_CANCELLATION,!1)},this.audioContext=o,this.checkForSilence()}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return _(this,void 0,void 0,function*(){const i=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===Q.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(this.log.debug("stopping mic track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{i()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return _(this,void 0,void 0,function*(){const i=yield this.muteLock.lock();try{return this.isMuted?(this.source===Q.Source.Microphone&&(this.stopOnMute||this._mediaStreamTrack.readyState==="ended"||this.pendingDeviceChange)&&!this.isUserProvided&&(this.log.debug("reacquiring mic track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this):(this.log.debug("Track already unmuted",this.logContext),this)}finally{i()}})}restartTrack(e){return _(this,void 0,void 0,function*(){let i;if(e){const s=bf({audio:e});typeof s.audio!="boolean"&&(i=s.audio)}yield this.restart(i)})}restart(e){const i=Object.create(null,{restart:{get:()=>super.restart}});return _(this,void 0,void 0,function*(){const s=yield i.restart.call(this,e);return this.checkForSilence(),s})}startMonitor(){Kt()&&(this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},xf)))}setProcessor(e){return _(this,void 0,void 0,function*(){var i;const s=yield this.trackChangeLock.lock();try{if(!qn()&&!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");this.processor&&(yield this.internalStopProcessor());const o={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};this.log.debug("setting up audio processor ".concat(e.name),this.logContext),yield e.init(o),this.processor=e,this.processor.processedTrack&&(yield(i=this.sender)===null||i===void 0?void 0:i.replaceTrack(this.processor.processedTrack),this.processor.processedTrack.addEventListener("enable-lk-krisp-noise-filter",this.handleKrispNoiseFilterEnable),this.processor.processedTrack.addEventListener("disable-lk-krisp-noise-filter",this.handleKrispNoiseFilterDisable)),this.emit($.TrackProcessorUpdate,this.processor)}finally{s()}})}setAudioContext(e){this.audioContext=e}getSenderStats(){return _(this,void 0,void 0,function*(){var e;if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return;const i=yield this.sender.getStats();let s;return i.forEach(o=>{o.type==="outbound-rtp"&&(s={type:"audio",streamId:o.id,packetsSent:o.packetsSent,packetsLost:o.packetsLost,bytesSent:o.bytesSent,timestamp:o.timestamp,roundTripTime:o.roundTripTime,jitter:o.jitter})}),s})}checkForSilence(){return _(this,void 0,void 0,function*(){const e=yield WS(this);return e&&(this.isMuted||this.log.debug("silence detected on local audio track",this.logContext),this.emit($.AudioSilenceDetected)),e})}}function HM(a,e,i){switch(a.kind){case"audio":return new nc(a,e,!1,void 0,i);case"video":return new ic(a,e,!1,i);default:throw new pi("unsupported track type: ".concat(a.kind))}}const VM=Object.values(Wr),GM=Object.values(Nh),KM=Object.values(yf),YM=[Wr.h180,Wr.h360],JM=[Nh.h180,Nh.h360],QM=a=>[{scaleResolutionDownBy:2,fps:a.encoding.maxFramerate}].map(i=>{var s,o;return new Ke(Math.floor(a.width/i.scaleResolutionDownBy),Math.floor(a.height/i.scaleResolutionDownBy),Math.max(15e4,Math.floor(a.encoding.maxBitrate/(Math.pow(i.scaleResolutionDownBy,2)*(((s=a.encoding.maxFramerate)!==null&&s!==void 0?s:30)/((o=i.fps)!==null&&o!==void 0?o:30))))),i.fps,a.encoding.priority)}),qh=["q","h","f"];function zh(a,e,i,s){var o,l;let d=s?.videoEncoding;a&&(d=s?.screenShareEncoding);const u=s?.simulcast,h=s?.scalabilityMode,m=s?.videoCodec;if(!d&&!u&&!h||!e||!i)return[{}];d||(d=WM(a,e,i,m),Se.debug("using video encoding",d));const g=d.maxFramerate,y=new Ke(e,i,d.maxBitrate,d.maxFramerate,d.priority);if(h&&Rn(m)){const x=new cC(h),E=[];if(x.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(h));const k=Yt();if(Zr()||qn()||k?.name==="Chrome"&&zn(k?.version,"113")<0){const R=x.suffix=="h"?2:3,O=KR(k);for(let L=0;L<x.spatial;L+=1)E.push({rid:qh[2-L],maxBitrate:d.maxBitrate/Math.pow(R,L),maxFramerate:y.encoding.maxFramerate,scaleResolutionDownBy:O?Math.pow(2,L):void 0});E[0].scalabilityMode=h}else E.push({maxBitrate:d.maxBitrate,maxFramerate:y.encoding.maxFramerate,scalabilityMode:h});return y.encoding.priority&&(E[0].priority=y.encoding.priority,E[0].networkPriority=y.encoding.priority),Se.debug("using svc encoding",{encodings:E}),E}if(!u)return[d];let S=[];a?S=(o=x0(s?.screenShareSimulcastLayers))!==null&&o!==void 0?o:w0(a,y):S=(l=x0(s?.videoSimulcastLayers))!==null&&l!==void 0?l:w0(a,y);let T;if(S.length>0){const x=S[0];S.length>1&&([,T]=S);const E=Math.max(e,i);if(E>=960&&T)return uh(e,i,[x,T,y],g);if(E>=480)return uh(e,i,[x,y],g)}return uh(e,i,[y])}function XM(a,e,i){var s,o,l,d;if(!i.backupCodec||i.backupCodec===!0||i.backupCodec.codec===i.videoCodec)return;e!==i.backupCodec.codec&&Se.warn("requested a different codec than specified as backup",{serverRequested:e,backup:i.backupCodec.codec}),i.videoCodec=e,i.videoEncoding=i.backupCodec.encoding;const u=a.mediaStreamTrack.getSettings(),h=(s=u.width)!==null&&s!==void 0?s:(o=a.dimensions)===null||o===void 0?void 0:o.width,m=(l=u.height)!==null&&l!==void 0?l:(d=a.dimensions)===null||d===void 0?void 0:d.height;return a.source===Q.Source.ScreenShare&&i.simulcast&&(i.simulcast=!1),zh(a.source===Q.Source.ScreenShare,h,m,i)}function WM(a,e,i,s){const o=ZM(a,e,i);let{encoding:l}=o[0];const d=Math.max(e,i);for(let u=0;u<o.length;u+=1){const h=o[u];if(l=h.encoding,h.width>=d)break}if(s)switch(s){case"av1":case"h265":l=Object.assign({},l),l.maxBitrate=l.maxBitrate*.7;break;case"vp9":l=Object.assign({},l),l.maxBitrate=l.maxBitrate*.85;break}return l}function ZM(a,e,i){if(a)return KM;const s=e>i?e/i:i/e;return Math.abs(s-16/9)<Math.abs(s-4/3)?VM:GM}function w0(a,e){if(a)return QM(e);const{width:i,height:s}=e,o=i>s?i/s:s/i;return Math.abs(o-16/9)<Math.abs(o-4/3)?YM:JM}function uh(a,e,i,s){const o=[];if(i.forEach((l,d)=>{if(d>=qh.length)return;const u=Math.min(a,e),m={rid:qh[d],scaleResolutionDownBy:Math.max(1,u/Math.min(l.width,l.height)),maxBitrate:l.encoding.maxBitrate},g=s&&l.encoding.maxFramerate?Math.min(s,l.encoding.maxFramerate):l.encoding.maxFramerate;g&&(m.maxFramerate=g);const y=Ma()||d===0;l.encoding.priority&&y&&(m.priority=l.encoding.priority,m.networkPriority=l.encoding.priority),o.push(m)}),qn()&&nC()==="ios"){let l;o.forEach(u=>{l?u.maxFramerate&&u.maxFramerate>l&&(l=u.maxFramerate):l=u.maxFramerate});let d=!0;o.forEach(u=>{var h;u.maxFramerate!=l&&(d&&(d=!1,Se.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),Se.info('Setting framerate of encoding "'.concat((h=u.rid)!==null&&h!==void 0?h:"",'" to ').concat(l)),u.maxFramerate=l)})}return o}function x0(a){if(a)return a.sort((e,i)=>{const{encoding:s}=e,{encoding:o}=i;return s.maxBitrate>o.maxBitrate?1:s.maxBitrate<o.maxBitrate?-1:s.maxBitrate===o.maxBitrate&&s.maxFramerate&&o.maxFramerate?s.maxFramerate>o.maxFramerate?1:-1:0})}class cC{constructor(e){const i=e.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!i)throw new Error("invalid scalability mode");if(this.spatial=parseInt(i[1]),this.temporal=parseInt(i[2]),i.length>3)switch(i[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=i[3]}}toString(){var e;return"L".concat(this.spatial,"T").concat(this.temporal).concat((e=this.suffix)!==null&&e!==void 0?e:"")}}function $M(a){return a.source===Q.Source.ScreenShare||a.constraints.height&&wa(a.constraints.height)>=1080?"maintain-resolution":"balanced"}const eA=5e3;class ic extends lC{get sender(){return this._sender}set sender(e){this._sender=e,this.degradationPreference&&this.setDegradationPreference(this.degradationPreference)}constructor(e,i){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=arguments.length>3?arguments[3]:void 0;super(e,Q.Kind.Video,i,s,o),this.simulcastCodecs=new Map,this.degradationPreference="balanced",this.isCpuConstrained=!1,this.optimizeForPerformance=!1,this.monitorSender=()=>_(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let l;try{l=yield this.getSenderStats()}catch(h){this.log.error("could not get video sender stats",Object.assign(Object.assign({},this.logContext),{error:h}));return}const d=new Map(l.map(h=>[h.rid,h])),u=l.some(h=>h.qualityLimitationReason==="cpu");if(u!==this.isCpuConstrained&&(this.isCpuConstrained=u,this.isCpuConstrained&&this.emit($.CpuConstrained)),this.prevStats){let h=0;d.forEach((m,g)=>{var y;const S=(y=this.prevStats)===null||y===void 0?void 0:y.get(g);h+=yc(m,S)}),this._currentBitrate=h}this.prevStats=d}),this.senderLock=new It}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e){var i;if(this.signalClient=e,!Kt())return;const s=(i=this.sender)===null||i===void 0?void 0:i.getParameters();s&&(this.encodings=s.encodings),!this.monitorInterval&&(this.monitorInterval=setInterval(()=>{this.monitorSender()},xf))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(e=>{e.mediaStreamTrack.stop()}),super.stop()}pauseUpstream(){const e=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});return _(this,void 0,void 0,function*(){var i,s,o,l,d;yield e.pauseUpstream.call(this);try{for(var u=!0,h=mi(this.simulcastCodecs.values()),m;m=yield h.next(),i=m.done,!i;u=!0)l=m.value,u=!1,yield(d=l.sender)===null||d===void 0?void 0:d.replaceTrack(null)}catch(g){s={error:g}}finally{try{!u&&!i&&(o=h.return)&&(yield o.call(h))}finally{if(s)throw s.error}}})}resumeUpstream(){const e=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});return _(this,void 0,void 0,function*(){var i,s,o,l,d;yield e.resumeUpstream.call(this);try{for(var u=!0,h=mi(this.simulcastCodecs.values()),m;m=yield h.next(),i=m.done,!i;u=!0){l=m.value,u=!1;const g=l;yield(d=g.sender)===null||d===void 0?void 0:d.replaceTrack(g.mediaStreamTrack)}}catch(g){s={error:g}}finally{try{!u&&!i&&(o=h.return)&&(yield o.call(h))}finally{if(s)throw s.error}}})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return _(this,void 0,void 0,function*(){const i=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===Q.Source.Camera&&!this.isUserProvided&&(this.log.debug("stopping camera track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{i()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return _(this,void 0,void 0,function*(){const i=yield this.muteLock.lock();try{return this.isMuted?(this.source===Q.Source.Camera&&!this.isUserProvided&&(this.log.debug("reacquiring camera track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this):(this.log.debug("Track already unmuted",this.logContext),this)}finally{i()}})}setTrackMuted(e){super.setTrackMuted(e);for(const i of this.simulcastCodecs.values())i.mediaStreamTrack.enabled=!e}getSenderStats(){return _(this,void 0,void 0,function*(){var e;if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return[];const i=[],s=yield this.sender.getStats();return s.forEach(o=>{var l;if(o.type==="outbound-rtp"){const d={type:"video",streamId:o.id,frameHeight:o.frameHeight,frameWidth:o.frameWidth,framesPerSecond:o.framesPerSecond,framesSent:o.framesSent,firCount:o.firCount,pliCount:o.pliCount,nackCount:o.nackCount,packetsSent:o.packetsSent,bytesSent:o.bytesSent,qualityLimitationReason:o.qualityLimitationReason,qualityLimitationDurations:o.qualityLimitationDurations,qualityLimitationResolutionChanges:o.qualityLimitationResolutionChanges,rid:(l=o.rid)!==null&&l!==void 0?l:o.id,retransmittedPacketsSent:o.retransmittedPacketsSent,targetBitrate:o.targetBitrate,timestamp:o.timestamp},u=s.get(o.remoteId);u&&(d.jitter=u.jitter,d.packetsLost=u.packetsLost,d.roundTripTime=u.roundTripTime),i.push(d)}}),i.sort((o,l)=>{var d,u;return((d=l.frameWidth)!==null&&d!==void 0?d:0)-((u=o.frameWidth)!==null&&u!==void 0?u:0)}),i})}setPublishingQuality(e){const i=[];for(let s=sn.LOW;s<=sn.HIGH;s+=1)i.push(new hf({quality:s,enabled:s<=e}));this.log.debug("setting publishing quality. max quality ".concat(e),this.logContext),this.setPublishingLayers(Rn(this.codec),i)}restartTrack(e){return _(this,void 0,void 0,function*(){var i,s,o,l,d;let u;if(e){const y=bf({video:e});typeof y.video!="boolean"&&(u=y.video)}yield this.restart(u),this.isCpuConstrained=!1;try{for(var h=!0,m=mi(this.simulcastCodecs.values()),g;g=yield m.next(),i=g.done,!i;h=!0){l=g.value,h=!1;const y=l;y.sender&&((d=y.sender.transport)===null||d===void 0?void 0:d.state)!=="closed"&&(y.mediaStreamTrack=this.mediaStreamTrack.clone(),yield y.sender.replaceTrack(y.mediaStreamTrack))}}catch(y){s={error:y}}finally{try{!h&&!i&&(o=m.return)&&(yield o.call(m))}finally{if(s)throw s.error}}})}setProcessor(e){const i=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});return _(this,arguments,void 0,function(s){var o=this;let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return(function*(){var d,u,h,m,g,y;if(yield i.setProcessor.call(o,s,l),!((g=o.processor)===null||g===void 0)&&g.processedTrack)try{for(var S=!0,T=mi(o.simulcastCodecs.values()),x;x=yield T.next(),d=x.done,!d;S=!0)m=x.value,S=!1,yield(y=m.sender)===null||y===void 0?void 0:y.replaceTrack(o.processor.processedTrack)}catch(E){u={error:E}}finally{try{!S&&!d&&(h=T.return)&&(yield h.call(T))}finally{if(u)throw u.error}}})()})}setDegradationPreference(e){return _(this,void 0,void 0,function*(){if(this.degradationPreference=e,this.sender)try{this.log.debug("setting degradationPreference to ".concat(e),this.logContext);const i=this.sender.getParameters();i.degradationPreference=e,this.sender.setParameters(i)}catch(i){this.log.warn("failed to set degradationPreference",Object.assign({error:i},this.logContext))}})}addSimulcastTrack(e,i){if(this.simulcastCodecs.has(e)){this.log.error("".concat(e," already added, skipping adding simulcast codec"),this.logContext);return}const s={codec:e,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:i};return this.simulcastCodecs.set(e,s),s}setSimulcastTrackSender(e,i){const s=this.simulcastCodecs.get(e);s&&(s.sender=i,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},eA))}setPublishingCodecs(e){return _(this,void 0,void 0,function*(){var i,s,o,l,d,u,h;if(this.log.debug("setting publishing codecs",Object.assign(Object.assign({},this.logContext),{codecs:e,currentCodec:this.codec})),!this.codec&&e.length>0)return yield this.setPublishingLayers(Rn(e[0].codec),e[0].qualities),[];this.subscribedCodecs=e;const m=[];try{for(i=!0,s=mi(e);o=yield s.next(),l=o.done,!l;i=!0){h=o.value,i=!1;const g=h;if(!this.codec||this.codec===g.codec)yield this.setPublishingLayers(Rn(g.codec),g.qualities);else{const y=this.simulcastCodecs.get(g.codec);if(this.log.debug("try setPublishingCodec for ".concat(g.codec),Object.assign(Object.assign({},this.logContext),{simulcastCodecInfo:y})),!y||!y.sender){for(const S of g.qualities)if(S.enabled){m.push(g.codec);break}}else y.encodings&&(this.log.debug("try setPublishingLayersForSender ".concat(g.codec),this.logContext),yield R0(y.sender,y.encodings,g.qualities,this.senderLock,Rn(g.codec),this.log,this.logContext))}}}catch(g){d={error:g}}finally{try{!i&&!l&&(u=s.return)&&(yield u.call(s))}finally{if(d)throw d.error}}return m})}setPublishingLayers(e,i){return _(this,void 0,void 0,function*(){if(this.optimizeForPerformance){this.log.info("skipping setPublishingLayers due to optimized publishing performance",Object.assign(Object.assign({},this.logContext),{qualities:i}));return}this.log.debug("setting publishing layers",Object.assign(Object.assign({},this.logContext),{qualities:i})),!(!this.sender||!this.encodings)&&(yield R0(this.sender,this.encodings,i,this.senderLock,e,this.log,this.logContext))})}prioritizePerformance(){return _(this,void 0,void 0,function*(){if(!this.sender)throw new Error("sender not found");const e=yield this.senderLock.lock();try{this.optimizeForPerformance=!0;const i=this.sender.getParameters();i.encodings=i.encodings.map((s,o)=>{var l;return Object.assign(Object.assign({},s),{active:o===0,scaleResolutionDownBy:Math.max(1,Math.ceil(((l=this.mediaStreamTrack.getSettings().height)!==null&&l!==void 0?l:360)/360)),scalabilityMode:o===0&&Rn(this.codec)?"L1T3":void 0,maxFramerate:o===0?15:0,maxBitrate:o===0?s.maxBitrate:0})}),this.log.debug("setting performance optimised encodings",Object.assign(Object.assign({},this.logContext),{encodings:i.encodings})),this.encodings=i.encodings,yield this.sender.setParameters(i)}catch(i){this.log.error("failed to set performance optimised encodings",Object.assign(Object.assign({},this.logContext),{error:i})),this.optimizeForPerformance=!1}finally{e()}})}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return _(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),eC()&&this.isInBackground&&this.source===Q.Source.Camera&&(this._mediaStreamTrack.enabled=!1)})}}function R0(a,e,i,s,o,l,d){return _(this,void 0,void 0,function*(){const u=yield s.lock();l.debug("setPublishingLayersForSender",Object.assign(Object.assign({},d),{sender:a,qualities:i,senderEncodings:e}));try{const h=a.getParameters(),{encodings:m}=h;if(!m)return;if(m.length!==e.length){l.warn("cannot set publishing layers, encodings mismatch",Object.assign(Object.assign({},d),{encodings:m,senderEncodings:e}));return}let g=!1;!1&&m[0].scalabilityMode||(o&&i.some(T=>T.enabled)&&i.forEach(T=>T.enabled=!0),m.forEach((S,T)=>{var x;let E=(x=S.rid)!==null&&x!==void 0?x:"";E===""&&(E="q");const k=uC(E),R=i.find(O=>O.quality===k);R&&S.active!==R.enabled&&(g=!0,S.active=R.enabled,l.debug("setting layer ".concat(R.quality," to ").concat(S.active?"enabled":"disabled"),d),Ma()&&(R.enabled?(S.scaleResolutionDownBy=e[T].scaleResolutionDownBy,S.maxBitrate=e[T].maxBitrate,S.maxFrameRate=e[T].maxFrameRate):(S.scaleResolutionDownBy=4,S.maxBitrate=10,S.maxFrameRate=2)))})),g&&(h.encodings=m,l.debug("setting encodings",Object.assign(Object.assign({},d),{encodings:h.encodings})),yield a.setParameters(h))}finally{u()}})}function uC(a){switch(a){case"f":return sn.HIGH;case"h":return sn.MEDIUM;case"q":return sn.LOW;default:return sn.HIGH}}function M0(a,e,i,s){if(!i)return[new Xi({quality:sn.HIGH,width:a,height:e,bitrate:0,ssrc:0})];if(s){const o=i[0].scalabilityMode,l=new cC(o),d=[],u=l.suffix=="h"?1.5:2,h=l.suffix=="h"?2:3;for(let m=0;m<l.spatial;m+=1)d.push(new Xi({quality:Math.min(sn.HIGH,l.spatial-1)-m,width:Math.ceil(a/Math.pow(u,m)),height:Math.ceil(e/Math.pow(u,m)),bitrate:i[0].maxBitrate?Math.ceil(i[0].maxBitrate/Math.pow(h,m)):0,ssrc:0}));return d}return i.map(o=>{var l,d,u;const h=(l=o.scaleResolutionDownBy)!==null&&l!==void 0?l:1;let m=uC((d=o.rid)!==null&&d!==void 0?d:"");return new Xi({quality:m,width:Math.ceil(a/h),height:Math.ceil(e/h),bitrate:(u=o.maxBitrate)!==null&&u!==void 0?u:0,ssrc:0})})}const A0="_lossy",N0="_reliable",tA=2*1e3,dh="leave-reconnect",nA=3e4,iA=8*1024,aA=256*1024;var gn;(function(a){a[a.New=0]="New",a[a.Connected=1]="Connected",a[a.Disconnected=2]="Disconnected",a[a.Reconnecting=3]="Reconnecting",a[a.Closed=4]="Closed"})(gn||(gn={}));class sA extends Hn.EventEmitter{get isClosed(){return this._isClosed}get pendingReconnect(){return!!this.reconnectTimeout}constructor(e){var i;super(),this.options=e,this.rtcConfig={},this.peerConnectionTimeout=_f.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.latestRemoteOfferId=0,this.subscriberPrimary=!1,this.pcState=gn.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.log=Se,this.reliableDataSequence=1,this.reliableMessageBuffer=new v0,this.reliableReceivedState=new _M(nA),this.lossyDataStatCurrentBytes=0,this.lossyDataStatByterate=0,this.lossyDataDropCount=0,this.midToTrackId={},this.isWaitingForNetworkReconnect=!1,this.handleDataChannel=s=>_(this,[s],void 0,function(o){var l=this;let{channel:d}=o;return(function*(){if(d){if(d.label===N0)l.reliableDCSub=d;else if(d.label===A0)l.lossyDCSub=d;else return;l.log.debug("on data channel ".concat(d.id,", ").concat(d.label),l.logContext),d.onmessage=l.handleDataMessage}})()}),this.handleDataMessage=s=>_(this,void 0,void 0,function*(){var o,l,d,u,h;const m=yield this.dataProcessLock.lock();try{let g;if(s.data instanceof ArrayBuffer)g=s.data;else if(s.data instanceof Blob)g=yield s.data.arrayBuffer();else{this.log.error("unsupported data type",Object.assign(Object.assign({},this.logContext),{data:s.data}));return}const y=jt.fromBinary(new Uint8Array(g));if(y.sequence>0&&y.participantSid!==""){const S=this.reliableReceivedState.get(y.participantSid);if(S&&y.sequence<=S)return;this.reliableReceivedState.set(y.participantSid,y.sequence)}if(((o=y.value)===null||o===void 0?void 0:o.case)==="speaker")this.emit(ie.ActiveSpeakersUpdate,y.value.value.speakers);else if(((l=y.value)===null||l===void 0?void 0:l.case)==="encryptedPacket"){if(!this.e2eeManager){this.log.error("Received encrypted packet but E2EE not set up",this.logContext);return}const S=yield(d=this.e2eeManager)===null||d===void 0?void 0:d.handleEncryptedData(y.value.value.encryptedValue,y.value.value.iv,y.participantIdentity,y.value.value.keyIndex),T=Gb.fromBinary(S.payload),x=new jt({value:T.value,participantIdentity:y.participantIdentity,participantSid:y.participantSid});((u=x.value)===null||u===void 0?void 0:u.case)==="user"&&D0(x,x.value.value),this.emit(ie.DataPacketReceived,x,y.value.value.encryptionType)}else((h=y.value)===null||h===void 0?void 0:h.case)==="user"&&D0(y,y.value.value),this.emit(ie.DataPacketReceived,y,ht.NONE)}finally{m()}}),this.handleDataError=s=>{const l=s.currentTarget.maxRetransmits===0?"lossy":"reliable";if(s instanceof ErrorEvent&&s.error){const{error:d}=s.error;this.log.error("DataChannel error on ".concat(l,": ").concat(s.message),Object.assign(Object.assign({},this.logContext),{error:d}))}else this.log.error("Unknown DataChannel error on ".concat(l),Object.assign(Object.assign({},this.logContext),{event:s}))},this.handleBufferedAmountLow=s=>{const l=s.currentTarget.maxRetransmits===0?Ce.LOSSY:Ce.RELIABLE;this.updateAndEmitDCBufferStatus(l)},this.handleDisconnect=(s,o)=>{if(this._isClosed)return;this.log.warn("".concat(s," disconnected"),this.logContext),this.reconnectAttempts===0&&(this.reconnectStart=Date.now());const l=h=>{this.log.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(h,"ms. giving up"),this.logContext),this.emit(ie.Disconnected),this.close()},d=Date.now()-this.reconnectStart;let u=this.getNextRetryDelay({elapsedMs:d,retryCount:this.reconnectAttempts});if(u===null){l(d);return}s===dh&&(u=0),this.log.debug("reconnecting in ".concat(u,"ms"),this.logContext),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=Rt.setTimeout(()=>this.attemptReconnect(o).finally(()=>this.reconnectTimeout=void 0),u)},this.waitForRestarted=()=>new Promise((s,o)=>{this.pcState===gn.Connected&&s();const l=()=>{this.off(ie.Disconnected,d),s()},d=()=>{this.off(ie.Restarted,l),o()};this.once(ie.Restarted,l),this.once(ie.Disconnected,d)}),this.updateAndEmitDCBufferStatus=s=>{if(s===Ce.RELIABLE){const l=this.dataChannelForKind(s);l&&this.reliableMessageBuffer.alignBufferedAmount(l.bufferedAmount)}const o=this.isBufferStatusLow(s);typeof o<"u"&&o!==this.dcBufferStatus.get(s)&&(this.dcBufferStatus.set(s,o),this.emit(ie.DCBufferStatusChanged,o,s))},this.isBufferStatusLow=s=>{const o=this.dataChannelForKind(s);if(o)return o.bufferedAmount<=o.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>_(this,void 0,void 0,function*(){!this.url||!(yield fetch($r(this.url),{method:"HEAD"}).then(o=>o.ok).catch(()=>!1))||(this.log.info("detected network reconnected"),(this.client.currentState===Je.RECONNECTING||this.isWaitingForNetworkReconnect&&this.client.currentState===Je.CONNECTED)&&(this.clearReconnectTimeout(),this.attemptReconnect(ka.RR_SIGNAL_DISCONNECTED),this.isWaitingForNetworkReconnect=!1))}),this.handleBrowserOffline=()=>_(this,void 0,void 0,function*(){if(this.url)try{yield Promise.race([fetch($r(this.url),{method:"HEAD"}),Mt(4e3).then(()=>Promise.reject())])}catch{window.navigator.onLine===!1&&(this.log.info("detected network interruption"),this.isWaitingForNetworkReconnect=!0)}}),this.log=Bn((i=e.loggerName)!==null&&i!==void 0?i:bn.Engine),this.loggerOptions={loggerName:e.loggerName,loggerContextCb:()=>this.logContext},this.client=new Cf(void 0,this.loggerOptions),this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.closingLock=new It,this.dataProcessLock=new It,this.dcBufferStatus=new Map([[Ce.LOSSY,!0],[Ce.RELIABLE,!0]]),this.client.onParticipantUpdate=s=>this.emit(ie.ParticipantUpdate,s),this.client.onConnectionQuality=s=>this.emit(ie.ConnectionQualityUpdate,s),this.client.onRoomUpdate=s=>this.emit(ie.RoomUpdate,s),this.client.onSubscriptionError=s=>this.emit(ie.SubscriptionError,s),this.client.onSubscriptionPermissionUpdate=s=>this.emit(ie.SubscriptionPermissionUpdate,s),this.client.onSpeakersChanged=s=>this.emit(ie.SpeakersChanged,s),this.client.onStreamStateUpdate=s=>this.emit(ie.StreamStateChanged,s),this.client.onRequestResponse=s=>this.emit(ie.SignalRequestResponse,s)}get logContext(){var e,i,s,o,l,d;return{room:(i=(e=this.latestJoinResponse)===null||e===void 0?void 0:e.room)===null||i===void 0?void 0:i.name,roomID:(o=(s=this.latestJoinResponse)===null||s===void 0?void 0:s.room)===null||o===void 0?void 0:o.sid,participant:(d=(l=this.latestJoinResponse)===null||l===void 0?void 0:l.participant)===null||d===void 0?void 0:d.identity,pID:this.participantSid}}join(e,i,s,o){return _(this,arguments,void 0,function(l,d,u,h){var m=this;let g=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;return(function*(){m.url=l,m.token=d,m.signalOpts=u,m.maxJoinAttempts=u.maxRetries;try{m.joinAttempts+=1,m.setupSignalClientCallbacks();const y=yield m.client.join(l,d,u,h,g);return m._isClosed=!1,m.latestJoinResponse=y,m.subscriberPrimary=y.subscriberPrimary,m.pcManager||(yield m.configure(y,!g)),(!m.subscriberPrimary||y.fastPublish)&&m.negotiate().catch(S=>{Se.error(S,m.logContext)}),m.registerOnLineListener(),m.clientConfiguration=y.clientConfiguration,m.emit(ie.SignalConnected,y),y}catch(y){if(y instanceof me){if(y.reason===Qe.ServerUnreachable){if(m.log.warn("Couldn't connect to server, attempt ".concat(m.joinAttempts," of ").concat(m.maxJoinAttempts),m.logContext),m.joinAttempts<m.maxJoinAttempts)return m.join(l,d,u,h,g)}else if(y.reason===Qe.ServiceNotFound)return m.log.warn("Initial connection failed: ".concat(y.message,"  Retrying")),m.join(l,d,u,h,!0)}throw y}})()})}close(){return _(this,void 0,void 0,function*(){const e=yield this.closingLock.lock();if(this.isClosed){e();return}try{this._isClosed=!0,this.joinAttempts=0,this.emit(ie.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),this.cleanupLossyDataStats(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{e()}})}cleanupPeerConnections(){return _(this,void 0,void 0,function*(){var e;yield(e=this.pcManager)===null||e===void 0?void 0:e.close(),this.pcManager=void 0;const i=s=>{s&&(s.close(),s.onbufferedamountlow=null,s.onclose=null,s.onclosing=null,s.onerror=null,s.onmessage=null,s.onopen=null)};i(this.lossyDC),i(this.lossyDCSub),i(this.reliableDC),i(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0,this.reliableMessageBuffer=new v0,this.reliableDataSequence=1,this.reliableReceivedState.clear()})}cleanupLossyDataStats(){this.lossyDataStatByterate=0,this.lossyDataStatCurrentBytes=0,this.lossyDataStatInterval&&(clearInterval(this.lossyDataStatInterval),this.lossyDataStatInterval=void 0),this.lossyDataDropCount=0}cleanupClient(){return _(this,void 0,void 0,function*(){yield this.client.close(),this.client.resetCallbacks()})}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new pi("a track with the same ID has already been published");return new Promise((i,s)=>{const o=setTimeout(()=>{delete this.pendingTrackResolvers[e.cid],s(me.timeout("publication of local track timed out, no response from server"))},1e4);this.pendingTrackResolvers[e.cid]={resolve:l=>{clearTimeout(o),i(l)},reject:()=>{clearTimeout(o),s(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(e)})}removeTrack(e){if(e.track&&this.pendingTrackResolvers[e.track.id]){const{reject:i}=this.pendingTrackResolvers[e.track.id];i&&i(),delete this.pendingTrackResolvers[e.track.id]}try{return this.pcManager.removeTrack(e),!0}catch(i){this.log.warn("failed to remove track",Object.assign(Object.assign({},this.logContext),{error:i}))}return!1}updateMuteStatus(e,i){this.client.sendMuteTrack(e,i)}get dataSubscriberReadyState(){var e;return(e=this.reliableDCSub)===null||e===void 0?void 0:e.readyState}getConnectedServerAddress(){return _(this,void 0,void 0,function*(){var e;return(e=this.pcManager)===null||e===void 0?void 0:e.getConnectedAddress()})}setRegionUrlProvider(e){this.regionUrlProvider=e}configure(e,i){return _(this,void 0,void 0,function*(){var s,o;if(this.pcManager&&this.pcManager.currentState!==tt.NEW)return;this.participantSid=(s=e.participant)===null||s===void 0?void 0:s.sid;const l=this.makeRTCConfiguration(e);this.pcManager=new PM(l,i?"publisher-only":e.subscriberPrimary?"subscriber-primary":"publisher-primary",this.loggerOptions),this.emit(ie.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(d,u)=>{this.client.sendIceCandidate(d,u)},this.pcManager.onPublisherOffer=(d,u)=>{this.client.sendOffer(d,u)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(d,u,h)=>_(this,void 0,void 0,function*(){if(this.log.debug("primary PC state changed ".concat(d),this.logContext),["closed","disconnected","failed"].includes(u)&&(this.publisherConnectionPromise=void 0),d===tt.CONNECTED){const y=this.pcState===gn.New;this.pcState=gn.Connected,y&&this.emit(ie.Connected,e)}else d===tt.FAILED&&(this.pcState===gn.Connected||this.pcState===gn.Reconnecting)&&(this.pcState=gn.Disconnected,this.handleDisconnect("peerconnection failed",h==="failed"?ka.RR_SUBSCRIBER_FAILED:ka.RR_PUBLISHER_FAILED));const m=this.client.isDisconnected||this.client.currentState===Je.RECONNECTING,g=[tt.FAILED,tt.CLOSING,tt.CLOSED].includes(d);m&&g&&!this._isClosed&&this.emit(ie.Offline)}),this.pcManager.onTrack=d=>{d.streams.length!==0&&this.emit(ie.MediaTrackAdded,d.track,d.streams[0],d.receiver)},rA((o=e.serverInfo)===null||o===void 0?void 0:o.protocol)||this.createDataChannels()})}setupSignalClientCallbacks(){this.client.onAnswer=(e,i,s)=>_(this,void 0,void 0,function*(){this.pcManager&&(this.log.debug("received server answer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,midToTrackId:s})),this.midToTrackId=s,yield this.pcManager.setPublisherAnswer(e,i))}),this.client.onTrickle=(e,i)=>{this.pcManager&&(this.log.debug("got ICE candidate from peer",Object.assign(Object.assign({},this.logContext),{candidate:e,target:i})),this.pcManager.addIceCandidate(e,i))},this.client.onOffer=(e,i,s)=>_(this,void 0,void 0,function*(){if(this.latestRemoteOfferId=i,!this.pcManager)return;this.midToTrackId=s;const o=yield this.pcManager.createSubscriberAnswerFromOffer(e,i);o&&this.client.sendAnswer(o,i)}),this.client.onLocalTrackPublished=e=>{var i;if(this.log.debug("received trackPublishedResponse",Object.assign(Object.assign({},this.logContext),{cid:e.cid,track:(i=e.track)===null||i===void 0?void 0:i.sid})),!this.pendingTrackResolvers[e.cid]){this.log.error("missing track resolver for ".concat(e.cid),Object.assign(Object.assign({},this.logContext),{cid:e.cid}));return}const{resolve:s}=this.pendingTrackResolvers[e.cid];delete this.pendingTrackResolvers[e.cid],s(e.track)},this.client.onLocalTrackUnpublished=e=>{this.emit(ie.LocalTrackUnpublished,e)},this.client.onLocalTrackSubscribed=e=>{this.emit(ie.LocalTrackSubscribed,e)},this.client.onTokenRefresh=e=>{var i;this.token=e,(i=this.regionUrlProvider)===null||i===void 0||i.updateToken(e)},this.client.onRemoteMuteChanged=(e,i)=>{this.emit(ie.RemoteMute,e,i)},this.client.onSubscribedQualityUpdate=e=>{this.emit(ie.SubscribedQualityUpdate,e)},this.client.onRoomMoved=e=>{var i;this.participantSid=(i=e.participant)===null||i===void 0?void 0:i.sid,this.latestJoinResponse&&(this.latestJoinResponse.room=e.room),this.emit(ie.RoomMoved,e)},this.client.onMediaSectionsRequirement=e=>{var i,s;const o={direction:"recvonly"};for(let l=0;l<e.numAudios;l++)(i=this.pcManager)===null||i===void 0||i.addPublisherTransceiverOfKind("audio",o);for(let l=0;l<e.numVideos;l++)(s=this.pcManager)===null||s===void 0||s.addPublisherTransceiverOfKind("video",o);this.negotiate()},this.client.onClose=()=>{this.handleDisconnect("signal",ka.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=e=>{switch(this.log.debug("client leave request",Object.assign(Object.assign({},this.logContext),{reason:e?.reason})),e.regions&&this.regionUrlProvider&&(this.log.debug("updating regions",this.logContext),this.regionUrlProvider.setServerReportedRegions({updatedAtInMs:Date.now(),maxAgeInMs:rC,regionSettings:e.regions})),e.action){case _s.DISCONNECT:this.emit(ie.Disconnected,e?.reason),this.close();break;case _s.RECONNECT:this.fullReconnectOnNext=!0,this.handleDisconnect(dh);break;case _s.RESUME:this.handleDisconnect(dh)}}}makeRTCConfiguration(e){var i;const s=Object.assign({},this.rtcConfig);if(!((i=this.signalOpts)===null||i===void 0)&&i.e2eeEnabled&&(this.log.debug("E2EE - setting up transports with insertable streams",this.logContext),s.encodedInsertableStreams=!0),e.iceServers&&!s.iceServers){const o=[];e.iceServers.forEach(l=>{const d={urls:l.urls};l.username&&(d.username=l.username),l.credential&&(d.credential=l.credential),o.push(d)}),s.iceServers=o}return e.clientConfiguration&&e.clientConfiguration.forceRelay===Jr.ENABLED&&(s.iceTransportPolicy="relay"),s.sdpSemantics="unified-plan",s.continualGatheringPolicy="gather_continually",s}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(A0,{ordered:!1,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel(N0,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow,this.cleanupLossyDataStats(),this.lossyDataStatInterval=setInterval(()=>{this.lossyDataStatByterate=this.lossyDataStatCurrentBytes,this.lossyDataStatCurrentBytes=0;const e=this.dataChannelForKind(Ce.LOSSY);if(e){const i=this.lossyDataStatByterate/10;e.bufferedAmountLowThreshold=Math.min(Math.max(i,iA),aA)}},1e3))}createSender(e,i,s){return _(this,void 0,void 0,function*(){if(Ph())return yield this.createTransceiverRTCRtpSender(e,i,s);if(jh())return this.log.warn("using add-track fallback",this.logContext),yield this.createRTCRtpSender(e.mediaStreamTrack);throw new ut("Required webRTC APIs not supported on this device")})}createSimulcastSender(e,i,s,o){return _(this,void 0,void 0,function*(){if(Ph())return this.createSimulcastTransceiverSender(e,i,s,o);if(jh())return this.log.debug("using add-track fallback",this.logContext),this.createRTCRtpSender(e.mediaStreamTrack);throw new ut("Cannot stream on this device")})}createTransceiverRTCRtpSender(e,i,s){return _(this,void 0,void 0,function*(){if(!this.pcManager)throw new ut("publisher is closed");const o=[];e.mediaStream&&o.push(e.mediaStream),na(e)&&(e.codec=i.videoCodec);const l={direction:"sendonly",streams:o};return s&&(l.sendEncodings=s),(yield this.pcManager.addPublisherTransceiver(e.mediaStreamTrack,l)).sender})}createSimulcastTransceiverSender(e,i,s,o){return _(this,void 0,void 0,function*(){if(!this.pcManager)throw new ut("publisher is closed");const l={direction:"sendonly"};o&&(l.sendEncodings=o);const d=yield this.pcManager.addPublisherTransceiver(i.mediaStreamTrack,l);if(s.videoCodec)return e.setSimulcastTrackSender(s.videoCodec,d.sender),d.sender})}createRTCRtpSender(e){return _(this,void 0,void 0,function*(){if(!this.pcManager)throw new ut("publisher is closed");return this.pcManager.addPublisherTrack(e)})}attemptReconnect(e){return _(this,void 0,void 0,function*(){var i,s,o;if(!this._isClosed){if(this.attemptingReconnect){Se.warn("already attempting reconnect, returning early",this.logContext);return}(((i=this.clientConfiguration)===null||i===void 0?void 0:i.resumeConnection)===Jr.DISABLED||((o=(s=this.pcManager)===null||s===void 0?void 0:s.currentState)!==null&&o!==void 0?o:tt.NEW)===tt.NEW)&&(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(e),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(l){this.reconnectAttempts+=1;let d=!0;l instanceof ut?(this.log.debug("received unrecoverable error",Object.assign(Object.assign({},this.logContext),{error:l})),d=!1):l instanceof Ss||(this.fullReconnectOnNext=!0),d?this.handleDisconnect("reconnect",ka.RR_UNKNOWN):(this.log.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up"),this.logContext),this.emit(ie.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}})}getNextRetryDelay(e){try{return this.reconnectPolicy.nextRetryDelayInMs(e)}catch(i){this.log.warn("encountered error in reconnect policy",Object.assign(Object.assign({},this.logContext),{error:i}))}return null}restartConnection(e){return _(this,void 0,void 0,function*(){var i,s,o;try{if(!this.url||!this.token)throw new ut("could not reconnect, url or token not saved");this.log.info("reconnecting, attempt: ".concat(this.reconnectAttempts),this.logContext),this.emit(ie.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();let l;try{if(!this.signalOpts)throw this.log.warn("attempted connection restart, without signal options present",this.logContext),new Ss;l=yield this.join(e??this.url,this.token,this.signalOpts,void 0,!this.options.singlePeerConnection)}catch(d){throw d instanceof me&&d.reason===Qe.NotAllowed?new ut("could not reconnect, token might be expired"):new Ss}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(this.client.setReconnected(),this.emit(ie.SignalRestarted,l),yield this.waitForPCReconnected(),this.client.currentState!==Je.CONNECTED)throw new Ss("Signal connection got severed during reconnect");(i=this.regionUrlProvider)===null||i===void 0||i.resetAttempts(),this.emit(ie.Restarted)}catch(l){const d=yield(s=this.regionUrlProvider)===null||s===void 0?void 0:s.getNextBestRegionUrl();if(d){yield this.restartConnection(d);return}else throw(o=this.regionUrlProvider)===null||o===void 0||o.resetAttempts(),l}})}resumeConnection(e){return _(this,void 0,void 0,function*(){var i;if(!this.url||!this.token)throw new ut("could not reconnect, url or token not saved");if(!this.pcManager)throw new ut("publisher and subscriber connections unset");this.log.info("resuming signal connection, attempt ".concat(this.reconnectAttempts),this.logContext),this.emit(ie.Resuming);let s;try{this.setupSignalClientCallbacks(),s=yield this.client.reconnect(this.url,this.token,this.participantSid,e)}catch(o){let l="";throw o instanceof Error&&(l=o.message,this.log.error(o.message,Object.assign(Object.assign({},this.logContext),{error:o}))),o instanceof me&&o.reason===Qe.NotAllowed?new ut("could not reconnect, token might be expired"):o instanceof me&&o.reason===Qe.LeaveRequest?o:new Ss(l)}if(this.emit(ie.SignalResumed),s){const o=this.makeRTCConfiguration(s);this.pcManager.updateConfiguration(o),this.latestJoinResponse&&(this.latestJoinResponse.serverInfo=s.serverInfo)}else this.log.warn("Did not receive reconnect response",this.logContext);if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.currentState!==Je.CONNECTED)throw new Ss("Signal connection got severed during reconnect");this.client.setReconnected(),((i=this.reliableDC)===null||i===void 0?void 0:i.readyState)==="open"&&this.reliableDC.id===null&&this.createDataChannels(),s?.lastMessageSeq&&this.resendReliableMessagesForResume(s.lastMessageSeq),this.emit(ie.Resumed)})}waitForPCInitialConnection(e,i){return _(this,void 0,void 0,function*(){if(!this.pcManager)throw new ut("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(i,e)})}waitForPCReconnected(){return _(this,void 0,void 0,function*(){this.pcState=gn.Reconnecting,this.log.debug("waiting for peer connection to reconnect",this.logContext);try{if(yield Mt(tA),!this.pcManager)throw new ut("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=gn.Connected}catch(e){throw this.pcState=gn.Disconnected,me.internal("could not establish PC connection, ".concat(e.message))}})}publishRpcResponse(e,i,s,o){return _(this,void 0,void 0,function*(){const l=new jt({destinationIdentities:[e],kind:Ce.RELIABLE,value:{case:"rpcResponse",value:new lf({requestId:i,value:o?{case:"error",value:o.toProto()}:{case:"payload",value:s??""}})}});yield this.sendDataPacket(l,Ce.RELIABLE)})}publishRpcAck(e,i){return _(this,void 0,void 0,function*(){const s=new jt({destinationIdentities:[e],kind:Ce.RELIABLE,value:{case:"rpcAck",value:new of({requestId:i})}});yield this.sendDataPacket(s,Ce.RELIABLE)})}sendDataPacket(e,i){return _(this,void 0,void 0,function*(){if(yield this.ensurePublisherConnected(i),this.e2eeManager&&this.e2eeManager.isDataChannelEncryptionEnabled){const l=mM(e);if(l){const d=yield this.e2eeManager.encryptData(l.toBinary());e.value={case:"encryptedPacket",value:new Vb({encryptedValue:d.payload,iv:d.iv,keyIndex:d.keyIndex})}}}i===Ce.RELIABLE&&(e.sequence=this.reliableDataSequence,this.reliableDataSequence+=1);const s=e.toBinary(),o=this.dataChannelForKind(i);if(o){if(i===Ce.RELIABLE)yield this.waitForBufferStatusLow(i),this.reliableMessageBuffer.push({data:s,sequence:e.sequence});else{if(!this.isBufferStatusLow(i)){this.lossyDataDropCount+=1,this.lossyDataDropCount%100===0&&this.log.warn("dropping lossy data channel messages, total dropped: ".concat(this.lossyDataDropCount),this.logContext);return}this.lossyDataStatCurrentBytes+=s.byteLength}if(this.attemptingReconnect)return;o.send(s)}this.updateAndEmitDCBufferStatus(i)})}resendReliableMessagesForResume(e){return _(this,void 0,void 0,function*(){yield this.ensurePublisherConnected(Ce.RELIABLE);const i=this.dataChannelForKind(Ce.RELIABLE);i&&(this.reliableMessageBuffer.popToSequence(e),this.reliableMessageBuffer.getAll().forEach(s=>{i.send(s.data)})),this.updateAndEmitDCBufferStatus(Ce.RELIABLE)})}waitForBufferStatusLow(e){return new Nt((i,s)=>_(this,void 0,void 0,function*(){if(this.isBufferStatusLow(e))i();else{const o=()=>s(new ut("engine closed"));for(this.once(ie.Closing,o);!this.dcBufferStatus.get(e);)yield Mt(10);this.off(ie.Closing,o),i()}}))}ensureDataTransportConnected(e){return _(this,arguments,void 0,function(i){var s=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscriberPrimary;return(function*(){var l;if(!s.pcManager)throw new ut("PC manager is closed");const d=o?s.pcManager.subscriber:s.pcManager.publisher,u=o?"Subscriber":"Publisher";if(!d)throw me.internal("".concat(u," connection not set"));let h=!1;!o&&!s.dataChannelForKind(i,o)&&(s.createDataChannels(),h=!0),!h&&!o&&!s.pcManager.publisher.isICEConnected&&s.pcManager.publisher.getICEConnectionState()!=="checking"&&(h=!0),h&&s.negotiate().catch(y=>{Se.error(y,s.logContext)});const m=s.dataChannelForKind(i,o);if(m?.readyState==="open")return;const g=new Date().getTime()+s.peerConnectionTimeout;for(;new Date().getTime()<g;){if(d.isICEConnected&&((l=s.dataChannelForKind(i,o))===null||l===void 0?void 0:l.readyState)==="open")return;yield Mt(50)}throw me.internal("could not establish ".concat(u," connection, state: ").concat(d.getICEConnectionState()))})()})}ensurePublisherConnected(e){return _(this,void 0,void 0,function*(){this.publisherConnectionPromise||(this.publisherConnectionPromise=this.ensureDataTransportConnected(e,!1)),yield this.publisherConnectionPromise})}verifyTransport(){return!(!this.pcManager||![tt.CONNECTING,tt.CONNECTED].includes(this.pcManager.currentState)||!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED)}negotiate(){return _(this,void 0,void 0,function*(){return new Nt((e,i)=>_(this,void 0,void 0,function*(){if(!this.pcManager){i(new _a("PC manager is closed"));return}this.pcManager.requirePublisher(),this.pcManager.publisher.getTransceivers().length==0&&!this.lossyDC&&!this.reliableDC&&this.createDataChannels();const s=new AbortController,o=()=>{s.abort(),this.log.debug("engine disconnected while negotiation was ongoing",this.logContext),e()};this.isClosed&&i(new _a("cannot negotiate on closed engine")),this.on(ie.Closing,o),this.on(ie.Restarting,o),this.pcManager.publisher.once(xa.RTPVideoPayloadTypes,l=>{const d=new Map;l.forEach(u=>{const h=u.codec.toLowerCase();WR(h)&&d.set(u.payload,h)}),this.emit(ie.RTPVideoMapUpdate,d)});try{yield this.pcManager.negotiate(s),e()}catch(l){if(s.signal.aborted){e();return}l instanceof _a&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",ka.RR_UNKNOWN),l instanceof Error?i(l):i(new Error(String(l)))}finally{this.off(ie.Closing,o),this.off(ie.Restarting,o)}}))})}dataChannelForKind(e,i){if(i){if(e===Ce.LOSSY)return this.lossyDCSub;if(e===Ce.RELIABLE)return this.reliableDCSub}else{if(e===Ce.LOSSY)return this.lossyDC;if(e===Ce.RELIABLE)return this.reliableDC}}sendSyncState(e,i){var s,o,l,d;if(!this.pcManager){this.log.warn("sync state cannot be sent without peer connection setup",this.logContext);return}const u=this.pcManager.publisher.getLocalDescription(),h=this.pcManager.publisher.getRemoteDescription(),m=(s=this.pcManager.subscriber)===null||s===void 0?void 0:s.getRemoteDescription(),g=(o=this.pcManager.subscriber)===null||o===void 0?void 0:o.getLocalDescription(),y=(d=(l=this.signalOpts)===null||l===void 0?void 0:l.autoSubscribe)!==null&&d!==void 0?d:!0,S=new Array,T=new Array;e.forEach(x=>{x.isDesired!==y&&S.push(x.trackSid),x.isEnabled||T.push(x.trackSid)}),this.client.sendSyncState(new ff({answer:this.pcManager.mode==="publisher-only"?h?ks({sdp:h.sdp,type:h.type}):void 0:g?ks({sdp:g.sdp,type:g.type}):void 0,offer:this.pcManager.mode==="publisher-only"?u?ks({sdp:u.sdp,type:u.type}):void 0:m?ks({sdp:m.sdp,type:m.type}):void 0,subscription:new pc({trackSids:S,subscribe:!y,participantTracks:[]}),publishTracks:PR(i),dataChannels:this.dataChannelsInfo(),trackSidsDisabled:T,datachannelReceiveStates:this.reliableReceivedState.map((x,E)=>new fS({publisherSid:E,lastSeq:x}))}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){const e=[],i=(s,o)=>{s?.id!==void 0&&s.id!==null&&e.push(new mS({label:s.label,id:s.id,target:o}))};return i(this.dataChannelForKind(Ce.LOSSY),xn.PUBLISHER),i(this.dataChannelForKind(Ce.RELIABLE),xn.PUBLISHER),i(this.dataChannelForKind(Ce.LOSSY,!0),xn.SUBSCRIBER),i(this.dataChannelForKind(Ce.RELIABLE,!0),xn.SUBSCRIBER),e}clearReconnectTimeout(){this.reconnectTimeout&&Rt.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){Kt()&&(window.addEventListener("online",this.handleBrowserOnLine),window.addEventListener("offline",this.handleBrowserOffline))}deregisterOnLineListener(){Kt()&&(window.removeEventListener("online",this.handleBrowserOnLine),window.removeEventListener("offline",this.handleBrowserOffline))}getTrackIdForReceiver(e){var i;const s=(i=this.pcManager)===null||i===void 0?void 0:i.getMidForReceiver(e);if(s){const o=Object.entries(this.midToTrackId).find(l=>{let[d]=l;return d===s});if(o)return o[1]}}}function rA(a){return a!==void 0&&a>13}function D0(a,e){const i=a.participantIdentity?a.participantIdentity:e.participantIdentity;a.participantIdentity=i,e.participantIdentity=i;const s=a.destinationIdentities.length!==0?a.destinationIdentities:e.destinationIdentities;a.destinationIdentities=s,e.destinationIdentities=s}class dC{get info(){return this._info}validateBytesReceived(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(typeof this.totalByteSize!="number"||this.totalByteSize===0)){if(e&&this.bytesReceived<this.totalByteSize)throw new vn("Not enough chunk(s) received - expected ".concat(this.totalByteSize," bytes of data total, only received ").concat(this.bytesReceived," bytes"),Pt.Incomplete);if(this.bytesReceived>this.totalByteSize)throw new vn("Extra chunk(s) received - expected ".concat(this.totalByteSize," bytes of data total, received ").concat(this.bytesReceived," bytes"),Pt.LengthExceeded)}}constructor(e,i,s,o){this.reader=i,this.totalByteSize=s,this._info=e,this.bytesReceived=0,this.outOfBandFailureRejectingFuture=o}}class oA extends dC{handleChunkReceived(e){var i;this.bytesReceived+=e.content.byteLength,this.validateBytesReceived();const s=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;(i=this.onProgress)===null||i===void 0||i.call(this,s)}[Symbol.asyncIterator](){const e=this.reader.getReader();let i=new yn,s=null,o=null;if(this.signal){const d=this.signal;o=()=>{var u;(u=i.reject)===null||u===void 0||u.call(i,d.reason)},d.addEventListener("abort",o),s=d}const l=()=>{e.releaseLock(),s&&o&&s.removeEventListener("abort",o),this.signal=void 0};return{next:()=>_(this,void 0,void 0,function*(){var d,u;try{const{done:h,value:m}=yield Promise.race([e.read(),i.promise,(u=(d=this.outOfBandFailureRejectingFuture)===null||d===void 0?void 0:d.promise)!==null&&u!==void 0?u:new Promise(()=>{})]);return h?(this.validateBytesReceived(!0),{done:!0,value:void 0}):(this.handleChunkReceived(m),{done:!1,value:m.content})}catch(h){throw l(),h}}),return(){return _(this,void 0,void 0,function*(){return l(),{done:!0,value:void 0}})}}}withAbortSignal(e){return this.signal=e,this}readAll(){return _(this,arguments,void 0,function(){var e=this;let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(function*(){var s,o,l,d;let u=new Set;const h=i.signal?e.withAbortSignal(i.signal):e;try{for(var m=!0,g=mi(h),y;y=yield g.next(),s=y.done,!s;m=!0){d=y.value,m=!1;const S=d;u.add(S)}}catch(S){o={error:S}}finally{try{!m&&!s&&(l=g.return)&&(yield l.call(g))}finally{if(o)throw o.error}}return Array.from(u)})()})}}class lA extends dC{constructor(e,i,s,o){super(e,i,s,o),this.receivedChunks=new Map}handleChunkReceived(e){var i;const s=Hl(e.chunkIndex),o=this.receivedChunks.get(s);if(o&&o.version>e.version)return;this.receivedChunks.set(s,e),this.bytesReceived+=e.content.byteLength,this.validateBytesReceived();const l=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;(i=this.onProgress)===null||i===void 0||i.call(this,l)}[Symbol.asyncIterator](){const e=this.reader.getReader(),i=new TextDecoder("utf-8",{fatal:!0});let s=new yn,o=null,l=null;if(this.signal){const u=this.signal;l=()=>{var h;(h=s.reject)===null||h===void 0||h.call(s,u.reason)},u.addEventListener("abort",l),o=u}const d=()=>{e.releaseLock(),o&&l&&o.removeEventListener("abort",l),this.signal=void 0};return{next:()=>_(this,void 0,void 0,function*(){var u,h;try{const{done:m,value:g}=yield Promise.race([e.read(),s.promise,(h=(u=this.outOfBandFailureRejectingFuture)===null||u===void 0?void 0:u.promise)!==null&&h!==void 0?h:new Promise(()=>{})]);if(m)return this.validateBytesReceived(!0),{done:!0,value:void 0};{this.handleChunkReceived(g);let y;try{y=i.decode(g.content)}catch(S){throw new vn("Cannot decode datastream chunk ".concat(g.chunkIndex," as text: ").concat(S),Pt.DecodeFailed)}return{done:!1,value:y}}}catch(m){throw d(),m}}),return(){return _(this,void 0,void 0,function*(){return d(),{done:!0,value:void 0}})}}}withAbortSignal(e){return this.signal=e,this}readAll(){return _(this,arguments,void 0,function(){var e=this;let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(function*(){var s,o,l,d;let u="";const h=i.signal?e.withAbortSignal(i.signal):e;try{for(var m=!0,g=mi(h),y;y=yield g.next(),s=y.done,!s;m=!0)d=y.value,m=!1,u+=d}catch(S){o={error:S}}finally{try{!m&&!s&&(l=g.return)&&(yield l.call(g))}finally{if(o)throw o.error}}return u})()})}}class cA{constructor(){this.log=Se,this.byteStreamControllers=new Map,this.textStreamControllers=new Map,this.byteStreamHandlers=new Map,this.textStreamHandlers=new Map}registerTextStreamHandler(e,i){if(this.textStreamHandlers.has(e))throw new vn('A text stream handler for topic "'.concat(e,'" has already been set.'),Pt.HandlerAlreadyRegistered);this.textStreamHandlers.set(e,i)}unregisterTextStreamHandler(e){this.textStreamHandlers.delete(e)}registerByteStreamHandler(e,i){if(this.byteStreamHandlers.has(e))throw new vn('A byte stream handler for topic "'.concat(e,'" has already been set.'),Pt.HandlerAlreadyRegistered);this.byteStreamHandlers.set(e,i)}unregisterByteStreamHandler(e){this.byteStreamHandlers.delete(e)}clearControllers(){this.byteStreamControllers.clear(),this.textStreamControllers.clear()}validateParticipantHasNoActiveDataStreams(e){var i,s,o,l;const d=Array.from(this.textStreamControllers.entries()).filter(h=>h[1].sendingParticipantIdentity===e),u=Array.from(this.byteStreamControllers.entries()).filter(h=>h[1].sendingParticipantIdentity===e);if(d.length>0||u.length>0){const h=new vn("Participant ".concat(e," unexpectedly disconnected in the middle of sending data"),Pt.AbnormalEnd);for(const[m,g]of u)(s=(i=g.outOfBandFailureRejectingFuture).reject)===null||s===void 0||s.call(i,h),this.byteStreamControllers.delete(m);for(const[m,g]of d)(l=(o=g.outOfBandFailureRejectingFuture).reject)===null||l===void 0||l.call(o,h),this.textStreamControllers.delete(m)}}handleDataStreamPacket(e,i){return _(this,void 0,void 0,function*(){switch(e.value.case){case"streamHeader":return this.handleStreamHeader(e.value.value,e.participantIdentity,i);case"streamChunk":return this.handleStreamChunk(e.value.value,i);case"streamTrailer":return this.handleStreamTrailer(e.value.value,i);default:throw new Error('DataPacket of value "'.concat(e.value.case,'" is not data stream related!'))}})}handleStreamHeader(e,i,s){return _(this,void 0,void 0,function*(){var o;if(e.contentHeader.case==="byteHeader"){const l=this.byteStreamHandlers.get(e.topic);if(!l){this.log.debug("ignoring incoming byte stream due to no handler for topic",e.topic);return}let d;const u=new yn;u.promise.catch(g=>{this.log.error(g)});const h={id:e.streamId,name:(o=e.contentHeader.value.name)!==null&&o!==void 0?o:"unknown",mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:Hl(e.timestamp),attributes:e.attributes,encryptionType:s},m=new ReadableStream({start:g=>{if(d=g,this.textStreamControllers.has(e.streamId))throw new vn("A data stream read is already in progress for a stream with id ".concat(e.streamId,"."),Pt.AlreadyOpened);this.byteStreamControllers.set(e.streamId,{info:h,controller:d,startTime:Date.now(),sendingParticipantIdentity:i,outOfBandFailureRejectingFuture:u})}});l(new oA(h,m,Hl(e.totalLength),u),{identity:i})}else if(e.contentHeader.case==="textHeader"){const l=this.textStreamHandlers.get(e.topic);if(!l){this.log.debug("ignoring incoming text stream due to no handler for topic",e.topic);return}let d;const u=new yn;u.promise.catch(g=>{this.log.error(g)});const h={id:e.streamId,mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:Number(e.timestamp),attributes:e.attributes,encryptionType:s,attachedStreamIds:e.contentHeader.value.attachedStreamIds},m=new ReadableStream({start:g=>{if(d=g,this.textStreamControllers.has(e.streamId))throw new vn("A data stream read is already in progress for a stream with id ".concat(e.streamId,"."),Pt.AlreadyOpened);this.textStreamControllers.set(e.streamId,{info:h,controller:d,startTime:Date.now(),sendingParticipantIdentity:i,outOfBandFailureRejectingFuture:u})}});l(new lA(h,m,Hl(e.totalLength),u),{identity:i})}})}handleStreamChunk(e,i){const s=this.byteStreamControllers.get(e.streamId);s&&(s.info.encryptionType!==i?(s.controller.error(new vn("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(i,", got ").concat(s.info.encryptionType),Pt.EncryptionTypeMismatch)),this.byteStreamControllers.delete(e.streamId)):e.content.length>0&&s.controller.enqueue(e));const o=this.textStreamControllers.get(e.streamId);o&&(o.info.encryptionType!==i?(o.controller.error(new vn("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(i,", got ").concat(o.info.encryptionType),Pt.EncryptionTypeMismatch)),this.textStreamControllers.delete(e.streamId)):e.content.length>0&&o.controller.enqueue(e))}handleStreamTrailer(e,i){const s=this.textStreamControllers.get(e.streamId);s&&(s.info.encryptionType!==i?s.controller.error(new vn("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(i,", got ").concat(s.info.encryptionType),Pt.EncryptionTypeMismatch)):(s.info.attributes=Object.assign(Object.assign({},s.info.attributes),e.attributes),s.controller.close(),this.textStreamControllers.delete(e.streamId)));const o=this.byteStreamControllers.get(e.streamId);o&&(o.info.encryptionType!==i?o.controller.error(new vn("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(i,", got ").concat(o.info.encryptionType),Pt.EncryptionTypeMismatch)):(o.info.attributes=Object.assign(Object.assign({},o.info.attributes),e.attributes),o.controller.close()),this.byteStreamControllers.delete(e.streamId))}}class hC{constructor(e,i,s){this.writableStream=e,this.defaultWriter=e.getWriter(),this.onClose=s,this.info=i}write(e){return this.defaultWriter.write(e)}close(){return _(this,void 0,void 0,function*(){var e;yield this.defaultWriter.close(),this.defaultWriter.releaseLock(),(e=this.onClose)===null||e===void 0||e.call(this)})}}class uA extends hC{}class dA extends hC{}const O0=15e3;class hA{constructor(e,i){this.engine=e,this.log=i}setupEngine(e){this.engine=e}sendText(e,i){return _(this,void 0,void 0,function*(){var s;const o=crypto.randomUUID(),d=new TextEncoder().encode(e).byteLength,u=(s=i?.attachments)===null||s===void 0?void 0:s.map(()=>crypto.randomUUID()),h=new Array(u?u.length+1:1).fill(0),m=(y,S)=>{var T;h[S]=y;const x=h.reduce((E,k)=>E+k,0);(T=i?.onProgress)===null||T===void 0||T.call(i,x)},g=yield this.streamText({streamId:o,totalSize:d,destinationIdentities:i?.destinationIdentities,topic:i?.topic,attachedStreamIds:u,attributes:i?.attributes});return yield g.write(e),m(1,0),yield g.close(),i?.attachments&&u&&(yield Promise.all(i.attachments.map((y,S)=>_(this,void 0,void 0,function*(){return this._sendFile(u[S],y,{topic:i.topic,mimeType:y.type,onProgress:T=>{m(T,S+1)}})})))),g.info})}streamText(e){return _(this,void 0,void 0,function*(){var i,s,o;const l=(i=e?.streamId)!==null&&i!==void 0?i:crypto.randomUUID(),d={id:l,mimeType:"text/plain",timestamp:Date.now(),topic:(s=e?.topic)!==null&&s!==void 0?s:"",size:e?.totalSize,attributes:e?.attributes,encryptionType:!((o=this.engine.e2eeManager)===null||o===void 0)&&o.isDataChannelEncryptionEnabled?ht.GCM:ht.NONE,attachedStreamIds:e?.attachedStreamIds},u=new Zl({streamId:l,mimeType:d.mimeType,topic:d.topic,timestamp:Ea(d.timestamp),totalLength:Ea(e?.totalSize),attributes:d.attributes,contentHeader:{case:"textHeader",value:new nS({version:e?.version,attachedStreamIds:d.attachedStreamIds,replyToStreamId:e?.replyToStreamId,operationType:e?.type==="update"?bh.UPDATE:bh.CREATE})}}),h=e?.destinationIdentities,m=new jt({destinationIdentities:h,value:{case:"streamHeader",value:u}});yield this.engine.sendDataPacket(m,Ce.RELIABLE);let g=0;const y=this.engine,S=new WritableStream({write(E){return _(this,void 0,void 0,function*(){for(const k of iM(E,O0)){const R=new $l({content:k,streamId:l,chunkIndex:Ea(g)}),O=new jt({destinationIdentities:h,value:{case:"streamChunk",value:R}});yield y.sendDataPacket(O,Ce.RELIABLE),g+=1}})},close(){return _(this,void 0,void 0,function*(){const E=new ec({streamId:l}),k=new jt({destinationIdentities:h,value:{case:"streamTrailer",value:E}});yield y.sendDataPacket(k,Ce.RELIABLE)})},abort(E){console.log("Sink error:",E)}});let T=()=>_(this,void 0,void 0,function*(){yield x.close()});y.once(ie.Closing,T);const x=new uA(S,d,()=>this.engine.off(ie.Closing,T));return x})}sendFile(e,i){return _(this,void 0,void 0,function*(){const s=crypto.randomUUID();return yield this._sendFile(s,e,i),{id:s}})}_sendFile(e,i,s){return _(this,void 0,void 0,function*(){var o;const l=yield this.streamBytes({streamId:e,totalSize:i.size,name:i.name,mimeType:(o=s?.mimeType)!==null&&o!==void 0?o:i.type,topic:s?.topic,destinationIdentities:s?.destinationIdentities}),d=i.stream().getReader();for(;;){const{done:u,value:h}=yield d.read();if(u)break;yield l.write(h)}return yield l.close(),l.info})}streamBytes(e){return _(this,void 0,void 0,function*(){var i,s,o,l,d,u;const h=(i=e?.streamId)!==null&&i!==void 0?i:crypto.randomUUID(),m=e?.destinationIdentities,g={id:h,mimeType:(s=e?.mimeType)!==null&&s!==void 0?s:"application/octet-stream",topic:(o=e?.topic)!==null&&o!==void 0?o:"",timestamp:Date.now(),attributes:e?.attributes,size:e?.totalSize,name:(l=e?.name)!==null&&l!==void 0?l:"unknown",encryptionType:!((d=this.engine.e2eeManager)===null||d===void 0)&&d.isDataChannelEncryptionEnabled?ht.GCM:ht.NONE},y=new Zl({totalLength:Ea((u=g.size)!==null&&u!==void 0?u:0),mimeType:g.mimeType,streamId:h,topic:g.topic,timestamp:Ea(Date.now()),attributes:g.attributes,contentHeader:{case:"byteHeader",value:new iS({name:g.name})}}),S=new jt({destinationIdentities:m,value:{case:"streamHeader",value:y}});yield this.engine.sendDataPacket(S,Ce.RELIABLE);let T=0;const x=new It,E=this.engine,k=this.log,R=new WritableStream({write(L){return _(this,void 0,void 0,function*(){const D=yield x.lock();let I=0;try{for(;I<L.byteLength;){const P=L.slice(I,I+O0),H=new jt({destinationIdentities:m,value:{case:"streamChunk",value:new $l({content:P,streamId:h,chunkIndex:Ea(T)})}});yield E.sendDataPacket(H,Ce.RELIABLE),T+=1,I+=P.byteLength}}finally{D()}})},close(){return _(this,void 0,void 0,function*(){const L=new ec({streamId:h}),D=new jt({destinationIdentities:m,value:{case:"streamTrailer",value:L}});yield E.sendDataPacket(D,Ce.RELIABLE)})},abort(L){k.error("Sink error:",L)}});return new dA(R,g)})}}class fC extends Q{constructor(e,i,s,o,l){super(e,s,l),this.sid=i,this.receiver=o}get isLocal(){return!1}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?$.Muted:$.Unmuted,this))}setMediaStream(e){this.mediaStream=e;const i=s=>{s.track===this._mediaStreamTrack&&(e.removeEventListener("removetrack",i),this.receiver&&"playoutDelayHint"in this.receiver&&(this.receiver.playoutDelayHint=void 0),this.receiver=void 0,this._currentBitrate=0,this.emit($.Ended,this))};e.addEventListener("removetrack",i)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){return _(this,void 0,void 0,function*(){var e;return!((e=this.receiver)===null||e===void 0)&&e.getStats?yield this.receiver.getStats():void 0})}setPlayoutDelay(e){this.receiver?"playoutDelayHint"in this.receiver?this.receiver.playoutDelayHint=e:this.log.warn("Playout delay not supported in this browser"):this.log.warn("Cannot set playout delay, track already ended")}getPlayoutDelay(){if(this.receiver){if("playoutDelayHint"in this.receiver)return this.receiver.playoutDelayHint;this.log.warn("Playout delay not supported in this browser")}else this.log.warn("Cannot get playout delay, track already ended");return 0}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),xf)),jR()&&this.registerTimeSyncUpdate()}registerTimeSyncUpdate(){const e=()=>{var i;this.timeSyncHandle=requestAnimationFrame(()=>e());const s=(i=this.receiver)===null||i===void 0?void 0:i.getSynchronizationSources()[0];if(s){const{timestamp:o,rtpTimestamp:l}=s;l&&this.rtpTimestamp!==l&&(this.emit($.TimeSyncUpdate,{timestamp:o,rtpTimestamp:l}),this.rtpTimestamp=l)}};e()}}class fA extends fC{constructor(e,i,s,o,l,d){super(e,i,Q.Kind.Audio,s,d),this.monitorReceiver=()=>_(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const u=yield this.getReceiverStats();u&&this.prevStats&&this.receiver&&(this._currentBitrate=yc(u,this.prevStats)),this.prevStats=u}),this.audioContext=o,this.webAudioPluginNodes=[],l&&(this.sinkId=l.deviceId)}setVolume(e){var i;for(const s of this.attachedElements)this.audioContext?(i=this.gainNode)===null||i===void 0||i.gain.setTargetAtTime(e,0,.1):s.volume=e;qn()&&this._mediaStreamTrack._setVolume(e),this.elementVolume=e}getVolume(){if(this.elementVolume)return this.elementVolume;if(qn())return 1;let e=0;return this.attachedElements.forEach(i=>{i.volume>e&&(e=i.volume)}),e}setSinkId(e){return _(this,void 0,void 0,function*(){this.sinkId=e,yield Promise.all(this.attachedElements.map(i=>{if(Ih(i))return i.setSinkId(e)}))})}attach(e){const i=this.attachedElements.length===0;return e?super.attach(e):e=super.attach(),this.sinkId&&Ih(e)&&e.setSinkId(this.sinkId).catch(s=>{this.log.error("Failed to set sink id on remote audio track",s,this.logContext)}),this.audioContext&&i&&(this.log.debug("using audio context mapping",this.logContext),this.connectWebAudio(this.audioContext,e),e.volume=0,e.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),e}detach(e){let i;return e?(i=super.detach(e),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(i=super.detach(),this.disconnectWebAudio()),i}setAudioContext(e){this.audioContext=e,e&&this.attachedElements.length>0?this.connectWebAudio(e,this.attachedElements[0]):e||this.disconnectWebAudio()}setWebAudioPlugins(e){this.webAudioPluginNodes=e,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(e,i){this.disconnectWebAudio(),this.sourceNode=e.createMediaStreamSource(i.srcObject);let s=this.sourceNode;this.webAudioPluginNodes.forEach(o=>{s.connect(o),s=o}),this.gainNode=e.createGain(),s.connect(this.gainNode),this.gainNode.connect(e.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),e.state!=="running"&&e.resume().then(()=>{e.state!=="running"&&this.emit($.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(o=>{this.emit($.AudioPlaybackFailed,o)})}disconnectWebAudio(){var e,i;(e=this.gainNode)===null||e===void 0||e.disconnect(),(i=this.sourceNode)===null||i===void 0||i.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return _(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let i;return e.forEach(s=>{s.type==="inbound-rtp"&&(i={type:"audio",streamId:s.id,timestamp:s.timestamp,jitter:s.jitter,bytesReceived:s.bytesReceived,concealedSamples:s.concealedSamples,concealmentEvents:s.concealmentEvents,silentConcealedSamples:s.silentConcealedSamples,silentConcealmentEvents:s.silentConcealmentEvents,totalAudioEnergy:s.totalAudioEnergy,totalSamplesDuration:s.totalSamplesDuration})}),i})}}const hh=100;class mA extends fC{constructor(e,i,s,o,l){super(e,i,Q.Kind.Video,s,l),this.elementInfos=[],this.monitorReceiver=()=>_(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const d=yield this.getReceiverStats();d&&this.prevStats&&this.receiver&&(this._currentBitrate=yc(d,this.prevStats)),this.prevStats=d}),this.debouncedHandleResize=kf(()=>{this.updateDimensions()},hh),this.adaptiveStreamSettings=o}get isAdaptiveStream(){return this.adaptiveStreamSettings!==void 0}setStreamState(e){super.setStreamState(e),this.log.debug("setStreamState",e),this.isAdaptiveStream&&e===Q.StreamState.Active&&this.updateVisibility()}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(e){super.setMuted(e),this.attachedElements.forEach(i=>{e?xs(this._mediaStreamTrack,i):Ts(this._mediaStreamTrack,i)})}attach(e){if(e?super.attach(e):e=super.attach(),this.adaptiveStreamSettings&&this.elementInfos.find(i=>i.element===e)===void 0){const i=new pA(e);this.observeElementInfo(i)}return e}observeElementInfo(e){this.adaptiveStreamSettings&&this.elementInfos.find(i=>i===e)===void 0?(e.handleResize=()=>{this.debouncedHandleResize()},e.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(e),e.observe(),this.debouncedHandleResize(),this.updateVisibility()):this.log.warn("visibility resize observer not triggered",this.logContext)}stopObservingElementInfo(e){if(!this.isAdaptiveStream){this.log.warn("stopObservingElementInfo ignored",this.logContext);return}const i=this.elementInfos.filter(s=>s===e);for(const s of i)s.stopObserving();this.elementInfos=this.elementInfos.filter(s=>s!==e),this.updateVisibility(),this.debouncedHandleResize()}detach(e){let i=[];if(e)return this.stopObservingElement(e),super.detach(e);i=super.detach();for(const s of i)this.stopObservingElement(s);return i}getDecoderImplementation(){var e;return(e=this.prevStats)===null||e===void 0?void 0:e.decoderImplementation}getReceiverStats(){return _(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let i,s="",o=new Map;return e.forEach(l=>{l.type==="inbound-rtp"?(s=l.codecId,i={type:"video",streamId:l.id,framesDecoded:l.framesDecoded,framesDropped:l.framesDropped,framesReceived:l.framesReceived,packetsReceived:l.packetsReceived,packetsLost:l.packetsLost,frameWidth:l.frameWidth,frameHeight:l.frameHeight,pliCount:l.pliCount,firCount:l.firCount,nackCount:l.nackCount,jitter:l.jitter,timestamp:l.timestamp,bytesReceived:l.bytesReceived,decoderImplementation:l.decoderImplementation}):l.type==="codec"&&o.set(l.id,l)}),i&&s!==""&&o.get(s)&&(i.mimeType=o.get(s).mimeType),i})}stopObservingElement(e){const i=this.elementInfos.filter(s=>s.element===e);for(const s of i)this.stopObservingElementInfo(s)}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return _(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()})}updateVisibility(e){var i,s;const o=this.elementInfos.reduce((h,m)=>Math.max(h,m.visibilityChangedAt||0),0),l=!((s=(i=this.adaptiveStreamSettings)===null||i===void 0?void 0:i.pauseVideoInBackground)!==null&&s!==void 0)||s?this.isInBackground:!1,d=this.elementInfos.some(h=>h.pictureInPicture),u=this.elementInfos.some(h=>h.visible)&&!l||d;if(!(this.lastVisible===u&&!e)){if(!u&&Date.now()-o<hh){Rt.setTimeout(()=>{this.updateVisibility()},hh);return}this.lastVisible=u,this.emit($.VisibilityChanged,u,this)}}updateDimensions(){var e,i;let s=0,o=0;const l=this.getPixelDensity();for(const d of this.elementInfos){const u=d.width()*l,h=d.height()*l;u+h>s+o&&(s=u,o=h)}((e=this.lastDimensions)===null||e===void 0?void 0:e.width)===s&&((i=this.lastDimensions)===null||i===void 0?void 0:i.height)===o||(this.lastDimensions={width:s,height:o},this.emit($.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var e;const i=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pixelDensity;return i==="screen"?o0():i||(o0()>2?2:1)}}class pA{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(e,i){this.onVisibilityChanged=s=>{var o;const{target:l,isIntersecting:d}=s;l===this.element&&(this.isIntersecting=d,this.isPiP=Lr(this.element),this.visibilityChangedAt=Date.now(),(o=this.handleVisibilityChanged)===null||o===void 0||o.call(this))},this.onEnterPiP=()=>{var s,o,l;(o=(s=window.documentPictureInPicture)===null||s===void 0?void 0:s.window)===null||o===void 0||o.addEventListener("pagehide",this.onLeavePiP),this.isPiP=Lr(this.element),(l=this.handleVisibilityChanged)===null||l===void 0||l.call(this)},this.onLeavePiP=()=>{var s;this.isPiP=Lr(this.element),(s=this.handleVisibilityChanged)===null||s===void 0||s.call(this)},this.element=e,this.isIntersecting=i??Fh(e),this.isPiP=Kt()&&Lr(e),this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){var e,i,s;this.isIntersecting=Fh(this.element),this.isPiP=Lr(this.element),this.element.handleResize=()=>{var o;(o=this.handleResize)===null||o===void 0||o.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,c0().observe(this.element),l0().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP),(e=window.documentPictureInPicture)===null||e===void 0||e.addEventListener("enter",this.onEnterPiP),(s=(i=window.documentPictureInPicture)===null||i===void 0?void 0:i.window)===null||s===void 0||s.addEventListener("pagehide",this.onLeavePiP)}stopObserving(){var e,i,s,o,l;(e=c0())===null||e===void 0||e.unobserve(this.element),(i=l0())===null||i===void 0||i.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP),(s=window.documentPictureInPicture)===null||s===void 0||s.removeEventListener("enter",this.onEnterPiP),(l=(o=window.documentPictureInPicture)===null||o===void 0?void 0:o.window)===null||l===void 0||l.removeEventListener("pagehide",this.onLeavePiP)}}function Lr(a){var e,i;return document.pictureInPictureElement===a?!0:!((e=window.documentPictureInPicture)===null||e===void 0)&&e.window?Fh(a,(i=window.documentPictureInPicture)===null||i===void 0?void 0:i.window):!1}function Fh(a,e){const i=e||window;let s=a.offsetTop,o=a.offsetLeft;const l=a.offsetWidth,d=a.offsetHeight,{hidden:u}=a,{display:h}=getComputedStyle(a);for(;a.offsetParent;)a=a.offsetParent,s+=a.offsetTop,o+=a.offsetLeft;return s<i.pageYOffset+i.innerHeight&&o<i.pageXOffset+i.innerWidth&&s+d>i.pageYOffset&&o+l>i.pageXOffset&&!u&&h!=="none"}class ui extends Hn.EventEmitter{constructor(e,i,s,o){var l;super(),this.metadataMuted=!1,this.encryption=ht.NONE,this.log=Se,this.handleMuted=()=>{this.emit($.Muted)},this.handleUnmuted=()=>{this.emit($.Unmuted)},this.log=Bn((l=o?.loggerName)!==null&&l!==void 0?l:bn.Publication),this.loggerContextCb=this.loggerContextCb,this.setMaxListeners(100),this.kind=e,this.trackSid=i,this.trackName=s,this.source=Q.Source.Unknown}setTrack(e){this.track&&(this.track.off($.Muted,this.handleMuted),this.track.off($.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on($.Muted,this.handleMuted),e.on($.Unmuted,this.handleUnmuted))}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),Ee(this))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return this.track!==void 0}get isEncrypted(){return this.encryption!==ht.NONE}get audioTrack(){if(Un(this.track))return this.track}get videoTrack(){if(na(this.track))return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=Q.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===Q.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.encryption=e.encryption,this.trackInfo=e,this.log.debug("update publication info",Object.assign(Object.assign({},this.logContext),{info:e}))}}(function(a){(function(e){e.Desired="desired",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed"})(a.SubscriptionStatus||(a.SubscriptionStatus={})),(function(e){e.Allowed="allowed",e.NotAllowed="not_allowed"})(a.PermissionStatus||(a.PermissionStatus={}))})(ui||(ui={}));class Hh extends ui{get isUpstreamPaused(){var e;return(e=this.track)===null||e===void 0?void 0:e.isUpstreamPaused}constructor(e,i,s,o){super(e,i.sid,i.name,o),this.track=void 0,this.handleTrackEnded=()=>{this.emit($.Ended)},this.handleCpuConstrained=()=>{this.track&&na(this.track)&&this.emit($.CpuConstrained,this.track)},this.updateInfo(i),this.setTrack(s)}setTrack(e){this.track&&(this.track.off($.Ended,this.handleTrackEnded),this.track.off($.CpuConstrained,this.handleCpuConstrained)),super.setTrack(e),e&&(e.on($.Ended,this.handleTrackEnded),e.on($.CpuConstrained,this.handleCpuConstrained))}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}get isLocal(){return!0}mute(){return _(this,void 0,void 0,function*(){var e;return(e=this.track)===null||e===void 0?void 0:e.mute()})}unmute(){return _(this,void 0,void 0,function*(){var e;return(e=this.track)===null||e===void 0?void 0:e.unmute()})}pauseUpstream(){return _(this,void 0,void 0,function*(){var e;yield(e=this.track)===null||e===void 0?void 0:e.pauseUpstream()})}resumeUpstream(){return _(this,void 0,void 0,function*(){var e;yield(e=this.track)===null||e===void 0?void 0:e.resumeUpstream()})}getTrackFeatures(){var e;if(Un(this.track)){const i=this.track.getSourceTrackSettings(),s=new Set;return i.autoGainControl&&s.add(Ct.TF_AUTO_GAIN_CONTROL),i.echoCancellation&&s.add(Ct.TF_ECHO_CANCELLATION),i.noiseSuppression&&s.add(Ct.TF_NOISE_SUPPRESSION),i.channelCount&&i.channelCount>1&&s.add(Ct.TF_STEREO),!((e=this.options)===null||e===void 0)&&e.dtx||s.add(Ct.TF_NO_DTX),this.track.enhancedNoiseCancellation&&s.add(Ct.TF_ENHANCED_NOISE_CANCELLATION),Array.from(s.values())}else return[]}}function bc(a,e){return _(this,void 0,void 0,function*(){a??(a={});let i=!1;const{audioProcessor:s,videoProcessor:o,optionsWithoutProcessor:l}=$S(a);let d=l.audio,u=l.video;if(s&&typeof l.audio=="object"&&(l.audio.processor=s),o&&typeof l.video=="object"&&(l.video.processor=o),a.audio&&typeof l.audio=="object"&&typeof l.audio.deviceId=="string"){const y=l.audio.deviceId;l.audio.deviceId={exact:y},i=!0,d=Object.assign(Object.assign({},l.audio),{deviceId:{ideal:y}})}if(l.video&&typeof l.video=="object"&&typeof l.video.deviceId=="string"){const y=l.video.deviceId;l.video.deviceId={exact:y},i=!0,u=Object.assign(Object.assign({},l.video),{deviceId:{ideal:y}})}l.audio===!0?l.audio={deviceId:"default"}:typeof l.audio=="object"&&l.audio!==null&&(l.audio=Object.assign(Object.assign({},l.audio),{deviceId:l.audio.deviceId||"default"})),l.video===!0?l.video={deviceId:"default"}:typeof l.video=="object"&&!l.video.deviceId&&(l.video.deviceId="default");const h=XS(l,aC,sC),m=bf(h),g=navigator.mediaDevices.getUserMedia(m);l.audio&&(Tt.userMediaPromiseMap.set("audioinput",g),g.catch(()=>Tt.userMediaPromiseMap.delete("audioinput"))),l.video&&(Tt.userMediaPromiseMap.set("videoinput",g),g.catch(()=>Tt.userMediaPromiseMap.delete("videoinput")));try{const y=yield g;return yield Promise.all(y.getTracks().map(S=>_(this,void 0,void 0,function*(){const T=S.kind==="audio";let x=T?h.audio:h.video;(typeof x=="boolean"||!x)&&(x={});let E;const k=T?m.audio:m.video;typeof k!="boolean"&&(E=k);const R=S.getSettings().deviceId;E?.deviceId&&wa(E.deviceId)!==R?E.deviceId=R:E||(E={deviceId:R});const O=HM(S,E,e);return O.kind===Q.Kind.Video?O.source=Q.Source.Camera:O.kind===Q.Kind.Audio&&(O.source=Q.Source.Microphone),O.mediaStream=y,Un(O)&&s?yield O.setProcessor(s):na(O)&&o&&(yield O.setProcessor(o)),O})))}catch(y){if(!i)throw y;return bc(Object.assign(Object.assign({},a),{audio:d,video:u}),e)}})}function gA(a){return _(this,void 0,void 0,function*(){return(yield bc({audio:!1,video:!0}))[0]})}function mC(a){return _(this,void 0,void 0,function*(){return(yield bc({audio:a??!0,video:!1}))[0]})}var Ji;(function(a){a.Excellent="excellent",a.Good="good",a.Poor="poor",a.Lost="lost",a.Unknown="unknown"})(Ji||(Ji={}));function vA(a){switch(a){case Ur.EXCELLENT:return Ji.Excellent;case Ur.GOOD:return Ji.Good;case Ur.POOR:return Ji.Poor;case Ur.LOST:return Ji.Lost;default:return Ji.Unknown}}class pC extends Hn.EventEmitter{get logContext(){var e,i;return Object.assign({},(i=(e=this.loggerOptions)===null||e===void 0?void 0:e.loggerContextCb)===null||i===void 0?void 0:i.call(e))}get isEncrypted(){return this.trackPublications.size>0&&Array.from(this.trackPublications.values()).every(e=>e.isEncrypted)}get isAgent(){var e;return((e=this.permissions)===null||e===void 0?void 0:e.agent)||this.kind===Qr.AGENT}get isActive(){var e;return((e=this.participantInfo)===null||e===void 0?void 0:e.state)===Es.ACTIVE}get kind(){return this._kind}get attributes(){return Object.freeze(Object.assign({},this._attributes))}constructor(e,i,s,o,l,d){let u=arguments.length>6&&arguments[6]!==void 0?arguments[6]:Qr.STANDARD;var h;super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=Ji.Unknown,this.log=Se,this.log=Bn((h=d?.loggerName)!==null&&h!==void 0?h:bn.Participant),this.loggerOptions=d,this.setMaxListeners(100),this.sid=e,this.identity=i,this.name=s,this.metadata=o,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this._kind=u,this._attributes=l??{}}getTrackPublications(){return Array.from(this.trackPublications.values())}getTrackPublication(e){for(const[,i]of this.trackPublications)if(i.source===e)return i}getTrackPublicationByName(e){for(const[,i]of this.trackPublications)if(i.trackName===e)return i}waitUntilActive(){return this.isActive?Promise.resolve():this.activeFuture?this.activeFuture.promise:(this.activeFuture=new yn,this.once(ae.Active,()=>{var e,i;(i=(e=this.activeFuture)===null||e===void 0?void 0:e.resolve)===null||i===void 0||i.call(e),this.activeFuture=void 0}),this.activeFuture.promise)}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const i=this.getTrackPublication(Q.Source.Camera);return!(!((e=i?.isMuted)!==null&&e!==void 0)||e)}get isMicrophoneEnabled(){var e;const i=this.getTrackPublication(Q.Source.Microphone);return!(!((e=i?.isMuted)!==null&&e!==void 0)||e)}get isScreenShareEnabled(){return!!this.getTrackPublication(Q.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(Number.parseInt(this.participantInfo.joinedAt.toString())*1e3):new Date}updateInfo(e){var i;return this.participantInfo&&this.participantInfo.sid===e.sid&&this.participantInfo.version>e.version?!1:(this.identity=e.identity,this.sid=e.sid,this._setName(e.name),this._setMetadata(e.metadata),this._setAttributes(e.attributes),e.state===Es.ACTIVE&&((i=this.participantInfo)===null||i===void 0?void 0:i.state)!==Es.ACTIVE&&this.emit(ae.Active),e.permission&&this.setPermissions(e.permission),this.participantInfo=e,!0)}_setMetadata(e){const i=this.metadata!==e,s=this.metadata;this.metadata=e,i&&this.emit(ae.ParticipantMetadataChanged,s)}_setName(e){const i=this.name!==e;this.name=e,i&&this.emit(ae.ParticipantNameChanged,e)}_setAttributes(e){const i=IR(this.attributes,e);this._attributes=e,Object.keys(i).length>0&&this.emit(ae.AttributesChanged,i)}setPermissions(e){var i,s,o,l,d,u;const h=this.permissions,m=e.canPublish!==((i=this.permissions)===null||i===void 0?void 0:i.canPublish)||e.canSubscribe!==((s=this.permissions)===null||s===void 0?void 0:s.canSubscribe)||e.canPublishData!==((o=this.permissions)===null||o===void 0?void 0:o.canPublishData)||e.hidden!==((l=this.permissions)===null||l===void 0?void 0:l.hidden)||e.recorder!==((d=this.permissions)===null||d===void 0?void 0:d.recorder)||e.canPublishSources.length!==this.permissions.canPublishSources.length||e.canPublishSources.some((g,y)=>{var S;return g!==((S=this.permissions)===null||S===void 0?void 0:S.canPublishSources[y])})||e.canSubscribeMetrics!==((u=this.permissions)===null||u===void 0?void 0:u.canSubscribeMetrics);return this.permissions=e,m&&this.emit(ae.ParticipantPermissionsChanged,h),m}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(ae.IsSpeakingChanged,e))}setConnectionQuality(e){const i=this._connectionQuality;this._connectionQuality=vA(e),i!==this._connectionQuality&&this.emit(ae.ConnectionQualityChanged,this._connectionQuality)}setDisconnected(){var e,i;this.activeFuture&&((i=(e=this.activeFuture).reject)===null||i===void 0||i.call(e,new Error("Participant disconnected")),this.activeFuture=void 0)}setAudioContext(e){this.audioContext=e,this.audioTrackPublications.forEach(i=>Un(i.track)&&i.track.setAudioContext(e))}addTrackPublication(e){e.on($.Muted,()=>{this.emit(ae.TrackMuted,e)}),e.on($.Unmuted,()=>{this.emit(ae.TrackUnmuted,e)});const i=e;switch(i.track&&(i.track.sid=e.trackSid),this.trackPublications.set(e.trackSid,e),e.kind){case Q.Kind.Audio:this.audioTrackPublications.set(e.trackSid,e);break;case Q.Kind.Video:this.videoTrackPublications.set(e.trackSid,e);break}}}function yA(a){var e,i,s;if(!a.participantSid&&!a.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new dS({participantIdentity:(e=a.participantIdentity)!==null&&e!==void 0?e:"",participantSid:(i=a.participantSid)!==null&&i!==void 0?i:"",allTracks:(s=a.allowAll)!==null&&s!==void 0?s:!1,trackSids:a.allowedTrackSids||[]})}class bA extends pC{constructor(e,i,s,o,l,d){super(e,i,void 0,void 0,void 0,{loggerName:o.loggerName,loggerContextCb:()=>this.engine.logContext}),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=ht.NONE,this.enabledPublishVideoCodecs=[],this.pendingAcks=new Map,this.pendingResponses=new Map,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new yn)},this.handleReconnected=()=>{var u,h;(h=(u=this.reconnectFuture)===null||u===void 0?void 0:u.resolve)===null||h===void 0||h.call(u),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleClosing=()=>{var u,h,m,g,y,S;this.reconnectFuture&&(this.reconnectFuture.promise.catch(T=>this.log.warn(T.message,this.logContext)),(h=(u=this.reconnectFuture)===null||u===void 0?void 0:u.reject)===null||h===void 0||h.call(u,new Error("Got disconnected during reconnection attempt")),this.reconnectFuture=void 0),this.signalConnectedFuture&&((g=(m=this.signalConnectedFuture).reject)===null||g===void 0||g.call(m,new Error("Got disconnected without signal connected")),this.signalConnectedFuture=void 0),(S=(y=this.activeAgentFuture)===null||y===void 0?void 0:y.reject)===null||S===void 0||S.call(y,new Error("Got disconnected without active agent present")),this.activeAgentFuture=void 0,this.firstActiveAgent=void 0},this.handleSignalConnected=u=>{var h,m;u.participant&&this.updateInfo(u.participant),this.signalConnectedFuture||(this.signalConnectedFuture=new yn),(m=(h=this.signalConnectedFuture).resolve)===null||m===void 0||m.call(h)},this.handleSignalRequestResponse=u=>{const{requestId:h,reason:m,message:g}=u,y=this.pendingSignalRequests.get(h);y&&(m!==mf.OK&&y.reject(new n0(g,m)),this.pendingSignalRequests.delete(h))},this.handleDataPacket=u=>{switch(u.value.case){case"rpcResponse":let h=u.value.value,m=null,g=null;h.value.case==="payload"?m=h.value.value:h.value.case==="error"&&(g=rt.fromProto(h.value.value)),this.handleIncomingRpcResponse(h.requestId,m,g);break;case"rpcAck":let y=u.value.value;this.handleIncomingRpcAck(y.requestId);break}},this.updateTrackSubscriptionPermissions=()=>{this.log.debug("updating track subscription permissions",Object.assign(Object.assign({},this.logContext),{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions})),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(u=>yA(u)))},this.onTrackUnmuted=u=>{this.onTrackMuted(u,u.isUpstreamPaused)},this.onTrackMuted=(u,h)=>{if(h===void 0&&(h=!0),!u.sid){this.log.error("could not update mute status for unpublished track",Object.assign(Object.assign({},this.logContext),Ee(u)));return}this.engine.updateMuteStatus(u.sid,h)},this.onTrackUpstreamPaused=u=>{this.log.debug("upstream paused",Object.assign(Object.assign({},this.logContext),Ee(u))),this.onTrackMuted(u,!0)},this.onTrackUpstreamResumed=u=>{this.log.debug("upstream resumed",Object.assign(Object.assign({},this.logContext),Ee(u))),this.onTrackMuted(u,u.isMuted)},this.onTrackFeatureUpdate=u=>{const h=this.audioTrackPublications.get(u.sid);if(!h){this.log.warn("Could not update local audio track settings, missing publication for track ".concat(u.sid),this.logContext);return}this.engine.client.sendUpdateLocalAudioTrack(h.trackSid,h.getTrackFeatures())},this.onTrackCpuConstrained=(u,h)=>{this.log.debug("track cpu constrained",Object.assign(Object.assign({},this.logContext),Ee(h))),this.emit(ae.LocalTrackCpuConstrained,u,h)},this.handleSubscribedQualityUpdate=u=>_(this,void 0,void 0,function*(){var h,m,g,y,S;if(!(!((S=this.roomOptions)===null||S===void 0)&&S.dynacast))return;const T=this.videoTrackPublications.get(u.trackSid);if(!T){this.log.warn("received subscribed quality update for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:u.trackSid}));return}if(!T.videoTrack)return;const x=yield T.videoTrack.setPublishingCodecs(u.subscribedCodecs);try{for(var E=!0,k=mi(x),R;R=yield k.next(),h=R.done,!h;E=!0){y=R.value,E=!1;const O=y;NR(O)&&(this.log.debug("publish ".concat(O," for ").concat(T.videoTrack.sid),Object.assign(Object.assign({},this.logContext),Ee(T))),yield this.publishAdditionalCodecForTrack(T.videoTrack,O,T.options))}}catch(O){m={error:O}}finally{try{!E&&!h&&(g=k.return)&&(yield g.call(k))}finally{if(m)throw m.error}}}),this.handleLocalTrackUnpublished=u=>{const h=this.trackPublications.get(u.trackSid);if(!h){this.log.warn("received unpublished event for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:u.trackSid}));return}this.unpublishTrack(h.track)},this.handleTrackEnded=u=>_(this,void 0,void 0,function*(){if(u.source===Q.Source.ScreenShare||u.source===Q.Source.ScreenShareAudio)this.log.debug("unpublishing local track due to TrackEnded",Object.assign(Object.assign({},this.logContext),Ee(u))),this.unpublishTrack(u);else if(u.isUserProvided)yield u.mute();else if(ci(u)||Ki(u))try{if(Kt())try{const h=yield navigator?.permissions.query({name:u.source===Q.Source.Camera?"camera":"microphone"});if(h&&h.state==="denied")throw this.log.warn("user has revoked access to ".concat(u.source),Object.assign(Object.assign({},this.logContext),Ee(u))),h.onchange=()=>{h.state!=="denied"&&(u.isMuted||u.restartTrack(),h.onchange=null)},new Error("GetUserMedia Permission denied")}catch{}u.isMuted||(this.log.debug("track ended, attempting to use a different device",Object.assign(Object.assign({},this.logContext),Ee(u))),ci(u)?yield u.restartTrack({deviceId:"default"}):yield u.restartTrack())}catch{this.log.warn("could not restart track, muting instead",Object.assign(Object.assign({},this.logContext),Ee(u))),yield u.mute()}}),this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this.engine=s,this.roomOptions=o,this.setupEngine(s),this.activeDeviceMap=new Map([["audioinput","default"],["videoinput","default"],["audiooutput","default"]]),this.pendingSignalRequests=new Map,this.rpcHandlers=l,this.roomOutgoingDataStreamManager=d}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==ht.NONE}getTrackPublication(e){const i=super.getTrackPublication(e);if(i)return i}getTrackPublicationByName(e){const i=super.getTrackPublicationByName(e);if(i)return i}setupEngine(e){var i;this.engine=e,this.engine.on(ie.RemoteMute,(s,o)=>{const l=this.trackPublications.get(s);!l||!l.track||(o?l.mute():l.unmute())}),!((i=this.signalConnectedFuture)===null||i===void 0)&&i.isResolved&&(this.signalConnectedFuture=void 0),this.engine.on(ie.Connected,this.handleReconnected).on(ie.SignalConnected,this.handleSignalConnected).on(ie.SignalRestarted,this.handleReconnected).on(ie.SignalResumed,this.handleReconnected).on(ie.Restarting,this.handleReconnecting).on(ie.Resuming,this.handleReconnecting).on(ie.LocalTrackUnpublished,this.handleLocalTrackUnpublished).on(ie.SubscribedQualityUpdate,this.handleSubscribedQualityUpdate).on(ie.Closing,this.handleClosing).on(ie.SignalRequestResponse,this.handleSignalRequestResponse).on(ie.DataPacketReceived,this.handleDataPacket)}setMetadata(e){return _(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({metadata:e})})}setName(e){return _(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({name:e})})}setAttributes(e){return _(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({attributes:e})})}requestMetadataUpdate(e){return _(this,arguments,void 0,function(i){var s=this;let{metadata:o,name:l,attributes:d}=i;return(function*(){return new Nt((u,h)=>_(s,void 0,void 0,function*(){var m,g;try{let y=!1;const S=yield this.engine.client.sendUpdateLocalMetadata((m=o??this.metadata)!==null&&m!==void 0?m:"",(g=l??this.name)!==null&&g!==void 0?g:"",d),T=performance.now();for(this.pendingSignalRequests.set(S,{resolve:u,reject:x=>{h(x),y=!0},values:{name:l,metadata:o,attributes:d}});performance.now()-T<5e3&&!y;){if((!l||this.name===l)&&(!o||this.metadata===o)&&(!d||Object.entries(d).every(x=>{let[E,k]=x;return this.attributes[E]===k||k===""&&!this.attributes[E]}))){this.pendingSignalRequests.delete(S),u();return}yield Mt(50)}h(new n0("Request to update local metadata timed out","TimeoutError"))}catch(y){y instanceof Error?h(y):h(new Error(String(y)))}}))})()})}setCameraEnabled(e,i,s){return this.setTrackEnabled(Q.Source.Camera,e,i,s)}setMicrophoneEnabled(e,i,s){return this.setTrackEnabled(Q.Source.Microphone,e,i,s)}setScreenShareEnabled(e,i,s){return this.setTrackEnabled(Q.Source.ScreenShare,e,i,s)}setE2EEEnabled(e){return _(this,void 0,void 0,function*(){this.encryptionType=e?ht.GCM:ht.NONE,yield this.republishAllTracks(void 0,!1)})}setTrackEnabled(e,i,s,o){return _(this,void 0,void 0,function*(){var l,d;this.log.debug("setTrackEnabled",Object.assign(Object.assign({},this.logContext),{source:e,enabled:i})),this.republishPromise&&(yield this.republishPromise);let u=this.getTrackPublication(e);if(i)if(u)yield u.unmute();else{let h;if(this.pendingPublishing.has(e)){const m=yield this.waitForPendingPublicationOfSource(e);return m||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e})),yield m?.unmute(),m}this.pendingPublishing.add(e);try{switch(e){case Q.Source.Camera:h=yield this.createTracks({video:(l=s)!==null&&l!==void 0?l:!0});break;case Q.Source.Microphone:h=yield this.createTracks({audio:(d=s)!==null&&d!==void 0?d:!0});break;case Q.Source.ScreenShare:h=yield this.createScreenTracks(Object.assign({},s));break;default:throw new pi(e)}}catch(m){throw h?.forEach(g=>{g.stop()}),m instanceof Error&&this.emit(ae.MediaDevicesError,m,Oh(e)),this.pendingPublishing.delete(e),m}for(const m of h){const g=Object.assign(Object.assign({},this.roomOptions.publishDefaults),s);e===Q.Source.Microphone&&Un(m)&&g.preConnectBuffer&&(this.log.info("starting preconnect buffer for microphone",Object.assign({},this.logContext)),m.startPreConnectBuffer())}try{const m=[];for(const y of h)this.log.info("publishing track",Object.assign(Object.assign({},this.logContext),Ee(y))),m.push(this.publishTrack(y,o));[u]=yield Promise.all(m)}catch(m){throw h?.forEach(g=>{g.stop()}),m}finally{this.pendingPublishing.delete(e)}}else if(!u?.track&&this.pendingPublishing.has(e)&&(u=yield this.waitForPendingPublicationOfSource(e),u||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e}))),u&&u.track)if(e===Q.Source.ScreenShare){u=yield this.unpublishTrack(u.track);const h=this.getTrackPublication(Q.Source.ScreenShareAudio);h&&h.track&&this.unpublishTrack(h.track)}else yield u.mute();return u})}enableCameraAndMicrophone(){return _(this,void 0,void 0,function*(){if(!(this.pendingPublishing.has(Q.Source.Camera)||this.pendingPublishing.has(Q.Source.Microphone))){this.pendingPublishing.add(Q.Source.Camera),this.pendingPublishing.add(Q.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map(i=>this.publishTrack(i)))}finally{this.pendingPublishing.delete(Q.Source.Camera),this.pendingPublishing.delete(Q.Source.Microphone)}}})}createTracks(e){return _(this,void 0,void 0,function*(){var i,s;e??(e={});const o=XS(e,(i=this.roomOptions)===null||i===void 0?void 0:i.audioCaptureDefaults,(s=this.roomOptions)===null||s===void 0?void 0:s.videoCaptureDefaults);try{return(yield bc(o,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext})).map(u=>(Un(u)&&(this.microphoneError=void 0,u.setAudioContext(this.audioContext),u.source=Q.Source.Microphone,this.emit(ae.AudioStreamAcquired)),na(u)&&(this.cameraError=void 0,u.source=Q.Source.Camera),u))}catch(l){throw l instanceof Error&&(e.audio&&(this.microphoneError=l),e.video&&(this.cameraError=l)),l}})}createScreenTracks(e){return _(this,void 0,void 0,function*(){if(e===void 0&&(e={}),navigator.mediaDevices.getDisplayMedia===void 0)throw new vf("getDisplayMedia not supported");e.resolution===void 0&&!GR()&&(e.resolution=yf.h1080fps30.resolution);const i=OR(e),s=yield navigator.mediaDevices.getDisplayMedia(i),o=s.getVideoTracks();if(o.length===0)throw new pi("no video track found");const l=new ic(o[0],void 0,!1,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});l.source=Q.Source.ScreenShare,e.contentHint&&(l.mediaStreamTrack.contentHint=e.contentHint);const d=[l];if(s.getAudioTracks().length>0){this.emit(ae.AudioStreamAcquired);const u=new nc(s.getAudioTracks()[0],void 0,!1,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});u.source=Q.Source.ScreenShareAudio,d.push(u)}return d})}publishTrack(e,i){return _(this,void 0,void 0,function*(){return this.publishOrRepublishTrack(e,i)})}publishOrRepublishTrack(e,i){return _(this,arguments,void 0,function(s,o){var l=this;let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return(function*(){var u,h,m,g;ci(s)&&s.setAudioContext(l.audioContext),yield(u=l.reconnectFuture)===null||u===void 0?void 0:u.promise,l.republishPromise&&!d&&(yield l.republishPromise),Rs(s)&&l.pendingPublishPromises.has(s)&&(yield l.pendingPublishPromises.get(s));let y;if(s instanceof MediaStreamTrack)y=s.getConstraints();else{y=s.constraints;let R;switch(s.source){case Q.Source.Microphone:R="audioinput";break;case Q.Source.Camera:R="videoinput"}R&&l.activeDeviceMap.has(R)&&(y=Object.assign(Object.assign({},y),{deviceId:l.activeDeviceMap.get(R)}))}if(s instanceof MediaStreamTrack)switch(s.kind){case"audio":s=new nc(s,y,!0,l.audioContext,{loggerName:l.roomOptions.loggerName,loggerContextCb:()=>l.logContext});break;case"video":s=new ic(s,y,!0,{loggerName:l.roomOptions.loggerName,loggerContextCb:()=>l.logContext});break;default:throw new pi("unsupported MediaStreamTrack kind ".concat(s.kind))}else s.updateLoggerOptions({loggerName:l.roomOptions.loggerName,loggerContextCb:()=>l.logContext});let S;if(l.trackPublications.forEach(R=>{R.track&&R.track===s&&(S=R)}),S)return l.log.warn("track has already been published, skipping",Object.assign(Object.assign({},l.logContext),Ee(S))),S;const T=Object.assign(Object.assign({},l.roomOptions.publishDefaults),o),x="channelCount"in s.mediaStreamTrack.getSettings()&&s.mediaStreamTrack.getSettings().channelCount===2||s.mediaStreamTrack.getConstraints().channelCount===2,E=(h=T.forceStereo)!==null&&h!==void 0?h:x;E&&(T.dtx===void 0&&l.log.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work.",Object.assign(Object.assign({},l.logContext),Ee(s))),T.red===void 0&&l.log.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),(m=T.dtx)!==null&&m!==void 0||(T.dtx=!1),(g=T.red)!==null&&g!==void 0||(T.red=!1)),!YR()&&l.roomOptions.e2ee&&(l.log.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari versions and iOS browsers running iOS < v17.2",Object.assign({},l.logContext)),T.simulcast=!1),T.source&&(s.source=T.source);const k=new Promise((R,O)=>_(l,void 0,void 0,function*(){try{if(this.engine.client.currentState!==Je.CONNECTED){this.log.debug("deferring track publication until signal is connected",Object.assign(Object.assign({},this.logContext),{track:Ee(s)}));let L=!1;const D=setTimeout(()=>{L=!0,s.stop(),O(new t0("publishing rejected as engine not connected within timeout",408))},15e3);if(yield this.waitUntilEngineConnected(),clearTimeout(D),L)return;const I=yield this.publish(s,T,E);R(I)}else try{const L=yield this.publish(s,T,E);R(L)}catch(L){O(L)}}catch(L){O(L)}}));l.pendingPublishPromises.set(s,k);try{return yield k}catch(R){throw R}finally{l.pendingPublishPromises.delete(s)}})()})}waitUntilEngineConnected(){return this.signalConnectedFuture||(this.signalConnectedFuture=new yn),this.signalConnectedFuture.promise}hasPermissionsToPublish(e){if(!this.permissions)return this.log.warn("no permissions present for publishing track",Object.assign(Object.assign({},this.logContext),Ee(e))),!1;const{canPublish:i,canPublishSources:s}=this.permissions;return i&&(s.length===0||s.map(o=>LR(o)).includes(e.source))?!0:(this.log.warn("insufficient permissions to publish",Object.assign(Object.assign({},this.logContext),Ee(e))),!1)}publish(e,i,s){return _(this,void 0,void 0,function*(){var o,l,d,u,h,m,g,y,S,T;if(!this.hasPermissionsToPublish(e))throw new t0("failed to publish track, insufficient permissions",403);Array.from(this.trackPublications.values()).find(ee=>Rs(e)&&ee.source===e.source)&&e.source!==Q.Source.Unknown&&this.log.info("publishing a second track with the same source: ".concat(e.source),Object.assign(Object.assign({},this.logContext),Ee(e))),i.stopMicTrackOnMute&&Un(e)&&(e.stopOnMute=!0),e.source===Q.Source.ScreenShare&&Ma()&&(i.simulcast=!1),i.videoCodec==="av1"&&!FR()&&(i.videoCodec=void 0),i.videoCodec==="vp9"&&!HR()&&(i.videoCodec=void 0),i.videoCodec===void 0&&(i.videoCodec=Bh),this.enabledPublishVideoCodecs.length>0&&(this.enabledPublishVideoCodecs.some(ee=>i.videoCodec===Fr(ee.mime))||(i.videoCodec=Fr(this.enabledPublishVideoCodecs[0].mime)));const E=i.videoCodec;e.on($.Muted,this.onTrackMuted),e.on($.Unmuted,this.onTrackUnmuted),e.on($.Ended,this.handleTrackEnded),e.on($.UpstreamPaused,this.onTrackUpstreamPaused),e.on($.UpstreamResumed,this.onTrackUpstreamResumed),e.on($.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate);const k=[],R=!(!((o=i.dtx)!==null&&o!==void 0)||o),O=e.getSourceTrackSettings();O.autoGainControl&&k.push(Ct.TF_AUTO_GAIN_CONTROL),O.echoCancellation&&k.push(Ct.TF_ECHO_CANCELLATION),O.noiseSuppression&&k.push(Ct.TF_NOISE_SUPPRESSION),O.channelCount&&O.channelCount>1&&k.push(Ct.TF_STEREO),R&&k.push(Ct.TF_NO_DTX),ci(e)&&e.hasPreConnectBuffer&&k.push(Ct.TF_PRECONNECT_BUFFER);const L=new Xr({cid:e.mediaStreamTrack.id,name:i.name,type:Q.kindToProto(e.kind),muted:e.isMuted,source:Q.sourceToProto(e.source),disableDtx:R,encryption:this.encryptionType,stereo:s,disableRed:this.isE2EEEnabled||!(!((l=i.red)!==null&&l!==void 0)||l),stream:i?.stream,backupCodecPolicy:i?.backupCodecPolicy,audioFeatures:k});let D;if(e.kind===Q.Kind.Video){let ee={width:0,height:0};try{ee=yield e.waitForDimensions()}catch{const re=(u=(d=this.roomOptions.videoCaptureDefaults)===null||d===void 0?void 0:d.resolution)!==null&&u!==void 0?u:Wr.h720.resolution;ee={width:re.width,height:re.height},this.log.error("could not determine track dimensions, using defaults",Object.assign(Object.assign(Object.assign({},this.logContext),Ee(e)),{dims:ee}))}L.width=ee.width,L.height=ee.height,Ki(e)&&(Rn(E)&&(e.source===Q.Source.ScreenShare&&(i.scalabilityMode="L1T3","contentHint"in e.mediaStreamTrack&&(e.mediaStreamTrack.contentHint="motion",this.log.info("forcing contentHint to motion for screenshare with SVC codecs",Object.assign(Object.assign({},this.logContext),Ee(e))))),i.scalabilityMode=(h=i.scalabilityMode)!==null&&h!==void 0?h:"L3T3_KEY"),L.simulcastCodecs=[new Ch({codec:E,cid:e.mediaStreamTrack.id})],i.backupCodec===!0&&(i.backupCodec={codec:Bh}),i.backupCodec&&E!==i.backupCodec.codec&&L.encryption===ht.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),L.simulcastCodecs.push(new Ch({codec:i.backupCodec.codec,cid:""})))),D=zh(e.source===Q.Source.ScreenShare,L.width,L.height,i),L.layers=M0(L.width,L.height,D,Rn(i.videoCodec))}else e.kind===Q.Kind.Audio&&(D=[{maxBitrate:(m=i.audioPreset)===null||m===void 0?void 0:m.maxBitrate,priority:(y=(g=i.audioPreset)===null||g===void 0?void 0:g.priority)!==null&&y!==void 0?y:"high",networkPriority:(T=(S=i.audioPreset)===null||S===void 0?void 0:S.priority)!==null&&T!==void 0?T:"high"}]);if(!this.engine||this.engine.isClosed)throw new ut("cannot publish track when not connected");const I=()=>_(this,void 0,void 0,function*(){var ee,te,re;if(!this.engine.pcManager)throw new ut("pcManager is not ready");if(e.sender=yield this.engine.createSender(e,i,D),this.emit(ae.LocalSenderCreated,e.sender,e),Ki(e)&&((ee=i.degradationPreference)!==null&&ee!==void 0||(i.degradationPreference=$M(e)),e.setDegradationPreference(i.degradationPreference)),D)if(Ma()&&e.kind===Q.Kind.Audio){let ue;for(const Ae of this.engine.pcManager.publisher.getTransceivers())if(Ae.sender===e.sender){ue=Ae;break}ue&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:ue,codec:"opus",maxbr:!((te=D[0])===null||te===void 0)&&te.maxBitrate?D[0].maxBitrate/1e3:0})}else e.codec&&Rn(e.codec)&&(!((re=D[0])===null||re===void 0)&&re.maxBitrate)&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:L.cid,codec:e.codec,maxbr:D[0].maxBitrate/1e3});yield this.engine.negotiate()});let P;const H=new Promise((ee,te)=>_(this,void 0,void 0,function*(){var re;try{P=yield this.engine.addTrack(L),ee(P)}catch(ue){e.sender&&(!((re=this.engine.pcManager)===null||re===void 0)&&re.publisher)&&(this.engine.pcManager.publisher.removeTrack(e.sender),yield this.engine.negotiate().catch(Ae=>{this.log.error("failed to negotiate after removing track due to failed add track request",Object.assign(Object.assign(Object.assign({},this.logContext),Ee(e)),{error:Ae}))})),te(ue)}}));if(this.enabledPublishVideoCodecs.length>0)P=(yield Promise.all([H,I()]))[0];else{P=yield H;let ee;if(P.codecs.forEach(te=>{ee===void 0&&(ee=te.mimeType)}),ee&&e.kind===Q.Kind.Video){const te=Fr(ee);te!==E&&(this.log.debug("falling back to server selected codec",Object.assign(Object.assign(Object.assign({},this.logContext),Ee(e)),{codec:te})),i.videoCodec=te,D=zh(e.source===Q.Source.ScreenShare,L.width,L.height,i))}yield I()}const Z=new Hh(e.kind,P,e,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});if(Z.on($.CpuConstrained,ee=>this.onTrackCpuConstrained(ee,Z)),Z.options=i,e.sid=P.sid,this.log.debug("publishing ".concat(e.kind," with encodings"),Object.assign(Object.assign({},this.logContext),{encodings:D,trackInfo:P})),Ki(e)?e.startMonitor(this.engine.client):ci(e)&&e.startMonitor(),this.addTrackPublication(Z),this.emit(ae.LocalTrackPublished,Z),ci(e)&&P.audioFeatures.includes(Ct.TF_PRECONNECT_BUFFER)){const ee=e.getPreConnectBuffer(),te=e.getPreConnectBufferMimeType();this.on(ae.LocalTrackSubscribed,re=>{if(re.trackSid===P.sid){if(!e.hasPreConnectBuffer){this.log.warn("subscribe event came to late, buffer already closed",this.logContext);return}this.log.debug("finished recording preconnect buffer",Object.assign(Object.assign({},this.logContext),Ee(e))),e.stopPreConnectBuffer()}}),ee&&new Promise((ue,Ae)=>_(this,void 0,void 0,function*(){var Xe,Fe,F,ne,he,Oe;try{this.log.debug("waiting for agent",Object.assign(Object.assign({},this.logContext),Ee(e)));const se=setTimeout(()=>{Ae(new Error("agent not active within 10 seconds"))},1e4),le=yield this.waitUntilActiveAgentPresent();clearTimeout(se),this.log.debug("sending preconnect buffer",Object.assign(Object.assign({},this.logContext),Ee(e)));const pe=yield this.streamBytes({name:"preconnect-buffer",mimeType:te,topic:"lk.agent.pre-connect-audio-buffer",destinationIdentities:[le.identity],attributes:{trackId:Z.trackSid,sampleRate:String((he=O.sampleRate)!==null&&he!==void 0?he:"48000"),channels:String((Oe=O.channelCount)!==null&&Oe!==void 0?Oe:"1")}});try{for(var Le=!0,A=mi(ee),Y;Y=yield A.next(),Xe=Y.done,!Xe;Le=!0){ne=Y.value,Le=!1;const ye=ne;yield pe.write(ye)}}catch(ye){Fe={error:ye}}finally{try{!Le&&!Xe&&(F=A.return)&&(yield F.call(A))}finally{if(Fe)throw Fe.error}}yield pe.close(),ue()}catch(se){Ae(se)}})).then(()=>{this.log.debug("preconnect buffer sent successfully",Object.assign(Object.assign({},this.logContext),Ee(e)))}).catch(ue=>{this.log.error("error sending preconnect buffer",Object.assign(Object.assign(Object.assign({},this.logContext),Ee(e)),{error:ue}))})}return Z})}get isLocal(){return!0}publishAdditionalCodecForTrack(e,i,s){return _(this,void 0,void 0,function*(){var o;if(this.encryptionType!==ht.NONE)return;let l;if(this.trackPublications.forEach(T=>{T.track&&T.track===e&&(l=T)}),!l)throw new pi("track is not published");if(!Ki(e))throw new pi("track is not a video track");const d=Object.assign(Object.assign({},(o=this.roomOptions)===null||o===void 0?void 0:o.publishDefaults),s),u=XM(e,i,d);if(!u){this.log.info("backup codec has been disabled, ignoring request to add additional codec for track",Object.assign(Object.assign({},this.logContext),Ee(e)));return}const h=e.addSimulcastTrack(i,u);if(!h)return;const m=new Xr({cid:h.mediaStreamTrack.id,type:Q.kindToProto(e.kind),muted:e.isMuted,source:Q.sourceToProto(e.source),sid:e.sid,simulcastCodecs:[{codec:d.videoCodec,cid:h.mediaStreamTrack.id}]});if(m.layers=M0(m.width,m.height,u),!this.engine||this.engine.isClosed)throw new ut("cannot publish track when not connected");const g=()=>_(this,void 0,void 0,function*(){yield this.engine.createSimulcastSender(e,h,d,u),yield this.engine.negotiate()}),S=(yield Promise.all([this.engine.addTrack(m),g()]))[0];this.log.debug("published ".concat(i," for track ").concat(e.sid),Object.assign(Object.assign({},this.logContext),{encodings:u,trackInfo:S}))})}unpublishTrack(e,i){return _(this,void 0,void 0,function*(){var s,o;if(Rs(e)){const m=this.pendingPublishPromises.get(e);m&&(this.log.info("awaiting publish promise before attempting to unpublish",Object.assign(Object.assign({},this.logContext),Ee(e))),yield m)}const l=this.getPublicationForTrack(e),d=l?Ee(l):void 0;if(this.log.debug("unpublishing track",Object.assign(Object.assign({},this.logContext),d)),!l||!l.track){this.log.warn("track was not unpublished because no publication was found",Object.assign(Object.assign({},this.logContext),d));return}e=l.track,e.off($.Muted,this.onTrackMuted),e.off($.Unmuted,this.onTrackUnmuted),e.off($.Ended,this.handleTrackEnded),e.off($.UpstreamPaused,this.onTrackUpstreamPaused),e.off($.UpstreamResumed,this.onTrackUpstreamResumed),e.off($.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate),i===void 0&&(i=(o=(s=this.roomOptions)===null||s===void 0?void 0:s.stopLocalTrackOnUnpublish)!==null&&o!==void 0?o:!0),i?e.stop():e.stopMonitor();let u=!1;const h=e.sender;if(e.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<tt.FAILED&&h)try{for(const m of this.engine.pcManager.publisher.getTransceivers())m.sender===h&&(m.direction="inactive",u=!0);if(this.engine.removeTrack(h)&&(u=!0),Ki(e)){for(const[,m]of e.simulcastCodecs)m.sender&&(this.engine.removeTrack(m.sender)&&(u=!0),m.sender=void 0);e.simulcastCodecs.clear()}}catch(m){this.log.warn("failed to unpublish track",Object.assign(Object.assign(Object.assign({},this.logContext),d),{error:m}))}switch(this.trackPublications.delete(l.trackSid),l.kind){case Q.Kind.Audio:this.audioTrackPublications.delete(l.trackSid);break;case Q.Kind.Video:this.videoTrackPublications.delete(l.trackSid);break}return this.emit(ae.LocalTrackUnpublished,l),l.setTrack(void 0),u&&(yield this.engine.negotiate()),l})}unpublishTracks(e){return _(this,void 0,void 0,function*(){return(yield Promise.all(e.map(s=>this.unpublishTrack(s)))).filter(s=>!!s)})}republishAllTracks(e){return _(this,arguments,void 0,function(i){var s=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return(function*(){s.republishPromise&&(yield s.republishPromise),s.republishPromise=new Nt((l,d)=>_(s,void 0,void 0,function*(){try{const u=[];this.trackPublications.forEach(h=>{h.track&&(i&&(h.options=Object.assign(Object.assign({},h.options),i)),u.push(h))}),yield Promise.all(u.map(h=>_(this,void 0,void 0,function*(){const m=h.track;yield this.unpublishTrack(m,!1),o&&!m.isMuted&&m.source!==Q.Source.ScreenShare&&m.source!==Q.Source.ScreenShareAudio&&(ci(m)||Ki(m))&&!m.isUserProvided&&(this.log.debug("restarting existing track",Object.assign(Object.assign({},this.logContext),{track:h.trackSid})),yield m.restartTrack()),yield this.publishOrRepublishTrack(m,h.options,!0)}))),l()}catch(u){u instanceof Error?d(u):d(new Error(String(u)))}finally{this.republishPromise=void 0}})),yield s.republishPromise})()})}publishData(e){return _(this,arguments,void 0,function(i){var s=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return(function*(){const l=o.reliable?Ce.RELIABLE:Ce.LOSSY,d=o.destinationIdentities,u=o.topic;let h=new sf({participantIdentity:s.identity,payload:i,destinationIdentities:d,topic:u});const m=new jt({kind:l,value:{case:"user",value:h}});yield s.engine.sendDataPacket(m,l)})()})}publishDtmf(e,i){return _(this,void 0,void 0,function*(){const s=new jt({kind:Ce.RELIABLE,value:{case:"sipDtmf",value:new Yb({code:e,digit:i})}});yield this.engine.sendDataPacket(s,Ce.RELIABLE)})}sendChatMessage(e,i){return _(this,void 0,void 0,function*(){const s={id:crypto.randomUUID(),message:e,timestamp:Date.now(),attachedFiles:i?.attachments},o=new jt({value:{case:"chatMessage",value:new Wl(Object.assign(Object.assign({},s),{timestamp:et.parse(s.timestamp)}))}});return yield this.engine.sendDataPacket(o,Ce.RELIABLE),this.emit(ae.ChatMessage,s),s})}editChatMessage(e,i){return _(this,void 0,void 0,function*(){const s=Object.assign(Object.assign({},i),{message:e,editTimestamp:Date.now()}),o=new jt({value:{case:"chatMessage",value:new Wl(Object.assign(Object.assign({},s),{timestamp:et.parse(s.timestamp),editTimestamp:et.parse(s.editTimestamp)}))}});return yield this.engine.sendDataPacket(o,Ce.RELIABLE),this.emit(ae.ChatMessage,s),s})}sendText(e,i){return _(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.sendText(e,i)})}streamText(e){return _(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.streamText(e)})}sendFile(e,i){return _(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.sendFile(e,i)})}streamBytes(e){return _(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.streamBytes(e)})}performRpc(e){let{destinationIdentity:i,method:s,payload:o,responseTimeout:l=15e3}=e;const d=7e3,u=d+1e3;return new Nt((h,m)=>_(this,void 0,void 0,function*(){var g,y,S,T;if(wf(o)>oC){m(rt.builtIn("REQUEST_PAYLOAD_TOO_LARGE"));return}if(!((y=(g=this.engine.latestJoinResponse)===null||g===void 0?void 0:g.serverInfo)===null||y===void 0)&&y.version&&zn((T=(S=this.engine.latestJoinResponse)===null||S===void 0?void 0:S.serverInfo)===null||T===void 0?void 0:T.version,"1.8.0")<0){m(rt.builtIn("UNSUPPORTED_SERVER"));return}const x=Math.max(l,u),E=crypto.randomUUID();yield this.publishRpcRequest(i,E,s,o,x);const k=setTimeout(()=>{this.pendingAcks.delete(E),m(rt.builtIn("CONNECTION_TIMEOUT")),this.pendingResponses.delete(E),clearTimeout(R)},d);this.pendingAcks.set(E,{resolve:()=>{clearTimeout(k)},participantIdentity:i});const R=setTimeout(()=>{this.pendingResponses.delete(E),m(rt.builtIn("RESPONSE_TIMEOUT"))},l);this.pendingResponses.set(E,{resolve:(O,L)=>{clearTimeout(R),this.pendingAcks.has(E)&&(this.log.warn("RPC response received before ack",E),this.pendingAcks.delete(E),clearTimeout(k)),L?m(L):h(O??"")},participantIdentity:i})}))}registerRpcMethod(e,i){this.rpcHandlers.has(e)&&this.log.warn("you're overriding the RPC handler for method ".concat(e,", in the future this will throw an error")),this.rpcHandlers.set(e,i)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}setTrackSubscriptionPermissions(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.participantTrackPermissions=i,this.allParticipantsAllowedToSubscribe=e,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}handleIncomingRpcAck(e){const i=this.pendingAcks.get(e);i?(i.resolve(),this.pendingAcks.delete(e)):console.error("Ack received for unexpected RPC request",e)}handleIncomingRpcResponse(e,i,s){const o=this.pendingResponses.get(e);o?(o.resolve(i,s),this.pendingResponses.delete(e)):console.error("Response received for unexpected RPC request",e)}publishRpcRequest(e,i,s,o,l){return _(this,void 0,void 0,function*(){const d=new jt({destinationIdentities:[e],kind:Ce.RELIABLE,value:{case:"rpcRequest",value:new rf({id:i,method:s,payload:o,responseTimeoutMs:l,version:1})}});yield this.engine.sendDataPacket(d,Ce.RELIABLE)})}handleParticipantDisconnected(e){for(const[i,{participantIdentity:s}]of this.pendingAcks)s===e&&this.pendingAcks.delete(i);for(const[i,{participantIdentity:s,resolve:o}]of this.pendingResponses)s===e&&(o(null,rt.builtIn("RECIPIENT_DISCONNECTED")),this.pendingResponses.delete(i))}setEnabledPublishCodecs(e){this.enabledPublishVideoCodecs=e.filter(i=>i.mime.split("/")[0].toLowerCase()==="video")}updateInfo(e){return super.updateInfo(e)?(e.tracks.forEach(i=>{var s,o;const l=this.trackPublications.get(i.sid);if(l){const d=l.isMuted||((o=(s=l.track)===null||s===void 0?void 0:s.isUpstreamPaused)!==null&&o!==void 0?o:!1);d!==i.muted&&(this.log.debug("updating server mute state after reconcile",Object.assign(Object.assign(Object.assign({},this.logContext),Ee(l)),{mutedOnServer:d})),this.engine.client.sendMuteTrack(i.sid,d))}}),!0):!1}setActiveAgent(e){var i,s,o,l;this.firstActiveAgent=e,e&&!this.firstActiveAgent&&(this.firstActiveAgent=e),e?(s=(i=this.activeAgentFuture)===null||i===void 0?void 0:i.resolve)===null||s===void 0||s.call(i,e):(l=(o=this.activeAgentFuture)===null||o===void 0?void 0:o.reject)===null||l===void 0||l.call(o,new Error("Agent disconnected")),this.activeAgentFuture=void 0}waitUntilActiveAgentPresent(){return this.firstActiveAgent?Promise.resolve(this.firstActiveAgent):(this.activeAgentFuture||(this.activeAgentFuture=new yn),this.activeAgentFuture.promise)}getPublicationForTrack(e){let i;return this.trackPublications.forEach(s=>{const o=s.track;o&&(e instanceof MediaStreamTrack?(ci(o)||Ki(o))&&o.mediaStreamTrack===e&&(i=s):e===o&&(i=s))}),i}waitForPendingPublicationOfSource(e){return _(this,void 0,void 0,function*(){const s=Date.now();for(;Date.now()<s+1e4;){const o=Array.from(this.pendingPublishPromises.entries()).find(l=>{let[d]=l;return d.source===e});if(o)return o[1];yield Mt(20)}})}}class SA extends ui{constructor(e,i,s,o){super(e,i.sid,i.name,o),this.track=void 0,this.allowed=!0,this.requestedDisabled=void 0,this.visible=!0,this.handleEnded=l=>{this.setTrack(void 0),this.emit($.Ended,l)},this.handleVisibilityChange=l=>{this.log.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(l),this.logContext),this.visible=l,this.emitTrackUpdate()},this.handleVideoDimensionsChange=l=>{this.log.debug("adaptivestream video dimensions ".concat(l.width,"x").concat(l.height),this.logContext),this.videoDimensionsAdaptiveStream=l,this.emitTrackUpdate()},this.subscribed=s,this.updateInfo(i)}setSubscribed(e){const i=this.subscriptionStatus,s=this.permissionStatus;this.subscribed=e,e&&(this.allowed=!0);const o=new pc({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new Qb({participantSid:"",trackSids:[this.trackSid]})]});this.emit($.UpdateSubscription,o),this.emitSubscriptionUpdateIfChanged(i),this.emitPermissionUpdateIfChanged(s)}get subscriptionStatus(){return this.subscribed===!1?ui.SubscriptionStatus.Unsubscribed:super.isSubscribed?ui.SubscriptionStatus.Subscribed:ui.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?ui.PermissionStatus.Allowed:ui.PermissionStatus.NotAllowed}get isSubscribed(){return this.subscribed===!1?!1:super.isSubscribed}get isDesired(){return this.subscribed!==!1}get isEnabled(){return this.requestedDisabled!==void 0?!this.requestedDisabled:this.isAdaptiveStream?this.visible:!0}get isLocal(){return!1}setEnabled(e){!this.isManualOperationAllowed()||this.requestedDisabled===!e||(this.requestedDisabled=!e,this.emitTrackUpdate())}setVideoQuality(e){!this.isManualOperationAllowed()||this.requestedMaxQuality===e||(this.requestedMaxQuality=e,this.requestedVideoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var i,s;this.isManualOperationAllowed()&&(((i=this.requestedVideoDimensions)===null||i===void 0?void 0:i.width)===e.width&&((s=this.requestedVideoDimensions)===null||s===void 0?void 0:s.height)===e.height||(sh(this.track)&&(this.requestedVideoDimensions=e),this.requestedMaxQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(e){this.isManualOperationAllowed()&&sh(this.track)&&this.fps!==e&&(this.fps=e,this.emitTrackUpdate())}get videoQuality(){var e;return(e=this.requestedMaxQuality)!==null&&e!==void 0?e:sn.HIGH}setTrack(e){const i=this.subscriptionStatus,s=this.permissionStatus,o=this.track;o!==e&&(o&&(o.off($.VideoDimensionsChanged,this.handleVideoDimensionsChange),o.off($.VisibilityChanged,this.handleVisibilityChange),o.off($.Ended,this.handleEnded),o.detach(),o.stopMonitor(),this.emit($.Unsubscribed,o)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on($.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on($.VisibilityChanged,this.handleVisibilityChange),e.on($.Ended,this.handleEnded),this.emit($.Subscribed,e)),this.emitPermissionUpdateIfChanged(s),this.emitSubscriptionUpdateIfChanged(i))}setAllowed(e){const i=this.subscriptionStatus,s=this.permissionStatus;this.allowed=e,this.emitPermissionUpdateIfChanged(s),this.emitSubscriptionUpdateIfChanged(i)}setSubscriptionError(e){this.emit($.SubscriptionFailed,e)}updateInfo(e){super.updateInfo(e);const i=this.metadataMuted;this.metadataMuted=e.muted,this.track?this.track.setMuted(e.muted):i!==e.muted&&this.emit(e.muted?$.Muted:$.Unmuted)}emitSubscriptionUpdateIfChanged(e){const i=this.subscriptionStatus;e!==i&&this.emit($.SubscriptionStatusChanged,i,e)}emitPermissionUpdateIfChanged(e){this.permissionStatus!==e&&this.emit($.SubscriptionPermissionChanged,this.permissionStatus,e)}isManualOperationAllowed(){return this.isDesired?!0:(this.log.warn("cannot update track settings when not subscribed",this.logContext),!1)}get isAdaptiveStream(){return sh(this.track)&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=new oS({trackSids:[this.trackSid],disabled:!this.isEnabled,fps:this.fps});if(this.kind===Q.Kind.Video){let i=this.requestedVideoDimensions;if(this.videoDimensionsAdaptiveStream!==void 0)if(i)a0(this.videoDimensionsAdaptiveStream,i)&&(this.log.debug("using adaptive stream dimensions instead of requested",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),i=this.videoDimensionsAdaptiveStream);else if(this.requestedMaxQuality!==void 0&&this.trackInfo){const s=UR(this.trackInfo,this.requestedMaxQuality);s&&a0(this.videoDimensionsAdaptiveStream,s)&&(this.log.debug("using adaptive stream dimensions instead of max quality layer",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),i=this.videoDimensionsAdaptiveStream)}else this.log.debug("using adaptive stream dimensions",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),i=this.videoDimensionsAdaptiveStream;i?(e.width=Math.ceil(i.width),e.height=Math.ceil(i.height)):this.requestedMaxQuality!==void 0?(this.log.debug("using requested max quality",Object.assign(Object.assign({},this.logContext),{quality:this.requestedMaxQuality})),e.quality=this.requestedMaxQuality):(this.log.debug("using default quality",Object.assign(Object.assign({},this.logContext),{quality:sn.HIGH})),e.quality=sn.HIGH)}this.emit($.UpdateSettings,e)}}class ac extends pC{static fromParticipantInfo(e,i,s){return new ac(e,i.sid,i.identity,i.name,i.metadata,i.attributes,s,i.kind)}get logContext(){return Object.assign(Object.assign({},super.logContext),{rpID:this.sid,remoteParticipant:this.identity})}constructor(e,i,s,o,l,d,u){let h=arguments.length>7&&arguments[7]!==void 0?arguments[7]:Qr.STANDARD;super(i,s||"",o,l,d,u,h),this.signalClient=e,this.trackPublications=new Map,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.volumeMap=new Map}addTrackPublication(e){super.addTrackPublication(e),e.on($.UpdateSettings,i=>{this.log.debug("send update settings",Object.assign(Object.assign(Object.assign({},this.logContext),Ee(e)),{settings:i})),this.signalClient.sendUpdateTrackSettings(i)}),e.on($.UpdateSubscription,i=>{i.participantTracks.forEach(s=>{s.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(i)}),e.on($.SubscriptionPermissionChanged,i=>{this.emit(ae.TrackSubscriptionPermissionChanged,e,i)}),e.on($.SubscriptionStatusChanged,i=>{this.emit(ae.TrackSubscriptionStatusChanged,e,i)}),e.on($.Subscribed,i=>{this.emit(ae.TrackSubscribed,i,e)}),e.on($.Unsubscribed,i=>{this.emit(ae.TrackUnsubscribed,i,e)}),e.on($.SubscriptionFailed,i=>{this.emit(ae.TrackSubscriptionFailed,e.trackSid,i)})}getTrackPublication(e){const i=super.getTrackPublication(e);if(i)return i}getTrackPublicationByName(e){const i=super.getTrackPublicationByName(e);if(i)return i}setVolume(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Q.Source.Microphone;this.volumeMap.set(i,e);const s=this.getTrackPublication(i);s&&s.track&&s.track.setVolume(e)}getVolume(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Q.Source.Microphone;const i=this.getTrackPublication(e);return i&&i.track?i.track.getVolume():this.volumeMap.get(e)}addSubscribedMediaTrack(e,i,s,o,l,d){let u=this.getTrackPublicationBySid(i);if(u||i.startsWith("TR")||this.trackPublications.forEach(g=>{!u&&e.kind===g.kind.toString()&&(u=g)}),!u){if(d===0){this.log.error("could not find published track",Object.assign(Object.assign({},this.logContext),{trackSid:i})),this.emit(ae.TrackSubscriptionFailed,i);return}d===void 0&&(d=20),setTimeout(()=>{this.addSubscribedMediaTrack(e,i,s,o,l,d-1)},150);return}if(e.readyState==="ended"){this.log.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",Object.assign(Object.assign({},this.logContext),Ee(u))),this.emit(ae.TrackSubscriptionFailed,i);return}const h=e.kind==="video";let m;return h?m=new mA(e,i,o,l):m=new fA(e,i,o,this.audioContext,this.audioOutput),m.source=u.source,m.isMuted=u.isMuted,m.setMediaStream(s),m.start(),u.setTrack(m),this.volumeMap.has(u.source)&&Lh(m)&&Un(m)&&m.setVolume(this.volumeMap.get(u.source)),u}get hasMetadata(){return!!this.participantInfo}getTrackPublicationBySid(e){return this.trackPublications.get(e)}updateInfo(e){if(!super.updateInfo(e))return!1;const i=new Map,s=new Map;return e.tracks.forEach(o=>{var l,d;let u=this.getTrackPublicationBySid(o.sid);if(u)u.updateInfo(o);else{const h=Q.kindFromProto(o.type);if(!h)return;u=new SA(h,o,(l=this.signalClient.connectOptions)===null||l===void 0?void 0:l.autoSubscribe,{loggerContextCb:()=>this.logContext,loggerName:(d=this.loggerOptions)===null||d===void 0?void 0:d.loggerName}),u.updateInfo(o),s.set(o.sid,u);const m=Array.from(this.trackPublications.values()).find(g=>g.source===u?.source);m&&u.source!==Q.Source.Unknown&&this.log.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(u.source),Object.assign(Object.assign({},this.logContext),{oldTrack:Ee(m),newTrack:Ee(u)})),this.addTrackPublication(u)}i.set(o.sid,u)}),this.trackPublications.forEach(o=>{i.has(o.trackSid)||(this.log.trace("detected removed track on remote participant, unpublishing",Object.assign(Object.assign({},this.logContext),Ee(o))),this.unpublishTrack(o.trackSid,!0))}),s.forEach(o=>{this.emit(ae.TrackPublished,o)}),!0}unpublishTrack(e,i){const s=this.trackPublications.get(e);if(!s)return;const{track:o}=s;switch(o&&(o.stop(),s.setTrack(void 0)),this.trackPublications.delete(e),s.kind){case Q.Kind.Audio:this.audioTrackPublications.delete(e);break;case Q.Kind.Video:this.videoTrackPublications.delete(e);break}i&&this.emit(ae.TrackUnpublished,s)}setAudioOutput(e){return _(this,void 0,void 0,function*(){this.audioOutput=e;const i=[];this.audioTrackPublications.forEach(s=>{var o;Un(s.track)&&Lh(s.track)&&i.push(s.track.setSinkId((o=e.deviceId)!==null&&o!==void 0?o:"default"))}),yield Promise.all(i)})}emit(e){for(var i=arguments.length,s=new Array(i>1?i-1:0),o=1;o<i;o++)s[o-1]=arguments[o];return this.log.trace("participant event",Object.assign(Object.assign({},this.logContext),{event:e,args:s})),super.emit(e,...s)}}var Ie;(function(a){a.Disconnected="disconnected",a.Connecting="connecting",a.Connected="connected",a.Reconnecting="reconnecting",a.SignalReconnecting="signalReconnecting"})(Ie||(Ie={}));const CA=4*1e3;class Os extends Hn.EventEmitter{get hasE2EESetup(){return this.e2eeManager!==void 0}constructor(e){var i,s,o,l,d;if(super(),i=this,this.state=Ie.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.log=Se,this.bufferedEvents=[],this.isResuming=!1,this.rpcHandlers=new Map,this.connect=(u,h,m)=>_(this,void 0,void 0,function*(){var g;if(!VR())throw qn()?Error("WebRTC isn't detected, have you called registerGlobals?"):Error("LiveKit doesn't seem to be supported on this browser. Try to update your browser and make sure no browser extensions are disabling webRTC.");const y=yield this.disconnectLock.lock();if(this.state===Ie.Connected)return this.log.info("already connected to room ".concat(this.name),this.logContext),y(),Promise.resolve();if(this.connectFuture)return y(),this.connectFuture.promise;this.setAndEmitConnectionState(Ie.Connecting),((g=this.regionUrlProvider)===null||g===void 0?void 0:g.getServerUrl().toString())!==iC(u)&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),Ds(new URL(u))&&(this.regionUrlProvider===void 0?this.regionUrlProvider=new Ne(u,h):this.regionUrlProvider.updateToken(h),this.regionUrlProvider.fetchRegionSettings().then(x=>{var E;(E=this.regionUrlProvider)===null||E===void 0||E.setServerReportedRegions(x)}).catch(x=>{this.log.warn("could not fetch region settings",Object.assign(Object.assign({},this.logContext),{error:x}))}));const S=(x,E,k)=>_(this,void 0,void 0,function*(){var R,O;this.abortController&&this.abortController.abort();const L=new AbortController;this.abortController=L,y?.();try{if(yield Ms.getInstance().getBackOffPromise(u),L.signal.aborted)throw me.cancelled("Connection attempt aborted");yield this.attemptConnection(k??u,h,m,L),this.abortController=void 0,x()}catch(D){if(this.regionUrlProvider&&D instanceof me&&D.reason!==Qe.Cancelled&&D.reason!==Qe.NotAllowed){let I=null;try{this.log.debug("Fetching next region"),I=yield this.regionUrlProvider.getNextBestRegionUrl((R=this.abortController)===null||R===void 0?void 0:R.signal)}catch(P){if(P instanceof me&&(P.status===401||P.reason===Qe.Cancelled)){this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),E(P);return}}[Qe.InternalError,Qe.ServerUnreachable,Qe.Timeout].includes(D.reason)&&(this.log.debug("Adding failed connection attempt to back off"),Ms.getInstance().addFailedConnectionAttempt(u)),I&&!(!((O=this.abortController)===null||O===void 0)&&O.signal.aborted)?(this.log.info("Initial connection failed with ConnectionError: ".concat(D.message,". Retrying with another region: ").concat(I),this.logContext),this.recreateEngine(),yield S(x,E,I)):(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,d0(D)),E(D))}else{let I=Mn.UNKNOWN_REASON;D instanceof me&&(I=d0(D)),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,I),E(D)}}}),T=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new yn((x,E)=>{S(x,E,T)},()=>{this.clearConnectionFutures()}),this.connectFuture.promise}),this.connectSignal=(u,h,m,g,y,S)=>_(this,void 0,void 0,function*(){var T,x,E;const k=yield m.join(u,h,{autoSubscribe:g.autoSubscribe,adaptiveStream:typeof y.adaptiveStream=="object"?!0:y.adaptiveStream,maxRetries:g.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:g.websocketTimeout},S.signal,!y.singlePeerConnection);let R=k.serverInfo;if(R||(R={version:k.serverVersion,region:k.serverRegion}),this.serverInfo=R,this.log.debug("connected to Livekit Server ".concat(Object.entries(R).map(O=>{let[L,D]=O;return"".concat(L,": ").concat(D)}).join(", ")),{room:(T=k.room)===null||T===void 0?void 0:T.name,roomSid:(x=k.room)===null||x===void 0?void 0:x.sid,identity:(E=k.participant)===null||E===void 0?void 0:E.identity}),!R.version)throw new wR("unknown server version");return R.version==="0.15.1"&&this.options.dynacast&&(this.log.debug("disabling dynacast due to server version",this.logContext),y.dynacast=!1),k}),this.applyJoinResponse=u=>{const h=u.participant;if(this.localParticipant.sid=h.sid,this.localParticipant.identity=h.identity,this.localParticipant.setEnabledPublishCodecs(u.enabledPublishCodecs),this.e2eeManager)try{this.e2eeManager.setSifTrailer(u.sifTrailer)}catch(m){this.log.error(m instanceof Error?m.message:"Could not set SifTrailer",Object.assign(Object.assign({},this.logContext),{error:m}))}this.handleParticipantUpdates([h,...u.otherParticipants]),u.room&&this.handleRoomUpdate(u.room)},this.attemptConnection=(u,h,m,g)=>_(this,void 0,void 0,function*(){var y,S;this.state===Ie.Reconnecting||this.isResuming||!((y=this.engine)===null||y===void 0)&&y.pendingReconnect?(this.log.info("Reconnection attempt replaced by new connection attempt",this.logContext),this.recreateEngine()):this.maybeCreateEngine(),!((S=this.regionUrlProvider)===null||S===void 0)&&S.isCloud()&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},_f),m),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const T=yield this.connectSignal(u,h,this.engine,this.connOptions,this.options,g);this.applyJoinResponse(T),this.setupLocalParticipantEvents(),this.emit(W.SignalConnected)}catch(T){yield this.engine.close(),this.recreateEngine();const x=g.signal.aborted?me.cancelled("Signal connection aborted"):me.serverUnreachable("could not establish signal connection");throw T instanceof Error&&(x.message="".concat(x.message,": ").concat(T.message)),T instanceof me&&(x.reason=T.reason,x.status=T.status),this.log.debug("error trying to establish signal connection",Object.assign(Object.assign({},this.logContext),{error:T})),x}if(g.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),me.cancelled("Connection attempt aborted");try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,g)}catch(T){throw yield this.engine.close(),this.recreateEngine(),T}Kt()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),Kt()&&window.addEventListener("freeze",this.onPageLeave),this.setAndEmitConnectionState(Ie.Connected),this.emit(W.Connected),Ms.getInstance().resetFailedConnectionAttempts(u),this.registerConnectionReconcile(),this.regionUrlProvider&&this.regionUrlProvider.notifyConnected()}),this.disconnect=function(){for(var u=arguments.length,h=new Array(u),m=0;m<u;m++)h[m]=arguments[m];return _(i,[...h],void 0,function(){var g=this;let y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return(function*(){var S,T,x;const E=yield g.disconnectLock.lock();try{if(g.state===Ie.Disconnected){g.log.debug("already disconnected",g.logContext);return}if(g.log.info("disconnect from room",Object.assign({},g.logContext)),g.state===Ie.Connecting||g.state===Ie.Reconnecting||g.isResuming){const k="Abort connection attempt due to user initiated disconnect";g.log.warn(k,g.logContext),(S=g.abortController)===null||S===void 0||S.abort(k),(x=(T=g.connectFuture)===null||T===void 0?void 0:T.reject)===null||x===void 0||x.call(T,me.cancelled("Client initiated disconnect")),g.connectFuture=void 0}g.engine&&(g.engine.client.isDisconnected||(yield g.engine.client.sendLeave()),yield g.engine.close()),g.handleDisconnect(y,Mn.CLIENT_INITIATED),g.engine=void 0}finally{E()}})()})},this.onPageLeave=()=>_(this,void 0,void 0,function*(){this.log.info("Page leave detected, disconnecting",this.logContext),yield this.disconnect()}),this.startAudio=()=>_(this,void 0,void 0,function*(){const u=[],h=Yt();if(h&&h.os==="iOS"){const m="livekit-dummy-audio-el";let g=document.getElementById(m);if(!g){g=document.createElement("audio"),g.id=m,g.autoplay=!0,g.hidden=!0;const y=ah();y.enabled=!0;const S=new MediaStream([y]);g.srcObject=S,document.addEventListener("visibilitychange",()=>{g&&(g.srcObject=document.hidden?null:S,document.hidden||(this.log.debug("page visible again, triggering startAudio to resume playback and update playback status",this.logContext),this.startAudio()))}),document.body.append(g),this.once(W.Disconnected,()=>{g?.remove(),g=null})}u.push(g)}this.remoteParticipants.forEach(m=>{m.audioTrackPublications.forEach(g=>{g.track&&g.track.attachedElements.forEach(y=>{u.push(y)})})});try{yield Promise.all([this.acquireAudioContext(),...u.map(m=>(m.muted=!1,m.play()))]),this.handleAudioPlaybackStarted()}catch(m){throw this.handleAudioPlaybackFailed(m),m}}),this.startVideo=()=>_(this,void 0,void 0,function*(){const u=[];for(const h of this.remoteParticipants.values())h.videoTrackPublications.forEach(m=>{var g;(g=m.track)===null||g===void 0||g.attachedElements.forEach(y=>{u.includes(y)||u.push(y)})});yield Promise.all(u.map(h=>h.play())).then(()=>{this.handleVideoPlaybackStarted()}).catch(h=>{h.name==="NotAllowedError"?this.handleVideoPlaybackFailed():this.log.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler",this.logContext)})}),this.handleRestarting=()=>{this.clearConnectionReconcile(),this.isResuming=!1;for(const u of this.remoteParticipants.values())this.handleParticipantDisconnected(u.identity,u);this.setAndEmitConnectionState(Ie.Reconnecting)&&this.emit(W.Reconnecting)},this.handleSignalRestarted=u=>_(this,void 0,void 0,function*(){this.log.debug("signal reconnected to server, region ".concat(u.serverRegion),Object.assign(Object.assign({},this.logContext),{region:u.serverRegion})),this.bufferedEvents=[],this.applyJoinResponse(u);try{yield this.localParticipant.republishAllTracks(void 0,!0)}catch(h){this.log.error("error trying to re-publish tracks after reconnection",Object.assign(Object.assign({},this.logContext),{error:h}))}try{yield this.engine.waitForRestarted(),this.log.debug("fully reconnected to server",Object.assign(Object.assign({},this.logContext),{region:u.serverRegion}))}catch{return}this.setAndEmitConnectionState(Ie.Connected),this.emit(W.Reconnected),this.registerConnectionReconcile(),this.emitBufferedEvents()}),this.handleParticipantUpdates=u=>{u.forEach(h=>{var m;if(h.identity===this.localParticipant.identity){this.localParticipant.updateInfo(h);return}h.identity===""&&(h.identity=(m=this.sidToIdentity.get(h.sid))!==null&&m!==void 0?m:"");let g=this.remoteParticipants.get(h.identity);h.state===Es.DISCONNECTED?this.handleParticipantDisconnected(h.identity,g):g=this.getOrCreateParticipant(h.identity,h)})},this.handleActiveSpeakersUpdate=u=>{const h=[],m={};u.forEach(g=>{if(m[g.sid]=!0,g.sid===this.localParticipant.sid)this.localParticipant.audioLevel=g.level,this.localParticipant.setIsSpeaking(!0),h.push(this.localParticipant);else{const y=this.getRemoteParticipantBySid(g.sid);y&&(y.audioLevel=g.level,y.setIsSpeaking(!0),h.push(y))}}),m[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.remoteParticipants.forEach(g=>{m[g.sid]||(g.audioLevel=0,g.setIsSpeaking(!1))}),this.activeSpeakers=h,this.emitWhenConnected(W.ActiveSpeakersChanged,h)},this.handleSpeakersChanged=u=>{const h=new Map;this.activeSpeakers.forEach(g=>{const y=this.remoteParticipants.get(g.identity);y&&y.sid!==g.sid||h.set(g.sid,g)}),u.forEach(g=>{let y=this.getRemoteParticipantBySid(g.sid);g.sid===this.localParticipant.sid&&(y=this.localParticipant),y&&(y.audioLevel=g.level,y.setIsSpeaking(g.active),g.active?h.set(g.sid,y):h.delete(g.sid))});const m=Array.from(h.values());m.sort((g,y)=>y.audioLevel-g.audioLevel),this.activeSpeakers=m,this.emitWhenConnected(W.ActiveSpeakersChanged,m)},this.handleStreamStateUpdate=u=>{u.streamStates.forEach(h=>{const m=this.getRemoteParticipantBySid(h.participantSid);if(!m)return;const g=m.getTrackPublicationBySid(h.trackSid);if(!g||!g.track)return;const y=Q.streamStateFromProto(h.state);g.track.setStreamState(y),y!==g.track.streamState&&(m.emit(ae.TrackStreamStateChanged,g,g.track.streamState),this.emitWhenConnected(W.TrackStreamStateChanged,g,g.track.streamState,m))})},this.handleSubscriptionPermissionUpdate=u=>{const h=this.getRemoteParticipantBySid(u.participantSid);if(!h)return;const m=h.getTrackPublicationBySid(u.trackSid);m&&m.setAllowed(u.allowed)},this.handleSubscriptionError=u=>{const h=Array.from(this.remoteParticipants.values()).find(g=>g.trackPublications.has(u.trackSid));if(!h)return;const m=h.getTrackPublicationBySid(u.trackSid);m&&m.setSubscriptionError(u.err)},this.handleDataPacket=(u,h)=>{const m=this.remoteParticipants.get(u.participantIdentity);if(u.value.case==="user")this.handleUserPacket(m,u.value.value,u.kind,h);else if(u.value.case==="transcription")this.handleTranscription(m,u.value.value);else if(u.value.case==="sipDtmf")this.handleSipDtmf(m,u.value.value);else if(u.value.case==="chatMessage")this.handleChatMessage(m,u.value.value);else if(u.value.case==="metrics")this.handleMetrics(u.value.value,m);else if(u.value.case==="streamHeader"||u.value.case==="streamChunk"||u.value.case==="streamTrailer")this.handleDataStream(u,h);else if(u.value.case==="rpcRequest"){const g=u.value.value;this.handleIncomingRpcRequest(u.participantIdentity,g.id,g.method,g.payload,g.responseTimeoutMs,g.version)}},this.handleUserPacket=(u,h,m,g)=>{this.emit(W.DataReceived,h.payload,u,m,h.topic,g),u?.emit(ae.DataReceived,h.payload,m,g)},this.handleSipDtmf=(u,h)=>{this.emit(W.SipDTMFReceived,h,u),u?.emit(ae.SipDTMFReceived,h)},this.handleTranscription=(u,h)=>{const m=h.transcribedParticipantIdentity===this.localParticipant.identity?this.localParticipant:this.getParticipantByIdentity(h.transcribedParticipantIdentity),g=m?.trackPublications.get(h.trackId),y=$R(h,this.transcriptionReceivedTimes);g?.emit($.TranscriptionReceived,y),m?.emit(ae.TranscriptionReceived,y,g),this.emit(W.TranscriptionReceived,y,m,g)},this.handleChatMessage=(u,h)=>{const m=eM(h);this.emit(W.ChatMessage,m,u)},this.handleMetrics=(u,h)=>{this.emit(W.MetricsReceived,u,h)},this.handleDataStream=(u,h)=>{this.incomingDataStreamManager.handleDataStreamPacket(u,h)},this.bufferedSegments=new Map,this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(W.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=u=>{this.log.warn("could not playback audio",Object.assign(Object.assign({},this.logContext),{error:u})),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(W.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit(W.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit(W.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>_(this,void 0,void 0,function*(){var u;((u=Yt())===null||u===void 0?void 0:u.os)!=="iOS"&&(yield this.selectDefaultDevices()),this.emit(W.MediaDevicesChanged)}),this.handleRoomUpdate=u=>{const h=this.roomInfo;this.roomInfo=u,h&&h.metadata!==u.metadata&&this.emitWhenConnected(W.RoomMetadataChanged,u.metadata),h?.activeRecording!==u.activeRecording&&this.emitWhenConnected(W.RecordingStatusChanged,u.activeRecording)},this.handleConnectionQualityUpdate=u=>{u.updates.forEach(h=>{if(h.participantSid===this.localParticipant.sid){this.localParticipant.setConnectionQuality(h.quality);return}const m=this.getRemoteParticipantBySid(h.participantSid);m&&m.setConnectionQuality(h.quality)})},this.onLocalParticipantMetadataChanged=u=>{this.emit(W.ParticipantMetadataChanged,u,this.localParticipant)},this.onLocalParticipantNameChanged=u=>{this.emit(W.ParticipantNameChanged,u,this.localParticipant)},this.onLocalAttributesChanged=u=>{this.emit(W.ParticipantAttributesChanged,u,this.localParticipant)},this.onLocalTrackMuted=u=>{this.emit(W.TrackMuted,u,this.localParticipant)},this.onLocalTrackUnmuted=u=>{this.emit(W.TrackUnmuted,u,this.localParticipant)},this.onTrackProcessorUpdate=u=>{var h;(h=u?.onPublish)===null||h===void 0||h.call(u,this)},this.onLocalTrackPublished=u=>_(this,void 0,void 0,function*(){var h,m,g,y,S,T;(h=u.track)===null||h===void 0||h.on($.TrackProcessorUpdate,this.onTrackProcessorUpdate),(m=u.track)===null||m===void 0||m.on($.Restarted,this.onLocalTrackRestarted),(S=(y=(g=u.track)===null||g===void 0?void 0:g.getProcessor())===null||y===void 0?void 0:y.onPublish)===null||S===void 0||S.call(y,this),this.emit(W.LocalTrackPublished,u,this.localParticipant),ci(u.track)&&(yield u.track.checkForSilence())&&this.emit(W.LocalAudioSilenceDetected,u);const x=yield(T=u.track)===null||T===void 0?void 0:T.getDeviceId(!1),E=Oh(u.source);E&&x&&x!==this.localParticipant.activeDeviceMap.get(E)&&(this.localParticipant.activeDeviceMap.set(E,x),this.emit(W.ActiveDeviceChanged,E,x))}),this.onLocalTrackUnpublished=u=>{var h,m;(h=u.track)===null||h===void 0||h.off($.TrackProcessorUpdate,this.onTrackProcessorUpdate),(m=u.track)===null||m===void 0||m.off($.Restarted,this.onLocalTrackRestarted),this.emit(W.LocalTrackUnpublished,u,this.localParticipant)},this.onLocalTrackRestarted=u=>_(this,void 0,void 0,function*(){const h=yield u.getDeviceId(!1),m=Oh(u.source);m&&h&&h!==this.localParticipant.activeDeviceMap.get(m)&&(this.log.debug("local track restarted, setting ".concat(m," ").concat(h," active"),this.logContext),this.localParticipant.activeDeviceMap.set(m,h),this.emit(W.ActiveDeviceChanged,m,h))}),this.onLocalConnectionQualityChanged=u=>{this.emit(W.ConnectionQualityChanged,u,this.localParticipant)},this.onMediaDevicesError=(u,h)=>{this.emit(W.MediaDevicesError,u,h)},this.onLocalParticipantPermissionsChanged=u=>{this.emit(W.ParticipantPermissionsChanged,u,this.localParticipant)},this.onLocalChatMessageSent=u=>{this.emit(W.ChatMessage,u,this.localParticipant)},this.setMaxListeners(100),this.remoteParticipants=new Map,this.sidToIdentity=new Map,this.options=Object.assign(Object.assign({},OM),e),this.log=Bn((s=this.options.loggerName)!==null&&s!==void 0?s:bn.Room),this.transcriptionReceivedTimes=new Map,this.options.audioCaptureDefaults=Object.assign(Object.assign({},aC),e?.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},sC),e?.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},DM),e?.publishDefaults),this.maybeCreateEngine(),this.incomingDataStreamManager=new cA,this.outgoingDataStreamManager=new hA(this.engine,this.log),this.disconnectLock=new It,this.localParticipant=new bA("","",this.engine,this.options,this.rpcHandlers,this.outgoingDataStreamManager),(this.options.e2ee||this.options.encryption)&&this.setupE2EE(),this.engine.e2eeManager=this.e2eeManager,this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",wa(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",wa(this.options.audioCaptureDefaults.deviceId)),!((o=this.options.audioOutput)===null||o===void 0)&&o.deviceId&&this.switchActiveDevice("audiooutput",wa(this.options.audioOutput.deviceId)).catch(u=>this.log.warn("Could not set audio output: ".concat(u.message),this.logContext)),Kt()){const u=new AbortController;(d=(l=navigator.mediaDevices)===null||l===void 0?void 0:l.addEventListener)===null||d===void 0||d.call(l,"devicechange",this.handleDeviceChange,{signal:u.signal}),Os.cleanupRegistry&&Os.cleanupRegistry.register(this,()=>{u.abort()})}}registerTextStreamHandler(e,i){return this.incomingDataStreamManager.registerTextStreamHandler(e,i)}unregisterTextStreamHandler(e){return this.incomingDataStreamManager.unregisterTextStreamHandler(e)}registerByteStreamHandler(e,i){return this.incomingDataStreamManager.registerByteStreamHandler(e,i)}unregisterByteStreamHandler(e){return this.incomingDataStreamManager.unregisterByteStreamHandler(e)}registerRpcMethod(e,i){if(this.rpcHandlers.has(e))throw Error("RPC handler already registered for method ".concat(e,", unregisterRpcMethod before trying to register again"));this.rpcHandlers.set(e,i)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}setE2EEEnabled(e){return _(this,void 0,void 0,function*(){if(this.e2eeManager)yield Promise.all([this.localParticipant.setE2EEEnabled(e)]),this.localParticipant.identity!==""&&this.e2eeManager.setParticipantCryptorEnabled(e,this.localParticipant.identity);else throw Error("e2ee not configured, please set e2ee settings within the room options")})}setupE2EE(){var e;const i=!!this.options.encryption,s=this.options.encryption||this.options.e2ee;s&&("e2eeManager"in s?(this.e2eeManager=s.e2eeManager,this.e2eeManager.isDataChannelEncryptionEnabled=i):this.e2eeManager=new pM(s,i),this.e2eeManager.on(Qi.ParticipantEncryptionStatusChanged,(o,l)=>{nM(l)&&(this.isE2EEEnabled=o),this.emit(W.ParticipantEncryptionStatusChanged,o,l)}),this.e2eeManager.on(Qi.EncryptionError,(o,l)=>{const d=l?this.getParticipantByIdentity(l):void 0;this.emit(W.EncryptionError,o,d)}),(e=this.e2eeManager)===null||e===void 0||e.setup(this))}get logContext(){var e;return{room:this.name,roomID:(e=this.roomInfo)===null||e===void 0?void 0:e.sid,participant:this.localParticipant.identity,pID:this.localParticipant.sid}}get isRecording(){var e,i;return(i=(e=this.roomInfo)===null||e===void 0?void 0:e.activeRecording)!==null&&i!==void 0?i:!1}getSid(){return this.state===Ie.Disconnected?Nt.resolve(""):this.roomInfo&&this.roomInfo.sid!==""?Nt.resolve(this.roomInfo.sid):new Nt((e,i)=>{const s=o=>{o.sid!==""&&(this.engine.off(ie.RoomUpdate,s),e(o.sid))};this.engine.on(ie.RoomUpdate,s),this.once(W.Disconnected,()=>{this.engine.off(ie.RoomUpdate,s),i(new ut("Room disconnected before room server id was available"))})})}get name(){var e,i;return(i=(e=this.roomInfo)===null||e===void 0?void 0:e.name)!==null&&i!==void 0?i:""}get metadata(){var e;return(e=this.roomInfo)===null||e===void 0?void 0:e.metadata}get numParticipants(){var e,i;return(i=(e=this.roomInfo)===null||e===void 0?void 0:e.numParticipants)!==null&&i!==void 0?i:0}get numPublishers(){var e,i;return(i=(e=this.roomInfo)===null||e===void 0?void 0:e.numPublishers)!==null&&i!==void 0?i:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new sA(this.options),this.engine.e2eeManager=this.e2eeManager,this.engine.on(ie.ParticipantUpdate,this.handleParticipantUpdates).on(ie.RoomUpdate,this.handleRoomUpdate).on(ie.SpeakersChanged,this.handleSpeakersChanged).on(ie.StreamStateChanged,this.handleStreamStateUpdate).on(ie.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(ie.SubscriptionError,this.handleSubscriptionError).on(ie.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(ie.MediaTrackAdded,(e,i,s)=>{this.onTrackAdded(e,i,s)}).on(ie.Disconnected,e=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,e)}).on(ie.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(ie.DataPacketReceived,this.handleDataPacket).on(ie.Resuming,()=>{this.clearConnectionReconcile(),this.isResuming=!0,this.log.info("Resuming signal connection",this.logContext),this.setAndEmitConnectionState(Ie.SignalReconnecting)&&this.emit(W.SignalReconnecting)}).on(ie.Resumed,()=>{this.registerConnectionReconcile(),this.isResuming=!1,this.log.info("Resumed signal connection",this.logContext),this.updateSubscriptions(),this.emitBufferedEvents(),this.setAndEmitConnectionState(Ie.Connected)&&this.emit(W.Reconnected)}).on(ie.SignalResumed,()=>{this.bufferedEvents=[],(this.state===Ie.Reconnecting||this.isResuming)&&this.sendSyncState()}).on(ie.Restarting,this.handleRestarting).on(ie.SignalRestarted,this.handleSignalRestarted).on(ie.Offline,()=>{this.setAndEmitConnectionState(Ie.Reconnecting)&&this.emit(W.Reconnecting)}).on(ie.DCBufferStatusChanged,(e,i)=>{this.emit(W.DCBufferStatusChanged,e,i)}).on(ie.LocalTrackSubscribed,e=>{const i=this.localParticipant.getTrackPublications().find(s=>{let{trackSid:o}=s;return o===e});if(!i){this.log.warn("could not find local track subscription for subscribed event",this.logContext);return}this.localParticipant.emit(ae.LocalTrackSubscribed,i),this.emitWhenConnected(W.LocalTrackSubscribed,i,this.localParticipant)}).on(ie.RoomMoved,e=>{this.log.debug("room moved",e),e.room&&this.handleRoomUpdate(e.room),this.remoteParticipants.forEach((i,s)=>{this.handleParticipantDisconnected(s,i)}),this.emit(W.Moved,e.room.name),e.participant?this.handleParticipantUpdates([e.participant,...e.otherParticipants]):this.handleParticipantUpdates(e.otherParticipants)}),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine),this.outgoingDataStreamManager&&this.outgoingDataStreamManager.setupEngine(this.engine))}static getLocalDevices(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return Tt.getInstance().getDevices(e,i)}prepareConnection(e,i){return _(this,void 0,void 0,function*(){if(this.state===Ie.Disconnected){this.log.debug("prepareConnection to ".concat(e),this.logContext);try{if(Ds(new URL(e))&&i){this.regionUrlProvider=new Ne(e,i);const s=yield this.regionUrlProvider.getNextBestRegionUrl();s&&this.state===Ie.Disconnected&&(this.regionUrl=s,yield fetch($r(s),{method:"HEAD"}),this.log.debug("prepared connection to ".concat(s),this.logContext))}else yield fetch($r(e),{method:"HEAD"})}catch(s){this.log.warn("could not prepare connection",Object.assign(Object.assign({},this.logContext),{error:s}))}}})}getParticipantByIdentity(e){return this.localParticipant.identity===e?this.localParticipant:this.remoteParticipants.get(e)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(e,i){return _(this,void 0,void 0,function*(){let s=()=>_(this,void 0,void 0,function*(){}),o;switch(e){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":o=new In({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":o=new In({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":o=new In({scenario:{case:"serverLeave",value:!0}});break;case"migration":o=new In({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"disconnect-signal-on-resume":s=()=>_(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),o=new In({scenario:{case:"disconnectSignalOnResume",value:!0}});break;case"disconnect-signal-on-resume-no-messages":s=()=>_(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),o=new In({scenario:{case:"disconnectSignalOnResumeNoMessages",value:!0}});break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":o=new In({scenario:{case:"switchCandidateProtocol",value:e==="force-tls"?2:1}}),s=()=>_(this,void 0,void 0,function*(){const l=this.engine.client.onLeave;l&&l(new gc({reason:Mn.CLIENT_INITIATED,action:_s.RECONNECT}))});break;case"subscriber-bandwidth":if(i===void 0||typeof i!="number")throw new Error("subscriber-bandwidth requires a number as argument");o=new In({scenario:{case:"subscriberBandwidth",value:Ea(i)}});break;case"leave-full-reconnect":o=new In({scenario:{case:"leaveRequestFullReconnect",value:!0}})}o&&(yield this.engine.client.sendSimulateScenario(o),yield s())})}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveDevice(e){return this.localParticipant.activeDeviceMap.get(e)}switchActiveDevice(e,i){return _(this,arguments,void 0,function(s,o){var l=this;let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return(function*(){var u,h,m,g,y,S,T;let x=!0,E=!1;const k=d?{exact:o}:o;if(s==="audioinput"){E=l.localParticipant.audioTrackPublications.size===0;const R=(u=l.getActiveDevice(s))!==null&&u!==void 0?u:l.options.audioCaptureDefaults.deviceId;l.options.audioCaptureDefaults.deviceId=k;const O=Array.from(l.localParticipant.audioTrackPublications.values()).filter(D=>D.source===Q.Source.Microphone);try{x=(yield Promise.all(O.map(D=>{var I;return(I=D.audioTrack)===null||I===void 0?void 0:I.setDeviceId(k)}))).every(D=>D===!0)}catch(D){throw l.options.audioCaptureDefaults.deviceId=R,D}const L=O.some(D=>{var I,P;return(P=(I=D.track)===null||I===void 0?void 0:I.isMuted)!==null&&P!==void 0?P:!1});x&&L&&(E=!0)}else if(s==="videoinput"){E=l.localParticipant.videoTrackPublications.size===0;const R=(h=l.getActiveDevice(s))!==null&&h!==void 0?h:l.options.videoCaptureDefaults.deviceId;l.options.videoCaptureDefaults.deviceId=k;const O=Array.from(l.localParticipant.videoTrackPublications.values()).filter(D=>D.source===Q.Source.Camera);try{x=(yield Promise.all(O.map(D=>{var I;return(I=D.videoTrack)===null||I===void 0?void 0:I.setDeviceId(k)}))).every(D=>D===!0)}catch(D){throw l.options.videoCaptureDefaults.deviceId=R,D}const L=O.some(D=>{var I,P;return(P=(I=D.track)===null||I===void 0?void 0:I.isMuted)!==null&&P!==void 0?P:!1});x&&L&&(E=!0)}else if(s==="audiooutput"){if(E=!0,!Ih()&&!l.options.webAudioMix||l.options.webAudioMix&&l.audioContext&&!("setSinkId"in l.audioContext))throw new Error("cannot switch audio output, the current browser does not support it");l.options.webAudioMix&&(o=(m=yield Tt.getInstance().normalizeDeviceId("audiooutput",o))!==null&&m!==void 0?m:""),(g=(T=l.options).audioOutput)!==null&&g!==void 0||(T.audioOutput={});const R=(y=l.getActiveDevice(s))!==null&&y!==void 0?y:l.options.audioOutput.deviceId;l.options.audioOutput.deviceId=o;try{l.options.webAudioMix&&((S=l.audioContext)===null||S===void 0||S.setSinkId(o)),yield Promise.all(Array.from(l.remoteParticipants.values()).map(O=>O.setAudioOutput({deviceId:o})))}catch(O){throw l.options.audioOutput.deviceId=R,O}}return E&&(l.localParticipant.activeDeviceMap.set(s,o),l.emit(W.ActiveDeviceChanged,s,o)),x})()})}setupLocalParticipantEvents(){this.localParticipant.on(ae.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(ae.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(ae.AttributesChanged,this.onLocalAttributesChanged).on(ae.TrackMuted,this.onLocalTrackMuted).on(ae.TrackUnmuted,this.onLocalTrackUnmuted).on(ae.LocalTrackPublished,this.onLocalTrackPublished).on(ae.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(ae.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(ae.MediaDevicesError,this.onMediaDevicesError).on(ae.AudioStreamAcquired,this.startAudio).on(ae.ChatMessage,this.onLocalChatMessageSent).on(ae.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var e;(e=this.engine)===null||e===void 0||e.close(),this.engine=void 0,this.isResuming=!1,this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.bufferedEvents=[],this.maybeCreateEngine()}onTrackAdded(e,i,s){if(this.state===Ie.Connecting||this.state===Ie.Reconnecting){const y=()=>{this.log.debug("deferring on track for later",{mediaTrackId:e.id,mediaStreamId:i.id,tracksInStream:i.getTracks().map(T=>T.id)}),this.onTrackAdded(e,i,s),S()},S=()=>{this.off(W.Reconnected,y),this.off(W.Connected,y),this.off(W.Disconnected,S)};this.once(W.Reconnected,y),this.once(W.Connected,y),this.once(W.Disconnected,S);return}if(this.state===Ie.Disconnected){this.log.warn("skipping incoming track after Room disconnected",this.logContext);return}if(e.readyState==="ended"){this.log.info("skipping incoming track as it already ended",this.logContext);return}const o=zR(i.id),l=o[0];let d=o[1],u=e.id;if(d&&d.startsWith("TR")&&(u=d),l===this.localParticipant.sid){this.log.warn("tried to create RemoteParticipant for local participant",this.logContext);return}const h=Array.from(this.remoteParticipants.values()).find(y=>y.sid===l);if(!h){this.log.error("Tried to add a track for a participant, that's not present. Sid: ".concat(l),this.logContext);return}if(!u.startsWith("TR")){const y=this.engine.getTrackIdForReceiver(s);if(!y){this.log.error("Tried to add a track whose 'sid' could not be found for a participant, that's not present. Sid: ".concat(l),this.logContext);return}u=y}u.startsWith("TR")||this.log.warn("Tried to add a track whose 'sid' could not be determined for a participant, that's not present. Sid: ".concat(l,", streamId: ").concat(d,", trackId: ").concat(u),Object.assign(Object.assign({},this.logContext),{rpID:l,streamId:d,trackId:u}));let m;this.options.adaptiveStream&&(typeof this.options.adaptiveStream=="object"?m=this.options.adaptiveStream:m={});const g=h.addSubscribedMediaTrack(e,u,i,s,m);g?.isEncrypted&&!this.e2eeManager&&this.emit(W.EncryptionError,new Error("Encrypted ".concat(g.source," track received from participant ").concat(h.sid,", but room does not have encryption enabled!")))}handleDisconnect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,i=arguments.length>1?arguments[1]:void 0;var s,o;if(this.clearConnectionReconcile(),this.isResuming=!1,this.bufferedEvents=[],this.transcriptionReceivedTimes.clear(),this.incomingDataStreamManager.clearControllers(),this.state!==Ie.Disconnected){this.regionUrl=void 0,this.regionUrlProvider&&this.regionUrlProvider.notifyDisconnected();try{this.remoteParticipants.forEach(l=>{l.trackPublications.forEach(d=>{l.unpublishTrack(d.trackSid)})}),this.localParticipant.trackPublications.forEach(l=>{var d,u,h;l.track&&this.localParticipant.unpublishTrack(l.track,e),e?((d=l.track)===null||d===void 0||d.detach(),(u=l.track)===null||u===void 0||u.stop()):(h=l.track)===null||h===void 0||h.stopMonitor()}),this.localParticipant.off(ae.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(ae.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(ae.AttributesChanged,this.onLocalAttributesChanged).off(ae.TrackMuted,this.onLocalTrackMuted).off(ae.TrackUnmuted,this.onLocalTrackUnmuted).off(ae.LocalTrackPublished,this.onLocalTrackPublished).off(ae.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(ae.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(ae.MediaDevicesError,this.onMediaDevicesError).off(ae.AudioStreamAcquired,this.startAudio).off(ae.ChatMessage,this.onLocalChatMessageSent).off(ae.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.trackPublications.clear(),this.localParticipant.videoTrackPublications.clear(),this.localParticipant.audioTrackPublications.clear(),this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.activeSpeakers=[],this.audioContext&&typeof this.options.webAudioMix=="boolean"&&(this.audioContext.close(),this.audioContext=void 0),Kt()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),(o=(s=navigator.mediaDevices)===null||s===void 0?void 0:s.removeEventListener)===null||o===void 0||o.call(s,"devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(Ie.Disconnected),this.emit(W.Disconnected,i)}}}handleParticipantDisconnected(e,i){var s;this.remoteParticipants.delete(e),i&&(this.incomingDataStreamManager.validateParticipantHasNoActiveDataStreams(e),i.trackPublications.forEach(o=>{i.unpublishTrack(o.trackSid,!0)}),this.emit(W.ParticipantDisconnected,i),i.setDisconnected(),(s=this.localParticipant)===null||s===void 0||s.handleParticipantDisconnected(i.identity))}handleIncomingRpcRequest(e,i,s,o,l,d){return _(this,void 0,void 0,function*(){if(yield this.engine.publishRpcAck(e,i),d!==1){yield this.engine.publishRpcResponse(e,i,null,rt.builtIn("UNSUPPORTED_VERSION"));return}const u=this.rpcHandlers.get(s);if(!u){yield this.engine.publishRpcResponse(e,i,null,rt.builtIn("UNSUPPORTED_METHOD"));return}let h=null,m=null;try{const g=yield u({requestId:i,callerIdentity:e,payload:o,responseTimeout:l});wf(g)>oC?(h=rt.builtIn("RESPONSE_PAYLOAD_TOO_LARGE"),this.log.warn("RPC Response payload too large for ".concat(s))):m=g}catch(g){g instanceof rt?h=g:(this.log.warn("Uncaught error returned by RPC handler for ".concat(s,". Returning APPLICATION_ERROR instead."),g),h=rt.builtIn("APPLICATION_ERROR"))}yield this.engine.publishRpcResponse(e,i,m,h)})}selectDefaultDevices(){return _(this,void 0,void 0,function*(){var e,i,s;const o=Tt.getInstance().previousDevices,l=yield Tt.getInstance().getDevices(void 0,!1),d=Yt();if(d?.name==="Chrome"&&d.os!=="iOS")for(let h of l){const m=o.find(g=>g.deviceId===h.deviceId);m&&m.label!==""&&m.kind===h.kind&&m.label!==h.label&&this.getActiveDevice(h.kind)==="default"&&this.emit(W.ActiveDeviceChanged,h.kind,h.deviceId)}const u=["audiooutput","audioinput","videoinput"];for(let h of u){const m=DR(h),g=this.localParticipant.getTrackPublication(m);if(g&&(!((e=g.track)===null||e===void 0)&&e.isUserProvided))continue;const y=l.filter(T=>T.kind===h),S=this.getActiveDevice(h);if(S===((i=o.filter(T=>T.kind===h)[0])===null||i===void 0?void 0:i.deviceId)&&y.length>0&&((s=y[0])===null||s===void 0?void 0:s.deviceId)!==S){yield this.switchActiveDevice(h,y[0].deviceId);continue}h==="audioinput"&&!Zr()||h==="videoinput"||y.length>0&&!y.find(T=>T.deviceId===this.getActiveDevice(h))&&(h!=="audiooutput"||!Zr())&&(yield this.switchActiveDevice(h,y[0].deviceId))}})}acquireAudioContext(){return _(this,void 0,void 0,function*(){var e,i;if(typeof this.options.webAudioMix!="boolean"&&this.options.webAudioMix.audioContext?this.audioContext=this.options.webAudioMix.audioContext:(!this.audioContext||this.audioContext.state==="closed")&&(this.audioContext=(e=ZS())!==null&&e!==void 0?e:void 0),this.options.webAudioMix&&this.remoteParticipants.forEach(o=>o.setAudioContext(this.audioContext)),this.localParticipant.setAudioContext(this.audioContext),this.audioContext&&this.audioContext.state==="suspended")try{yield Promise.race([this.audioContext.resume(),Mt(200)])}catch(o){this.log.warn("Could not resume audio context",Object.assign(Object.assign({},this.logContext),{error:o}))}const s=((i=this.audioContext)===null||i===void 0?void 0:i.state)==="running";s!==this.canPlaybackAudio&&(this.audioEnabled=s,this.emit(W.AudioPlaybackStatusChanged,s))})}createParticipant(e,i){var s;let o;return i?o=ac.fromParticipantInfo(this.engine.client,i,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}):o=new ac(this.engine.client,"",e,void 0,void 0,void 0,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}),this.options.webAudioMix&&o.setAudioContext(this.audioContext),!((s=this.options.audioOutput)===null||s===void 0)&&s.deviceId&&o.setAudioOutput(this.options.audioOutput).catch(l=>this.log.warn("Could not set audio output: ".concat(l.message),this.logContext)),o}getOrCreateParticipant(e,i){if(this.remoteParticipants.has(e)){const o=this.remoteParticipants.get(e);return i&&o.updateInfo(i)&&this.sidToIdentity.set(i.sid,i.identity),o}const s=this.createParticipant(e,i);return this.remoteParticipants.set(e,s),this.sidToIdentity.set(i.sid,i.identity),this.emitWhenConnected(W.ParticipantConnected,s),s.on(ae.TrackPublished,o=>{this.emitWhenConnected(W.TrackPublished,o,s)}).on(ae.TrackSubscribed,(o,l)=>{o.kind===Q.Kind.Audio?(o.on($.AudioPlaybackStarted,this.handleAudioPlaybackStarted),o.on($.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):o.kind===Q.Kind.Video&&(o.on($.VideoPlaybackFailed,this.handleVideoPlaybackFailed),o.on($.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit(W.TrackSubscribed,o,l,s)}).on(ae.TrackUnpublished,o=>{this.emit(W.TrackUnpublished,o,s)}).on(ae.TrackUnsubscribed,(o,l)=>{this.emit(W.TrackUnsubscribed,o,l,s)}).on(ae.TrackMuted,o=>{this.emitWhenConnected(W.TrackMuted,o,s)}).on(ae.TrackUnmuted,o=>{this.emitWhenConnected(W.TrackUnmuted,o,s)}).on(ae.ParticipantMetadataChanged,o=>{this.emitWhenConnected(W.ParticipantMetadataChanged,o,s)}).on(ae.ParticipantNameChanged,o=>{this.emitWhenConnected(W.ParticipantNameChanged,o,s)}).on(ae.AttributesChanged,o=>{this.emitWhenConnected(W.ParticipantAttributesChanged,o,s)}).on(ae.ConnectionQualityChanged,o=>{this.emitWhenConnected(W.ConnectionQualityChanged,o,s)}).on(ae.ParticipantPermissionsChanged,o=>{this.emitWhenConnected(W.ParticipantPermissionsChanged,o,s)}).on(ae.TrackSubscriptionStatusChanged,(o,l)=>{this.emitWhenConnected(W.TrackSubscriptionStatusChanged,o,l,s)}).on(ae.TrackSubscriptionFailed,(o,l)=>{this.emit(W.TrackSubscriptionFailed,o,s,l)}).on(ae.TrackSubscriptionPermissionChanged,(o,l)=>{this.emitWhenConnected(W.TrackSubscriptionPermissionChanged,o,l,s)}).on(ae.Active,()=>{this.emitWhenConnected(W.ParticipantActive,s),s.kind===Qr.AGENT&&this.localParticipant.setActiveAgent(s)}),i&&s.updateInfo(i),s}sendSyncState(){const e=Array.from(this.remoteParticipants.values()).reduce((s,o)=>(s.push(...o.getTrackPublications()),s),[]),i=this.localParticipant.getTrackPublications();this.engine.sendSyncState(e,i)}updateSubscriptions(){for(const e of this.remoteParticipants.values())for(const i of e.videoTrackPublications.values())i.isSubscribed&&tM(i)&&i.emitTrackUpdate()}getRemoteParticipantBySid(e){const i=this.sidToIdentity.get(e);if(i)return this.remoteParticipants.get(i)}registerConnectionReconcile(){this.clearConnectionReconcile();let e=0;this.connectionReconcileInterval=Rt.setInterval(()=>{!this.engine||this.engine.isClosed||!this.engine.verifyTransport()?(e++,this.log.warn("detected connection state mismatch",Object.assign(Object.assign({},this.logContext),{numFailures:e,engine:this.engine?{closed:this.engine.isClosed,transportsConnectedOrConnecting:this.engine.verifyTransport()}:void 0})),e>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,Mn.STATE_MISMATCH))):e=0},CA)}clearConnectionReconcile(){this.connectionReconcileInterval&&Rt.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(e){return e===this.state?!1:(this.state=e,this.emit(W.ConnectionStateChanged,this.state),!0)}emitBufferedEvents(){this.bufferedEvents.forEach(e=>{let[i,s]=e;this.emit(i,...s)}),this.bufferedEvents=[]}emitWhenConnected(e){for(var i=arguments.length,s=new Array(i>1?i-1:0),o=1;o<i;o++)s[o-1]=arguments[o];if(this.state===Ie.Reconnecting||this.isResuming||!this.engine||this.engine.pendingReconnect)this.bufferedEvents.push([e,s]);else if(this.state===Ie.Connected)return this.emit(e,...s);return!1}simulateParticipants(e){return _(this,void 0,void 0,function*(){var i,s,o,l;const d=Object.assign({audio:!0,video:!0,useRealTracks:!1},e.publish),u=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},e.participants);if(this.handleDisconnect(),this.roomInfo=new hc({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:et.parse(new Date().getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new Ra({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(W.SignalConnected),this.emit(W.Connected),this.setAndEmitConnectionState(Ie.Connected),d.video){const h=new Hh(Q.Kind.Video,new Cs({source:vt.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:wn.AUDIO,name:"video-dummy"}),new ic(d.useRealTracks&&(!((i=window.navigator.mediaDevices)===null||i===void 0)&&i.getUserMedia)?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:u0(160*((s=u.aspectRatios[0])!==null&&s!==void 0?s:1),160,!0,!0),void 0,!1,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(h),this.localParticipant.emit(ae.LocalTrackPublished,h)}if(d.audio){const h=new Hh(Q.Kind.Audio,new Cs({source:vt.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:wn.AUDIO}),new nc(d.useRealTracks&&(!((o=navigator.mediaDevices)===null||o===void 0)&&o.getUserMedia)?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:ah(),void 0,!1,this.audioContext,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(h),this.localParticipant.emit(ae.LocalTrackPublished,h)}for(let h=0;h<u.count-1;h+=1){let m=new Ra({sid:Math.floor(Math.random()*1e4).toString(),identity:"simulated-".concat(h),state:Es.ACTIVE,tracks:[],joinedAt:et.parse(Date.now())});const g=this.getOrCreateParticipant(m.identity,m);if(u.video){const y=u0(160*((l=u.aspectRatios[h%u.aspectRatios.length])!==null&&l!==void 0?l:1),160,!1,!0),S=new Cs({source:vt.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:wn.AUDIO});g.addSubscribedMediaTrack(y,S.sid,new MediaStream([y]),new RTCRtpReceiver),m.tracks=[...m.tracks,S]}if(u.audio){const y=ah(),S=new Cs({source:vt.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:wn.AUDIO});g.addSubscribedMediaTrack(y,S.sid,new MediaStream([y]),new RTCRtpReceiver),m.tracks=[...m.tracks,S]}g.updateInfo(m)}})}emit(e){for(var i=arguments.length,s=new Array(i>1?i-1:0),o=1;o<i;o++)s[o-1]=arguments[o];if(e!==W.ActiveSpeakersChanged&&e!==W.TranscriptionReceived){const l=gC(s).filter(d=>d!==void 0);(e===W.TrackSubscribed||e===W.TrackUnsubscribed)&&this.log.trace("subscribe trace: ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:l})),this.log.debug("room event ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:l}))}return super.emit(e,...s)}}Os.cleanupRegistry=typeof FinalizationRegistry<"u"&&new FinalizationRegistry(a=>{a()});function gC(a){return a.map(e=>{if(e)return Array.isArray(e)?gC(e):typeof e=="object"?"logContext"in e?e.logContext:void 0:e})}var P0;(function(a){a[a.TooShort=0]="TooShort",a[a.HeaderOverrun=1]="HeaderOverrun",a[a.MissingExtWords=2]="MissingExtWords",a[a.UnsupportedVersion=3]="UnsupportedVersion",a[a.InvalidHandle=4]="InvalidHandle",a[a.MalformedExt=5]="MalformedExt"})(P0||(P0={}));var j0;(function(a){a[a.TooSmallForHeader=0]="TooSmallForHeader",a[a.TooSmallForPayload=1]="TooSmallForPayload"})(j0||(j0={}));var sc;(function(a){a[a.UserTimestamp=2]="UserTimestamp",a[a.E2ee=1]="E2ee"})(sc||(sc={}));sc.UserTimestamp;sc.E2ee;var I0;(function(a){a[a.Reserved=0]="Reserved",a[a.TooLarge=1]="TooLarge"})(I0||(I0={}));var L0;(function(a){a[a.Start=0]="Start",a[a.Inter=1]="Inter",a[a.Final=2]="Final",a[a.Single=3]="Single"})(L0||(L0={}));var U0;(function(a){a[a.MtuTooShort=0]="MtuTooShort"})(U0||(U0={}));Bn(bn.DataTracks);var B0;(function(a){a[a.Interrupted=0]="Interrupted",a[a.UnknownFrame=1]="UnknownFrame",a[a.BufferFull=2]="BufferFull",a[a.Incomplete=3]="Incomplete"})(B0||(B0={}));var _n;(function(a){a[a.IDLE=0]="IDLE",a[a.RUNNING=1]="RUNNING",a[a.SKIPPED=2]="SKIPPED",a[a.SUCCESS=3]="SUCCESS",a[a.FAILED=4]="FAILED"})(_n||(_n={}));class ia extends Hn.EventEmitter{constructor(e,i){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.status=_n.IDLE,this.logs=[],this.options={},this.url=e,this.token=i,this.name=this.constructor.name,this.room=new Os(s.roomOptions),this.connectOptions=s.connectOptions,this.options=s}run(e){return _(this,void 0,void 0,function*(){if(this.status!==_n.IDLE)throw Error("check is running already");this.setStatus(_n.RUNNING);try{yield this.perform()}catch(i){i instanceof Error&&(this.options.errorsAsWarnings?this.appendWarning(i.message):this.appendError(i.message))}return yield this.disconnect(),yield new Promise(i=>setTimeout(i,500)),this.status!==_n.SKIPPED&&this.setStatus(this.isSuccess()?_n.SUCCESS:_n.FAILED),e&&e(),this.getInfo()})}isSuccess(){return!this.logs.some(e=>e.level==="error")}connect(e){return _(this,void 0,void 0,function*(){return this.room.state===Ie.Connected?this.room:(e||(e=this.url),yield this.room.connect(e,this.token,this.connectOptions),this.room)})}disconnect(){return _(this,void 0,void 0,function*(){this.room&&this.room.state!==Ie.Disconnected&&(yield this.room.disconnect(),yield new Promise(e=>setTimeout(e,500)))})}skip(){this.setStatus(_n.SKIPPED)}switchProtocol(e){return _(this,void 0,void 0,function*(){let i=!1,s=!1;if(this.room.on(W.Reconnecting,()=>{i=!0}),this.room.once(W.Reconnected,()=>{s=!0}),this.room.simulateScenario("force-".concat(e)),yield new Promise(l=>setTimeout(l,1e3)),!i)return;const o=Date.now()+1e4;for(;Date.now()<o;){if(s)return;yield Mt(100)}throw new Error("Could not reconnect using ".concat(e," protocol after 10 seconds"))})}appendMessage(e){this.logs.push({level:"info",message:e}),this.emit("update",this.getInfo())}appendWarning(e){this.logs.push({level:"warning",message:e}),this.emit("update",this.getInfo())}appendError(e){this.logs.push({level:"error",message:e}),this.emit("update",this.getInfo())}setStatus(e){this.status=e,this.emit("update",this.getInfo())}get engine(){var e;return(e=this.room)===null||e===void 0?void 0:e.engine}getInfo(){return{logs:this.logs,name:this.name,status:this.status,description:this.description}}}class TA extends ia{get description(){return"Cloud regions"}perform(){return _(this,void 0,void 0,function*(){const e=new Ne(this.url,this.token);if(!e.isCloud()){this.skip();return}const i=[],s=new Set;for(let l=0;l<3;l++){const d=yield e.getNextBestRegionUrl();if(!d)break;if(s.has(d))continue;s.add(d);const u=yield this.checkCloudRegion(d);this.appendMessage("".concat(u.region," RTT: ").concat(u.rtt,"ms, duration: ").concat(u.duration,"ms")),i.push(u)}i.sort((l,d)=>(l.duration-d.duration)*.5+(l.rtt-d.rtt)*.5);const o=i[0];this.bestStats=o,this.appendMessage("best Cloud region: ".concat(o.region))})}getInfo(){const e=super.getInfo();return e.data=this.bestStats,e}checkCloudRegion(e){return _(this,void 0,void 0,function*(){var i,s;yield this.connect(e),this.options.protocol==="tcp"&&(yield this.switchProtocol("tcp"));const o=(i=this.room.serverInfo)===null||i===void 0?void 0:i.region;if(!o)throw new Error("Region not found");const l=yield this.room.localParticipant.streamText({topic:"test"}),d=1e3,h=1e6/d,m="A".repeat(d),g=Date.now();for(let x=0;x<h;x++)yield l.write(m);yield l.close();const y=Date.now(),S=yield(s=this.room.engine.pcManager)===null||s===void 0?void 0:s.publisher.getStats(),T={region:o,rtt:1e4,duration:y-g};return S?.forEach(x=>{x.type==="candidate-pair"&&x.nominated&&(T.rtt=x.currentRoundTripTime*1e3)}),yield this.disconnect(),T})}}const fh=1e4;class kA extends ia{get description(){return"Connection via UDP vs TCP"}perform(){return _(this,void 0,void 0,function*(){const e=yield this.checkConnectionProtocol("udp"),i=yield this.checkConnectionProtocol("tcp");this.bestStats=e,e.qualityLimitationDurations.bandwidth-i.qualityLimitationDurations.bandwidth>.5||(e.packetsLost-i.packetsLost)/e.packetsSent>.01?(this.appendMessage("best connection quality via tcp"),this.bestStats=i):this.appendMessage("best connection quality via udp");const s=this.bestStats;this.appendMessage("upstream bitrate: ".concat((s.bitrateTotal/s.count/1e3/1e3).toFixed(2)," mbps")),this.appendMessage("RTT: ".concat((s.rttTotal/s.count*1e3).toFixed(2)," ms")),this.appendMessage("jitter: ".concat((s.jitterTotal/s.count*1e3).toFixed(2)," ms")),s.packetsLost>0&&this.appendWarning("packets lost: ".concat((s.packetsLost/s.packetsSent*100).toFixed(2),"%")),s.qualityLimitationDurations.bandwidth>1&&this.appendWarning("bandwidth limited ".concat((s.qualityLimitationDurations.bandwidth/(fh/1e3)*100).toFixed(2),"%")),s.qualityLimitationDurations.cpu>0&&this.appendWarning("cpu limited ".concat((s.qualityLimitationDurations.cpu/(fh/1e3)*100).toFixed(2),"%"))})}getInfo(){const e=super.getInfo();return e.data=this.bestStats,e}checkConnectionProtocol(e){return _(this,void 0,void 0,function*(){yield this.connect(),e==="tcp"?yield this.switchProtocol("tcp"):yield this.switchProtocol("udp");const i=document.createElement("canvas");i.width=1280,i.height=720;const s=i.getContext("2d");if(!s)throw new Error("Could not get canvas context");let o=0;const l=()=>{o=(o+1)%360,s.fillStyle="hsl(".concat(o,", 100%, 50%)"),s.fillRect(0,0,i.width,i.height),requestAnimationFrame(l)};l();const u=i.captureStream(30).getVideoTracks()[0],m=(yield this.room.localParticipant.publishTrack(u,{simulcast:!1,degradationPreference:"maintain-resolution",videoEncoding:{maxBitrate:2e6}})).track,g={protocol:e,packetsLost:0,packetsSent:0,qualityLimitationDurations:{},rttTotal:0,jitterTotal:0,bitrateTotal:0,count:0},y=setInterval(()=>_(this,void 0,void 0,function*(){const S=yield m.getRTCStatsReport();S?.forEach(T=>{T.type==="outbound-rtp"?(g.packetsSent=T.packetsSent,g.qualityLimitationDurations=T.qualityLimitationDurations,g.bitrateTotal+=T.targetBitrate,g.count++):T.type==="remote-inbound-rtp"&&(g.packetsLost=T.packetsLost,g.rttTotal+=T.roundTripTime,g.jitterTotal+=T.jitter)})}),1e3);return yield new Promise(S=>setTimeout(S,fh)),clearInterval(y),u.stop(),i.remove(),yield this.disconnect(),g})}}class EA extends ia{get description(){return"Can publish audio"}perform(){return _(this,void 0,void 0,function*(){var e;const i=yield this.connect(),s=yield mC();if(yield WS(s,1e3))throw new Error("unable to detect audio from microphone");this.appendMessage("detected audio from microphone"),i.localParticipant.publishTrack(s),yield new Promise(u=>setTimeout(u,3e3));const l=yield(e=s.sender)===null||e===void 0?void 0:e.getStats();if(!l)throw new Error("Could not get RTCStats");let d=0;if(l.forEach(u=>{u.type==="outbound-rtp"&&(u.kind==="audio"||!u.kind&&u.mediaType==="audio")&&(d=u.packetsSent)}),d===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(d," audio packets"))})}}class _A extends ia{get description(){return"Can publish video"}perform(){return _(this,void 0,void 0,function*(){var e;const i=yield this.connect(),s=yield gA();yield this.checkForVideo(s.mediaStreamTrack),i.localParticipant.publishTrack(s),yield new Promise(d=>setTimeout(d,5e3));const o=yield(e=s.sender)===null||e===void 0?void 0:e.getStats();if(!o)throw new Error("Could not get RTCStats");let l=0;if(o.forEach(d=>{d.type==="outbound-rtp"&&(d.kind==="video"||!d.kind&&d.mediaType==="video")&&(l+=d.packetsSent)}),l===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(l," video packets"))})}checkForVideo(e){return _(this,void 0,void 0,function*(){const i=new MediaStream;i.addTrack(e.clone());const s=document.createElement("video");s.srcObject=i,s.muted=!0,s.autoplay=!0,s.playsInline=!0,s.setAttribute("playsinline","true"),document.body.appendChild(s),yield new Promise(o=>{s.onplay=()=>{setTimeout(()=>{var l,d,u,h;const m=document.createElement("canvas"),g=e.getSettings(),y=(d=(l=g.width)!==null&&l!==void 0?l:s.videoWidth)!==null&&d!==void 0?d:1280,S=(h=(u=g.height)!==null&&u!==void 0?u:s.videoHeight)!==null&&h!==void 0?h:720;m.width=y,m.height=S;const T=m.getContext("2d");T.drawImage(s,0,0);const E=T.getImageData(0,0,m.width,m.height).data;let k=!0;for(let R=0;R<E.length;R+=4)if(E[R]!==0||E[R+1]!==0||E[R+2]!==0){k=!1;break}k?this.appendError("camera appears to be producing only black frames"):this.appendMessage("received video frames"),o()},1e3)},s.play()}),i.getTracks().forEach(o=>o.stop()),s.remove()})}}class wA extends ia{get description(){return"Resuming connection after interruption"}perform(){return _(this,void 0,void 0,function*(){var e;const i=yield this.connect();let s=!1,o=!1,l;const d=new Promise(m=>{setTimeout(m,5e3),l=m}),u=()=>{s=!0};i.on(W.SignalReconnecting,u).on(W.Reconnecting,u).on(W.Reconnected,()=>{o=!0,l(!0)}),(e=i.engine.client.ws)===null||e===void 0||e.close();const h=i.engine.client.onClose;if(h&&h(""),yield d,s){if(!o||i.state!==Ie.Connected)throw this.appendWarning("reconnection is only possible in Redis-based configurations"),new Error("Not able to reconnect")}else throw new Error("Did not attempt to reconnect")})}}class xA extends ia{get description(){return"Can connect via TURN"}perform(){return _(this,void 0,void 0,function*(){var e,i,s;Ds(new URL(this.url))&&(this.appendMessage("Using region specific url"),this.url=(e=yield new Ne(this.url,this.token).getNextBestRegionUrl())!==null&&e!==void 0?e:this.url);const o=new Cf,l=yield o.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3},void 0,!0);let d=!1,u=!1,h=!1;for(let m of l.iceServers)for(let g of m.urls)g.startsWith("turn:")?(u=!0,h=!0):g.startsWith("turns:")&&(u=!0,h=!0,d=!0),g.startsWith("stun:")&&(h=!0);h?u&&!d&&this.appendWarning("TURN is configured server side, but TURN/TLS is unavailable."):this.appendWarning("No STUN servers configured on server side."),yield o.close(),!((s=(i=this.connectOptions)===null||i===void 0?void 0:i.rtcConfig)===null||s===void 0)&&s.iceServers||u?yield this.room.connect(this.url,this.token,{rtcConfig:{iceTransportPolicy:"relay"}}):(this.appendWarning("No TURN servers configured."),this.skip(),yield new Promise(m=>setTimeout(m,0)))})}}class RA extends ia{get description(){return"Establishing WebRTC connection"}perform(){return _(this,void 0,void 0,function*(){let e=!1,i=!1;this.room.on(W.SignalConnected,()=>{var s;const o=this.room.engine.client.onTrickle;this.room.engine.client.onTrickle=(l,d)=>{if(l.candidate){const u=new RTCIceCandidate(l);let h="".concat(u.protocol," ").concat(u.address,":").concat(u.port," ").concat(u.type);u.address&&(MA(u.address)?h+=" (private)":u.protocol==="tcp"&&u.tcpType==="passive"?(e=!0,h+=" (passive)"):u.protocol==="udp"&&(i=!0)),this.appendMessage(h)}o&&o(l,d)},!((s=this.room.engine.pcManager)===null||s===void 0)&&s.subscriber&&(this.room.engine.pcManager.subscriber.onIceCandidateError=l=>{l instanceof RTCPeerConnectionIceErrorEvent&&this.appendWarning("error with ICE candidate: ".concat(l.errorCode," ").concat(l.errorText," ").concat(l.url))})});try{yield this.connect(),Se.info("now the room is connected")}catch(s){throw this.appendWarning("ports need to be open on firewall in order to connect."),s}e||this.appendWarning("Server is not configured for ICE/TCP"),i||this.appendWarning("No public IPv4 UDP candidates were found. Your server is likely not configured correctly")})}}function MA(a){const e=a.split(".");if(e.length===4){if(e[0]==="10")return!0;if(e[0]==="192"&&e[1]==="168")return!0;if(e[0]==="172"){const i=parseInt(e[1],10);if(i>=16&&i<=31)return!0}}return!1}class AA extends ia{get description(){return"Connecting to signal connection via WebSocket"}perform(){return _(this,void 0,void 0,function*(){var e,i,s;(this.url.startsWith("ws:")||this.url.startsWith("http:"))&&this.appendWarning("Server is insecure, clients may block connections to it");let o=new Cf,l;try{l=yield o.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3},void 0,!0)}catch(d){if(Ds(new URL(this.url))){this.appendMessage("Initial connection failed with error ".concat(d.message,". Retrying with region fallback"));const h=yield new Ne(this.url,this.token).getNextBestRegionUrl();h&&(l=yield o.join(h,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3},void 0,!0),this.appendMessage("Fallback to region worked. To avoid initial connections failing, ensure you're calling room.prepareConnection() ahead of time"))}}l?(this.appendMessage("Connected to server, version ".concat(l.serverVersion,".")),((e=l.serverInfo)===null||e===void 0?void 0:e.edition)===Wb.Cloud&&(!((i=l.serverInfo)===null||i===void 0)&&i.region)&&this.appendMessage("LiveKit Cloud: ".concat((s=l.serverInfo)===null||s===void 0?void 0:s.region))):this.appendError("Websocket connection could not be established"),yield o.close()})}}class sN extends Hn.EventEmitter{constructor(e,i){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.options={},this.checkResults=new Map,this.url=e,this.token=i,this.options=s}getNextCheckId(){const e=this.checkResults.size;return this.checkResults.set(e,{logs:[],status:_n.IDLE,name:"",description:""}),e}updateCheck(e,i){this.checkResults.set(e,i),this.emit("checkUpdate",e,i)}isSuccess(){return Array.from(this.checkResults.values()).every(e=>e.status!==_n.FAILED)}getResults(){return Array.from(this.checkResults.values())}createAndRunCheck(e){return _(this,void 0,void 0,function*(){const i=this.getNextCheckId(),s=new e(this.url,this.token,this.options),o=d=>{this.updateCheck(i,d)};s.on("update",o);const l=yield s.run();return s.off("update",o),l})}checkWebsocket(){return _(this,void 0,void 0,function*(){return this.createAndRunCheck(AA)})}checkWebRTC(){return _(this,void 0,void 0,function*(){return this.createAndRunCheck(RA)})}checkTURN(){return _(this,void 0,void 0,function*(){return this.createAndRunCheck(xA)})}checkReconnect(){return _(this,void 0,void 0,function*(){return this.createAndRunCheck(wA)})}checkPublishAudio(){return _(this,void 0,void 0,function*(){return this.createAndRunCheck(EA)})}checkPublishVideo(){return _(this,void 0,void 0,function*(){return this.createAndRunCheck(_A)})}checkConnectionProtocol(){return _(this,void 0,void 0,function*(){const e=yield this.createAndRunCheck(kA);if(e.data&&"protocol"in e.data){const i=e.data;this.options.protocol=i.protocol}return e})}checkCloudRegion(){return _(this,void 0,void 0,function*(){return this.createAndRunCheck(TA)})}}function _e(a,e,i){return(e=DA(e))in a?Object.defineProperty(a,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):a[e]=i,a}function NA(a,e){if(typeof a!="object"||!a)return a;var i=a[Symbol.toPrimitive];if(i!==void 0){var s=i.call(a,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(a)}function DA(a){var e=NA(a,"string");return typeof e=="symbol"?e:e+""}new TextEncoder;new TextDecoder;class Lt extends Error{constructor(e,i){var s;super(e,i),_e(this,"code","ERR_JOSE_GENERIC"),this.name=this.constructor.name,(s=Error.captureStackTrace)===null||s===void 0||s.call(Error,this,this.constructor)}}_e(Lt,"code","ERR_JOSE_GENERIC");class OA extends Lt{constructor(e,i){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"unspecified",o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unspecified";super(e,{cause:{claim:s,reason:o,payload:i}}),_e(this,"code","ERR_JWT_CLAIM_VALIDATION_FAILED"),_e(this,"claim",void 0),_e(this,"reason",void 0),_e(this,"payload",void 0),this.claim=s,this.reason=o,this.payload=i}}_e(OA,"code","ERR_JWT_CLAIM_VALIDATION_FAILED");class PA extends Lt{constructor(e,i){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"unspecified",o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unspecified";super(e,{cause:{claim:s,reason:o,payload:i}}),_e(this,"code","ERR_JWT_EXPIRED"),_e(this,"claim",void 0),_e(this,"reason",void 0),_e(this,"payload",void 0),this.claim=s,this.reason=o,this.payload=i}}_e(PA,"code","ERR_JWT_EXPIRED");class jA extends Lt{constructor(){super(...arguments),_e(this,"code","ERR_JOSE_ALG_NOT_ALLOWED")}}_e(jA,"code","ERR_JOSE_ALG_NOT_ALLOWED");class IA extends Lt{constructor(){super(...arguments),_e(this,"code","ERR_JOSE_NOT_SUPPORTED")}}_e(IA,"code","ERR_JOSE_NOT_SUPPORTED");class LA extends Lt{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"decryption operation failed",i=arguments.length>1?arguments[1]:void 0;super(e,i),_e(this,"code","ERR_JWE_DECRYPTION_FAILED")}}_e(LA,"code","ERR_JWE_DECRYPTION_FAILED");class UA extends Lt{constructor(){super(...arguments),_e(this,"code","ERR_JWE_INVALID")}}_e(UA,"code","ERR_JWE_INVALID");class BA extends Lt{constructor(){super(...arguments),_e(this,"code","ERR_JWS_INVALID")}}_e(BA,"code","ERR_JWS_INVALID");class qA extends Lt{constructor(){super(...arguments),_e(this,"code","ERR_JWT_INVALID")}}_e(qA,"code","ERR_JWT_INVALID");class zA extends Lt{constructor(){super(...arguments),_e(this,"code","ERR_JWK_INVALID")}}_e(zA,"code","ERR_JWK_INVALID");class FA extends Lt{constructor(){super(...arguments),_e(this,"code","ERR_JWKS_INVALID")}}_e(FA,"code","ERR_JWKS_INVALID");class HA extends Lt{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"no applicable key found in the JSON Web Key Set",i=arguments.length>1?arguments[1]:void 0;super(e,i),_e(this,"code","ERR_JWKS_NO_MATCHING_KEY")}}_e(HA,"code","ERR_JWKS_NO_MATCHING_KEY");class VA extends Lt{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"multiple matching keys found in the JSON Web Key Set",i=arguments.length>1?arguments[1]:void 0;super(e,i),_e(this,Symbol.asyncIterator,void 0),_e(this,"code","ERR_JWKS_MULTIPLE_MATCHING_KEYS")}}_e(VA,"code","ERR_JWKS_MULTIPLE_MATCHING_KEYS");class GA extends Lt{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"request timed out",i=arguments.length>1?arguments[1]:void 0;super(e,i),_e(this,"code","ERR_JWKS_TIMEOUT")}}_e(GA,"code","ERR_JWKS_TIMEOUT");class KA extends Lt{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"signature verification failed",i=arguments.length>1?arguments[1]:void 0;super(e,i),_e(this,"code","ERR_JWS_SIGNATURE_VERIFICATION_FAILED")}}_e(KA,"code","ERR_JWS_SIGNATURE_VERIFICATION_FAILED");function An(){return An=Object.assign?Object.assign.bind():function(a){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)({}).hasOwnProperty.call(i,s)&&(a[s]=i[s])}return a},An.apply(null,arguments)}const q0=new Uint8Array(0);class eo{static getFullOptions(e){var i;const s=(function(o){var l,d;const{textOnly:u}=(l=(d=o.overrides)==null?void 0:d.conversation)!=null?l:{},{textOnly:h}=o;return typeof h=="boolean"?(typeof u=="boolean"&&h!==u&&console.warn(`Conflicting textOnly options provided: ${h} via options.textOnly (will be used) and ${u} via options.overrides.conversation.textOnly (will be ignored)`),h):typeof u=="boolean"?u:void 0})(e);return An({clientTools:{},onConnect:()=>{},onDebug:()=>{},onDisconnect:()=>{},onError:()=>{},onMessage:()=>{},onAudio:()=>{},onModeChange:()=>{},onStatusChange:()=>{},onCanSendFeedbackChange:()=>{},onInterruption:()=>{}},e,{textOnly:s,overrides:An({},e.overrides,{conversation:An({},(i=e.overrides)==null?void 0:i.conversation,{textOnly:s})})})}constructor(e,i){var s=this;this.options=void 0,this.connection=void 0,this.lastInterruptTimestamp=0,this.mode="listening",this.status="connecting",this.volume=1,this.currentEventId=1,this.lastFeedbackEventId=0,this.canSendFeedback=!1,this.endSessionWithDetails=async function(o){s.status!=="connected"&&s.status!=="connecting"||(s.updateStatus("disconnecting"),await s.handleEndSession(),s.updateStatus("disconnected"),s.options.onDisconnect&&s.options.onDisconnect(o))},this.onMessage=async function(o){switch(o.type){case"interruption":return void s.handleInterruption(o);case"agent_response":return void s.handleAgentResponse(o);case"user_transcript":return void s.handleUserTranscript(o);case"internal_tentative_agent_response":return void s.handleTentativeAgentResponse(o);case"client_tool_call":try{await s.handleClientToolCall(o)}catch(l){s.onError(`Unexpected error in client tool call handling: ${l instanceof Error?l.message:String(l)}`,{clientToolName:o.client_tool_call.tool_name,toolCallId:o.client_tool_call.tool_call_id})}return;case"audio":return void s.handleAudio(o);case"vad_score":return void s.handleVadScore(o);case"ping":return void s.connection.sendMessage({type:"pong",event_id:o.ping_event.event_id});case"mcp_tool_call":return void s.handleMCPToolCall(o);case"mcp_connection_status":return void s.handleMCPConnectionStatus(o);case"agent_tool_request":return void s.handleAgentToolRequest(o);case"agent_tool_response":return void s.handleAgentToolResponse(o);case"conversation_initiation_metadata":return void s.handleConversationMetadata(o);case"asr_initiation_metadata":return void s.handleAsrInitiationMetadata(o);case"agent_chat_response_part":return void s.handleAgentChatResponsePart(o);case"error":return void s.handleErrorEvent(o);default:return void(s.options.onDebug&&s.options.onDebug(o))}},this.setVolume=({volume:o})=>{this.volume=o},this.options=e,this.connection=i,this.options.onConnect&&this.options.onConnect({conversationId:i.conversationId}),this.connection.onMessage(this.onMessage),this.connection.onDisconnect(this.endSessionWithDetails),this.connection.onModeChange(o=>this.updateMode(o)),this.updateStatus("connected")}endSession(){return this.endSessionWithDetails({reason:"user"})}async handleEndSession(){this.connection.close()}updateMode(e){e!==this.mode&&(this.mode=e,this.options.onModeChange&&this.options.onModeChange({mode:e}))}updateStatus(e){e!==this.status&&(this.status=e,this.options.onStatusChange&&this.options.onStatusChange({status:e}))}updateCanSendFeedback(){const e=this.currentEventId!==this.lastFeedbackEventId;this.canSendFeedback!==e&&(this.canSendFeedback=e,this.options.onCanSendFeedbackChange&&this.options.onCanSendFeedbackChange({canSendFeedback:e}))}handleInterruption(e){e.interruption_event&&(this.lastInterruptTimestamp=e.interruption_event.event_id,this.options.onInterruption&&this.options.onInterruption({event_id:e.interruption_event.event_id}))}handleAgentResponse(e){this.options.onMessage&&this.options.onMessage({source:"ai",role:"agent",message:e.agent_response_event.agent_response})}handleUserTranscript(e){this.options.onMessage&&this.options.onMessage({source:"user",role:"user",message:e.user_transcription_event.user_transcript})}handleTentativeAgentResponse(e){this.options.onDebug&&this.options.onDebug({type:"tentative_agent_response",response:e.tentative_agent_response_internal_event.tentative_agent_response})}handleVadScore(e){this.options.onVadScore&&this.options.onVadScore({vadScore:e.vad_score_event.vad_score})}async handleClientToolCall(e){if(Object.prototype.hasOwnProperty.call(this.options.clientTools,e.client_tool_call.tool_name))try{var i;const s=(i=await this.options.clientTools[e.client_tool_call.tool_name](e.client_tool_call.parameters))!=null?i:"Client tool execution successful.",o=typeof s=="object"?JSON.stringify(s):String(s);this.connection.sendMessage({type:"client_tool_result",tool_call_id:e.client_tool_call.tool_call_id,result:o,is_error:!1})}catch(s){this.onError(`Client tool execution failed with following error: ${s?.message}`,{clientToolName:e.client_tool_call.tool_name}),this.connection.sendMessage({type:"client_tool_result",tool_call_id:e.client_tool_call.tool_call_id,result:`Client tool execution failed: ${s?.message}`,is_error:!0})}else{if(this.options.onUnhandledClientToolCall)return void this.options.onUnhandledClientToolCall(e.client_tool_call);this.onError(`Client tool with name ${e.client_tool_call.tool_name} is not defined on client`,{clientToolName:e.client_tool_call.tool_name}),this.connection.sendMessage({type:"client_tool_result",tool_call_id:e.client_tool_call.tool_call_id,result:`Client tool with name ${e.client_tool_call.tool_name} is not defined on client`,is_error:!0})}}handleAudio(e){}handleMCPToolCall(e){this.options.onMCPToolCall&&this.options.onMCPToolCall(e.mcp_tool_call)}handleMCPConnectionStatus(e){this.options.onMCPConnectionStatus&&this.options.onMCPConnectionStatus(e.mcp_connection_status)}handleAgentToolRequest(e){this.options.onAgentToolRequest&&this.options.onAgentToolRequest(e.agent_tool_request)}handleAgentToolResponse(e){e.agent_tool_response.tool_name==="end_call"&&this.endSessionWithDetails({reason:"agent",context:new CloseEvent("end_call",{reason:"Agent ended the call"})}),this.options.onAgentToolResponse&&this.options.onAgentToolResponse(e.agent_tool_response)}handleConversationMetadata(e){this.options.onConversationMetadata&&this.options.onConversationMetadata(e.conversation_initiation_metadata_event)}handleAsrInitiationMetadata(e){this.options.onAsrInitiationMetadata&&this.options.onAsrInitiationMetadata(e.asr_initiation_metadata_event)}handleAgentChatResponsePart(e){this.options.onAgentChatResponsePart&&this.options.onAgentChatResponsePart(e.text_response_part)}handleErrorEvent(e){const i=e.error_event.error_type,s=e.error_event.message||e.error_event.reason||"Unknown error";i!=="max_duration_exceeded"?this.onError(`Server error: ${s}`,{errorType:i,code:e.error_event.code,debugMessage:e.error_event.debug_message,details:e.error_event.details}):this.endSessionWithDetails({reason:"error",message:s,context:new Event("max_duration_exceeded")})}onError(e,i){console.error(e,i),this.options.onError&&this.options.onError(e,i)}getId(){return this.connection.conversationId}isOpen(){return this.status==="connected"}setMicMuted(e){this.connection.setMicMuted(e)}getInputByteFrequencyData(){return q0}getOutputByteFrequencyData(){return q0}getInputVolume(){return 0}getOutputVolume(){return 0}sendFeedback(e){this.canSendFeedback?(this.connection.sendMessage({type:"feedback",score:e?"like":"dislike",event_id:this.currentEventId}),this.lastFeedbackEventId=this.currentEventId,this.updateCanSendFeedback()):console.warn(this.lastFeedbackEventId===0?"Cannot send feedback: the conversation has not started yet.":"Cannot send feedback: feedback has already been sent for the current response.")}sendContextualUpdate(e){this.connection.sendMessage({type:"contextual_update",text:e})}sendUserMessage(e){this.connection.sendMessage({type:"user_message",text:e})}sendUserActivity(){this.connection.sendMessage({type:"user_activity"})}sendMCPToolApprovalResult(e,i){this.connection.sendMessage({type:"mcp_tool_approval_result",tool_call_id:e,is_approved:i})}}let vC=class{constructor(e={}){this.queue=[],this.disconnectionDetails=null,this.onDisconnectCallback=null,this.onMessageCallback=null,this.onModeChangeCallback=null,this.onDebug=void 0,this.onDebug=e.onDebug}debug(e){this.onDebug&&this.onDebug(e)}onMessage(e){this.onMessageCallback=e;const i=this.queue;this.queue=[],i.length>0&&queueMicrotask(()=>{i.forEach(e)})}onDisconnect(e){this.onDisconnectCallback=e;const i=this.disconnectionDetails;i&&queueMicrotask(()=>{e(i)})}onModeChange(e){this.onModeChangeCallback=e}updateMode(e){var i;(i=this.onModeChangeCallback)==null||i.call(this,e)}disconnect(e){var i;this.disconnectionDetails||(this.disconnectionDetails=e,(i=this.onDisconnectCallback)==null||i.call(this,e))}handleMessage(e){this.onMessageCallback?this.onMessageCallback(e):this.queue.push(e)}};function rc(a){const[e,i]=a.split("_");if(!["pcm","ulaw"].includes(e))throw new Error(`Invalid format: ${a}`);const s=Number.parseInt(i);if(Number.isNaN(s))throw new Error(`Invalid sample rate: ${i}`);return{format:e,sampleRate:s}}const yC="0.14.0";function Vh(a){return!!a.type}const bC="conversation_initiation_client_data";function SC(a){var e;const i={type:bC};var s,o,l,d,u,h,m,g;return a.overrides&&(i.conversation_config_override={agent:{prompt:(s=a.overrides.agent)==null?void 0:s.prompt,first_message:(o=a.overrides.agent)==null?void 0:o.firstMessage,language:(l=a.overrides.agent)==null?void 0:l.language},tts:{voice_id:(d=a.overrides.tts)==null?void 0:d.voiceId,speed:(u=a.overrides.tts)==null?void 0:u.speed,stability:(h=a.overrides.tts)==null?void 0:h.stability,similarity_boost:(m=a.overrides.tts)==null?void 0:m.similarityBoost},conversation:{text_only:(g=a.overrides.conversation)==null?void 0:g.textOnly}}),a.customLlmExtraBody&&(i.custom_llm_extra_body=a.customLlmExtraBody),a.dynamicVariables&&(i.dynamic_variables=a.dynamicVariables),a.userId&&(i.user_id=a.userId),(e=a.overrides)!=null&&e.client&&(i.source_info={source:a.overrides.client.source,version:a.overrides.client.version}),i}let z0=class extends Error{constructor(e,i){super(e),this.closeCode=void 0,this.closeReason=void 0,this.name="SessionConnectionError",this.closeCode=i?.closeCode,this.closeReason=i?.closeReason}},Gh=class CC extends vC{constructor(e,i,s,o){super(),this.socket=void 0,this.conversationId=void 0,this.inputFormat=void 0,this.outputFormat=void 0,this.socket=e,this.conversationId=i,this.inputFormat=s,this.outputFormat=o,this.socket.addEventListener("error",l=>{setTimeout(()=>this.disconnect({reason:"error",message:"The connection was closed due to a socket error.",context:l}),0)}),this.socket.addEventListener("close",l=>{this.disconnect(l.code===1e3?{reason:"agent",context:l,closeCode:l.code,closeReason:l.reason||void 0}:{reason:"error",message:l.reason||"The connection was closed by the server.",context:l,closeCode:l.code,closeReason:l.reason||void 0})}),this.socket.addEventListener("message",l=>{try{const d=JSON.parse(l.data);if(!Vh(d))return void this.debug({type:"invalid_event",message:"Received invalid socket event",data:l.data});this.handleMessage(d)}catch(d){this.debug({type:"parsing_error",message:"Failed to parse socket message",error:d instanceof Error?d.message:String(d),data:l.data})}})}static async create(e){let i=null;try{var s,o,l;const u=(s=e.origin)!=null?s:"wss://api.elevenlabs.io";let h;const m=((o=e.overrides)==null||(o=o.client)==null?void 0:o.version)||yC,g=((l=e.overrides)==null||(l=l.client)==null?void 0:l.source)||"js_sdk";if(e.signedUrl){const O=e.signedUrl.includes("?")?"&":"?";h=`${e.signedUrl}${O}source=${g}&version=${m}`}else h=`${u}/v1/convai/conversation?agent_id=${e.agentId}&source=${g}&version=${m}`;const y=["convai"];e.authorization&&y.push(`bearer.${e.authorization}`),i=new WebSocket(h,y);const S=await new Promise((O,L)=>{i.addEventListener("open",()=>{var D;const I=SC(e);(D=i)==null||D.send(JSON.stringify(I))},{once:!0}),i.addEventListener("error",D=>{setTimeout(()=>L(new z0("The connection was closed due to a socket error.")),0)}),i.addEventListener("close",D=>{L(new z0(D.reason||(D.code===1e3?"Connection closed normally before session could be established.":"Connection closed unexpectedly before session could be established."),{closeCode:D.code,closeReason:D.reason||void 0}))}),i.addEventListener("message",D=>{const I=JSON.parse(D.data);Vh(I)&&(I.type==="conversation_initiation_metadata"?O(I.conversation_initiation_metadata_event):console.warn("First received message is not conversation metadata."))},{once:!0})}),{conversation_id:T,agent_output_audio_format:x,user_input_audio_format:E}=S,k=rc(E??"pcm_16000"),R=rc(x);return new CC(i,T,k,R)}catch(u){var d;throw(d=i)==null||d.close(),u}}close(){this.socket.close(1e3,"User ended conversation")}sendMessage(e){this.socket.send(JSON.stringify(e))}async setMicMuted(e){console.warn(`WebSocket connection setMicMuted called with ${e}, but this is handled by VoiceConversation`)}};function TC(a){const e=new Uint8Array(a);return window.btoa(String.fromCharCode(...e))}function YA(a){const e=window.atob(a),i=e.length,s=new Uint8Array(i);for(let o=0;o<i;o++)s[o]=e.charCodeAt(o);return s.buffer}const wl=new Map;function kC(a,e){return async(i,s)=>{const o=wl.get(a);if(o)return i.addModule(o);if(s)try{return await i.addModule(s),void wl.set(a,s)}catch(u){throw new Error(`Failed to load the ${a} worklet module from path: ${s}. Error: ${u}`)}const l=new Blob([e],{type:"application/javascript"}),d=URL.createObjectURL(l);try{return await i.addModule(d),void wl.set(a,d)}catch{URL.revokeObjectURL(d)}try{const u=`data:application/javascript;base64,${btoa(e)}`;await i.addModule(u),wl.set(a,u)}catch{throw new Error(`Failed to load the ${a} worklet module. Make sure the browser supports AudioWorklets. If you are using a strict CSP, you may need to self-host the worklet files.`)}}}const EC=kC("rawAudioProcessor",`/*
 * ulaw encoding logic taken from the wavefile library
 * https://github.com/rochars/wavefile/blob/master/lib/codecs/mulaw.js
 * USED BY @elevenlabs/client
 */

const BIAS = 0x84;
const CLIP = 32635;
const encodeTable = [
  0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,
  4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,
  5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,
  5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,
  6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,
  6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,
  6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,
  6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,
  7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
  7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
  7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
  7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
  7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
  7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
  7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
  7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7
];

function encodeSample(sample) {
  let sign;
  let exponent;
  let mantissa;
  let muLawSample;
  sign = (sample >> 8) & 0x80;
  if (sign !== 0) sample = -sample;
  sample = sample + BIAS;
  if (sample > CLIP) sample = CLIP;
  exponent = encodeTable[(sample>>7) & 0xFF];
  mantissa = (sample >> (exponent+3)) & 0x0F;
  muLawSample = ~(sign | (exponent << 4) | mantissa);
  
  return muLawSample;
}

class RawAudioProcessor extends AudioWorkletProcessor {
  constructor() {
    super();
              
    this.port.onmessage = ({ data }) => {
      switch (data.type) {
        case "setFormat":
          this.isMuted = false;
          this.buffer = []; // Initialize an empty buffer
          this.bufferSize = data.sampleRate / 10;
          this.format = data.format;

          if (globalThis.LibSampleRate && sampleRate !== data.sampleRate) {
            globalThis.LibSampleRate.create(1, sampleRate, data.sampleRate).then(resampler => {
              this.resampler = resampler;
            });
          }
          break;
        case "setMuted":
          this.isMuted = data.isMuted;
          break;
      }
    };
  }
  process(inputs) {
    if (!this.buffer) {
      return true;
    }
    
    const input = inputs[0]; // Get the first input node
    if (input.length > 0) {
      let channelData = input[0]; // Get the first channel's data

      // Resample the audio if necessary
      if (this.resampler) {
        channelData = this.resampler.full(channelData);
      }

      // Add channel data to the buffer
      this.buffer.push(...channelData);
      // Get max volume 
      let sum = 0.0;
      for (let i = 0; i < channelData.length; i++) {
        sum += channelData[i] * channelData[i];
      }
      const maxVolume = Math.sqrt(sum / channelData.length);
      // Check if buffer size has reached or exceeded the threshold
      if (this.buffer.length >= this.bufferSize) {
        const float32Array = this.isMuted 
          ? new Float32Array(this.buffer.length)
          : new Float32Array(this.buffer);

        let encodedArray = this.format === "ulaw"
          ? new Uint8Array(float32Array.length)
          : new Int16Array(float32Array.length);

        // Iterate through the Float32Array and convert each sample to PCM16
        for (let i = 0; i < float32Array.length; i++) {
          // Clamp the value to the range [-1, 1]
          let sample = Math.max(-1, Math.min(1, float32Array[i]));

          // Scale the sample to the range [-32768, 32767]
          let value = sample < 0 ? sample * 32768 : sample * 32767;
          if (this.format === "ulaw") {
            value = encodeSample(Math.round(value));
          }

          encodedArray[i] = value;
        }

        // Send the buffered data to the main script
        this.port.postMessage([encodedArray, maxVolume]);

        // Clear the buffer after sending
        this.buffer = [];
      }
    }
    return true; // Continue processing
  }
}
registerProcessor("rawAudioProcessor", RawAudioProcessor);
`);class di extends vC{constructor(e,i,s,o,l={}){super(l),this.conversationId=void 0,this.inputFormat=void 0,this.outputFormat=void 0,this.room=void 0,this.isConnected=!1,this.audioEventId=1,this.audioCaptureContext=null,this.audioElements=[],this.outputDeviceId=null,this.outputAnalyser=null,this.outputFrequencyData=null,this.room=e,this.conversationId=i,this.inputFormat=s,this.outputFormat=o,this.setupRoomEventListeners()}static async create(e){let i;if("conversationToken"in e&&e.conversationToken)i=e.conversationToken;else{if(!("agentId"in e)||!e.agentId)throw new Error("Either conversationToken or agentId is required for WebRTC connection");try{var s,o,l;const m=((s=e.overrides)==null||(s=s.client)==null?void 0:s.version)||yC,g=((o=e.overrides)==null||(o=o.client)==null?void 0:o.source)||"js_sdk",y=`${d=(l=e.origin)!=null?l:"https://api.elevenlabs.io",d.replace(/^wss:\/\//,"https://")}/v1/convai/conversation/token?agent_id=${e.agentId}&source=${g}&version=${m}`,S=await fetch(y);if(!S.ok)throw new Error(`ElevenLabs API returned ${S.status} ${S.statusText}`);if(i=(await S.json()).token,!i)throw new Error("No conversation token received from API")}catch(m){let g=m instanceof Error?m.message:String(m);throw m instanceof Error&&m.message.includes("401")&&(g="Your agent has authentication enabled, but no signed URL or conversation token was provided."),new Error(`Failed to fetch conversation token for agent ${e.agentId}: ${g}`)}}var d;const u=new Os;try{const m=`room_${Date.now()}`,g=rc("pcm_48000"),y=rc("pcm_48000"),S=new di(u,m,g,y,e),T=e.livekitUrl||"wss://livekit.rtc.elevenlabs.io";var h;await u.connect(T,i),await new Promise(E=>{if(S.isConnected)E();else{const k=()=>{u.off(W.Connected,k),E()};u.on(W.Connected,k)}}),u.name&&(S.conversationId=((h=u.name.match(/(conv_[a-zA-Z0-9]+)/))==null?void 0:h[0])||u.name),e.textOnly||await u.localParticipant.setMicrophoneEnabled(!0);const x=SC(e);return S.debug({type:bC,message:x}),await S.sendMessage(x),S}catch(m){throw await u.disconnect(),m}}setupRoomEventListeners(){var e=this;this.room.on(W.Connected,async function(){e.isConnected=!0,console.info("WebRTC room connected")}),this.room.on(W.Disconnected,i=>{this.isConnected=!1,this.disconnect({reason:"agent",context:new CloseEvent("close",{reason:i?.toString()})})}),this.room.on(W.ConnectionStateChanged,i=>{i===Ie.Disconnected&&(this.isConnected=!1,this.disconnect({reason:"error",message:`LiveKit connection state changed to ${i}`,context:new Event("connection_state_changed")}))}),this.room.on(W.DataReceived,(i,s)=>{try{const o=JSON.parse(new TextDecoder().decode(i));if(o.type==="audio")return;Vh(o)?this.handleMessage(o):console.warn("Invalid socket event received:",o)}catch(o){console.warn("Failed to parse incoming data message:",o),console.warn("Raw payload:",new TextDecoder().decode(i))}}),this.room.on(W.TrackSubscribed,async function(i,s,o){if(i.kind===Q.Kind.Audio&&o.identity.includes("agent")){const l=i,d=l.attach();if(d.autoplay=!0,d.controls=!1,e.outputDeviceId&&d.setSinkId)try{await d.setSinkId(e.outputDeviceId)}catch(u){console.warn("Failed to set output device for new audio element:",u)}d.style.display="none",document.body.appendChild(d),e.audioElements.push(d),e.audioElements.length===1&&(e.onDebug==null||e.onDebug({type:"audio_element_ready"})),await e.setupAudioCapture(l)}}),this.room.on(W.ActiveSpeakersChanged,async function(i){e.updateMode(i.length>0&&i[0].identity.startsWith("agent")?"speaking":"listening")}),this.room.on(W.ParticipantDisconnected,i=>{var s;(s=i.identity)!=null&&s.startsWith("agent")&&this.disconnect({reason:"agent",context:new CloseEvent("close",{reason:"agent disconnected"})})})}close(){if(this.isConnected){try{this.room.localParticipant.audioTrackPublications.forEach(e=>{e.track&&e.track.stop()})}catch(e){console.warn("Error stopping local tracks:",e)}this.audioCaptureContext&&(this.audioCaptureContext.close().catch(e=>{console.warn("Error closing audio capture context:",e)}),this.audioCaptureContext=null),this.audioElements.forEach(e=>{e.parentNode&&e.parentNode.removeChild(e)}),this.audioElements=[],this.room.disconnect()}}async sendMessage(e){if(this.isConnected&&this.room.localParticipant){if(!("user_audio_chunk"in e))try{const i=new TextEncoder().encode(JSON.stringify(e));await this.room.localParticipant.publishData(i,{reliable:!0})}catch(i){this.debug({type:"send_message_error",message:{message:e,error:i}}),console.error("Failed to send message via WebRTC:",i)}}else console.warn("Cannot send message: room not connected or no local participant")}getRoom(){return this.room}async setMicMuted(e){if(!this.isConnected||!this.room.localParticipant)return void console.warn("Cannot set microphone muted: room not connected or no local participant");const i=this.room.localParticipant.getTrackPublication(Q.Source.Microphone);if(i!=null&&i.track)try{e?await i.track.mute():await i.track.unmute()}catch{await this.room.localParticipant.setMicrophoneEnabled(!e)}else await this.room.localParticipant.setMicrophoneEnabled(!e)}async setupAudioCapture(e){try{const i=new AudioContext;this.audioCaptureContext=i,this.outputAnalyser=i.createAnalyser(),this.outputAnalyser.fftSize=2048,this.outputAnalyser.smoothingTimeConstant=.8;const s=new MediaStream([e.mediaStreamTrack]),o=i.createMediaStreamSource(s);o.connect(this.outputAnalyser),await EC(i.audioWorklet);const l=new AudioWorkletNode(i,"rawAudioProcessor");this.outputAnalyser.connect(l),l.port.postMessage({type:"setFormat",format:this.outputFormat.format,sampleRate:this.outputFormat.sampleRate}),l.port.onmessage=d=>{const[u,h]=d.data;if(h>.01){const m=TC(u.buffer),g=this.audioEventId++;this.handleMessage({type:"audio",audio_event:{audio_base_64:m,event_id:g}})}},o.connect(l)}catch(i){console.warn("Failed to set up audio capture:",i)}}setAudioVolume(e){this.audioElements.forEach(i=>{i.volume=e})}async setAudioOutputDevice(e){if(!("setSinkId"in HTMLAudioElement.prototype))throw new Error("setSinkId is not supported in this browser");const i=this.audioElements.map(async function(s){try{await s.setSinkId(e)}catch(o){throw console.error("Failed to set sink ID for audio element:",o),o}});await Promise.all(i),this.outputDeviceId=e}async setAudioInputDevice(e){if(!this.isConnected||!this.room.localParticipant)throw new Error("Cannot change input device: room not connected or no local participant");try{const i=this.room.localParticipant.getTrackPublication(Q.Source.Microphone);i!=null&&i.track&&(await i.track.stop(),await this.room.localParticipant.unpublishTrack(i.track));const s={deviceId:{exact:e},echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0,channelCount:{ideal:1}},o=await mC(s);await this.room.localParticipant.publishTrack(o,{name:"microphone",source:Q.Source.Microphone})}catch(i){console.error("Failed to change input device:",i);try{await this.room.localParticipant.setMicrophoneEnabled(!0)}catch(s){console.error("Failed to recover microphone after device switch error:",s)}throw i}}getOutputByteFrequencyData(){return this.outputAnalyser?(this.outputFrequencyData!=null||(this.outputFrequencyData=new Uint8Array(this.outputAnalyser.frequencyBinCount)),this.outputAnalyser.getByteFrequencyData(this.outputFrequencyData),this.outputFrequencyData):null}}async function _C(a){const e=(function(i){return i.connectionType?i.connectionType:"conversationToken"in i&&i.conversationToken?"webrtc":"websocket"})(a);switch(e){case"websocket":return Gh.create(a);case"webrtc":return di.create(a);default:throw new Error(`Unknown connection type: ${e}`)}}function Kh(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}async function wC(a={default:0,android:3e3}){let e=a.default;var i;if(/android/i.test(navigator.userAgent))e=(i=a.android)!=null?i:e;else if(Kh()){var s;e=(s=a.ios)!=null?s:e}e>0&&await new Promise(o=>setTimeout(o,e))}class Mf extends eo{static async startSession(e){const i=eo.getFullOptions(e);i.onStatusChange&&i.onStatusChange({status:"connecting"}),i.onCanSendFeedbackChange&&i.onCanSendFeedbackChange({canSendFeedback:!1}),i.onModeChange&&i.onModeChange({mode:"listening"}),i.onCanSendFeedbackChange&&i.onCanSendFeedbackChange({canSendFeedback:!1});let s=null;try{return await wC(i.connectionDelay),s=await _C(e),new Mf(i,s)}catch(l){var o;throw i.onStatusChange&&i.onStatusChange({status:"disconnected"}),(o=s)==null||o.close(),l}}}const F0={echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0,channelCount:{ideal:1}};class As{static async create({sampleRate:e,format:i,preferHeadphonesForIosDevices:s,inputDeviceId:o,workletPaths:l,libsampleratePath:d,onError:u}){let h=null,m=null;try{const S=An({sampleRate:{ideal:e}},F0);if(Kh()&&s){const L=(await window.navigator.mediaDevices.enumerateDevices()).find(D=>D.kind==="audioinput"&&["airpod","headphone","earphone"].find(I=>D.label.toLowerCase().includes(I)));L&&(S.deviceId={ideal:L.deviceId})}o&&(S.deviceId=As.getDeviceIdConstraint(o));const T=navigator.mediaDevices.getSupportedConstraints().sampleRate;h=new window.AudioContext(T?{sampleRate:e}:{});const x=h.createAnalyser();if(!T){const L=d||"https://cdn.jsdelivr.net/npm/@alexanderolsen/libsamplerate-js@2.1.2/dist/libsamplerate.worklet.js";await h.audioWorklet.addModule(L)}await EC(h.audioWorklet,l?.rawAudioProcessor);const E=An({voiceIsolation:!0},S);m=await navigator.mediaDevices.getUserMedia({audio:E});const k=h.createMediaStreamSource(m),R=new AudioWorkletNode(h,"rawAudioProcessor");R.port.postMessage({type:"setFormat",format:i,sampleRate:e}),k.connect(x),x.connect(R),await h.resume();const O=await navigator.permissions.query({name:"microphone"});return new As(h,x,R,m,k,O,u)}catch(S){var g,y;throw(g=m)==null||g.getTracks().forEach(T=>{T.stop()}),(y=h)==null||y.close(),S}}static getDeviceIdConstraint(e){if(e)return Kh()?{ideal:e}:{exact:e}}constructor(e,i,s,o,l,d,u=console.error){this.context=void 0,this.analyser=void 0,this.worklet=void 0,this.inputStream=void 0,this.mediaStreamSource=void 0,this.permissions=void 0,this.onError=void 0,this.settingInput=!1,this.handlePermissionsChange=()=>{if(this.permissions.state==="denied")this.onError("Microphone permission denied");else if(!this.settingInput){var h;const[m]=this.inputStream.getAudioTracks(),{deviceId:g}=(h=m?.getSettings())!=null?h:{};this.setInputDevice(g).catch(y=>{this.onError("Failed to reset input device after permission change:",y)})}},this.context=e,this.analyser=i,this.worklet=s,this.inputStream=o,this.mediaStreamSource=l,this.permissions=d,this.onError=u,this.permissions.addEventListener("change",this.handlePermissionsChange)}forgetInputStreamAndSource(){for(const e of this.inputStream.getTracks())e.stop();this.mediaStreamSource.disconnect()}async close(){this.forgetInputStreamAndSource(),this.permissions.removeEventListener("change",this.handlePermissionsChange),await this.context.close()}setMuted(e){this.worklet.port.postMessage({type:"setMuted",isMuted:e})}async setInputDevice(e){try{if(this.settingInput)throw new Error("Input device is already being set");this.settingInput=!0;const i=An({},F0);e&&(i.deviceId=As.getDeviceIdConstraint(e));const s=An({voiceIsolation:!0},i),o=await navigator.mediaDevices.getUserMedia({audio:s});this.forgetInputStreamAndSource(),this.inputStream=o,this.mediaStreamSource=this.context.createMediaStreamSource(o),this.mediaStreamSource.connect(this.analyser)}catch(i){throw this.onError("Failed to switch input device:",i),i}finally{this.settingInput=!1}}}const JA=kC("audioConcatProcessor",`/*
 * ulaw decoding logic taken from the wavefile library
 * https://github.com/rochars/wavefile/blob/master/lib/codecs/mulaw.js
 * USED BY @elevenlabs/client
 */

const decodeTable = [0,132,396,924,1980,4092,8316,16764];

function decodeSample(muLawSample) {
  let sign;
  let exponent;
  let mantissa;
  let sample;
  muLawSample = ~muLawSample;
  sign = (muLawSample & 0x80);
  exponent = (muLawSample >> 4) & 0x07;
  mantissa = muLawSample & 0x0F;
  sample = decodeTable[exponent] + (mantissa << (exponent+3));
  if (sign !== 0) sample = -sample;

  return sample;
}

class AudioConcatProcessor extends AudioWorkletProcessor {
  constructor() {
    super();
    this.buffers = []; // Initialize an empty buffer
    this.cursor = 0;
    this.currentBuffer = null;
    this.wasInterrupted = false;
    this.finished = false;
    
    this.port.onmessage = ({ data }) => {
      switch (data.type) {
        case "setFormat":
          this.format = data.format;
          break;
        case "buffer":
          this.wasInterrupted = false;
          this.buffers.push(
            this.format === "ulaw"
              ? new Uint8Array(data.buffer)
              : new Int16Array(data.buffer)
          );
          break;
        case "interrupt":
          this.wasInterrupted = true;
          break;
        case "clearInterrupted":
          if (this.wasInterrupted) {
            this.wasInterrupted = false;
            this.buffers = [];
            this.currentBuffer = null;
          }
      }
    };
  }
  process(_, outputs) {
    let finished = false;
    const output = outputs[0][0];
    for (let i = 0; i < output.length; i++) {
      if (!this.currentBuffer) {
        if (this.buffers.length === 0) {
          finished = true;
          break;
        }
        this.currentBuffer = this.buffers.shift();
        this.cursor = 0;
      }

      let value = this.currentBuffer[this.cursor];
      if (this.format === "ulaw") {
        value = decodeSample(value);
      }
      output[i] = value / 32768;
      this.cursor++;

      if (this.cursor >= this.currentBuffer.length) {
        this.currentBuffer = null;
      }
    }

    if (this.finished !== finished) {
      this.finished = finished;
      this.port.postMessage({ type: "process", finished });
    }

    return true; // Continue processing
  }
}

registerProcessor("audioConcatProcessor", AudioConcatProcessor);
`);class oc{static async create({sampleRate:e,format:i,outputDeviceId:s,workletPaths:o}){let l=null,d=null;try{l=new AudioContext({sampleRate:e});const m=l.createAnalyser(),g=l.createGain();d=new Audio,d.src="",d.load(),d.autoplay=!0,d.style.display="none",document.body.appendChild(d);const y=l.createMediaStreamDestination();d.srcObject=y.stream,g.connect(m),m.connect(y),await JA(l.audioWorklet,o?.audioConcatProcessor);const S=new AudioWorkletNode(l,"audioConcatProcessor");return S.port.postMessage({type:"setFormat",format:i}),S.connect(g),await l.resume(),s&&d.setSinkId&&await d.setSinkId(s),new oc(l,m,g,S,d)}catch(m){var u,h;throw(u=d)!=null&&u.parentNode&&d.parentNode.removeChild(d),(h=d)==null||h.pause(),l&&l.state!=="closed"&&await l.close(),m}}constructor(e,i,s,o,l){this.context=void 0,this.analyser=void 0,this.gain=void 0,this.worklet=void 0,this.audioElement=void 0,this.context=e,this.analyser=i,this.gain=s,this.worklet=o,this.audioElement=l}async setOutputDevice(e){if(!("setSinkId"in HTMLAudioElement.prototype))throw new Error("setSinkId is not supported in this browser");await this.audioElement.setSinkId(e||"")}async close(){this.audioElement.parentNode&&this.audioElement.parentNode.removeChild(this.audioElement),this.audioElement.pause(),await this.context.close()}}class Vr extends eo{static async requestWakeLock(){if("wakeLock"in navigator)try{return await navigator.wakeLock.request("screen")}catch{}return null}static async startSession(e){var i;const s=eo.getFullOptions(e);s.onStatusChange&&s.onStatusChange({status:"connecting"}),s.onCanSendFeedbackChange&&s.onCanSendFeedbackChange({canSendFeedback:!1});let o=null,l=null,d=null,u=null,h=null;((i=e.useWakeLock)==null||i)&&(h=await Vr.requestWakeLock());try{var m;return u=await navigator.mediaDevices.getUserMedia({audio:!0}),await wC(s.connectionDelay),l=await _C(e),[o,d]=await Promise.all([As.create(An({},l.inputFormat,{preferHeadphonesForIosDevices:e.preferHeadphonesForIosDevices,inputDeviceId:e.inputDeviceId,workletPaths:e.workletPaths,libsampleratePath:e.libsampleratePath})),oc.create(An({},l.outputFormat,{outputDeviceId:e.outputDeviceId,workletPaths:e.workletPaths}))]),(m=u)==null||m.getTracks().forEach(E=>{E.stop()}),u=null,new Vr(s,l,o,d,h)}catch(E){var g,y,S,T;s.onStatusChange&&s.onStatusChange({status:"disconnected"}),(g=u)==null||g.getTracks().forEach(k=>{k.stop()}),(y=l)==null||y.close(),await((S=o)==null?void 0:S.close()),await((T=d)==null?void 0:T.close());try{var x;await((x=h)==null?void 0:x.release()),h=null}catch{}throw E}}constructor(e,i,s,o,l){super(e,i),this.input=void 0,this.output=void 0,this.wakeLock=void 0,this.inputFrequencyData=void 0,this.outputFrequencyData=void 0,this.visibilityChangeHandler=null,this.onInputWorkletMessage=d=>{this.status==="connected"&&this.connection.sendMessage({user_audio_chunk:TC(d.data[0].buffer)})},this.onOutputWorkletMessage=({data:d})=>{d.type==="process"&&this.updateMode(d.finished?"listening":"speaking")},this.addAudioBase64Chunk=d=>{this.output.gain.gain.cancelScheduledValues(this.output.context.currentTime),this.output.gain.gain.value=this.volume,this.output.worklet.port.postMessage({type:"clearInterrupted"}),this.output.worklet.port.postMessage({type:"buffer",buffer:YA(d)})},this.fadeOutAudio=()=>{this.updateMode("listening"),this.output.worklet.port.postMessage({type:"interrupt"}),this.output.gain.gain.exponentialRampToValueAtTime(1e-4,this.output.context.currentTime+2),setTimeout(()=>{this.output.gain.gain.value=this.volume,this.output.worklet.port.postMessage({type:"clearInterrupted"})},2e3)},this.calculateVolume=d=>{if(d.length===0)return 0;let u=0;for(let h=0;h<d.length;h++)u+=d[h]/255;return u/=d.length,u<0?0:u>1?1:u},this.setVolume=({volume:d})=>{const u=Number.isFinite(d)?Math.min(1,Math.max(0,d)):1;this.volume=u,this.connection instanceof di?this.connection.setAudioVolume(u):this.output.gain.gain.value=u},this.input=s,this.output=o,this.wakeLock=l,this.input.worklet.port.onmessage=this.onInputWorkletMessage,this.output.worklet.port.onmessage=this.onOutputWorkletMessage,l&&(this.visibilityChangeHandler=()=>{var d;document.visibilityState==="visible"&&(d=this.wakeLock)!=null&&d.released&&Vr.requestWakeLock().then(u=>{this.wakeLock=u})},document.addEventListener("visibilitychange",this.visibilityChangeHandler))}async handleEndSession(){await super.handleEndSession(),this.visibilityChangeHandler&&document.removeEventListener("visibilitychange",this.visibilityChangeHandler);try{var e;await((e=this.wakeLock)==null?void 0:e.release()),this.wakeLock=null}catch{}await this.input.close(),await this.output.close()}handleInterruption(e){super.handleInterruption(e),this.fadeOutAudio()}handleAudio(e){var i,s;super.handleAudio(e),e.audio_event.alignment&&this.options.onAudioAlignment&&this.options.onAudioAlignment(e.audio_event.alignment),this.lastInterruptTimestamp<=e.audio_event.event_id&&(e.audio_event.audio_base_64&&((i=(s=this.options).onAudio)==null||i.call(s,e.audio_event.audio_base_64),this.connection instanceof di||this.addAudioBase64Chunk(e.audio_event.audio_base_64)),this.currentEventId=e.audio_event.event_id,this.updateCanSendFeedback(),this.updateMode("speaking"))}setMicMuted(e){this.connection instanceof di?this.connection.setMicMuted(e):this.input.setMuted(e)}getInputByteFrequencyData(){return this.inputFrequencyData!=null||(this.inputFrequencyData=new Uint8Array(this.input.analyser.frequencyBinCount)),this.input.analyser.getByteFrequencyData(this.inputFrequencyData),this.inputFrequencyData}getOutputByteFrequencyData(){return this.connection instanceof di?this.connection.getOutputByteFrequencyData()||new Uint8Array(1024):(this.outputFrequencyData!=null||(this.outputFrequencyData=new Uint8Array(this.output.analyser.frequencyBinCount)),this.output.analyser.getByteFrequencyData(this.outputFrequencyData),this.outputFrequencyData)}getInputVolume(){return this.calculateVolume(this.getInputByteFrequencyData())}getOutputVolume(){return this.calculateVolume(this.getOutputByteFrequencyData())}async changeInputDevice({sampleRate:e,format:i,preferHeadphonesForIosDevices:s,inputDeviceId:o}){try{if(this.connection instanceof Gh)try{return await this.input.setInputDevice(o),this.input}catch(d){console.warn("Failed to change device on existing input, recreating:",d)}this.connection instanceof di&&await this.connection.setAudioInputDevice(o||""),await this.input.close();const l=await As.create({sampleRate:e??this.connection.inputFormat.sampleRate,format:i??this.connection.inputFormat.format,preferHeadphonesForIosDevices:s,inputDeviceId:o,workletPaths:this.options.workletPaths,libsampleratePath:this.options.libsampleratePath,onError:this.options.onError});return this.input=l,this.input.worklet.port.onmessage=this.onInputWorkletMessage,this.input}catch(l){throw console.error("Error changing input device",l),l}}async changeOutputDevice({sampleRate:e,format:i,outputDeviceId:s}){try{if(this.connection instanceof Gh)try{return await this.output.setOutputDevice(s),this.output}catch(l){console.warn("Failed to change device on existing output, recreating:",l)}this.connection instanceof di&&await this.connection.setAudioOutputDevice(s||""),await this.output.close();const o=await oc.create({sampleRate:e??this.connection.outputFormat.sampleRate,format:i??this.connection.outputFormat.format,outputDeviceId:s,workletPaths:this.options.workletPaths});return this.output=o,this.output}catch(o){throw console.error("Error changing output device",o),o}}}var H0;(function(a){a.SESSION_STARTED="session_started",a.PARTIAL_TRANSCRIPT="partial_transcript",a.COMMITTED_TRANSCRIPT="committed_transcript",a.COMMITTED_TRANSCRIPT_WITH_TIMESTAMPS="committed_transcript_with_timestamps",a.AUTH_ERROR="auth_error",a.ERROR="error",a.OPEN="open",a.CLOSE="close",a.QUOTA_EXCEEDED="quota_exceeded",a.COMMIT_THROTTLED="commit_throttled",a.TRANSCRIBER_ERROR="transcriber_error",a.UNACCEPTED_TERMS="unaccepted_terms",a.RATE_LIMITED="rate_limited",a.INPUT_ERROR="input_error",a.QUEUE_OVERFLOW="queue_overflow",a.RESOURCE_EXHAUSTED="resource_exhausted",a.SESSION_TIME_LIMIT_EXCEEDED="session_time_limit_exceeded",a.CHUNK_SIZE_EXCEEDED="chunk_size_exceeded",a.INSUFFICIENT_AUDIO_ACTIVITY="insufficient_audio_activity"})(H0||(H0={}));var V0,G0;(function(a){a.PCM_8000="pcm_8000",a.PCM_16000="pcm_16000",a.PCM_22050="pcm_22050",a.PCM_24000="pcm_24000",a.PCM_44100="pcm_44100",a.PCM_48000="pcm_48000",a.ULAW_8000="ulaw_8000"})(V0||(V0={})),(function(a){a.MANUAL="manual",a.VAD="vad"})(G0||(G0={}));class Af extends eo{static startSession(e){const i=Af.getFullOptions(e);return i.textOnly?Mf.startSession(i):Vr.startSession(i)}}function Gr(){return Gr=Object.assign?Object.assign.bind():function(a){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)({}).hasOwnProperty.call(i,s)&&(a[s]=i[s])}return a},Gr.apply(null,arguments)}const QA=["micMuted","volume","serverLocation"];function XA(a="us"){switch(a){case"eu-residency":case"in-residency":case"us":case"global":return a;default:return console.warn(`[ConversationalAI] Invalid server-location: ${a}. Defaulting to "us"`),"us"}}function WA(a){return{us:"wss://api.elevenlabs.io","eu-residency":"wss://api.eu.residency.elevenlabs.io","in-residency":"wss://api.in.residency.elevenlabs.io",global:"wss://api.elevenlabs.io"}[a]}function ZA(a){return{us:"wss://livekit.rtc.elevenlabs.io","eu-residency":"wss://livekit.rtc.eu.residency.elevenlabs.io","in-residency":"wss://livekit.rtc.in.residency.elevenlabs.io",global:"wss://livekit.rtc.elevenlabs.io"}[a]}function $A(a={}){const{micMuted:e,volume:i,serverLocation:s}=a,o=(function(k,R){if(k==null)return{};var O={};for(var L in k)if({}.hasOwnProperty.call(k,L)){if(R.indexOf(L)!==-1)continue;O[L]=k[L]}return O})(a,QA),l=N.useRef(null),d=N.useRef(null),u=N.useRef(!1),[h,m]=N.useState("disconnected"),[g,y]=N.useState(!1),[S,T]=N.useState("listening"),x=N.useRef(e),E=N.useRef(i);return x.current=e,E.current=i,N.useEffect(()=>{var k;e!==void 0&&(l==null||(k=l.current)==null||k.setMicMuted(e))},[e]),N.useEffect(()=>{var k;i!==void 0&&(l==null||(k=l.current)==null||k.setVolume({volume:i}))},[i]),N.useEffect(()=>()=>{var k;u.current=!0,d.current?d.current.then(R=>R.endSession()):(k=l.current)==null||k.endSession()},[]),{startSession:async k=>{var R;if((R=l.current)!=null&&R.isOpen())return l.current.getId();if(d.current)return(await d.current).getId();u.current=!1;try{var O,L,D,I,P,H,Z,ee,te,re;const ue=XA(k?.serverLocation||s),Ae=WA(ue),Xe=ZA(ue);if(d.current=Af.startSession(Gr({},o??{},k??{},{origin:Ae,livekitUrl:k?.livekitUrl||o?.livekitUrl||Xe,overrides:Gr({},(O=o?.overrides)!=null?O:{},(L=k?.overrides)!=null?L:{},{client:Gr({},(D=o==null||(I=o.overrides)==null?void 0:I.client)!=null?D:{},(P=k==null||(H=k.overrides)==null?void 0:H.client)!=null?P:{},{source:(k==null||(Z=k.overrides)==null||(Z=Z.client)==null?void 0:Z.source)||(o==null||(ee=o.overrides)==null||(ee=ee.client)==null?void 0:ee.source)||"react_sdk",version:(k==null||(te=k.overrides)==null||(te=te.client)==null?void 0:te.version)||(o==null||(re=o.overrides)==null||(re=re.client)==null?void 0:re.version)||"0.14.0"})}),onConnect:k?.onConnect||o?.onConnect,onDisconnect:k?.onDisconnect||o?.onDisconnect,onError:k?.onError||o?.onError,onMessage:k?.onMessage||o?.onMessage,onAudio:k?.onAudio||o?.onAudio,onDebug:k?.onDebug||o?.onDebug,onUnhandledClientToolCall:k?.onUnhandledClientToolCall||o?.onUnhandledClientToolCall,onVadScore:k?.onVadScore||o?.onVadScore,onInterruption:k?.onInterruption||o?.onInterruption,onAgentToolRequest:k?.onAgentToolRequest||o?.onAgentToolRequest,onAgentToolResponse:k?.onAgentToolResponse||o?.onAgentToolResponse,onConversationMetadata:k?.onConversationMetadata||o?.onConversationMetadata,onMCPToolCall:k?.onMCPToolCall||o?.onMCPToolCall,onMCPConnectionStatus:k?.onMCPConnectionStatus||o?.onMCPConnectionStatus,onAsrInitiationMetadata:k?.onAsrInitiationMetadata||o?.onAsrInitiationMetadata,onAgentChatResponsePart:k?.onAgentChatResponsePart||o?.onAgentChatResponsePart,onAudioAlignment:k?.onAudioAlignment||o?.onAudioAlignment,onModeChange:({mode:Fe})=>{var F;T(Fe),(F=k?.onModeChange||o?.onModeChange)==null||F({mode:Fe})},onStatusChange:({status:Fe})=>{var F;m(Fe),(F=k?.onStatusChange||o?.onStatusChange)==null||F({status:Fe})},onCanSendFeedbackChange:({canSendFeedback:Fe})=>{var F;y(Fe),(F=k?.onCanSendFeedbackChange||o?.onCanSendFeedbackChange)==null||F({canSendFeedback:Fe})}})),l.current=await d.current,u.current)throw await l.current.endSession(),l.current=null,d.current=null,new Error("Session cancelled during connection");return x.current!==void 0&&l.current.setMicMuted(x.current),E.current!==void 0&&l.current.setVolume({volume:E.current}),l.current.getId()}finally{d.current=null}},endSession:async()=>{u.current=!0;const k=d.current,R=l.current;l.current=null,k?await(await k).endSession():await R?.endSession()},setVolume:({volume:k})=>{var R;(R=l.current)==null||R.setVolume({volume:k})},getInputByteFrequencyData:()=>{var k;return(k=l.current)==null?void 0:k.getInputByteFrequencyData()},getOutputByteFrequencyData:()=>{var k;return(k=l.current)==null?void 0:k.getOutputByteFrequencyData()},getInputVolume:()=>{var k,R;return(k=(R=l.current)==null?void 0:R.getInputVolume())!=null?k:0},getOutputVolume:()=>{var k,R;return(k=(R=l.current)==null?void 0:R.getOutputVolume())!=null?k:0},sendFeedback:k=>{var R;(R=l.current)==null||R.sendFeedback(k)},getId:()=>{var k;return(k=l.current)==null?void 0:k.getId()},sendContextualUpdate:k=>{var R;(R=l.current)==null||R.sendContextualUpdate(k)},sendUserMessage:k=>{var R;(R=l.current)==null||R.sendUserMessage(k)},sendUserActivity:()=>{var k;(k=l.current)==null||k.sendUserActivity()},sendMCPToolApprovalResult:(k,R)=>{var O;(O=l.current)==null||O.sendMCPToolApprovalResult(k,R)},changeInputDevice:async k=>{if(l.current&&"changeInputDevice"in l.current)return await l.current.changeInputDevice(k);throw new Error("Device switching is only available for voice conversations")},changeOutputDevice:async k=>{if(l.current&&"changeOutputDevice"in l.current)return await l.current.changeOutputDevice(k);throw new Error("Device switching is only available for voice conversations")},status:h,canSendFeedback:g,micMuted:e,isSpeaking:S==="speaking"}}const K0="/assets/AI_voicebot_image-lrpUZ6MZ.png",eN="agent_8001khx0a8vee5z8gcab88e1xhye",tN=()=>{const[a,e]=N.useState(!1),i=N.useRef(!1),s=$A({onConnect:()=>console.log("ElevenLabs: connected"),onDisconnect:()=>{console.log("ElevenLabs: disconnected"),i.current=!1},onError:g=>console.error("ElevenLabs error:",g)}),{status:o,isSpeaking:l}=s,d=o==="connected",u=N.useCallback(async()=>{if(!i.current){i.current=!0;try{await navigator.mediaDevices.getUserMedia({audio:!0}),await s.startSession({agentId:eN,connectionType:"webrtc"})}catch(g){console.error("Pre-warm failed:",g),i.current=!1}}},[s]),h=N.useCallback(()=>{e(!0),i.current||u()},[u]),m=N.useCallback(async()=>{await s.endSession(),i.current=!1,e(!1)},[s]);return N.useEffect(()=>(document.body.style.overflow=a?"hidden":"",()=>{document.body.style.overflow=""}),[a]),N.useEffect(()=>{const g=y=>{y.key==="Escape"&&m()};return window.addEventListener("keydown",g),()=>window.removeEventListener("keydown",g)},[m]),N.useEffect(()=>()=>{s.endSession()},[]),v.jsxs("main",{className:"maruthompal-page",children:[v.jsx("section",{className:"maruthompal-hero",children:v.jsx("div",{className:"maruthompal-hero-overlay",children:v.jsx("div",{className:"container",children:v.jsxs("div",{className:"maruthompal-hero-inner",children:[v.jsxs("div",{className:"maruthompal-hero-content",children:[v.jsxs("div",{className:"maruthompal-badge",children:[v.jsx(f_,{size:16}),v.jsx("span",{children:"Traditional Herbal Blends"})]}),v.jsx("h1",{className:"maruthompal-title",children:"Maruthompal"}),v.jsx("p",{className:"maruthompal-subtitle",children:"Authentic South Indian herbal idly podis, masalas & teas  crafted from nature's finest medicinal plants. Every product is a time-honoured recipe that nourishes both body and soul."}),v.jsxs("div",{className:"maruthompal-stats",children:[v.jsxs("div",{className:"stat-item",children:[v.jsx("span",{className:"stat-num",children:"27+"}),v.jsx("span",{className:"stat-label",children:"Herbal Products"})]}),v.jsx("div",{className:"stat-divider"}),v.jsxs("div",{className:"stat-item",children:[v.jsx("span",{className:"stat-num",children:"100%"}),v.jsx("span",{className:"stat-label",children:"Natural"})]}),v.jsx("div",{className:"stat-divider"}),v.jsxs("div",{className:"stat-item",children:[v.jsx("span",{className:"stat-num",children:"0"}),v.jsx("span",{className:"stat-label",children:"Preservatives"})]})]})]}),v.jsxs("div",{className:"maruthompal-hero-img-wrap",onMouseEnter:u,onClick:h,role:"button",tabIndex:0,"aria-label":"Talk to our Voice AI Assistant",onKeyDown:g=>g.key==="Enter"&&h(),children:[v.jsx("div",{className:"ai-img-pulse-ring"}),v.jsx("img",{src:K0,alt:"Voice AI Assistant",className:"maruthompal-hero-img"}),v.jsxs("div",{className:"ai-img-hint",children:[v.jsx(Xv,{size:13}),v.jsx("span",{children:"Click to talk"})]})]})]})})})}),a&&v.jsx("div",{className:"ai-modal-overlay",onClick:g=>{g.target===g.currentTarget&&m()},children:v.jsxs("div",{className:"ai-modal",children:[v.jsx("button",{className:"ai-modal-close",onClick:m,"aria-label":"Close",children:v.jsx(uc,{size:20})}),v.jsxs("div",{className:`ai-status-badge ${d?l?"speaking":"listening":"connecting"}`,children:[!d&&v.jsx("span",{children:"Connecting"}),d&&l&&v.jsxs(v.Fragment,{children:[v.jsx(V_,{size:13}),v.jsx("span",{children:"Agent is speaking"})]}),d&&!l&&v.jsxs(v.Fragment,{children:[v.jsx(Xv,{size:13}),v.jsx("span",{children:"Listening to you"})]})]}),v.jsxs("div",{className:"ai-modal-img-wrap",children:[v.jsx("div",{className:`ai-modal-pulse ${d&&l?"active":""}`}),v.jsx("img",{src:K0,alt:"Voice AI Agent",className:`ai-modal-img ${d&&l?"speaking-glow":""}`})]}),v.jsxs("div",{className:"ai-modal-controls",children:[v.jsx("p",{className:"ai-modal-hint",children:d?"Speak naturally  ask about any Maruthompal product!":"Connecting to your herbal assistant"}),v.jsxs("button",{className:"ai-end-btn",onClick:m,children:[v.jsx(C_,{size:18}),"End conversation"]})]})]})}),v.jsx("section",{className:"maruthompal-products-section",children:v.jsxs("div",{className:"container",children:[v.jsxs("div",{className:"section-header",children:[v.jsx("h2",{className:"section-title-main",children:"Our Herbal Collection"}),v.jsx("p",{className:"section-desc",children:"Explore our complete range of traditional South Indian herbal blends, each crafted with care from premium medicinal plants."})]}),v.jsx("div",{className:"maruthompal-grid",children:Tb.map(g=>v.jsx(Yr,{product:g},g.id))})]})})]})},nN=()=>v.jsx(AE,{children:v.jsxs(HE,{children:[v.jsx(VE,{}),v.jsx(nw,{}),v.jsx(iw,{}),v.jsxs(sE,{children:[v.jsx(li,{path:"/",element:v.jsx(cw,{})}),v.jsx(li,{path:"/products",element:v.jsx(fw,{})}),v.jsx(li,{path:"/product/:id",element:v.jsx(mw,{})}),v.jsx(li,{path:"/checkout",element:v.jsx(vw,{})}),v.jsx(li,{path:"/order-summary",element:v.jsx(yw,{})}),v.jsx(li,{path:"/payment",element:v.jsx(bw,{})}),v.jsx(li,{path:"/order-confirmed",element:v.jsx(Sw,{})}),v.jsx(li,{path:"/maruthompal",element:v.jsx(tN,{})})]}),v.jsx(aw,{})]})});o1.createRoot(document.getElementById("root")).render(v.jsx(N.StrictMode,{children:v.jsx(nN,{})}));
